<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: budgetmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacebudgetmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">budgetmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the BudgetModule.  
<a href="namespacebudgetmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derived type for the Budget object.  <a href="structbudgetmodule_1_1budgettype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5d07ccf1026ac718f510c44519685c0f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f">budget_cr</a> (this, name_model)</td></tr>
<tr class="memdesc:a5d07ccf1026ac718f510c44519685c0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new budget object  <a href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f">More...</a><br /></td></tr>
<tr class="separator:a5d07ccf1026ac718f510c44519685c0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f49bba84f7cfcd15985c30c1fa25d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#ad6f49bba84f7cfcd15985c30c1fa25d9">budget_df</a> (this, maxsize, bdtype, bddim, labeltitle, bdzone)</td></tr>
<tr class="memdesc:ad6f49bba84f7cfcd15985c30c1fa25d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define information for this object  <a href="namespacebudgetmodule.html#ad6f49bba84f7cfcd15985c30c1fa25d9">More...</a><br /></td></tr>
<tr class="separator:ad6f49bba84f7cfcd15985c30c1fa25d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e31f388ad2141273e14cda050e53d3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a56e31f388ad2141273e14cda050e53d3">value_to_string</a> (val, string, big, small)</td></tr>
<tr class="memdesc:a56e31f388ad2141273e14cda050e53d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Convert a number to a string  <a href="namespacebudgetmodule.html#a56e31f388ad2141273e14cda050e53d3">More...</a><br /></td></tr>
<tr class="separator:a56e31f388ad2141273e14cda050e53d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298e22d844aa23c78ba9748e1f1b7593"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a298e22d844aa23c78ba9748e1f1b7593">budget_ot</a> (this, kstp, kper, iout)</td></tr>
<tr class="memdesc:a298e22d844aa23c78ba9748e1f1b7593"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output the budget table  <a href="namespacebudgetmodule.html#a298e22d844aa23c78ba9748e1f1b7593">More...</a><br /></td></tr>
<tr class="separator:a298e22d844aa23c78ba9748e1f1b7593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c4082bbb21d3d9eb4de08171f65149f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a3c4082bbb21d3d9eb4de08171f65149f">budget_da</a> (this)</td></tr>
<tr class="memdesc:a3c4082bbb21d3d9eb4de08171f65149f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate memory  <a href="namespacebudgetmodule.html#a3c4082bbb21d3d9eb4de08171f65149f">More...</a><br /></td></tr>
<tr class="separator:a3c4082bbb21d3d9eb4de08171f65149f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39509e944da4b291d11e868a53bc9ae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#ae39509e944da4b291d11e868a53bc9ae">reset</a> (this)</td></tr>
<tr class="memdesc:ae39509e944da4b291d11e868a53bc9ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Reset the budget object  <a href="namespacebudgetmodule.html#ae39509e944da4b291d11e868a53bc9ae">More...</a><br /></td></tr>
<tr class="separator:ae39509e944da4b291d11e868a53bc9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60641e5c71aa6a3e9f4660ceefe01ffe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a60641e5c71aa6a3e9f4660ceefe01ffe">add_single_entry</a> (this, rin, rout, delt, text, isupress_accumulate, rowlabel)</td></tr>
<tr class="memdesc:a60641e5c71aa6a3e9f4660ceefe01ffe"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add a single row of information  <a href="namespacebudgetmodule.html#a60641e5c71aa6a3e9f4660ceefe01ffe">More...</a><br /></td></tr>
<tr class="separator:a60641e5c71aa6a3e9f4660ceefe01ffe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76969d53fb39887ed817359f4891c2b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#ad76969d53fb39887ed817359f4891c2b">add_multi_entry</a> (this, budterm, delt, budtxt, isupress_accumulate, rowlabel)</td></tr>
<tr class="memdesc:ad76969d53fb39887ed817359f4891c2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add multiple rows of information  <a href="namespacebudgetmodule.html#ad76969d53fb39887ed817359f4891c2b">More...</a><br /></td></tr>
<tr class="separator:ad76969d53fb39887ed817359f4891c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f48a08dc7b9e719b38cea87bd9a07fa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a5f48a08dc7b9e719b38cea87bd9a07fa">allocate_scalars</a> (this, name_model)</td></tr>
<tr class="memdesc:a5f48a08dc7b9e719b38cea87bd9a07fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief allocate scalar variables  <a href="namespacebudgetmodule.html#a5f48a08dc7b9e719b38cea87bd9a07fa">More...</a><br /></td></tr>
<tr class="separator:a5f48a08dc7b9e719b38cea87bd9a07fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab12053853e14f7b37219889b561eb652"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#ab12053853e14f7b37219889b561eb652">allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:ab12053853e14f7b37219889b561eb652"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief allocate array variables  <a href="namespacebudgetmodule.html#ab12053853e14f7b37219889b561eb652">More...</a><br /></td></tr>
<tr class="separator:ab12053853e14f7b37219889b561eb652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a913e6d6fa8bd406cc858211a23d35a48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a913e6d6fa8bd406cc858211a23d35a48">resize</a> (this, maxsize)</td></tr>
<tr class="memdesc:a913e6d6fa8bd406cc858211a23d35a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Resize the budget object  <a href="namespacebudgetmodule.html#a913e6d6fa8bd406cc858211a23d35a48">More...</a><br /></td></tr>
<tr class="separator:a913e6d6fa8bd406cc858211a23d35a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a917d4897942de165ea88d0c1f0850d8e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a> (flow, rin, rout)</td></tr>
<tr class="memdesc:a917d4897942de165ea88d0c1f0850d8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Rate accumulator subroutine  <a href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">More...</a><br /></td></tr>
<tr class="separator:a917d4897942de165ea88d0c1f0850d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeca274b138e7c0cf4c5e1ec97e875e59"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#aeca274b138e7c0cf4c5e1ec97e875e59">set_ibudcsv</a> (this, ibudcsv)</td></tr>
<tr class="memdesc:aeca274b138e7c0cf4c5e1ec97e875e59"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set unit number for csv output file  <a href="namespacebudgetmodule.html#aeca274b138e7c0cf4c5e1ec97e875e59">More...</a><br /></td></tr>
<tr class="separator:aeca274b138e7c0cf4c5e1ec97e875e59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66c74a8a82039a89d304d5a37a492da1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a66c74a8a82039a89d304d5a37a492da1">writecsv</a> (this, totim)</td></tr>
<tr class="memdesc:a66c74a8a82039a89d304d5a37a492da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Write csv output  <a href="namespacebudgetmodule.html#a66c74a8a82039a89d304d5a37a492da1">More...</a><br /></td></tr>
<tr class="separator:a66c74a8a82039a89d304d5a37a492da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf33b8aeb57836770515b94d54ccff5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebudgetmodule.html#a7cf33b8aeb57836770515b94d54ccff5">write_csv_header</a> (this)</td></tr>
<tr class="memdesc:a7cf33b8aeb57836770515b94d54ccff5"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Write csv header  <a href="namespacebudgetmodule.html#a7cf33b8aeb57836770515b94d54ccff5">More...</a><br /></td></tr>
<tr class="separator:a7cf33b8aeb57836770515b94d54ccff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>New entries can be added for each time step, however, the same number of entries must be provided, and they must be provided in the same order. If not, the module will terminate with an error.</p>
<p>Maxsize is required as part of the df method and the arrays will be allocated to maxsize. If additional entries beyond maxsize are added, the arrays will dynamically increase in size, however, to avoid allocation and copying, it is best to set maxsize large enough up front.</p>
<p>vbvl(1, :) contains cumulative rate in vbvl(2, :) contains cumulative rate out vbvl(3, :) contains rate in vbvl(4, :) contains rate out vbnm(:) contains a LENPACKAGENAME character text string for each entry rowlabel(:) contains a LENPACKAGENAME character text string to write as a label for each entry </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ad76969d53fb39887ed817359f4891c2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76969d53fb39887ed817359f4891c2b">&#9670;&nbsp;</a></span>add_multi_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::add_multi_entry </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:, :), intent(in)&#160;</td>
          <td class="paramname"><em>budterm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenbudtxt), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>budtxt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>isupress_accumulate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenpackagename), intent(in), optional&#160;</td>
          <td class="paramname"><em>rowlabel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add information corresponding to one multiple rows in the budget table budterm is an array with inflow in column 1 and outflow in column 2 delt is the time step length budtxt is the name of the entries. It should have one entry for each row in budterm isupress_accumulate is an optional flag. If specified as 1, then the volume is NOT added to the accumulators on vbvl(1, :) and vbvl(2, :). rowlabel is a LENPACKAGENAME character text entry that is written to the right of the table. It can be used for adding package names to budget entries. For multiple entries, the same rowlabel is used for each entry. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">budterm</td><td>array of budget terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delt</td><td>time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">budtxt</td><td>name of the entries </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isupress_accumulate</td><td>suppress accumulate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowlabel</td><td>row label </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00456">456</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">                                          !&lt; BudgetType object</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:, :)</span>, <span class="keywordtype">intent(in)</span> :: budterm<span class="comment">                   !&lt; array of budget terms</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: delt<span class="comment">                                       !&lt; time step length</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: budtxt<span class="comment">       !&lt; name of the entries</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: isupress_accumulate<span class="comment">          !&lt; suppress accumulate</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordtype">character(len=LENPACKAGENAME)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: rowlabel<span class="comment">    !&lt; row label</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtbuderr = &amp;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="stringliteral">&quot;(&#39;Error in MODFLOW 6.&#39;, &#39;Entries do not match: &#39;, (a), (a) )&quot;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iscv, i</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nbudterms, maxsize</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    iscv = 0</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(isupress_accumulate)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      iscv = isupress_accumulate</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">! -- ensure budget arrays are large enough</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    nbudterms = <span class="keyword">size</span>(budtxt)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    maxsize = this%msum - 1 + nbudterms</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (maxsize &gt; this%maxsize) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keyword">call </span>this%resize(maxsize)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">! -- Process each of the multi-entry budget terms</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(budtxt)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">! -- If budget has been written at least once, then make sure that the present</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">!    text entry matches the last text entry</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">if</span>(this%written_once) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;          <span class="keywordflow">if</span>(trim(adjustl(this%vbnm(this%msum))) /=                            &amp;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;              trim(adjustl(budtxt(i)))) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keyword">write</span>(errmsg, fmtbuderr) trim(adjustl(this%vbnm(this%msum))),      &amp;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                     trim(adjustl(budtxt(i)))</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">if</span>(iscv == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        this%vbvl(1, this%msum)=this%vbvl(1,this%msum) + budterm(1, i) * delt</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        this%vbvl(2, this%msum)=this%vbvl(2,this%msum) + budterm(2, i) * delt</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      this%vbvl(3, this%msum) = budterm(1, i)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      this%vbvl(4, this%msum) = budterm(2, i)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      this%vbnm(this%msum) = adjustr(budtxt(i))</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">present</span>(rowlabel)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        this%rowlabel(this%msum) = adjustl(rowlabel)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        this%labeled = .true.</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      this%msum = this%msum + 1</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">! -- Check for errors</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span>(count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Could not add multi-entry&#39;</span>, terminate=.true.)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_cgraph.png" border="0" usemap="#namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_cgraph" alt=""/></div>
<map name="namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_cgraph" id="namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_cgraph">
<area shape="rect" title="@ brief Add multiple rows of information" alt="" coords="5,35,195,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="243,17,427,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="247,68,422,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="475,68,613,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="661,27,829,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="661,93,829,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="877,5,1072,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="891,57,1059,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_icgraph.png" border="0" usemap="#namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_icgraph" alt=""/></div>
<map name="namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_icgraph" id="namespacebudgetmodule_ad76969d53fb39887ed817359f4891c2b_icgraph">
<area shape="rect" title="@ brief Add multiple rows of information" alt="" coords="252,5,441,47"/>
<area shape="rect" href="structbudgetmodule_1_1budgettype.html#a57a1290c59abcb66b2d687e49748be14" title=" " alt="" coords="5,5,204,47"/>
</map>
</div>

</div>
</div>
<a id="a60641e5c71aa6a3e9f4660ceefe01ffe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60641e5c71aa6a3e9f4660ceefe01ffe">&#9670;&nbsp;</a></span>add_single_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::add_single_entry </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>rin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>rout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenbudtxt), intent(in)&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>isupress_accumulate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenpackagename), intent(in), optional&#160;</td>
          <td class="paramname"><em>rowlabel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add information corresponding to one row in the budget table rin the inflow rate rout is the outflow rate delt is the time step length text is the name of the entry isupress_accumulate is an optional flag. If specified as 1, then the volume is NOT added to the accumulators on vbvl(1, :) and vbvl(2, :). rowlabel is a LENPACKAGENAME character text entry that is written to the right of the table. It can be used for adding package names to budget entries. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rin</td><td>inflow rate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rout</td><td>outflow rate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delt</td><td>time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">text</td><td>name of the entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isupress_accumulate</td><td>accumulate flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowlabel</td><td>row label </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00386">386</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">                                         !&lt; BudgetType object</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: rin<span class="comment">                                       !&lt; inflow rate</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: rout<span class="comment">                                      !&lt; outflow rate</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: delt<span class="comment">                                      !&lt; time step length</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">intent(in)</span> :: text<span class="comment">                      !&lt; name of the entry</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: isupress_accumulate<span class="comment">         !&lt; accumulate flag</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">character(len=LENPACKAGENAME)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: rowlabel<span class="comment">   !&lt; row label</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtbuderr = &amp;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="stringliteral">&quot;(&#39;Error in MODFLOW 6.&#39;, &#39;Entries do not match: &#39;, (a), (a) )&quot;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iscv</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: maxsize</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    iscv = 0</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(isupress_accumulate)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      iscv = isupress_accumulate</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">! -- ensure budget arrays are large enough</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    maxsize = this%msum</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (maxsize &gt; this%maxsize) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keyword">call </span>this%resize(maxsize)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">! -- If budget has been written at least once, then make sure that the present</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">!    text entry matches the last text entry</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span>(this%written_once) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">if</span>(trim(adjustl(this%vbnm(this%msum))) /= trim(adjustl(text))) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keyword">write</span>(errmsg, fmtbuderr) trim(adjustl(this%vbnm(this%msum))), &amp;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                 trim(adjustl(text))</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span>(iscv == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      this%vbvl(1, this%msum)=this%vbvl(1,this%msum) + rin * delt</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      this%vbvl(2, this%msum)=this%vbvl(2,this%msum) + rout * delt</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    this%vbvl(3, this%msum) = rin</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    this%vbvl(4, this%msum) = rout</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    this%vbnm(this%msum) = adjustr(text)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(rowlabel)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      this%rowlabel(this%msum) = adjustl(rowlabel)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      this%labeled = .true.</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    this%msum = this%msum + 1</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_cgraph.png" border="0" usemap="#namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_cgraph" alt=""/></div>
<map name="namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_cgraph" id="namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_cgraph">
<area shape="rect" title="@ brief Add a single row of information" alt="" coords="5,61,200,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="248,68,423,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="471,68,609,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="657,27,825,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="657,93,825,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="873,5,1068,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="887,57,1055,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_icgraph.png" border="0" usemap="#namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_icgraph" alt=""/></div>
<map name="namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_icgraph" id="namespacebudgetmodule_a60641e5c71aa6a3e9f4660ceefe01ffe_icgraph">
<area shape="rect" title="@ brief Add a single row of information" alt="" coords="252,5,447,47"/>
<area shape="rect" href="structbudgetmodule_1_1budgettype.html#a57a1290c59abcb66b2d687e49748be14" title=" " alt="" coords="5,5,204,47"/>
</map>
</div>

</div>
</div>
<a id="ab12053853e14f7b37219889b561eb652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab12053853e14f7b37219889b561eb652">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate array variables of this budget object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>BudgetType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00565">565</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">           !&lt; BudgetType object</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">! -- If redefining, then need to deallocate/reallocate</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">associated</span>(this%vbvl)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keyword">deallocate</span>(this%vbvl)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keyword">nullify</span>(this%vbvl)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">associated</span>(this%vbnm)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keyword">deallocate</span>(this%vbnm)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keyword">nullify</span>(this%vbnm)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">associated</span>(this%rowlabel)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keyword">deallocate</span>(this%rowlabel)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keyword">nullify</span>(this%rowlabel)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keyword">allocate</span>(this%vbvl(4, this%maxsize))</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keyword">allocate</span>(this%vbnm(this%maxsize))</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keyword">allocate</span>(this%rowlabel(this%maxsize))</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">! -- Initialize values</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    this%vbvl(:, :) = dzero</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    this%vbnm(:) = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    this%rowlabel(:) = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f48a08dc7b9e719b38cea87bd9a07fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f48a08dc7b9e719b38cea87bd9a07fa">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name_model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate scalar variables of this budget object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name_model</td><td>name of the model </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00527">527</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">                      !&lt; BudgetType object</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name_model<span class="comment">     !&lt; name of the model</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">allocate</span>(this%msum)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">allocate</span>(this%maxsize)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keyword">allocate</span>(this%budperc)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keyword">allocate</span>(this%written_once)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keyword">allocate</span>(this%labeled)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keyword">allocate</span>(this%bdtype)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keyword">allocate</span>(this%bddim)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">allocate</span>(this%labeltitle)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keyword">allocate</span>(this%bdzone)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keyword">allocate</span>(this%ibudcsv)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">allocate</span>(this%icsvheader)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">! -- Initialize values</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    this%msum = 0</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    this%maxsize = 0</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    this%written_once = .false.</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    this%labeled = .false.</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    this%bdtype = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    this%bddim = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    this%labeltitle = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    this%bdzone = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    this%ibudcsv = 0</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    this%icsvheader = 0</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d07ccf1026ac718f510c44519685c0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d07ccf1026ac718f510c44519685c0f">&#9670;&nbsp;</a></span>budget_cr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public budgetmodule::budget_cr </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>), pointer&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name_model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new budget object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name_model</td><td>name of the model </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00082">82</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">type</span>(BudgetType), <span class="keywordtype">pointer</span> :: this<span class="comment">           !&lt; BudgetType object</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name_model<span class="comment">  !&lt; name of the model</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">! -- Create the object</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">allocate</span>(this)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">! -- Allocate scalars</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">call </span>this%allocate_scalars(name_model)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_a5d07ccf1026ac718f510c44519685c0f_icgraph.png" border="0" usemap="#namespacebudgetmodule_a5d07ccf1026ac718f510c44519685c0f_icgraph" alt=""/></div>
<map name="namespacebudgetmodule_a5d07ccf1026ac718f510c44519685c0f_icgraph" id="namespacebudgetmodule_a5d07ccf1026ac718f510c44519685c0f_icgraph">
<area shape="rect" title="@ brief Create a new budget object" alt="" coords="1773,507,1961,534"/>
<area shape="rect" href="namespacegwtaptmodule.html#a1e8922a2b5914568394ce0894b253669" title=" " alt="" coords="1544,235,1725,276"/>
<area shape="rect" href="namespacebudgetobjectmodule.html#a0b10034ed28f5a4131a181f960908a1d" title=" " alt="" coords="1557,300,1713,341"/>
<area shape="rect" href="namespacegwfmodule.html#ab7c4f16fdcabd8814e3649d4950a4c9b" title=" " alt="" coords="1323,579,1470,606"/>
<area shape="rect" href="namespacegwtmodule.html#ad4f6eefd4112176d49bd99d8944bdef3" title=" " alt="" coords="1561,457,1708,483"/>
<area shape="rect" href="namespacegwtistmodule.html#aaec4957a4392e2394289597478328dd0" title="@ brief Allocate and read method for package" alt="" coords="1557,558,1712,585"/>
<area shape="rect" href="namespacegwfmvrmodule.html#a179c35a501fee8f0e98b62f5560f157e" title=" " alt="" coords="1547,609,1722,635"/>
<area shape="rect" href="namespacegwtmvtmodule.html#a48546e7e988f509d98457258a8b0747d" title=" " alt="" coords="1547,659,1722,686"/>
<area shape="rect" href="namespacegwtaptmodule.html#a624d6d488cb111e0c05004d1f0f313f3" title=" " alt="" coords="1303,201,1491,243"/>
<area shape="rect" href="namespacebudgetobjectmodule.html#aa7df76ed823c2253dc6d34757e29fbe0" title=" " alt="" coords="1317,267,1476,308"/>
<area shape="rect" href="namespacelakmodule.html#a3dc63137b0190ec81f528211613b3f30" title=" " alt="" coords="1315,332,1478,373"/>
<area shape="rect" href="namespacemawmodule.html#ae2307716e9a2632482c8cc9aec4caae7" title=" " alt="" coords="1303,397,1490,439"/>
<area shape="rect" href="namespacegwfmvrmodule.html#a8670bd8f16ec79d4b34a8e3be8f7266c" title=" " alt="" coords="1297,463,1496,504"/>
<area shape="rect" href="namespacegwtmvtmodule.html#a3c4f0ff3c7bc70fe45097a1bde191b47" title=" " alt="" coords="1297,5,1496,47"/>
<area shape="rect" href="namespacesfrmodule.html#a7fa3402fe639ad226e2ade9195cc66b3" title="Setup budget object for package." alt="" coords="1319,71,1475,112"/>
<area shape="rect" href="namespaceuzfmodule.html#a3543020d64fb60e48c551865d683e5c4" title=" " alt="" coords="1315,136,1478,177"/>
<area shape="rect" href="namespacegwtfmimodule.html#aa2d7d9f3d9643a001e151f1e97603f56" title=" " alt="" coords="1081,267,1236,308"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a0043d2fa8d8b96e41e5e0fdfecaadae7" title="Set the models to be used for the simulation." alt="" coords="1068,547,1249,588"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,547,1020,588"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,547,773,588"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,554,544,581"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,529,276,555"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,579,281,606"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,579,53,606"/>
<area shape="rect" href="namespacegwfgwfexchangemodule.html#adc570e5db32482ada98b47690b1c92a5" title=" " alt="" coords="1305,631,1488,672"/>
</map>
</div>

</div>
</div>
<a id="a3c4082bbb21d3d9eb4de08171f65149f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c4082bbb21d3d9eb4de08171f65149f">&#9670;&nbsp;</a></span>budget_da()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::budget_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Deallocate budget memory </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>BudgetType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00325">325</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">      !&lt; BudgetType object</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">deallocate</span>(this%msum)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">deallocate</span>(this%maxsize)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">deallocate</span>(this%budperc)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">deallocate</span>(this%written_once)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keyword">deallocate</span>(this%labeled)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keyword">deallocate</span>(this%bdtype)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">deallocate</span>(this%bddim)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">deallocate</span>(this%labeltitle)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">deallocate</span>(this%bdzone)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">! -- Arrays</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">deallocate</span>(this%vbvl)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keyword">deallocate</span>(this%vbnm)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">deallocate</span>(this%rowlabel)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6f49bba84f7cfcd15985c30c1fa25d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6f49bba84f7cfcd15985c30c1fa25d9">&#9670;&nbsp;</a></span>budget_df()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::budget_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>maxsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), optional&#160;</td>
          <td class="paramname"><em>bdtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), optional&#160;</td>
          <td class="paramname"><em>bddim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), optional&#160;</td>
          <td class="paramname"><em>labeltitle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), optional&#160;</td>
          <td class="paramname"><em>bdzone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate arrays and set member variables </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxsize</td><td>maximum size of budget arrays </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">bdtype</td><td>type of budget, default is VOLUME </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">bddim</td><td>dimensions of terms, default is L**3 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">labeltitle</td><td>budget label, default is PACKAGE NAME </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">bdzone</td><td>corresponding zone, default is ENTIRE MODEL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00104">104</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">                    !&lt; BudgetType object</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: maxsize<span class="comment">          !&lt; maximum size of budget arrays</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span> :: bdtype<span class="comment">         !&lt; type of budget, default is VOLUME</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span> :: bddim<span class="comment">          !&lt; dimensions of terms, default is L**3</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span> :: labeltitle<span class="comment">     !&lt; budget label, default is PACKAGE NAME</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span> :: bdzone<span class="comment">         !&lt; corresponding zone, default is ENTIRE MODEL</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">! -- Set values</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    this%maxsize = maxsize</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">! -- Allocate arrays</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">call </span>this%allocate_arrays()</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">! -- Set the budget type</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(bdtype)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      this%bdtype = bdtype</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      this%bdtype = <span class="stringliteral">&#39;VOLUME&#39;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">! -- Set the budget dimension</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(bddim)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      this%bddim = bddim</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      this%bddim = <span class="stringliteral">&#39;L**3&#39;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">! -- Set the budget zone</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(bdzone)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      this%bdzone = bdzone</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      this%bdzone = <span class="stringliteral">&#39;ENTIRE MODEL&#39;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">! -- Set the label title</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(labeltitle)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      this%labeltitle = labeltitle</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      this%labeltitle = <span class="stringliteral">&#39;PACKAGE NAME&#39;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a298e22d844aa23c78ba9748e1f1b7593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298e22d844aa23c78ba9748e1f1b7593">&#9670;&nbsp;</a></span>budget_ot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::budget_ot </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write the budget table for the current set of budget information. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kstp</td><td>time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kper</td><td>stress period </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>output unit number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00185">185</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">            !&lt; BudgetType object</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp<span class="comment">     !&lt; time step</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper<span class="comment">     !&lt; stress period</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment">     !&lt; output unit number</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">character(len=17)</span> :: val1, val2</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: msum1, l</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordtype">    real</span>(DP) :: two, hund, bigvl1, bigvl2, small,                              &amp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                totrin, totrot, totvin, totvot, diffr, adiffr,                 &amp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                pdiffr, pdiffv, avgrat, diffv, adiffv, avgvol</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">! -- Set constants</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    two = 2.d0</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    hund = 100.d0</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    bigvl1 = 9.99999d11</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    bigvl2 = 9.99999d10</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    small = 0.1d0</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">! -- Determine number of individual budget entries.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    this%budperc = dzero</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    msum1 = this%msum - 1</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span>(msum1 &lt;= 0) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">! -- Clear rate and volume accumulators.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    totrin = dzero</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    totrot = dzero</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    totvin = dzero</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    totvot = dzero</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">! -- Add rates and volumes (in and out) to accumulators.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">do</span> l=1,msum1</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      totrin = totrin + this%vbvl(3,l)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      totrot = totrot + this%vbvl(4,l)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      totvin = totvin + this%vbvl(1,l)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      totvot = totvot + this%vbvl(2,l)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">! -- Print time step number and stress period number.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span>(this%labeled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keyword">write</span>(iout,261) trim(adjustl(this%bdtype)), trim(adjustl(this%bdzone)),  &amp;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                      <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keyword">write</span>(iout,266) trim(adjustl(this%bdtype)), trim(adjustl(this%bddim)),   &amp;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                      trim(adjustl(this%bddim)),this%labeltitle</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keyword">write</span>(iout,260) trim(adjustl(this%bdtype)), trim(adjustl(this%bdzone)),  &amp;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                      <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">write</span>(iout,265) trim(adjustl(this%bdtype)), trim(adjustl(this%bddim)),   &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                      trim(adjustl(this%bddim))</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">! -- Print individual inflow rates and volumes and their totals.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">do</span> l=1,msum1</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keyword">call </span>value_to_string(this%vbvl(1, l), val1, bigvl1, small)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keyword">call </span>value_to_string(this%vbvl(3, l), val2, bigvl1, small)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span>(this%labeled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">write</span>(iout,276) this%vbnm(l), val1, this%vbnm(l), val2, this%rowlabel(l)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keyword">write</span>(iout,275) this%vbnm(l), val1, this%vbnm(l), val2</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">call </span>value_to_string(totvin, val1, bigvl1, small)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">call </span>value_to_string(totrin, val2, bigvl1, small)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">write</span>(iout,286) val1, val2</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! -- Print individual outflow rates and volumes and their totals.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">write</span>(iout,287)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">do</span> l=1,msum1</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keyword">call </span>value_to_string(this%vbvl(2,l), val1, bigvl1, small)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keyword">call </span>value_to_string(this%vbvl(4,l), val2, bigvl1, small)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">if</span>(this%labeled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">write</span>(iout,276) this%vbnm(l), val1, this%vbnm(l), val2, this%rowlabel(l)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">write</span>(iout,275) this%vbnm(l), val1, this%vbnm(l), val2</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">call </span>value_to_string(totvot, val1, bigvl1, small)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keyword">call </span>value_to_string(totrot, val2, bigvl1, small)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">write</span>(iout,298) val1, val2</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">! -- Calculate the difference between inflow and outflow.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">! -- Calculate difference between rate in and rate out.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    diffr=totrin-totrot</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    adiffr=abs(diffr)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">! -- Calculate percent difference between rate in and rate out.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    pdiffr = dzero</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    avgrat=(totrin+totrot)/two</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span>(avgrat /= dzero) pdiffr = hund * diffr / avgrat</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    this%budperc = pdiffr</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">! -- Calculate difference between volume in and volume out.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    diffv = totvin - totvot</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    adiffv = abs(diffv)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">! -- Get percent difference between volume in and volume out.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    pdiffv = dzero</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    avgvol=(totvin+totvot)/two</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span>(avgvol /= dzero) pdiffv= hund * diffv / avgvol</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">! -- Print differences and percent differences between input</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">! -- and output rates and volumes.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keyword">call </span>value_to_string(diffv, val1, bigvl2, small)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">call </span>value_to_string(diffr, val2, bigvl2, small)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">write</span>(iout,299) val1, val2</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">write</span>(iout,300) pdiffv, pdiffr</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">! -- set written_once to .true.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    this%written_once = .true.</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    260 <span class="keyword">FORMAT</span>(//2x,a,<span class="stringliteral">&#39; BUDGET FOR &#39;</span>,a,<span class="stringliteral">&#39; AT END OF&#39;</span>                            &amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        ,<span class="stringliteral">&#39; TIME STEP&#39;</span>,i5,<span class="stringliteral">&#39;, STRESS PERIOD&#39;</span>,i4/2x,78(<span class="stringliteral">&#39;-&#39;</span>))</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    261 <span class="keyword">FORMAT</span>(//2x,a,<span class="stringliteral">&#39; BUDGET FOR &#39;</span>,a,<span class="stringliteral">&#39; AT END OF&#39;</span>                            &amp;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        ,<span class="stringliteral">&#39; TIME STEP&#39;</span>,i5,<span class="stringliteral">&#39;, STRESS PERIOD&#39;</span>,i4/2x,99(<span class="stringliteral">&#39;-&#39;</span>))</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    265 <span class="keyword">FORMAT</span>(1x,/5x,<span class="stringliteral">&#39;CUMULATIVE &#39;</span>,a,6x,a,7x                                  &amp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        ,<span class="stringliteral">&#39;RATES FOR THIS TIME STEP&#39;</span>,6x,a,<span class="stringliteral">&#39;/T&#39;</span>/5x,18(<span class="stringliteral">&#39;-&#39;</span>),17x,24(<span class="stringliteral">&#39;-&#39;</span>)           &amp;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        //11x,<span class="stringliteral">&#39;IN:&#39;</span>,38x,<span class="stringliteral">&#39;IN:&#39;</span>/11x,<span class="stringliteral">&#39;---&#39;</span>,38x,<span class="stringliteral">&#39;---&#39;</span>)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    266 <span class="keyword">FORMAT</span>(1x,/5x,<span class="stringliteral">&#39;CUMULATIVE &#39;</span>,a,6x,a,7x                                  &amp;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        ,<span class="stringliteral">&#39;RATES FOR THIS TIME STEP&#39;</span>,6x,a,<span class="stringliteral">&#39;/T&#39;</span>,10x,a16,                         &amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        /5x,18(<span class="stringliteral">&#39;-&#39;</span>),17x,24(<span class="stringliteral">&#39;-&#39;</span>),21x,16(<span class="stringliteral">&#39;-&#39;</span>)                                    &amp;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        //11x,<span class="stringliteral">&#39;IN:&#39;</span>,38x,<span class="stringliteral">&#39;IN:&#39;</span>/11x,<span class="stringliteral">&#39;---&#39;</span>,38x,<span class="stringliteral">&#39;---&#39;</span>)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    275 <span class="keyword">FORMAT</span>(1x,3x,a16,<span class="stringliteral">&#39; =&#39;</span>,a17,6x,a16,<span class="stringliteral">&#39; =&#39;</span>,a17)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    276 <span class="keyword">FORMAT</span>(1x,3x,a16,<span class="stringliteral">&#39; =&#39;</span>,a17,6x,a16,<span class="stringliteral">&#39; =&#39;</span>,a17,5x,a16)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    286 <span class="keyword">FORMAT</span>(1x,/12x,<span class="stringliteral">&#39;TOTAL IN =&#39;</span>,a,14x,<span class="stringliteral">&#39;TOTAL IN =&#39;</span>,a)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    287 <span class="keyword">FORMAT</span>(1x,/10x,<span class="stringliteral">&#39;OUT:&#39;</span>,37x,<span class="stringliteral">&#39;OUT:&#39;</span>/10x,4(<span class="stringliteral">&#39;-&#39;</span>),37x,4(<span class="stringliteral">&#39;-&#39;</span>))</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    298 <span class="keyword">FORMAT</span>(1x,/11x,<span class="stringliteral">&#39;TOTAL OUT =&#39;</span>,a,13x,<span class="stringliteral">&#39;TOTAL OUT =&#39;</span>,a)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    299 <span class="keyword">FORMAT</span>(1x,/12x,<span class="stringliteral">&#39;IN - OUT =&#39;</span>,a,14x,<span class="stringliteral">&#39;IN - OUT =&#39;</span>,a)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    300 <span class="keyword">FORMAT</span>(1x,/1x,<span class="stringliteral">&#39;PERCENT DISCREPANCY =&#39;</span>,f15.2                            &amp;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        ,5x,<span class="stringliteral">&#39;PERCENT DISCREPANCY =&#39;</span>,f15.2/)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_a298e22d844aa23c78ba9748e1f1b7593_cgraph.png" border="0" usemap="#namespacebudgetmodule_a298e22d844aa23c78ba9748e1f1b7593_cgraph" alt=""/></div>
<map name="namespacebudgetmodule_a298e22d844aa23c78ba9748e1f1b7593_cgraph" id="namespacebudgetmodule_a298e22d844aa23c78ba9748e1f1b7593_cgraph">
<area shape="rect" title="@ brief Output the budget table" alt="" coords="5,13,195,39"/>
<area shape="rect" href="namespacebudgetmodule.html#a56e31f388ad2141273e14cda050e53d3" title="@ brief Convert a number to a string" alt="" coords="243,5,403,47"/>
</map>
</div>

</div>
</div>
<a id="a917d4897942de165ea88d0c1f0850d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a917d4897942de165ea88d0c1f0850d8e">&#9670;&nbsp;</a></span>rate_accumulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public budgetmodule::rate_accumulator </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in), contiguous&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out)&#160;</td>
          <td class="paramname"><em>rin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out)&#160;</td>
          <td class="paramname"><em>rout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Routing for tallying inflows and outflows of an array </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flow</td><td>array of flows </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rin</td><td>calculated sum of inflows </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rout</td><td>calculated sum of outflows </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00646">646</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(in)</span> :: flow<span class="comment">  !&lt; array of flows</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span> :: rin<span class="comment">                            !&lt; calculated sum of inflows</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span> :: rout<span class="comment">                           !&lt; calculated sum of outflows</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    rin = dzero</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    rout = dzero</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(flow)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">if</span> (flow(n) &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        rout = rout - flow(n)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        rin = rin + flow(n)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_a917d4897942de165ea88d0c1f0850d8e_icgraph.png" border="0" usemap="#namespacebudgetmodule_a917d4897942de165ea88d0c1f0850d8e_icgraph" alt=""/></div>
<map name="namespacebudgetmodule_a917d4897942de165ea88d0c1f0850d8e_icgraph" id="namespacebudgetmodule_a917d4897942de165ea88d0c1f0850d8e_icgraph">
<area shape="rect" title="@ brief Rate accumulator subroutine" alt="" coords="240,230,391,271"/>
<area shape="rect" href="namespacebndmodule.html#a6e1b610b6f33bd977f3541ad9c610e93" title="@ brief Add package flows to model budget." alt="" coords="23,5,174,32"/>
<area shape="rect" href="namespacechdmodule.html#abbd0e7988d54f58f56548abb7146de97" title=" " alt="" coords="25,56,173,83"/>
<area shape="rect" href="namespacegwtcncmodule.html#ad723ceb706fe12f698c3f8b1b4737d3f" title=" " alt="" coords="13,107,184,133"/>
<area shape="rect" href="namespacegwfcsubmodule.html#aaa5fa6b598abf6a6b02566ac6e011d02" title="@ brief Model budget calculation for package" alt="" coords="5,157,192,184"/>
<area shape="rect" href="namespacegwtfmimodule.html#ac152d511607839ed58034e6c05cd1f21" title=" " alt="" coords="13,208,184,235"/>
<area shape="rect" href="namespacegwfgwfexchangemodule.html#a71c2790d83529c51a5fee3fe1d9bdd04" title=" " alt="" coords="7,259,190,301"/>
<area shape="rect" href="namespacegwtistmodule.html#ae29f3d0e014cba69c1aa21c6a74afa89" title="@ brief Add package flows to model budget." alt="" coords="19,325,178,352"/>
<area shape="rect" href="namespacegwtmstmodule.html#a55c5b3f7739e5780f9c8174ed786f8b4" title="@ brief Calculate budget terms for package" alt="" coords="11,376,187,403"/>
<area shape="rect" href="namespacegwfstomodule.html#a08bfa3f870bb260a7efb7fde537406ec" title="@ brief Model budget calculation for package" alt="" coords="15,427,182,453"/>
<area shape="rect" href="namespaceuzfmodule.html#aac10ef422938ecc1d634278440fa3b66" title=" " alt="" coords="27,477,170,504"/>
</map>
</div>

</div>
</div>
<a id="ae39509e944da4b291d11e868a53bc9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae39509e944da4b291d11e868a53bc9ae">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::reset </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reset the budget object in preparation for next set of entries </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>BudgetType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00353">353</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">     !&lt; BudgetType object</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    this%msum = 1</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">do</span> i = 1, this%maxsize</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      this%vbvl(3, i) = dzero</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      this%vbvl(4, i) = dzero</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a913e6d6fa8bd406cc858211a23d35a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a913e6d6fa8bd406cc858211a23d35a48">&#9670;&nbsp;</a></span>resize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::resize </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>maxsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If the size wasn't allocated to be large enough, then the budget object we reallocate itself to a larger size. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxsize</td><td>maximum size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00603">603</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">              !&lt; BudgetType object</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: maxsize<span class="comment">    !&lt; maximum size</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:, :)</span>, <span class="keywordtype">allocatable</span> :: vbvl</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: vbnm</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">character(len=LENPACKAGENAME)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: rowlabel</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: maxsizeold</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">! -- allocate and copy into local storage</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    maxsizeold = this%maxsize</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keyword">allocate</span>(vbvl(4, maxsizeold))</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keyword">allocate</span>(vbnm(maxsizeold))</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keyword">allocate</span>(rowlabel(maxsizeold))</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    vbvl(:, :) = this%vbvl(:, :)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    vbnm(:) = this%vbnm(:)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    rowlabel(:) = this%rowlabel(:)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">! -- Set new size and reallocate</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    this%maxsize = maxsize</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">call </span>this%allocate_arrays()</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">! -- Copy from local back into member variables</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    this%vbvl(:, 1:maxsizeold) = vbvl(:, 1:maxsizeold)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    this%vbnm(1:maxsizeold) = vbnm(1:maxsizeold)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    this%rowlabel(1:maxsizeold) = rowlabel(1:maxsizeold)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">! - deallocate local copies</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keyword">deallocate</span>(vbvl)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">deallocate</span>(vbnm)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keyword">deallocate</span>(rowlabel)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeca274b138e7c0cf4c5e1ec97e875e59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeca274b138e7c0cf4c5e1ec97e875e59">&#9670;&nbsp;</a></span>set_ibudcsv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::set_ibudcsv </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibudcsv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine can be used to activate csv output by passing in a valid unit number opened for output </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibudcsv</td><td>unit number for csv budget output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00672">672</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">               !&lt; BudgetType object</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ibudcsv<span class="comment">     !&lt; unit number for csv budget output</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    this%ibudcsv = ibudcsv</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56e31f388ad2141273e14cda050e53d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e31f388ad2141273e14cda050e53d3">&#9670;&nbsp;</a></span>value_to_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::value_to_string </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(out)&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>big</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>small</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is sometimes needed to avoid numbers that do not fit correctly into a text string </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>value to convert </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">string</td><td>string to fill </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">big</td><td>big value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">small</td><td>small value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00156">156</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: val<span class="comment">                 !&lt; value to convert</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(out)</span> :: string<span class="comment">     !&lt; string to fill</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: big<span class="comment">                 !&lt; big value</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: small<span class="comment">               !&lt; small value</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordtype">    real</span>(DP) :: absval</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    absval = abs(val)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (val /= dzero .and. (absval &gt;= big .or. absval &lt; small)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">if</span> (absval &gt;= 1.d100 .or. absval &lt;= 1.d-100) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">! -- if exponent has 3 digits, then need to explicitly use the ES </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">!    format to force writing the E character</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keyword">write</span>(string, <span class="stringliteral">&#39;(es17.4E3)&#39;</span>) val</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">write</span>(string, <span class="stringliteral">&#39;(1pe17.4)&#39;</span>) val</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">! -- value is within range where number looks good with F format</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keyword">write</span>(string, <span class="stringliteral">&#39;(f17.4)&#39;</span>) val</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebudgetmodule_a56e31f388ad2141273e14cda050e53d3_icgraph.png" border="0" usemap="#namespacebudgetmodule_a56e31f388ad2141273e14cda050e53d3_icgraph" alt=""/></div>
<map name="namespacebudgetmodule_a56e31f388ad2141273e14cda050e53d3_icgraph" id="namespacebudgetmodule_a56e31f388ad2141273e14cda050e53d3_icgraph">
<area shape="rect" title="@ brief Convert a number to a string" alt="" coords="243,5,403,47"/>
<area shape="rect" href="namespacebudgetmodule.html#a298e22d844aa23c78ba9748e1f1b7593" title="@ brief Output the budget table" alt="" coords="5,13,195,39"/>
</map>
</div>

</div>
</div>
<a id="a7cf33b8aeb57836770515b94d54ccff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf33b8aeb57836770515b94d54ccff5">&#9670;&nbsp;</a></span>write_csv_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::write_csv_header </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine will write the csv header based on the names in vbnm </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>BudgetType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00740">740</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">    !&lt; BudgetType object</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: l</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: txt, txtl</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keyword">write</span>(this%ibudcsv, <span class="stringliteral">&#39;(a)&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) <span class="stringliteral">&#39;time,&#39;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">! -- first write IN</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">do</span> l = 1, this%msum - 1</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      txt = this%vbnm(l)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      txtl = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keywordflow">if</span> (this%labeled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        txtl = <span class="stringliteral">&#39;(&#39;</span> // trim(adjustl(this%rowlabel(l))) // <span class="stringliteral">&#39;)&#39;</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      txt = trim(adjustl(txt)) // trim(adjustl(txtl)) // <span class="stringliteral">&#39;_IN,&#39;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keyword">write</span>(this%ibudcsv, <span class="stringliteral">&#39;(a)&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) trim(adjustl(txt))</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">! -- then write OUT</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">do</span> l = 1, this%msum - 1</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      txt = this%vbnm(l)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      txtl = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">if</span> (this%labeled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        txtl = <span class="stringliteral">&#39;(&#39;</span> // trim(adjustl(this%rowlabel(l))) // <span class="stringliteral">&#39;)&#39;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      txt = trim(adjustl(txt)) // trim(adjustl(txtl)) // <span class="stringliteral">&#39;_OUT,&#39;</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keyword">write</span>(this%ibudcsv, <span class="stringliteral">&#39;(a)&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) trim(adjustl(txt))</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keyword">write</span>(this%ibudcsv, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;TOTAL_IN,TOTAL_OUT,PERCENT_DIFFERENCE&#39;</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66c74a8a82039a89d304d5a37a492da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66c74a8a82039a89d304d5a37a492da1">&#9670;&nbsp;</a></span>writecsv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine budgetmodule::writecsv </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbudgetmodule_1_1budgettype.html">budgettype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>totim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine will write a row of output to the csv file, if it is available for output. Upon first call, it will write the csv header. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BudgetType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totim</td><td>time corresponding to this data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_budget_8f90_source.html#l00688">688</a> of file <a class="el" href="_budget_8f90_source.html">Budget.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordtype">class</span>(BudgetType) :: this<span class="comment">        !&lt; BudgetType object</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: totim<span class="comment">    !&lt; time corresponding to this data</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordtype">    real</span>(DP) :: totrin</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordtype">    real</span>(DP) :: totrout</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordtype">    real</span>(DP) :: diffr</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordtype">    real</span>(DP) :: pdiffr</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordtype">    real</span>(DP) :: avgrat</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (this%ibudcsv &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="comment">! -- write header</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keywordflow">if</span> (this%icsvheader == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keyword">call </span>this%write_csv_header()</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        this%icsvheader = 1</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="comment">! -- Calculate in and out</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      totrin = dzero</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      totrout = dzero</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">do</span> i = 1, this%msum - 1</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        totrin = totrin + this%vbvl(3, i)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        totrout = totrout + this%vbvl(4, i)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">! -- calculate percent difference</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      diffr = totrin - totrout</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      pdiffr = dzero</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      avgrat = (totrin + totrout) / dtwo</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">if</span> (avgrat /= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        pdiffr = dhundred * diffr / avgrat</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">! -- write data</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keyword">write</span>(this%ibudcsv, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>) totim,                              &amp;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                           (this%vbvl(3, i), i=1,this%msum-1), &amp;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                           (this%vbvl(4, i), i=1,this%msum-1), &amp;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                           totrin, totrout, pdiffr</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacebudgetmodule.html">budgetmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:11 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
