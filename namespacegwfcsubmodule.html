<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: gwfcsubmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="CustomDoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version6.2.2</span>
   </div>
   <div id="projectbrief">MODFLOW6CodeDocumentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacegwfcsubmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gwfcsubmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aadc0a0e9249722a2c4669507d5d073ac"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aadc0a0e9249722a2c4669507d5d073ac">csub_cr</a> (csubobj, name_model, istounit, stoPckName, inunit, iout)</td></tr>
<tr class="memdesc:aadc0a0e9249722a2c4669507d5d073ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new package object  <a href="namespacegwfcsubmodule.html#aadc0a0e9249722a2c4669507d5d073ac">More...</a><br /></td></tr>
<tr class="separator:aadc0a0e9249722a2c4669507d5d073ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dda5eb3b012a87d4aa46d2425fe103d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a0dda5eb3b012a87d4aa46d2425fe103d">csub_ar</a> (this, dis, ibound)</td></tr>
<tr class="memdesc:a0dda5eb3b012a87d4aa46d2425fe103d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read method for package  <a href="namespacegwfcsubmodule.html#a0dda5eb3b012a87d4aa46d2425fe103d">More...</a><br /></td></tr>
<tr class="separator:a0dda5eb3b012a87d4aa46d2425fe103d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1576ca3a5da563e697ae4e94e64af607"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a1576ca3a5da563e697ae4e94e64af607">read_options</a> (this)</td></tr>
<tr class="memdesc:a1576ca3a5da563e697ae4e94e64af607"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read options for package  <a href="namespacegwfcsubmodule.html#a1576ca3a5da563e697ae4e94e64af607">More...</a><br /></td></tr>
<tr class="separator:a1576ca3a5da563e697ae4e94e64af607"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cdaf8fb7dd626c1ec18c122e5a3b661"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a0cdaf8fb7dd626c1ec18c122e5a3b661">csub_read_dimensions</a> (this)</td></tr>
<tr class="memdesc:a0cdaf8fb7dd626c1ec18c122e5a3b661"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read dimensions for package  <a href="namespacegwfcsubmodule.html#a0cdaf8fb7dd626c1ec18c122e5a3b661">More...</a><br /></td></tr>
<tr class="separator:a0cdaf8fb7dd626c1ec18c122e5a3b661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f459be672c8354f88a908b7fcca80c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#af9f459be672c8354f88a908b7fcca80c">csub_allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:af9f459be672c8354f88a908b7fcca80c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespacegwfcsubmodule.html#af9f459be672c8354f88a908b7fcca80c">More...</a><br /></td></tr>
<tr class="separator:af9f459be672c8354f88a908b7fcca80c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dadf0602edb6af0bc699aac2a883709"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a3dadf0602edb6af0bc699aac2a883709">csub_allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:a3dadf0602edb6af0bc699aac2a883709"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate package arrays  <a href="namespacegwfcsubmodule.html#a3dadf0602edb6af0bc699aac2a883709">More...</a><br /></td></tr>
<tr class="separator:a3dadf0602edb6af0bc699aac2a883709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a1313609e09b356017ff94bea8f6ad"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a05a1313609e09b356017ff94bea8f6ad">csub_read_packagedata</a> (this)</td></tr>
<tr class="memdesc:a05a1313609e09b356017ff94bea8f6ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read packagedata for package  <a href="namespacegwfcsubmodule.html#a05a1313609e09b356017ff94bea8f6ad">More...</a><br /></td></tr>
<tr class="separator:a05a1313609e09b356017ff94bea8f6ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4ca553966e181a7d0fbd13ff20cebb2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ad4ca553966e181a7d0fbd13ff20cebb2">csub_fp</a> (this)</td></tr>
<tr class="memdesc:ad4ca553966e181a7d0fbd13ff20cebb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Final processing for package  <a href="namespacegwfcsubmodule.html#ad4ca553966e181a7d0fbd13ff20cebb2">More...</a><br /></td></tr>
<tr class="separator:ad4ca553966e181a7d0fbd13ff20cebb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8d88f964fa12806a3f06686c1627a39"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ab8d88f964fa12806a3f06686c1627a39">csub_da</a> (this)</td></tr>
<tr class="memdesc:ab8d88f964fa12806a3f06686c1627a39"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate package memory  <a href="namespacegwfcsubmodule.html#ab8d88f964fa12806a3f06686c1627a39">More...</a><br /></td></tr>
<tr class="separator:ab8d88f964fa12806a3f06686c1627a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ccb5ef50fc4b8ec98326239abb68696"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a9ccb5ef50fc4b8ec98326239abb68696">csub_rp</a> (this)</td></tr>
<tr class="memdesc:a9ccb5ef50fc4b8ec98326239abb68696"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read and prepare stress period data for package  <a href="namespacegwfcsubmodule.html#a9ccb5ef50fc4b8ec98326239abb68696">More...</a><br /></td></tr>
<tr class="separator:a9ccb5ef50fc4b8ec98326239abb68696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa463f493d828e990a7f6de445c75feb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aa463f493d828e990a7f6de445c75feb6">csub_ad</a> (this, nodes, hnew)</td></tr>
<tr class="memdesc:aa463f493d828e990a7f6de445c75feb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance the package  <a href="namespacegwfcsubmodule.html#aa463f493d828e990a7f6de445c75feb6">More...</a><br /></td></tr>
<tr class="separator:aa463f493d828e990a7f6de445c75feb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560871903438a5355800128ec18c63c8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a560871903438a5355800128ec18c63c8">csub_fc</a> (this, kiter, hold, hnew, njasln, amat, idxglo, rhs)</td></tr>
<tr class="memdesc:a560871903438a5355800128ec18c63c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill A and r for the package  <a href="namespacegwfcsubmodule.html#a560871903438a5355800128ec18c63c8">More...</a><br /></td></tr>
<tr class="separator:a560871903438a5355800128ec18c63c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1631b4d58e6f1422074de8de77eb316f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a1631b4d58e6f1422074de8de77eb316f">csub_fn</a> (this, kiter, hold, hnew, njasln, amat, idxglo, rhs)</td></tr>
<tr class="memdesc:a1631b4d58e6f1422074de8de77eb316f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill Newton-Raphson terms in A and r for the package  <a href="namespacegwfcsubmodule.html#a1631b4d58e6f1422074de8de77eb316f">More...</a><br /></td></tr>
<tr class="separator:a1631b4d58e6f1422074de8de77eb316f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54be5f032991010dead79b3ed5fe17e6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a54be5f032991010dead79b3ed5fe17e6">csub_cc</a> (this, innertot, kiter, iend, icnvgmod, nodes, hnew, hold, cpak, ipak, dpak)</td></tr>
<tr class="memdesc:a54be5f032991010dead79b3ed5fe17e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Final convergence check  <a href="namespacegwfcsubmodule.html#a54be5f032991010dead79b3ed5fe17e6">More...</a><br /></td></tr>
<tr class="separator:a54be5f032991010dead79b3ed5fe17e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88936ae36bbf93083c3ce94fa419db9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#af88936ae36bbf93083c3ce94fa419db9">csub_cq</a> (this, nodes, hnew, hold, isuppress_output, flowja)</td></tr>
<tr class="memdesc:af88936ae36bbf93083c3ce94fa419db9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate flows for package  <a href="namespacegwfcsubmodule.html#af88936ae36bbf93083c3ce94fa419db9">More...</a><br /></td></tr>
<tr class="separator:af88936ae36bbf93083c3ce94fa419db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5fa6b598abf6a6b02566ac6e011d02"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aaa5fa6b598abf6a6b02566ac6e011d02">csub_bd</a> (this, isuppress_output, model_budget)</td></tr>
<tr class="memdesc:aaa5fa6b598abf6a6b02566ac6e011d02"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Model budget calculation for package  <a href="namespacegwfcsubmodule.html#aaa5fa6b598abf6a6b02566ac6e011d02">More...</a><br /></td></tr>
<tr class="separator:aaa5fa6b598abf6a6b02566ac6e011d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd1b90b11e50759af854c5b70975c3a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#abd1b90b11e50759af854c5b70975c3a7">csub_save_model_flows</a> (this, icbcfl, icbcun)</td></tr>
<tr class="memdesc:abd1b90b11e50759af854c5b70975c3a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Save model flows for package  <a href="namespacegwfcsubmodule.html#abd1b90b11e50759af854c5b70975c3a7">More...</a><br /></td></tr>
<tr class="separator:abd1b90b11e50759af854c5b70975c3a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07d0c233bc82a992e66d3d3136e5818"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ab07d0c233bc82a992e66d3d3136e5818">csub_ot_dv</a> (this, idvfl, idvprint)</td></tr>
<tr class="memdesc:ab07d0c233bc82a992e66d3d3136e5818"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Save and print dependent values for package  <a href="namespacegwfcsubmodule.html#ab07d0c233bc82a992e66d3d3136e5818">More...</a><br /></td></tr>
<tr class="separator:ab07d0c233bc82a992e66d3d3136e5818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e69e05a6ae353d6c27eaaee57a49966"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a4e69e05a6ae353d6c27eaaee57a49966">csub_bdsav</a> (this, idvfl, icbcfl, icbcun)</td></tr>
<tr class="memdesc:a4e69e05a6ae353d6c27eaaee57a49966"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Save budget for package  <a href="namespacegwfcsubmodule.html#a4e69e05a6ae353d6c27eaaee57a49966">More...</a><br /></td></tr>
<tr class="separator:a4e69e05a6ae353d6c27eaaee57a49966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b990f1d8726331981c41f505040308a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a8b990f1d8726331981c41f505040308a">csub_cg_calc_stress</a> (this, nodes, hnew)</td></tr>
<tr class="memdesc:a8b990f1d8726331981c41f505040308a"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the stress for model cells  <a href="namespacegwfcsubmodule.html#a8b990f1d8726331981c41f505040308a">More...</a><br /></td></tr>
<tr class="separator:a8b990f1d8726331981c41f505040308a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5faaf5a2d3613e66d1892838e16fbef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#af5faaf5a2d3613e66d1892838e16fbef">csub_cg_chk_stress</a> (this)</td></tr>
<tr class="memdesc:af5faaf5a2d3613e66d1892838e16fbef"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Check effective stress values  <a href="namespacegwfcsubmodule.html#af5faaf5a2d3613e66d1892838e16fbef">More...</a><br /></td></tr>
<tr class="separator:af5faaf5a2d3613e66d1892838e16fbef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37765e933144faa55b0b8017316dd90c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a37765e933144faa55b0b8017316dd90c">csub_nodelay_update</a> (this, i)</td></tr>
<tr class="memdesc:a37765e933144faa55b0b8017316dd90c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Update no-delay material properties  <a href="namespacegwfcsubmodule.html#a37765e933144faa55b0b8017316dd90c">More...</a><br /></td></tr>
<tr class="separator:a37765e933144faa55b0b8017316dd90c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f3988b40430cbfc8f7f1d2bd41879fb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a9f3988b40430cbfc8f7f1d2bd41879fb">csub_nodelay_fc</a> (this, ib, hcell, hcellold, rho1, rho2, rhs, argtled)</td></tr>
<tr class="memdesc:a9f3988b40430cbfc8f7f1d2bd41879fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate no-delay interbed storage coefficients  <a href="namespacegwfcsubmodule.html#a9f3988b40430cbfc8f7f1d2bd41879fb">More...</a><br /></td></tr>
<tr class="separator:a9f3988b40430cbfc8f7f1d2bd41879fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b967992eb3ac29fcaa98cad30d52f8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a85b967992eb3ac29fcaa98cad30d52f8">csub_nodelay_calc_comp</a> (this, ib, hcell, hcellold, comp, rho1, rho2)</td></tr>
<tr class="memdesc:a85b967992eb3ac29fcaa98cad30d52f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate no-delay interbed compaction  <a href="namespacegwfcsubmodule.html#a85b967992eb3ac29fcaa98cad30d52f8">More...</a><br /></td></tr>
<tr class="separator:a85b967992eb3ac29fcaa98cad30d52f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a895b630bf8ee96f93d1709b6aae59b0e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a895b630bf8ee96f93d1709b6aae59b0e">csub_set_initial_state</a> (this, nodes, hnew)</td></tr>
<tr class="memdesc:a895b630bf8ee96f93d1709b6aae59b0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set initial states for the package  <a href="namespacegwfcsubmodule.html#a895b630bf8ee96f93d1709b6aae59b0e">More...</a><br /></td></tr>
<tr class="separator:a895b630bf8ee96f93d1709b6aae59b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ba2cc610b8fd91243b2d0e3a7cce90"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#af6ba2cc610b8fd91243b2d0e3a7cce90">csub_cg_fc</a> (this, node, tled, area, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:af6ba2cc610b8fd91243b2d0e3a7cce90"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate the coefficients for coarse-grained materials  <a href="namespacegwfcsubmodule.html#af6ba2cc610b8fd91243b2d0e3a7cce90">More...</a><br /></td></tr>
<tr class="separator:af6ba2cc610b8fd91243b2d0e3a7cce90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad317ed87eb5b8b4ad72359c7cfd0d2c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ad317ed87eb5b8b4ad72359c7cfd0d2c1">csub_cg_fn</a> (this, node, tled, area, hcell, hcof, rhs)</td></tr>
<tr class="memdesc:ad317ed87eb5b8b4ad72359c7cfd0d2c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate coarse-grained Newton-Raphson terms  <a href="namespacegwfcsubmodule.html#ad317ed87eb5b8b4ad72359c7cfd0d2c1">More...</a><br /></td></tr>
<tr class="separator:ad317ed87eb5b8b4ad72359c7cfd0d2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291e2e48ad1cadd66cc0e5cb1f70d958"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a291e2e48ad1cadd66cc0e5cb1f70d958">csub_interbed_fc</a> (this, ib, node, area, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:a291e2e48ad1cadd66cc0e5cb1f70d958"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate the coefficients for a interbed  <a href="namespacegwfcsubmodule.html#a291e2e48ad1cadd66cc0e5cb1f70d958">More...</a><br /></td></tr>
<tr class="separator:a291e2e48ad1cadd66cc0e5cb1f70d958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99bcf821bdec79c75c9045a455ce9d0b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a99bcf821bdec79c75c9045a455ce9d0b">csub_interbed_fn</a> (this, ib, node, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:a99bcf821bdec79c75c9045a455ce9d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate the coefficients for a interbed  <a href="namespacegwfcsubmodule.html#a99bcf821bdec79c75c9045a455ce9d0b">More...</a><br /></td></tr>
<tr class="separator:a99bcf821bdec79c75c9045a455ce9d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4448d660bfe423c8327c9f3d835348d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a4448d660bfe423c8327c9f3d835348d8">csub_cg_calc_sske</a> (this, n, sske, hcell)</td></tr>
<tr class="memdesc:a4448d660bfe423c8327c9f3d835348d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate Sske for a cell  <a href="namespacegwfcsubmodule.html#a4448d660bfe423c8327c9f3d835348d8">More...</a><br /></td></tr>
<tr class="separator:a4448d660bfe423c8327c9f3d835348d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15ed2c5ae1530711a95ae4b952dd6156"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a15ed2c5ae1530711a95ae4b952dd6156">csub_cg_calc_comp</a> (this, node, hcell, hcellold, comp)</td></tr>
<tr class="memdesc:a15ed2c5ae1530711a95ae4b952dd6156"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate coarse-grained compaction in a cell  <a href="namespacegwfcsubmodule.html#a15ed2c5ae1530711a95ae4b952dd6156">More...</a><br /></td></tr>
<tr class="separator:a15ed2c5ae1530711a95ae4b952dd6156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7b742c3ab5529ca58759bbffad470b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aa7b742c3ab5529ca58759bbffad470b7">csub_cg_update</a> (this, node)</td></tr>
<tr class="memdesc:aa7b742c3ab5529ca58759bbffad470b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Update coarse-grained material properties  <a href="namespacegwfcsubmodule.html#aa7b742c3ab5529ca58759bbffad470b7">More...</a><br /></td></tr>
<tr class="separator:aa7b742c3ab5529ca58759bbffad470b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09133d8438afb7837770ed2db4db56e9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a09133d8438afb7837770ed2db4db56e9">csub_cg_wcomp_fc</a> (this, node, tled, area, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:a09133d8438afb7837770ed2db4db56e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate coarse-grained water compressibility coefficients  <a href="namespacegwfcsubmodule.html#a09133d8438afb7837770ed2db4db56e9">More...</a><br /></td></tr>
<tr class="separator:a09133d8438afb7837770ed2db4db56e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16905bb4d2ab3b1b01461ef996d3eb44"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a16905bb4d2ab3b1b01461ef996d3eb44">csub_cg_wcomp_fn</a> (this, node, tled, area, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:a16905bb4d2ab3b1b01461ef996d3eb44"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate coarse-grained water compressibility coefficients  <a href="namespacegwfcsubmodule.html#a16905bb4d2ab3b1b01461ef996d3eb44">More...</a><br /></td></tr>
<tr class="separator:a16905bb4d2ab3b1b01461ef996d3eb44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10a63339c738dcc0d9e6f2668e547e61"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a10a63339c738dcc0d9e6f2668e547e61">csub_nodelay_wcomp_fc</a> (this, ib, node, tled, area, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:a10a63339c738dcc0d9e6f2668e547e61"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate no-delay interbed water compressibility coefficients  <a href="namespacegwfcsubmodule.html#a10a63339c738dcc0d9e6f2668e547e61">More...</a><br /></td></tr>
<tr class="separator:a10a63339c738dcc0d9e6f2668e547e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a038950db763e2c4ca76e07b99932bc5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a038950db763e2c4ca76e07b99932bc5d">csub_nodelay_wcomp_fn</a> (this, ib, node, tled, area, hcell, hcellold, hcof, rhs)</td></tr>
<tr class="memdesc:a038950db763e2c4ca76e07b99932bc5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate no-delay interbed water compressibility coefficients  <a href="namespacegwfcsubmodule.html#a038950db763e2c4ca76e07b99932bc5d">More...</a><br /></td></tr>
<tr class="separator:a038950db763e2c4ca76e07b99932bc5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35837b7432d5c546ff39b5ae5b0822b"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ac35837b7432d5c546ff39b5ae5b0822b">csub_calc_void</a> (this, theta)</td></tr>
<tr class="memdesc:ac35837b7432d5c546ff39b5ae5b0822b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the void ratio.  <a href="namespacegwfcsubmodule.html#ac35837b7432d5c546ff39b5ae5b0822b">More...</a><br /></td></tr>
<tr class="separator:ac35837b7432d5c546ff39b5ae5b0822b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc23a9d6539f4b29458036dcbfd2dbb"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#abfc23a9d6539f4b29458036dcbfd2dbb">csub_calc_theta</a> (this, void)</td></tr>
<tr class="memdesc:abfc23a9d6539f4b29458036dcbfd2dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the porosity.  <a href="namespacegwfcsubmodule.html#abfc23a9d6539f4b29458036dcbfd2dbb">More...</a><br /></td></tr>
<tr class="separator:abfc23a9d6539f4b29458036dcbfd2dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf53003c8beb84858f8d048f829c06e"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a8cf53003c8beb84858f8d048f829c06e">csub_calc_interbed_thickness</a> (this, ib)</td></tr>
<tr class="memdesc:a8cf53003c8beb84858f8d048f829c06e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the interbed thickness.  <a href="namespacegwfcsubmodule.html#a8cf53003c8beb84858f8d048f829c06e">More...</a><br /></td></tr>
<tr class="separator:a8cf53003c8beb84858f8d048f829c06e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ada08295accec1b680f6f87de831990"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a6ada08295accec1b680f6f87de831990">csub_calc_znode</a> (this, top, bottom, zbar)</td></tr>
<tr class="memdesc:a6ada08295accec1b680f6f87de831990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the cell node.  <a href="namespacegwfcsubmodule.html#a6ada08295accec1b680f6f87de831990">More...</a><br /></td></tr>
<tr class="separator:a6ada08295accec1b680f6f87de831990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a164b41c7b6754d700790c5a28b5a4dc0"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a164b41c7b6754d700790c5a28b5a4dc0">csub_calc_adjes</a> (this, node, es0, z0, z)</td></tr>
<tr class="memdesc:a164b41c7b6754d700790c5a28b5a4dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the effective stress at elevation z.  <a href="namespacegwfcsubmodule.html#a164b41c7b6754d700790c5a28b5a4dc0">More...</a><br /></td></tr>
<tr class="separator:a164b41c7b6754d700790c5a28b5a4dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a91474ff56376b37f51630c6a94bf3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ad3a91474ff56376b37f51630c6a94bf3">csub_delay_head_check</a> (this, ib)</td></tr>
<tr class="memdesc:ad3a91474ff56376b37f51630c6a94bf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check delay interbed head.  <a href="namespacegwfcsubmodule.html#ad3a91474ff56376b37f51630c6a94bf3">More...</a><br /></td></tr>
<tr class="separator:ad3a91474ff56376b37f51630c6a94bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b5e00a1dc845b9af4a494fa7af9c457"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a4b5e00a1dc845b9af4a494fa7af9c457">csub_calc_sat</a> (this, node, hcell, hcellold, snnew, snold)</td></tr>
<tr class="memdesc:a4b5e00a1dc845b9af4a494fa7af9c457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate cell saturation.  <a href="namespacegwfcsubmodule.html#a4b5e00a1dc845b9af4a494fa7af9c457">More...</a><br /></td></tr>
<tr class="separator:a4b5e00a1dc845b9af4a494fa7af9c457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e6b1f6f88d19723a48b4c70f1073c6"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a12e6b1f6f88d19723a48b4c70f1073c6">csub_calc_sat_derivative</a> (this, node, hcell)</td></tr>
<tr class="memdesc:a12e6b1f6f88d19723a48b4c70f1073c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the saturation derivative.  <a href="namespacegwfcsubmodule.html#a12e6b1f6f88d19723a48b4c70f1073c6">More...</a><br /></td></tr>
<tr class="separator:a12e6b1f6f88d19723a48b4c70f1073c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e60f0362ac490833bcd7733c1724b2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a09e60f0362ac490833bcd7733c1724b2">csub_calc_sfacts</a> (this, node, bot, znode, theta, es, es0, fact)</td></tr>
<tr class="memdesc:a09e60f0362ac490833bcd7733c1724b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate specific storage coefficient factor.  <a href="namespacegwfcsubmodule.html#a09e60f0362ac490833bcd7733c1724b2">More...</a><br /></td></tr>
<tr class="separator:a09e60f0362ac490833bcd7733c1724b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3edea7306c5e72051a662d1709303834"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a3edea7306c5e72051a662d1709303834">csub_adj_matprop</a> (this, comp, thick, theta)</td></tr>
<tr class="memdesc:a3edea7306c5e72051a662d1709303834"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate new material properties.  <a href="namespacegwfcsubmodule.html#a3edea7306c5e72051a662d1709303834">More...</a><br /></td></tr>
<tr class="separator:a3edea7306c5e72051a662d1709303834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4a2c469e98478f9265e269615bc3bed"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ad4a2c469e98478f9265e269615bc3bed">csub_delay_sln</a> (this, ib, hcell, update)</td></tr>
<tr class="memdesc:ad4a2c469e98478f9265e269615bc3bed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve delay interbed continuity equation.  <a href="namespacegwfcsubmodule.html#ad4a2c469e98478f9265e269615bc3bed">More...</a><br /></td></tr>
<tr class="separator:ad4a2c469e98478f9265e269615bc3bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ec51605bc6be2771a65e3e4f1b24fd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a36ec51605bc6be2771a65e3e4f1b24fd">csub_delay_init_zcell</a> (this, ib)</td></tr>
<tr class="memdesc:a36ec51605bc6be2771a65e3e4f1b24fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed znode and z relative to interbed center.  <a href="namespacegwfcsubmodule.html#a36ec51605bc6be2771a65e3e4f1b24fd">More...</a><br /></td></tr>
<tr class="separator:a36ec51605bc6be2771a65e3e4f1b24fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3af5c6357365affa1546adad1cc095"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a7b3af5c6357365affa1546adad1cc095">csub_delay_calc_stress</a> (this, ib, hcell)</td></tr>
<tr class="memdesc:a7b3af5c6357365affa1546adad1cc095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed stress values.  <a href="namespacegwfcsubmodule.html#a7b3af5c6357365affa1546adad1cc095">More...</a><br /></td></tr>
<tr class="separator:a7b3af5c6357365affa1546adad1cc095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbd720cd8f56b3b389a1742acca0a4c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a3dbd720cd8f56b3b389a1742acca0a4c">csub_delay_calc_ssksske</a> (this, ib, n, hcell, ssk, sske)</td></tr>
<tr class="memdesc:a3dbd720cd8f56b3b389a1742acca0a4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed cell storage coefficients.  <a href="namespacegwfcsubmodule.html#a3dbd720cd8f56b3b389a1742acca0a4c">More...</a><br /></td></tr>
<tr class="separator:a3dbd720cd8f56b3b389a1742acca0a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa935103b95b95beb8a1c40867f9ab08f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aa935103b95b95beb8a1c40867f9ab08f">csub_delay_assemble</a> (this, ib, hcell)</td></tr>
<tr class="memdesc:aa935103b95b95beb8a1c40867f9ab08f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble delay interbed coefficients.  <a href="namespacegwfcsubmodule.html#aa935103b95b95beb8a1c40867f9ab08f">More...</a><br /></td></tr>
<tr class="separator:aa935103b95b95beb8a1c40867f9ab08f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d62a1ef47868303e6063594743f7d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a98d62a1ef47868303e6063594743f7d6">csub_delay_assemble_fc</a> (this, ib, n, hcell, aii, au, al, r)</td></tr>
<tr class="memdesc:a98d62a1ef47868303e6063594743f7d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble delay interbed standard formulation coefficients.  <a href="namespacegwfcsubmodule.html#a98d62a1ef47868303e6063594743f7d6">More...</a><br /></td></tr>
<tr class="separator:a98d62a1ef47868303e6063594743f7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d39881d356523dd2fbf75afd55a6044"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a0d39881d356523dd2fbf75afd55a6044">csub_delay_assemble_fn</a> (this, ib, n, hcell, aii, au, al, r)</td></tr>
<tr class="memdesc:a0d39881d356523dd2fbf75afd55a6044"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble delay interbed Newton-Raphson formulation coefficients.  <a href="namespacegwfcsubmodule.html#a0d39881d356523dd2fbf75afd55a6044">More...</a><br /></td></tr>
<tr class="separator:a0d39881d356523dd2fbf75afd55a6044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a5310d2e8da71802bc99a1dda4dc2f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a3a5310d2e8da71802bc99a1dda4dc2f6">csub_delay_solve</a> (n, tl, td, tu, b, x, w)</td></tr>
<tr class="memdesc:a3a5310d2e8da71802bc99a1dda4dc2f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay interbed linear solution.  <a href="namespacegwfcsubmodule.html#a3a5310d2e8da71802bc99a1dda4dc2f6">More...</a><br /></td></tr>
<tr class="separator:a3a5310d2e8da71802bc99a1dda4dc2f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de9b5ce7587d84c51e385122b456777"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a5de9b5ce7587d84c51e385122b456777">csub_delay_calc_sat</a> (this, node, idelay, n, hcell, hcellold, snnew, snold)</td></tr>
<tr class="memdesc:a5de9b5ce7587d84c51e385122b456777"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed saturation.  <a href="namespacegwfcsubmodule.html#a5de9b5ce7587d84c51e385122b456777">More...</a><br /></td></tr>
<tr class="separator:a5de9b5ce7587d84c51e385122b456777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab108c26f37ea97eda24bb4305f7cd17e"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ab108c26f37ea97eda24bb4305f7cd17e">csub_delay_calc_sat_derivative</a> (this, node, idelay, n, hcell)</td></tr>
<tr class="memdesc:ab108c26f37ea97eda24bb4305f7cd17e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the delay interbed cell saturation derivative.  <a href="namespacegwfcsubmodule.html#ab108c26f37ea97eda24bb4305f7cd17e">More...</a><br /></td></tr>
<tr class="separator:ab108c26f37ea97eda24bb4305f7cd17e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3d763ef89cbcd53e10ec9d386760034"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#af3d763ef89cbcd53e10ec9d386760034">csub_delay_calc_dstor</a> (this, ib, hcell, stoe, stoi)</td></tr>
<tr class="memdesc:af3d763ef89cbcd53e10ec9d386760034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed storage change.  <a href="namespacegwfcsubmodule.html#af3d763ef89cbcd53e10ec9d386760034">More...</a><br /></td></tr>
<tr class="separator:af3d763ef89cbcd53e10ec9d386760034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b544c7e70fa15d51f64518efff49ccd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a5b544c7e70fa15d51f64518efff49ccd">csub_delay_calc_wcomp</a> (this, ib, dwc)</td></tr>
<tr class="memdesc:a5b544c7e70fa15d51f64518efff49ccd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed water compressibility.  <a href="namespacegwfcsubmodule.html#a5b544c7e70fa15d51f64518efff49ccd">More...</a><br /></td></tr>
<tr class="separator:a5b544c7e70fa15d51f64518efff49ccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c596b6b35956f54815556b283a493c6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a6c596b6b35956f54815556b283a493c6">csub_delay_calc_comp</a> (this, ib, hcell, hcellold, comp, compi, compe)</td></tr>
<tr class="memdesc:a6c596b6b35956f54815556b283a493c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed compaction.  <a href="namespacegwfcsubmodule.html#a6c596b6b35956f54815556b283a493c6">More...</a><br /></td></tr>
<tr class="separator:a6c596b6b35956f54815556b283a493c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ff5ca50df375188aae4109b3533447d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a2ff5ca50df375188aae4109b3533447d">csub_delay_update</a> (this, ib)</td></tr>
<tr class="memdesc:a2ff5ca50df375188aae4109b3533447d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update delay interbed material properties.  <a href="namespacegwfcsubmodule.html#a2ff5ca50df375188aae4109b3533447d">More...</a><br /></td></tr>
<tr class="separator:a2ff5ca50df375188aae4109b3533447d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbb0e017f3d64404995ac479d467a92"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a2dbb0e017f3d64404995ac479d467a92">csub_delay_fc</a> (this, ib, hcof, rhs)</td></tr>
<tr class="memdesc:a2dbb0e017f3d64404995ac479d467a92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delay interbed contribution to the cell.  <a href="namespacegwfcsubmodule.html#a2dbb0e017f3d64404995ac479d467a92">More...</a><br /></td></tr>
<tr class="separator:a2dbb0e017f3d64404995ac479d467a92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05fcad1c27703a703fb6d69d45c0180a"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a05fcad1c27703a703fb6d69d45c0180a">csub_calc_delay_flow</a> (this, ib, n, hcell)</td></tr>
<tr class="memdesc:a05fcad1c27703a703fb6d69d45c0180a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the flow from delay interbed top or bottom.  <a href="namespacegwfcsubmodule.html#a05fcad1c27703a703fb6d69d45c0180a">More...</a><br /></td></tr>
<tr class="separator:a05fcad1c27703a703fb6d69d45c0180a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae3d4ffc092723193ea954f7a6c1f75"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aeae3d4ffc092723193ea954f7a6c1f75">csub_obs_supported</a> (this)</td></tr>
<tr class="memdesc:aeae3d4ffc092723193ea954f7a6c1f75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if observations are supported.  <a href="namespacegwfcsubmodule.html#aeae3d4ffc092723193ea954f7a6c1f75">More...</a><br /></td></tr>
<tr class="separator:aeae3d4ffc092723193ea954f7a6c1f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff7429ef99fb08cfc2407ef45d243600"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aff7429ef99fb08cfc2407ef45d243600">csub_df_obs</a> (this)</td></tr>
<tr class="memdesc:aff7429ef99fb08cfc2407ef45d243600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the observation types available in the package.  <a href="namespacegwfcsubmodule.html#aff7429ef99fb08cfc2407ef45d243600">More...</a><br /></td></tr>
<tr class="separator:aff7429ef99fb08cfc2407ef45d243600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7004edcb691fddec7a23394829abda8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aa7004edcb691fddec7a23394829abda8">csub_bd_obs</a> (this)</td></tr>
<tr class="memdesc:aa7004edcb691fddec7a23394829abda8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the observations for this time step.  <a href="namespacegwfcsubmodule.html#aa7004edcb691fddec7a23394829abda8">More...</a><br /></td></tr>
<tr class="separator:aa7004edcb691fddec7a23394829abda8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a79144a384f3d3685b9ca6a36d81011"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a9a79144a384f3d3685b9ca6a36d81011">csub_rp_obs</a> (this)</td></tr>
<tr class="memdesc:a9a79144a384f3d3685b9ca6a36d81011"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and prepare the observations.  <a href="namespacegwfcsubmodule.html#a9a79144a384f3d3685b9ca6a36d81011">More...</a><br /></td></tr>
<tr class="separator:a9a79144a384f3d3685b9ca6a36d81011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad68ca7f4707c3966465805e2681808ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#ad68ca7f4707c3966465805e2681808ee">csub_process_obsid</a> (obsrv, dis, inunitobs, iout)</td></tr>
<tr class="memdesc:ad68ca7f4707c3966465805e2681808ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the observation IDs for the package.  <a href="namespacegwfcsubmodule.html#ad68ca7f4707c3966465805e2681808ee">More...</a><br /></td></tr>
<tr class="separator:ad68ca7f4707c3966465805e2681808ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac822d74d0679c15790c78ad8abbf546"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aac822d74d0679c15790c78ad8abbf546">define_listlabel</a> (this)</td></tr>
<tr class="memdesc:aac822d74d0679c15790c78ad8abbf546"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define the list label for the package  <a href="namespacegwfcsubmodule.html#aac822d74d0679c15790c78ad8abbf546">More...</a><br /></td></tr>
<tr class="separator:aac822d74d0679c15790c78ad8abbf546"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a136ee84d957d82663b3c6aa37438586a"><td class="memItemLeft" align="right" valign="top">character(len=lenbudtxt), dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a136ee84d957d82663b3c6aa37438586a">budtxt</a> = [' CSUB-CGELASTIC', ' CSUB-ELASTIC', ' CSUB-INELASTIC', ' CSUB-WATERCOMP']</td></tr>
<tr class="separator:a136ee84d957d82663b3c6aa37438586a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd151aed99f0a2c63cf0129679ca9e2"><td class="memItemLeft" align="right" valign="top">character(len=lenbudtxt), dimension(6)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#aecd151aed99f0a2c63cf0129679ca9e2">comptxt</a> = ['CSUB-COMPACTION', ' CSUB-INELASTIC', ' CSUB-ELASTIC', ' CSUB-INTERBED', ' CSUB-COARSE', ' CSUB-ZDISPLACE']</td></tr>
<tr class="separator:aecd151aed99f0a2c63cf0129679ca9e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96bf9f5d28ae75e537251a99e0fa1d4c"><td class="memItemLeft" align="right" valign="top">real(dp), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfcsubmodule.html#a96bf9f5d28ae75e537251a99e0fa1d4c">dlog10es</a> = 0.4342942_DP</td></tr>
<tr class="memdesc:a96bf9f5d28ae75e537251a99e0fa1d4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">derivative of the log of effective stress  <a href="namespacegwfcsubmodule.html#a96bf9f5d28ae75e537251a99e0fa1d4c">More...</a><br /></td></tr>
<tr class="separator:a96bf9f5d28ae75e537251a99e0fa1d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa463f493d828e990a7f6de445c75feb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa463f493d828e990a7f6de445c75feb6">&#9670;&nbsp;</a></span>csub_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance data in the CSUB package. The method sets data for the previous time step to the current value for the data (e.g., HOLD = HNEW). The method also calls the method to initialize the initial stress conditions if this is the first transient stress period. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of active model nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current head </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l02639">2639</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                !&lt; number of active model nodes</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nodes)</span>, <span class="keywordtype">intent(in)</span> :: hnew<span class="comment">   !&lt; current head</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="comment">! -- evaluate if steady-state stress periods are specified for more</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="comment">!    than the first and last stress period if interbeds are simulated</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> &gt; 1 .and. <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> &lt; <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keywordflow">if</span> (this%gwfiss /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,i0,a,1x,a,1x,a,1x,i0,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            <span class="stringliteral">&#39;Only the first and last (&#39;</span>, <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a>, <span class="stringliteral">&#39;)&#39;</span>, &amp;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;            <span class="stringliteral">&#39;stress period can be steady if interbeds are simulated.&#39;</span>, &amp;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            <span class="stringliteral">&#39;Stress period&#39;</span>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <span class="stringliteral">&#39;has been defined to be steady state.&#39;</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <span class="comment">! -- set initial states</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordflow">if</span> (this%initialized == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        <span class="keyword">call </span>this%csub_set_initial_state(nodes, hnew)</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="comment">! -- update state variables</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    <span class="comment">! -- coarse-grained materials</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordflow">do</span> node = 1, nodes</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      this%cg_comp(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      this%cg_es0(node) = this%cg_es(node)</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        this%cg_thick0(node) = this%cg_thick(node)</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        this%cg_theta0(node) = this%cg_theta(node)</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">! -- interbeds</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      <span class="comment">! -- update common terms for no-delay and delay interbeds</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      this%comp(ib) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordflow">if</span> (this%initialized /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        es = this%cg_es(node)</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        pcs = this%pcs(ib)</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <span class="keywordflow">if</span> (es &gt; pcs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;          this%pcs(ib) = es</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        this%thick0(ib) = this%thick(ib)</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        this%theta0(ib) = this%theta(ib)</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <span class="comment">! -- update delay interbed terms</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        <span class="comment">! -- update state if previous period was steady state</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;          <span class="keywordflow">if</span> (this%gwfiss0 /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;            node = this%nodelist(ib)</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            h = hnew(node)</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;              this%dbh(n, idelay) = h</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        <span class="comment">! -- update preconsolidation stress, stresses, head, dbdz0, and theta0</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;          <span class="comment">! update preconsolidation stress</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;          <span class="keywordflow">if</span> (this%initialized /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordflow">if</span> (this%dbes(n, idelay) &gt; this%dbpcs(n, idelay)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;              this%dbpcs(n, idelay) = this%dbes(n, idelay)</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;          this%dbh0(n, idelay) = this%dbh(n, idelay)</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;          this%dbes0(n, idelay) = this%dbes(n, idelay)</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;          <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            this%dbdz0(n, idelay) = this%dbdz(n, idelay)</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;            this%dbtheta0(n, idelay) = this%dbtheta(n, idelay)</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="comment">! -- set gwfiss0</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    this%gwfiss0 = this%gwfiss</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="comment">! -- Advance the time series managers</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <span class="keyword">call </span>this%TsManager%ad()</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="comment">! -- For each observation, push simulated value and corresponding</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="comment">!    simulation time from &quot;current&quot; to &quot;preceding&quot; and reset</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="comment">!    &quot;current&quot; value.</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="keyword">call </span>this%obs%obs_ad()</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aa463f493d828e990a7f6de445c75feb6_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_aa463f493d828e990a7f6de445c75feb6_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aa463f493d828e990a7f6de445c75feb6_cgraph" id="namespacegwfcsubmodule_aa463f493d828e990a7f6de445c75feb6_cgraph">
<area shape="rect" title="@ brief Advance the package" alt="" coords="5,43,192,69"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="240,17,415,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="258,68,397,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="463,27,631,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="463,93,631,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="679,5,873,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="692,57,860,98"/>
</map>
</div>

</div>
</div>
<a id="a3edea7306c5e72051a662d1709303834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3edea7306c5e72051a662d1709303834">&#9670;&nbsp;</a></span>csub_adj_matprop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_adj_matprop </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the current thickness and porosity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">thick</td><td>initial and current thickness </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">theta</td><td>initial and current porosity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comp</td><td>compaction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">thick</td><td>thickness </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">theta</td><td>porosity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05978">5978</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: comp<span class="comment">        !&lt; compaction</span></div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: thick<span class="comment">    !&lt; thickness</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: theta<span class="comment">    !&lt; porosity</span></div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;<span class="keywordtype">    real</span>(DP) :: strain</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;<span class="keywordtype">    real</span>(DP) :: void</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;    strain = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;    void = this%csub_calc_void(theta)</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;    <span class="comment">! -- calculate strain</span></div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;    <span class="keywordflow">if</span> (thick &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) strain = -comp/thick</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;    <span class="comment">! -- update void ratio, theta, and thickness</span></div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;    void = void + strain*(done + void)</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;    theta = this%csub_calc_theta(void)</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;    thick = thick - comp</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dadf0602edb6af0bc699aac2a883709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dadf0602edb6af0bc699aac2a883709">&#9670;&nbsp;</a></span>csub_allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize CSUB package arrays. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l01212">1212</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iblen</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ilen</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">! -- grid based data</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (this%ioutcomp == 0 .and. this%ioutcompi == 0 .and. &amp;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        this%ioutcompe == 0 .and. this%ioutcompib == 0 .and. &amp;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        this%ioutcomps == 0 .and. this%ioutzdisp == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%buff, 1, <span class="stringliteral">&#39;BUFF&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%buff, this%dis%nodes, <span class="stringliteral">&#39;BUFF&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">if</span> (this%ioutcomp == 0 .and. this%ioutzdisp == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%buffusr, 1, <span class="stringliteral">&#39;BUFFUSR&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%buffusr, this%dis%nodesuser, <span class="stringliteral">&#39;BUFFUSR&#39;</span>, &amp;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                        trim(this%memoryPath))</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sgm, this%dis%nodes, <span class="stringliteral">&#39;SGM&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sgs, this%dis%nodes, <span class="stringliteral">&#39;SGS&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_ske_cr, this%dis%nodes, <span class="stringliteral">&#39;CG_SKE_CR&#39;</span>, &amp;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                      trim(this%memoryPath))</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_es, this%dis%nodes, <span class="stringliteral">&#39;CG_ES&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_es0, this%dis%nodes, <span class="stringliteral">&#39;CG_ES0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_pcs, this%dis%nodes, <span class="stringliteral">&#39;CG_PCS&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_comp, this%dis%nodes, <span class="stringliteral">&#39;CG_COMP&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_tcomp, this%dis%nodes, <span class="stringliteral">&#39;CG_TCOMP&#39;</span>, &amp;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                      trim(this%memoryPath))</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_stor, this%dis%nodes, <span class="stringliteral">&#39;CG_STOR&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_ske, this%dis%nodes, <span class="stringliteral">&#39;CG_SKE&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_sk, this%dis%nodes, <span class="stringliteral">&#39;CG_SK&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_thickini, this%dis%nodes, <span class="stringliteral">&#39;CG_THICKINI&#39;</span>, &amp;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                      trim(this%memoryPath))</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_thetaini, this%dis%nodes, <span class="stringliteral">&#39;CG_THETAINI&#39;</span>, &amp;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                      trim(this%memoryPath))</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span> (this%iupdatematprop == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%cg_thick, <span class="stringliteral">&#39;CG_THICKINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%cg_thick0, <span class="stringliteral">&#39;CG_THICKINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%cg_theta, <span class="stringliteral">&#39;CG_THETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%cg_theta0, <span class="stringliteral">&#39;CG_THETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_thick, this%dis%nodes, <span class="stringliteral">&#39;CG_THICK&#39;</span>, &amp;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                        trim(this%memoryPath))</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_thick0, this%dis%nodes, <span class="stringliteral">&#39;CG_THICK0&#39;</span>, &amp;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                        trim(this%memoryPath))</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_theta, this%dis%nodes, <span class="stringliteral">&#39;CG_THETA&#39;</span>, &amp;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                        trim(this%memoryPath))</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_theta0, this%dis%nodes, <span class="stringliteral">&#39;CG_THETA0&#39;</span>, &amp;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                        trim(this%memoryPath))</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">! -- cell storage data</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cell_wcstor, this%dis%nodes, <span class="stringliteral">&#39;CELL_WCSTOR&#39;</span>, &amp;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                      trim(this%memoryPath))</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cell_thick, this%dis%nodes, <span class="stringliteral">&#39;CELL_THICK&#39;</span>, &amp;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                      trim(this%memoryPath))</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment">! -- interbed data</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    iblen = 1</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      iblen = this%ninterbeds</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    naux = 1</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">if</span> (this%naux &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      naux = this%naux</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%auxvar, naux, iblen, <span class="stringliteral">&#39;AUXVAR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">do</span> n = 1, iblen</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <span class="keywordflow">do</span> j = 1, naux</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        this%auxvar(j, n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%unodelist, iblen, <span class="stringliteral">&#39;UNODELIST&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nodelist, iblen, <span class="stringliteral">&#39;NODELIST&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cg_gs, this%dis%nodes, <span class="stringliteral">&#39;CG_GS&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%pcs, iblen, <span class="stringliteral">&#39;PCS&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rnb, iblen, <span class="stringliteral">&#39;RNB&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%kv, iblen, <span class="stringliteral">&#39;KV&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%h0, iblen, <span class="stringliteral">&#39;H0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ci, iblen, <span class="stringliteral">&#39;CI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rci, iblen, <span class="stringliteral">&#39;RCI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idelay, iblen, <span class="stringliteral">&#39;IDELAY&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ielastic, iblen, <span class="stringliteral">&#39;IELASTIC&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iconvert, iblen, <span class="stringliteral">&#39;ICONVERT&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%comp, iblen, <span class="stringliteral">&#39;COMP&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%tcomp, iblen, <span class="stringliteral">&#39;TCOMP&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%tcompi, iblen, <span class="stringliteral">&#39;TCOMPI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%tcompe, iblen, <span class="stringliteral">&#39;TCOMPE&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%storagee, iblen, <span class="stringliteral">&#39;STORAGEE&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%storagei, iblen, <span class="stringliteral">&#39;STORAGEI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ske, iblen, <span class="stringliteral">&#39;SKE&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sk, iblen, <span class="stringliteral">&#39;SK&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%thickini, iblen, <span class="stringliteral">&#39;THICKINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%thetaini, iblen, <span class="stringliteral">&#39;THETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">if</span> (this%iupdatematprop == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%thick, <span class="stringliteral">&#39;THICKINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%thick0, <span class="stringliteral">&#39;THICKINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%theta, <span class="stringliteral">&#39;THETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%theta0, <span class="stringliteral">&#39;THETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%thick, iblen, <span class="stringliteral">&#39;THICK&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%thick0, iblen, <span class="stringliteral">&#39;THICK0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%theta, iblen, <span class="stringliteral">&#39;THETA&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%theta0, iblen, <span class="stringliteral">&#39;THETA0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">! -- delay bed storage - allocated in csub_read_packagedata</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">!    after number of delay beds is defined</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">! -- allocate boundname</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%boundname, lenboundname, this%ninterbeds, &amp;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                        <span class="stringliteral">&#39;BOUNDNAME&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">! -- allocate the nodelist and bound arrays</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">if</span> (this%maxsig0 &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      ilen = this%maxsig0</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      ilen = 1</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nodelistsig0, ilen, <span class="stringliteral">&#39;NODELISTSIG0&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sig0, ilen, <span class="stringliteral">&#39;SIG0&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">! -- set pointers to gwf variables</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%gwfiss, <span class="stringliteral">&#39;ISS&#39;</span>, trim(this%name_model))</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">! -- set pointers to variables in the storage package</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%stoiconv, <span class="stringliteral">&#39;ICONVERT&#39;</span>, this%stoMemPath)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%stoss, <span class="stringliteral">&#39;SS&#39;</span>, this%stoMemPath)</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">! -- initialize variables that are not specified by user</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      this%cg_gs(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      this%cg_es(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      this%cg_comp(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      this%cg_tcomp(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      this%cell_wcstor(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">do</span> n = 1, this%ninterbeds</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      this%theta(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      this%tcomp(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      this%tcompi(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      this%tcompe(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">do</span> n = 1, max(1, this%maxsig0)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      this%nodelistsig0(n) = 0</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      this%sig0(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="af9f459be672c8354f88a908b7fcca80c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f459be672c8354f88a908b7fcca80c">&#9670;&nbsp;</a></span>csub_allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize scalars for the CSUB package. The base model allocate scalars method is also called. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l01099">1099</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">! -- call standard NumericalPackageType allocate scalars</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%allocate_scalars()</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">! -- allocate character variables</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%listlabel, lenlistlabel, <span class="stringliteral">&#39;LISTLABEL&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%stoMemPath, lenmempath, <span class="stringliteral">&#39;STONAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">! -- allocate the object and assign values to object variables</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%istounit, <span class="stringliteral">&#39;ISTOUNIT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%inobspkg, <span class="stringliteral">&#39;INOBSPKG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ninterbeds, <span class="stringliteral">&#39;NINTERBEDS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%maxsig0, <span class="stringliteral">&#39;MAXSIG0&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nbound, <span class="stringliteral">&#39;NBOUND&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iscloc, <span class="stringliteral">&#39;ISCLOC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iauxmultcol, <span class="stringliteral">&#39;IAUXMULTCOL&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ndelaycells, <span class="stringliteral">&#39;NDELAYCELLS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ndelaybeds, <span class="stringliteral">&#39;NDELAYBEDS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%initialized, <span class="stringliteral">&#39;INITIALIZED&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ieslag, <span class="stringliteral">&#39;IESLAG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ipch, <span class="stringliteral">&#39;IPCH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%lhead_based, <span class="stringliteral">&#39;LHEAD_BASED&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iupdatestress, <span class="stringliteral">&#39;IUPDATESTRESS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ispecified_pcs, <span class="stringliteral">&#39;ISPECIFIED_PCS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ispecified_dbh, <span class="stringliteral">&#39;ISPECIFIED_DBH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%inamedbound, <span class="stringliteral">&#39;INAMEDBOUND&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iconvchk, <span class="stringliteral">&#39;ICONVCHK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%naux, <span class="stringliteral">&#39;NAUX&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%istoragec, <span class="stringliteral">&#39;ISTORAGEC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%istrainib, <span class="stringliteral">&#39;ISTRAINIB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%istrainsk, <span class="stringliteral">&#39;ISTRAINSK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ioutcomp, <span class="stringliteral">&#39;IOUTCOMP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ioutcompi, <span class="stringliteral">&#39;IOUTCOMPI&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ioutcompe, <span class="stringliteral">&#39;IOUTCOMPE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ioutcompib, <span class="stringliteral">&#39;IOUTCOMPIB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ioutcomps, <span class="stringliteral">&#39;IOUTCOMPS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ioutzdisp, <span class="stringliteral">&#39;IOUTZDISP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ipakcsv, <span class="stringliteral">&#39;IPAKCSV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iupdatematprop, <span class="stringliteral">&#39;IUPDATEMATPROP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%epsilon, <span class="stringliteral">&#39;EPSILON&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cc_crit, <span class="stringliteral">&#39;CC_CRIT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%gammaw, <span class="stringliteral">&#39;GAMMAW&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%beta, <span class="stringliteral">&#39;BETA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%brg, <span class="stringliteral">&#39;BRG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%satomega, <span class="stringliteral">&#39;SATOMEGA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icellf, <span class="stringliteral">&#39;ICELLF&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%gwfiss0, <span class="stringliteral">&#39;GWFISS0&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">! -- allocate TS object</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keyword">allocate</span>(this%TsManager)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">! -- initialize values</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    this%istounit = 0</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    this%inobspkg = 0</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    this%ninterbeds = 0</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    this%maxsig0 = 0</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    this%nbound = 0</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    this%iscloc = 0</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    this%iauxmultcol = 0</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    this%ndelaycells = 19</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    this%ndelaybeds = 0</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    this%initialized = 0</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    this%ieslag = 0</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    this%ipch = 0</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    this%lhead_based = .false.</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    this%iupdatestress = 1</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    this%ispecified_pcs = 0</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    this%ispecified_dbh = 0</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    this%inamedbound = 0</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    this%iconvchk = 1</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    this%naux = 0</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    this%istoragec = 1</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    this%istrainib = 0</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    this%istrainsk = 0</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    this%ioutcomp = 0</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    this%ioutcompi = 0</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    this%ioutcompe = 0</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    this%ioutcompib = 0</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    this%ioutcomps = 0</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    this%ioutzdisp = 0</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    this%ipakcsv = 0</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    this%iupdatematprop = 0</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    this%epsilon = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    this%cc_crit = dem7</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    this%gammaw = dgravity*1000._dp</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    this%beta = 4.6512e-10_dp</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    this%brg = this%gammaw*this%beta</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">! -- set omega value used for saturation calculations</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">if</span> (this%inewton /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      this%satomega = dem6</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      this%epsilon = dhalf*dem6</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      this%satomega = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    this%icellf = 0</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    this%ninterbeds = 0</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    this%gwfiss0 = 0</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0dda5eb3b012a87d4aa46d2425fe103d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dda5eb3b012a87d4aa46d2425fe103d">&#9670;&nbsp;</a></span>csub_ar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disbasetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), pointer, contiguous&#160;</td>
          <td class="paramname"><em>ibound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to allocate and read static data for the CSUB package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dis</td><td>model discretization </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ibound</td><td>model ibound array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l00343">343</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacekindmodule.html">kindmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacekindmodule.html#a2f6861418b5e7d3d602b77228232a470">i4b</a></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: dis<span class="comment">               !&lt; model discretization</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: ibound<span class="comment">    !&lt; model ibound array</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: line</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">character(len=20)</span> :: cellid</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iske</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istheta</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isgm</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isgs</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: lloc</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istart</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istop</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istoerr</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordtype">    real</span>(DP) :: cg_ske_cr</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordtype">    real</span>(DP) :: v</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtcsub = &amp;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="stringliteral">&quot;(1x,/1x,&#39;CSUB -- COMPACTION PACKAGE, VERSION 1, 12/15/2019&#39;,            &amp;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     &amp;&#39; INPUT READ FROM UNIT &#39;, i0, //)&quot;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">! --print a message identifying the csub package.</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">write</span> (this%iout, fmtcsub) this%inunit</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">! -- store pointers to arguments that were passed in</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    this%dis =&gt; dis</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    this%ibound =&gt; ibound</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">! -- Create time series managers</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#abd6baa3f1522c5c5dff9f8fd8d53fb58">tsmanager_cr</a>(this%TsManager, this%iout)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">! -- create obs package</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">call </span>obs_cr(this%obs, this%inobspkg)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">! -- Read csub options</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keyword">call </span>this%read_options()</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">! -- Now that time series will have been read, need to call the df</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">!    routine to define the manager</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">call </span>this%tsmanager%tsmanager_df()</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">! -- Read the csub dimensions</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keyword">call </span>this%read_dimensions()</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">! - observation data</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">call </span>this%obs%obs_ar()</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">! -- terminate if errors dimensions block data</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">! -- Allocate arrays in</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">call </span>this%csub_allocate_arrays()</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    iske = 0</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    istheta = 0</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    isgm = 0</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    isgs = 0</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">! -- read griddata block</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;GRIDDATA&#39;</span>, isfound, ierr)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keyword">call </span>this%parser%GetRemainingLine(line)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        lloc = 1</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CG_SKE_CR&#39;</span>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, &amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                        this%iout, this%parser%iuactive, &amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                        this%cg_ske_cr, <span class="stringliteral">&#39;CG_SKE_CR&#39;</span>)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          iske = 1</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CG_THETA&#39;</span>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, &amp;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                        this%iout, this%parser%iuactive, &amp;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                        this%cg_thetaini, <span class="stringliteral">&#39;CG_THETA&#39;</span>)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          istheta = 1</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SGM&#39;</span>)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, &amp;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                        this%iout, this%parser%iuactive, &amp;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                        this%sgm, <span class="stringliteral">&#39;SGM&#39;</span>)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          isgm = 1</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SGS&#39;</span>)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, &amp;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                        this%iout, this%parser%iuactive, &amp;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                        this%sgs, <span class="stringliteral">&#39;SGS&#39;</span>)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          isgs = 1</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="stringliteral">&quot;Unknown GRIDDATA tag &#39;&quot;</span>, trim(keyword), <span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(<span class="stringliteral">&#39;Required GRIDDATA block not found.&#39;</span>)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">! -- detemine if cg_ske and cg_theta have been specified</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (iske == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;CG_SKE GRIDDATA must be specified.&#39;</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span> (istheta == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;CG_THETA GRIDDATA must be specified.&#39;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">! -- determine if sgm and sgs have been specified, if not assign default values</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (isgm == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        this%sgm(node) = 1.7d0</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (isgs == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        this%sgs(node) = 2.0d0</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">! -- evaluate the coarse-grained material properties and if</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">!    non-zero specific storage values are specified in the</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">!    STO package</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    istoerr = 0</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      cg_ske_cr = this%cg_ske_cr(node)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      theta = this%cg_thetaini(node)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">! -- coarse-grained storage error condition</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">if</span> (cg_ske_cr &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,g0,a,1x,a,1x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          <span class="stringliteral">&#39;Coarse-grained material CG_SKE_CR (&#39;</span>, cg_ske_cr, <span class="stringliteral">&#39;) is less&#39;</span>, &amp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="stringliteral">&#39;than zero in cell&#39;</span>, trim(adjustl(cellid)), <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">! -- storage (STO) package error condition</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> (this%stoss(node) /= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        istoerr = 1</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">! -- porosity error condition</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">if</span> (theta &gt; done .or. theta &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,g0,a,1x,a,1x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="stringliteral">&#39;Coarse-grained material THETA (&#39;</span>, theta, <span class="stringliteral">&#39;) is less&#39;</span>, &amp;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="stringliteral">&#39;than zero or greater than 1 in cell&#39;</span>, trim(adjustl(cellid)), <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">! -- write single message if storage (STO) package has non-zero specific</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">!    storage values</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span> (istoerr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,3(1x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="stringliteral">&#39;Specific storage values in the storage (STO) package must&#39;</span>, &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="stringliteral">&#39;be zero in all active cells when using the&#39;</span>, trim(adjustl(this%packName)), &amp;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="stringliteral">&#39;package.&#39;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">! -- read interbed data</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keyword">call </span>this%csub_read_packagedata()</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">! -- calculate the coarse-grained material thickness without the interbeds</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      this%cg_thickini(node) = top - bot</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      this%cell_thick(node) = top - bot</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">! -- subtract the interbed thickness from aquifer thickness</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        v = this%thickini(ib)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        v = this%rnb(ib)*this%thickini(ib)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      this%cg_thickini(node) = this%cg_thickini(node) - v</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">! -- evaluate if any cg_thick values are less than 0</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      thick = this%cg_thickini(node)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">if</span> (thick &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,g0,a,1x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="stringliteral">&#39;Aquifer thickness is less than zero (&#39;</span>, &amp;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          thick, <span class="stringliteral">&#39;) in cell&#39;</span>, trim(adjustl(cellid)), <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">! -- terminate if errors griddata, packagedata blocks, TDIS, or STO data</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">! -- set current coarse-grained thickness (cg_thick) and</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">!    current coarse-grained porosity (cg_theta). Only needed</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">!    if updating material properties</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        this%cg_thick(node) = this%cg_thickini(node)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        this%cg_theta(node) = this%cg_thetaini(node)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a0dda5eb3b012a87d4aa46d2425fe103d_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a0dda5eb3b012a87d4aa46d2425fe103d_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a0dda5eb3b012a87d4aa46d2425fe103d_cgraph" id="namespacegwfcsubmodule_a0dda5eb3b012a87d4aa46d2425fe103d_cgraph">
<area shape="rect" title="@ brief Allocate and read method for package" alt="" coords="5,107,188,133"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="243,5,427,32"/>
<area shape="rect" href="namespaceobsmodule.html#a57372fbf202fe90e2d12383ce1b15eee" title=" " alt="" coords="263,56,407,83"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="248,107,423,133"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#abd6baa3f1522c5c5dff9f8fd8d53fb58" title=" " alt="" coords="236,158,435,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="266,224,405,251"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="483,183,651,225"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="483,249,651,290"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="699,161,893,188"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="712,213,880,254"/>
</map>
</div>

</div>
</div>
<a id="aaa5fa6b598abf6a6b02566ac6e011d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5fa6b598abf6a6b02566ac6e011d02">&#9670;&nbsp;</a></span>csub_bd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_bd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(budgettype), intent(inout)&#160;</td>
          <td class="paramname"><em>model_budget</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Budget calculation for the CSUB package components. Components include coarse-grained storage, delay and no-delay interbeds, and water compressibility.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model_budget</td><td>model budget object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model_budget</td><td>model budget object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l03519">3519</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#aa63ca3273e52df46471c4746566f46bd">lenboundname</a>, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbudgetmodule_1_1budgettype.html">budgettype</a>, <a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;    <span class="keywordtype">type</span>(BudgetType), <span class="keywordtype">intent(inout)</span> :: model_budget<span class="comment">   !&lt; model budget object</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="keywordtype">    real</span>(DP) :: rin</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="keywordtype">    real</span>(DP) :: rout</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <span class="comment">! -- interbed elastic storage  (this%cg_stor)</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%cg_stor, rin, rout)</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(1), &amp;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                               isuppress_output, <span class="stringliteral">&#39;            CSUB&#39;</span>)</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      <span class="comment">! -- interbed elastic storage (this%storagee)</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%storagee, rin, rout)</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(2), &amp;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                                 isuppress_output, <span class="stringliteral">&#39;            CSUB&#39;</span>)</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <span class="comment">! -- interbed elastic storage (this%storagei)</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%storagei, rin, rout)</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(3), &amp;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                                 isuppress_output, <span class="stringliteral">&#39;            CSUB&#39;</span>)</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%cell_wcstor, rin, rout)</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(4), &amp;  </div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;                               isuppress_output, <span class="stringliteral">&#39;            CSUB&#39;</span>)</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aaa5fa6b598abf6a6b02566ac6e011d02_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_aaa5fa6b598abf6a6b02566ac6e011d02_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aaa5fa6b598abf6a6b02566ac6e011d02_cgraph" id="namespacegwfcsubmodule_aaa5fa6b598abf6a6b02566ac6e011d02_cgraph">
<area shape="rect" title="@ brief Model budget calculation for package" alt="" coords="5,13,192,39"/>
<area shape="rect" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e" title=" " alt="" coords="240,5,391,47"/>
</map>
</div>

</div>
</div>
<a id="aa7004edcb691fddec7a23394829abda8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7004edcb691fddec7a23394829abda8">&#9670;&nbsp;</a></span>csub_bd_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_bd_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to set the CSUB package observations for this time step. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07401">7401</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;    <span class="keywordtype">type</span>(ObserveType), <span class="keywordtype">pointer</span> :: obsrv =&gt; null()</div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ncol</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;<span class="keywordtype">    real</span>(DP) :: v</div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;<span class="keywordtype">    real</span>(DP) :: r</div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;    <span class="comment">! -- Fill simulated values for all csub observations</span></div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;    <span class="keywordflow">if</span> (this%obs%npakobs &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;      <span class="keyword">call </span>this%obs%obs_bd_clear()</div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;      <span class="keywordflow">do</span> i = 1, this%obs%npakobs</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;        obsrv =&gt; this%obs%pakobs(i)%obsrv</div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;        <span class="keywordflow">if</span> (obsrv%BndFound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;          <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;SKE&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;SK&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;SKE-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;SK-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-HEAD&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-PRECONSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-GSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-ESTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;PRECONSTRESS-CELL&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;            <span class="keywordflow">if</span> (this%gwfiss /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;              <span class="keyword">call </span>this%obs%SaveOneSimval(obsrv, dnodata)</div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;              v = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;              <span class="keywordflow">do</span> j = 1, obsrv%indxbnds_count</div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;                n = obsrv%indxbnds(j)</div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;                <span class="keywordflow">select case</span> (obsrv%ObsTypeId)</div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SKE&#39;</span>)</div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;                  v = this%ske(n)</div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SK&#39;</span>)</div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;                  v = this%sk(n)</div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SKE-CELL&#39;</span>)</div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;                  <span class="comment">! -- add the coarse component</span></div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;                  <span class="keywordflow">if</span> (j == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;                    v = this%cg_ske(n)</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;                    v = this%ske(n)</div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SK-CELL&#39;</span>)</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;                  <span class="comment">! -- add the coarse component</span></div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;                  <span class="keywordflow">if</span> (j == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;                    v = this%cg_sk(n)</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;                    v = this%sk(n)</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-HEAD&#39;</span>, <span class="stringliteral">&#39;DELAY-PRECONSTRESS&#39;</span>, &amp;</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;                      <span class="stringliteral">&#39;DELAY-GSTRESS&#39;</span>, <span class="stringliteral">&#39;DELAY-ESTRESS&#39;</span>)</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;                  <span class="keywordflow">if</span> (n &gt; this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;                    r = real(n - 1, dp)/real(this%ndelaycells, dp)</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;                    idelay = int(floor(r)) + 1                    </div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;                    ncol = n - int(floor(r)) * this%ndelaycells</div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;                    idelay = 1</div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;                    ncol = n</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;                  <span class="keywordflow">select case</span> (obsrv%ObsTypeId)</div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;                  <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-HEAD&#39;</span>)</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;                    v = this%dbh(ncol, idelay)</div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;                  <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-PRECONSTRESS&#39;</span>)</div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;                    v = this%dbpcs(ncol, idelay)</div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;                  <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-GSTRESS&#39;</span>)</div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;                    v = this%dbgeo(ncol, idelay)</div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;                  <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-ESTRESS&#39;</span>)</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;                    v = this%dbes(ncol, idelay)</div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;<span class="keywordflow">                  end select</span></div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRECONSTRESS-CELL&#39;</span>)</div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;                  v = this%pcs(n)</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;<span class="keywordflow">                case default</span></div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;                  errmsg = <span class="stringliteral">&quot;Unrecognized observation type &#39;&quot;</span>// &amp;</div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;                           trim(obsrv%ObsTypeId)//<span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;<span class="keywordflow">                end select</span></div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;                <span class="keyword">call </span>this%obs%SaveOneSimval(obsrv, v)</div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;<span class="keywordflow">              end do</span></div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;            v = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;            <span class="keywordflow">do</span> j = 1, obsrv%indxbnds_count</div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;              n = obsrv%indxbnds(j)</div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;              <span class="keywordflow">select case</span> (obsrv%ObsTypeId)</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CSUB&#39;</span>)</div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;                v = this%storagee(n) + this%storagei(n)</div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INELASTIC-CSUB&#39;</span>)</div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;                v = this%storagei(n)</div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ELASTIC-CSUB&#39;</span>)</div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;                v = this%storagee(n)</div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COARSE-CSUB&#39;</span>)</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;                v = this%cg_stor(n)</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;WCOMP-CSUB-CELL&#39;</span>)</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;                v = this%cell_wcstor(n)</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CSUB-CELL&#39;</span>)</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;                <span class="comment">! -- add the coarse component</span></div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;                <span class="keywordflow">if</span> (j == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;                  v = this%cg_stor(n)</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;                  v = this%storagee(n) + this%storagei(n)</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THETA&#39;</span>)</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;                v = this%theta(n)</div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COARSE-THETA&#39;</span>)</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;                v = this%cg_theta(n)</div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THETA-CELL&#39;</span>)</div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;                <span class="comment">! -- add the coarse component</span></div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;                <span class="keywordflow">if</span> (j == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;                  f = this%cg_thick(n)/this%cell_thick(n)</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;                  v = f*this%cg_theta(n)</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;                  node = this%nodelist(n)</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;                  f = this%csub_calc_interbed_thickness(n)/this%cell_thick(node)</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;                  v = f*this%theta(n)</div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GSTRESS-CELL&#39;</span>)</div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;                v = this%cg_gs(n)</div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ESTRESS-CELL&#39;</span>)</div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;                v = this%cg_es(n)</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INTERBED-COMPACTION&#39;</span>)</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;                v = this%tcomp(n)</div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INELASTIC-COMPACTION&#39;</span>)</div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;                v = this%tcompi(n)</div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ELASTIC-COMPACTION&#39;</span>)</div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;                v = this%tcompe(n)</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COARSE-COMPACTION&#39;</span>)</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;                v = this%cg_tcomp(n)</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INELASTIC-COMPACTION-CELL&#39;</span>)</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;                <span class="comment">! -- no coarse inelastic component</span></div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;                <span class="keywordflow">if</span> (j &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;                  v = this%tcompi(n)</div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ELASTIC-COMPACTION-CELL&#39;</span>)</div>
<div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;                <span class="comment">! -- add the coarse component</span></div>
<div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;                <span class="keywordflow">if</span> (j == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;                  v = this%cg_tcomp(n)</div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;                  v = this%tcompe(n)</div>
<div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPACTION-CELL&#39;</span>)</div>
<div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;                <span class="comment">! -- add the coarse component</span></div>
<div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;                <span class="keywordflow">if</span> (j == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;                  v = this%cg_tcomp(n)</div>
<div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;                  v = this%tcomp(n)</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THICKNESS&#39;</span>)</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;                idelay = this%idelay(n)</div>
<div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;                v = this%thick(n)</div>
<div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;                <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;                  v = v*this%rnb(n)</div>
<div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COARSE-THICKNESS&#39;</span>)</div>
<div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;                v = this%cg_thick(n)</div>
<div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THICKNESS-CELL&#39;</span>)</div>
<div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;                v = this%cell_thick(n)</div>
<div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-COMPACTION&#39;</span>, <span class="stringliteral">&#39;DELAY-THICKNESS&#39;</span>, &amp;</div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;                    <span class="stringliteral">&#39;DELAY-THETA&#39;</span>)</div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;                <span class="keywordflow">if</span> (n &gt; this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;                  r = real(n, dp)/real(this%ndelaycells, dp)</div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;                  idelay = int(floor(r)) + 1</div>
<div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;                  ncol = mod(n, this%ndelaycells)</div>
<div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;                  idelay = 1</div>
<div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;                  ncol = n</div>
<div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;                <span class="keywordflow">select case</span> (obsrv%ObsTypeId)</div>
<div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-COMPACTION&#39;</span>)</div>
<div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;                  v = this%dbtcomp(ncol, idelay)</div>
<div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-THICKNESS&#39;</span>)</div>
<div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;                  v = this%dbdz(ncol, idelay)</div>
<div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;                <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-THETA&#39;</span>)</div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;                  v = this%dbtheta(ncol, idelay)</div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;<span class="keywordflow">                end select</span></div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-FLOWTOP&#39;</span>)</div>
<div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;                idelay = this%idelay(n)</div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;                v = this%dbflowtop(idelay)</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY-FLOWBOT&#39;</span>)</div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;                idelay = this%idelay(n)</div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;                v = this%dbflowbot(idelay)</div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;<span class="keywordflow">              case default</span></div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;                errmsg = <span class="stringliteral">&quot;Unrecognized observation type: &#39;&quot;</span>// &amp;</div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;                         trim(obsrv%ObsTypeId)//<span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;<span class="keywordflow">              end select</span></div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;              <span class="keyword">call </span>this%obs%SaveOneSimval(obsrv, v)</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;          <span class="keyword">call </span>this%obs%SaveOneSimval(obsrv, dnodata)</div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;      <span class="comment">! -- write summary of package error messages</span></div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aa7004edcb691fddec7a23394829abda8_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_aa7004edcb691fddec7a23394829abda8_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aa7004edcb691fddec7a23394829abda8_cgraph" id="namespacegwfcsubmodule_aa7004edcb691fddec7a23394829abda8_cgraph">
<area shape="rect" title="Set the observations for this time step." alt="" coords="5,49,168,90"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="216,5,400,32"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="221,56,395,83"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="239,107,377,133"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="448,66,616,107"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="448,131,616,173"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="664,44,859,71"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="677,95,845,137"/>
</map>
</div>

</div>
</div>
<a id="a4e69e05a6ae353d6c27eaaee57a49966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e69e05a6ae353d6c27eaaee57a49966">&#9670;&nbsp;</a></span>csub_bdsav()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_bdsav </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Save cell-by-cell budget terms for the CSUB package. Method also saves cell-by-cell compaction and z-displacement terms. The method also calls the method to process observation output. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idvfl</td><td>flag to output dependent variable data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcfl</td><td>flag to output budget data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcun</td><td>unit number for cell-by-cell file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l03884">3884</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvfl<span class="comment">     !&lt; flag to output dependent variable data</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcfl<span class="comment">    !&lt; flag to output budget data</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcun<span class="comment">    !&lt; unit number for cell-by-cell file</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    <span class="keywordtype">character(len=1)</span> :: cdatafmp = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    <span class="keywordtype">character(len=1)</span> :: editdesc = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iprint</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nvaluesp</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nwidthp</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodem</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodeu</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: k</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ncpl</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nlay</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;<span class="keywordtype">    real</span>(DP) :: dinact</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;<span class="keywordtype">    real</span>(DP) :: Q</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtnconv = &amp;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    <span class="stringliteral">&quot;(/4x, &#39;DELAY INTERBED CELL HEADS IN &#39;, i0, &#39; INTERBEDS IN&#39;,               &amp;</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;<span class="stringliteral"></span><span class="stringliteral">    &amp;&#39; NON-CONVERTIBLE GWF CELLS WERE LESS THAN THE TOP OF THE INTERBED CELL&#39;)&quot;</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;    <span class="comment">! -- Set unit number for binary output</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;    <span class="keywordflow">if</span> (this%ipakcb &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;      ibinun = icbcun</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;    <span class="keywordflow">elseif</span> (this%ipakcb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;      ibinun = this%ipakcb</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    <span class="keywordflow">if</span> (icbcfl == 0) ibinun = 0</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="comment">! -- Record the storage rates if requested</span></div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      dinact = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;      <span class="comment">! -- coarse-grained storage (sske)</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%cg_stor, this%iout, iprint, -ibinun, &amp;</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;                                 budtxt(1), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;        naux = 0</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;        <span class="comment">! -- interbed elastic storage</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        <span class="keyword">call </span>this%dis%record_srcdst_list_header(budtxt(2), this%name_model, &amp;</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                                                this%name_model, this%name_model, this%packName, naux, &amp;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                                                this%auxname, ibinun, this%ninterbeds, this%iout)</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;          q = this%storagee(ib)</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;          <span class="keyword">call </span>this%dis%record_mf6_list_entry(ibinun, node, node, q, naux, &amp;</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                                              this%auxvar(:, ib))</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;        <span class="comment">! -- interbed inelastic storage</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;        <span class="keyword">call </span>this%dis%record_srcdst_list_header(budtxt(3), this%name_model, &amp;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                                                this%name_model, this%name_model, this%packName, naux, &amp;</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                                                this%auxname, ibinun, this%ninterbeds, this%iout)</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;          q = this%storagei(ib)</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;          <span class="keyword">call </span>this%dis%record_mf6_list_entry(ibinun, node, node, q, naux, &amp;</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                                              this%auxvar(:, ib))</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;      <span class="comment">! -- water compressibility</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%cell_wcstor, this%iout, iprint, -ibinun, &amp;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                                 budtxt(4), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    <span class="comment">! -- Save compaction results</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    <span class="comment">! -- Set unit number for binary compaction and z-displacement output</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    <span class="keywordflow">if</span> (this%ioutcomp /= 0 .or. this%ioutzdisp /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      ibinun = 1</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    <span class="comment">! -- save compaction results</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;      <span class="comment">! -- fill buff with total compaction</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        this%buff(node) = this%cg_tcomp(node)</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        this%buff(node) = this%buff(node) + this%tcomp(ib)</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;      <span class="comment">! -- write compaction data to binary file</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      <span class="keywordflow">if</span> (this%ioutcomp /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;        ibinun = this%ioutcomp</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;        <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                                   comptxt(1), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                                   nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;      <span class="comment">! -- calculate z-displacement (subsidence) and write data to binary file</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;      <span class="keywordflow">if</span> (this%ioutzdisp /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;        ibinun = this%ioutzdisp</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;        <span class="comment">! -- initialize buffusr</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;        <span class="keywordflow">do</span> nodeu = 1, this%dis%nodesuser</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;          this%buffusr(nodeu) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;        <span class="comment">! -- fill buffusr with buff</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;          nodeu = this%dis%get_nodeuser(node)</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;          this%buffusr(nodeu) = this%buff(node)</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;        <span class="comment">! -- calculate z-displacement</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        ncpl = this%dis%get_ncpl()</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;        <span class="comment">! -- disu</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        <span class="keywordflow">if</span> (this%dis%ndim == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;          <span class="comment">! TO DO -</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;          <span class="comment">! -- disv or dis</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;          nlay = this%dis%nodesuser/ncpl</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;          <span class="keywordflow">do</span> k = nlay - 1, 1, -1</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;            <span class="keywordflow">do</span> i = 1, ncpl</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;              node = (k - 1)*ncpl + i</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;              nodem = k*ncpl + i</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;              this%buffusr(node) = this%buffusr(node) + this%buffusr(nodem)</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        <span class="comment">! -- fill buff with data from buffusr</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        <span class="keywordflow">do</span> nodeu = 1, this%dis%nodesuser</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;          node = this%dis%get_nodenumber_idx1(nodeu, 1)</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;          <span class="keywordflow">if</span> (node /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;            this%buff(node) = this%buffusr(nodeu)</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;        <span class="comment">! -- write z-displacement</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;                                   comptxt(6), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                                   nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160; </div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    <span class="comment">! -- Set unit number for binary inelastic interbed compaction</span></div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <span class="keywordflow">if</span> (this%ioutcompi /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;      ibinun = this%ioutcompi</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="comment">! -- save inelastic interbed compaction results</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;      iprint = 0</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;      <span class="comment">! -- fill buff with inelastic interbed compaction</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;        this%buff(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        this%buff(node) = this%buff(node) + this%tcompi(ib)</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      <span class="comment">! -- write inelastic interbed compaction data to binary file</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                                 comptxt(2), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <span class="comment">! -- Set unit number for binary elastic interbed compaction</span></div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <span class="keywordflow">if</span> (this%ioutcompe /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      ibinun = this%ioutcompe</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <span class="comment">! -- save elastic interbed compaction results</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      iprint = 0</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;      <span class="comment">! -- fill buff with elastic interbed compaction</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;        this%buff(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        this%buff(node) = this%buff(node) + this%tcompe(ib)</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      <span class="comment">! -- write elastic interbed compaction data to binary file</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;                                 comptxt(3), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    <span class="comment">! -- Set unit number for binary interbed compaction</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;    <span class="keywordflow">if</span> (this%ioutcompib /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;      ibinun = this%ioutcompib</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    <span class="comment">! -- save interbed compaction results</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;      iprint = 0</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;      <span class="comment">! -- fill buff with interbed compaction</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;        this%buff(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;        this%buff(node) = this%buff(node) + this%tcompe(ib) + this%tcompi(ib)</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;      <span class="comment">! -- write interbed compaction data to binary file</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                                 comptxt(4), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    <span class="comment">! -- Set unit number for binary coarse-grained compaction</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    <span class="keywordflow">if</span> (this%ioutcomps /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      ibinun = this%ioutcomps</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;    <span class="comment">! -- save coarse-grained compaction results</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      iprint = 0</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;      <span class="comment">! -- fill buff with coarse-grained compaction</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;        this%buff(node) = this%cg_tcomp(node)</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      <span class="comment">! -- write coarse-grained compaction data to binary file</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                                 comptxt(5), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    <span class="comment">! -- check that final effective stress values for the time step</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="comment">!    are greater than zero</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;      <span class="keyword">call </span>this%csub_cg_chk_stress()</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    <span class="comment">! -- update maximum count of delay interbeds that violate</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    <span class="comment">!    basic head assumptions for delay beds and write a message</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <span class="comment">!    for delay interbeds in non-convertible gwf cells that</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <span class="comment">!    violate these head assumptions</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    <span class="keywordflow">if</span> (this%ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;      <span class="keywordflow">if</span> (this%idb_nconv_count(1) &gt; this%idb_nconv_count(2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;        this%idb_nconv_count(2) = this%idb_nconv_count(1)</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;      <span class="keywordflow">if</span> (this%idb_nconv_count(1) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;        <span class="keyword">write</span> (this%iout, fmtnconv) this%idb_nconv_count(1)</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a164b41c7b6754d700790c5a28b5a4dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a164b41c7b6754d700790c5a28b5a4dc0">&#9670;&nbsp;</a></span>csub_calc_adjes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_adjes </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>es0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the effective stress at specified elevation z using the provided effective stress (es0) calculated at elevation z0 (which is &lt;= z)</p>
<dl class="section return"><dt>Returns</dt><dd>es node elevation </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">es0</td><td>effective stress at elevation z0 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z0</td><td>elevation effective stress is calculate at </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>elevation to calculate effective stress at </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05790">5790</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">  !&lt; cell node number</span></div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: es0<span class="comment">       !&lt; effective stress at elevation z0</span></div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: z0<span class="comment">        !&lt; elevation effective stress is calculate at</span></div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: z<span class="comment">         !&lt; elevation to calculate effective stress at</span></div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;    <span class="comment">! -- adjust effective stress to vertical node position</span></div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;    es = es0 - (z - z0)*(this%sgs(node) - <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>)</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05fcad1c27703a703fb6d69d45c0180a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05fcad1c27703a703fb6d69d45c0180a">&#9670;&nbsp;</a></span>csub_calc_delay_flow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_delay_flow </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the flow from across the top or bottom of a delay interbed.</p>
<dl class="section return"><dt>Returns</dt><dd>q flow across the top or bottom of a delay interbed </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>delay interbed cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07167">7167</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">  !&lt; interbed number</span></div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">   !&lt; delay interbed cell</span></div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">   !&lt; current head in cell</span></div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;<span class="keywordtype">    real</span>(DP) :: q</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;<span class="keywordtype">    real</span>(DP) :: c</div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;    <span class="comment">! -- calculate flow between delay interbed and GWF</span></div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;    c = dtwo*this%kv(ib)/this%dbdzini(n, idelay)</div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;    q = c*(hcell - this%dbh(n, idelay))</div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8cf53003c8beb84858f8d048f829c06e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf53003c8beb84858f8d048f829c06e">&#9670;&nbsp;</a></span>csub_calc_interbed_thickness()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_interbed_thickness </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the interbed thickness.</p>
<dl class="section return"><dt>Returns</dt><dd>thick interbed thickness </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05731">5731</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">  !&lt; interbed number</span></div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;    <span class="comment">! -- calculate interbed thickness</span></div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    thick = this%thick(ib)</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;    <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;      thick = thick*this%rnb(ib)</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b5e00a1dc845b9af4a494fa7af9c457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b5e00a1dc845b9af4a494fa7af9c457">&#9670;&nbsp;</a></span>csub_calc_sat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_calc_sat </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>snnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>snold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the cell saturation for the current and previous time step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snnew</td><td>current saturation </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snold</td><td>previous saturation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snnew</td><td>current saturation </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snold</td><td>previous saturation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05867">5867</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">  !&lt; cell node number</span></div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">     !&lt; current head</span></div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">  !&lt; previous head</span></div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: snnew<span class="comment">  !&lt; current saturation</span></div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: snold<span class="comment">  !&lt; previous saturation</span></div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;    <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;    <span class="keywordflow">if</span> (this%stoiconv(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;      snnew = squadraticsaturation(top, bot, hcell, this%satomega)</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;      snold = squadraticsaturation(top, bot, hcellold, this%satomega)</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;      snnew = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;      snold = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;      snold = snnew</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a4b5e00a1dc845b9af4a494fa7af9c457_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a4b5e00a1dc845b9af4a494fa7af9c457_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a4b5e00a1dc845b9af4a494fa7af9c457_cgraph" id="namespacegwfcsubmodule_a4b5e00a1dc845b9af4a494fa7af9c457_cgraph">
<area shape="rect" title="Calculate cell saturation." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#a4be083cd9964c682d55802ff9bc436bc" title=" " alt="" coords="216,13,499,39"/>
</map>
</div>

</div>
</div>
<a id="a12e6b1f6f88d19723a48b4c70f1073c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12e6b1f6f88d19723a48b4c70f1073c6">&#9670;&nbsp;</a></span>csub_calc_sat_derivative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_sat_derivative </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the derivative of the saturation with respect to the current head.</p>
<dl class="section return"><dt>Returns</dt><dd>satderv derivative of saturation </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05904">5904</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">  !&lt; cell node number</span></div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">     !&lt; current head</span></div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;<span class="keywordtype">    real</span>(DP) :: satderv</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;    <span class="keywordflow">if</span> (this%stoiconv(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;      satderv = <a class="code" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c">squadraticsaturationderivative</a>(top, bot, hcell, this%satomega)</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;      satderv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a12e6b1f6f88d19723a48b4c70f1073c6_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a12e6b1f6f88d19723a48b4c70f1073c6_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a12e6b1f6f88d19723a48b4c70f1073c6_cgraph" id="namespacegwfcsubmodule_a12e6b1f6f88d19723a48b4c70f1073c6_cgraph">
<area shape="rect" title="Calculate the saturation derivative." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c" title=" " alt="" coords="216,13,564,39"/>
</map>
</div>

</div>
</div>
<a id="a09e60f0362ac490833bcd7733c1724b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09e60f0362ac490833bcd7733c1724b2">&#9670;&nbsp;</a></span>csub_calc_sfacts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_calc_sfacts </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>bot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>znode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>es</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>es0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>fact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the factor that is used to calculate skeletal specific storage coefficients. Can be used for coarse-grained materials and interbeds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fact</td><td>skeletal storage coefficient factor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta</td><td>porosity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">es</td><td>current effective stress </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">es0</td><td>previous effective stress </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fact</td><td>skeletal storage coefficient factor (1/((1+void)*bar(es))) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05935">5935</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">  !&lt; cell node number</span></div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: bot       <span class="comment">!</span></div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: znode</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: theta<span class="comment">     !&lt; porosity</span></div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: es<span class="comment">        !&lt; current effective stress</span></div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: es0<span class="comment">       !&lt; previous effective stress</span></div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: fact<span class="comment">   !&lt; skeletal storage coefficient factor (1/((1+void)*bar(es)))</span></div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;<span class="keywordtype">    real</span>(DP) :: esv</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;<span class="keywordtype">    real</span>(DP) :: void</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;<span class="keywordtype">    real</span>(DP) :: denom</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;    fact = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;      esv = es0</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;      esv = es</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;    <span class="comment">! -- calculate storage factors for the effective stress case</span></div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;    void = this%csub_calc_void(theta)</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;    denom = this%csub_calc_adjes(node, esv, bot, znode)</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;    denom = denom*(<a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a> + void)</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;    <span class="keywordflow">if</span> (denom /= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;      fact = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/denom</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfc23a9d6539f4b29458036dcbfd2dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfc23a9d6539f4b29458036dcbfd2dbb">&#9670;&nbsp;</a></span>csub_calc_theta()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_theta </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>void</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the porosity from the void ratio.</p>
<dl class="section return"><dt>Returns</dt><dd>theta porosity </dd></dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05711">5711</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: void</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;    <span class="comment">! -- calculate theta</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;    theta = void/(<a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a> + void)</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac35837b7432d5c546ff39b5ae5b0822b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac35837b7432d5c546ff39b5ae5b0822b">&#9670;&nbsp;</a></span>csub_calc_void()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_void </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the void ratio from the porosity.</p>
<dl class="section return"><dt>Returns</dt><dd>void void ratio </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">theta</td><td>porosity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05692">5692</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: theta<span class="comment">  !&lt; porosity</span></div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;<span class="keywordtype">    real</span>(DP) :: void</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;    <span class="comment">! -- calculate void ratio</span></div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;    void = theta/(<a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a> - theta)</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ada08295accec1b680f6f87de831990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ada08295accec1b680f6f87de831990">&#9670;&nbsp;</a></span>csub_calc_znode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_calc_znode </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>zbar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate elevation of the node between the specified corrected elevation zbar and the bottom elevation. If zbar is greater than the top elevation, the node elevation is halfway between the top and bottom elevations. The corrected elevation (zbar) is always greater than or equal to bottom.</p>
<dl class="section return"><dt>Returns</dt><dd>znode node elevation </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>top of cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bottom</td><td>bottom of cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zbar</td><td>corrected elevation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05760">5760</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: top<span class="comment">       !&lt; top of cell</span></div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: bottom<span class="comment">    !&lt; bottom of cell</span></div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: zbar<span class="comment">      !&lt; corrected elevation</span></div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;<span class="keywordtype">    real</span>(DP) :: znode</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;<span class="keywordtype">    real</span>(DP) :: v</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    <span class="comment">! -- calculate the node elevation</span></div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;    <span class="keywordflow">if</span> (zbar &gt; top) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;      v = top</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;      v = zbar</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;    znode = dhalf*(v + bottom)</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54be5f032991010dead79b3ed5fe17e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54be5f032991010dead79b3ed5fe17e6">&#9670;&nbsp;</a></span>csub_cc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>innertot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icnvgmod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenpakloc), intent(inout)&#160;</td>
          <td class="paramname"><em>cpak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>ipak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>dpak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Final convergence check for the CSUB package. The final convergence check is only required when the simulation includes delay interbeds. The final convergence check compares the sum of water contributed by storage and water compressibility in the delay bed to the fluid exchange between the delay interbed and the gwf cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cpak</td><td>string location of the maximum change in csub package </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ipak</td><td>node with the maximum change in csub package </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dpak</td><td>maximum change in csub package </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">innertot</td><td>total number of inner iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>outer iteration number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iend</td><td>flag indicating if it is the last iteration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icnvgmod</td><td>flag indicating if the solution is considered converged </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of active nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current gwf head </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hold</td><td>gwf for previous time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cpak</td><td>string location of the maximum change in csub package </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ipak</td><td>node with the maximum change in csub package </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dpak</td><td>maximum change in csub package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l02992">2992</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: innertot<span class="comment">                !&lt; total number of inner iterations</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                   !&lt; outer iteration number</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iend<span class="comment">                    !&lt; flag indicating if it is the last iteration</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icnvgmod<span class="comment">                !&lt; flag indicating if the solution is considered converged</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                   !&lt; number of active nodes</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nodes)</span>, <span class="keywordtype">intent(in)</span> :: hnew<span class="comment">      !&lt; current gwf head</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nodes)</span>, <span class="keywordtype">intent(in)</span> :: hold<span class="comment">      !&lt; gwf for previous time step</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span>, <span class="keywordtype">intent(inout)</span> :: cpak<span class="comment">     !&lt; string location of the maximum change in csub package</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: ipak<span class="comment">                 !&lt; node with the maximum change in csub package</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: dpak<span class="comment">                     !&lt; maximum change in csub package</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: cloc</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icheck</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipakfail</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locdhmax</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locrmax</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ifirst</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;<span class="keywordtype">    real</span>(DP) :: dhmax</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;<span class="keywordtype">    real</span>(DP) :: rmax</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="keywordtype">    real</span>(DP) :: dh</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcell</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcellold</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;<span class="keywordtype">    real</span>(DP) :: stoe</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;<span class="keywordtype">    real</span>(DP) :: stoi</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;<span class="keywordtype">    real</span>(DP) :: dwc</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcof</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhs</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="keywordtype">    real</span>(DP) :: v1</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="keywordtype">    real</span>(DP) :: v2</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="keywordtype">    real</span>(DP) :: df</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    icheck = this%iconvchk</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    ipakfail = 0</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    locdhmax = 0</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    locrmax = 0</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    dhmax = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    rmax = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    ifirst = 1</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="comment">! -- additional checks to see if convergence needs to be checked</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="comment">! -- no convergence check for steady-state stress periods</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <span class="keywordflow">if</span> (this%gwfiss /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;      icheck = 0</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      <span class="comment">! -- if not saving package convergence data on check convergence if</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;      <span class="comment">!    the model is considered converged</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="keywordflow">if</span> (this%ipakcsv == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;        <span class="keywordflow">if</span> (icnvgmod == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;          icheck = 0</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="comment">! -- header for package csv</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%pakcsvtab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;          <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          ntabrows = 1</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;          ntabcols = 9</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%pakcsvtab, this%packName, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%table_df(ntabrows, ntabcols, this%ipakcsv, &amp;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                                       lineseparator=.false., separator=<span class="stringliteral">&#39;,&#39;</span>, &amp;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                                       finalize=.false.)</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;          <span class="comment">! -- add columns to package csv</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;          tag = <span class="stringliteral">&#39;total_inner_iterations&#39;</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;          tag = <span class="stringliteral">&#39;totim&#39;</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;          tag = <span class="stringliteral">&#39;kper&#39;</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;          tag = <span class="stringliteral">&#39;kstp&#39;</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;          tag = <span class="stringliteral">&#39;nouter&#39;</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;          tag = <span class="stringliteral">&#39;dvmax&#39;</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft)</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;          tag = <span class="stringliteral">&#39;dvmax_loc&#39;</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft)</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;          tag = <span class="stringliteral">&#39;dstoragemax&#39;</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft)</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;          tag = <span class="stringliteral">&#39;dstoragemax_loc&#39;</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft)</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="comment">! -- perform package convergence check</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordflow">if</span> (icheck /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a> &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        tled = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      final_check: <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        idelay = this%idelay(ib)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        <span class="comment">! -- skip nodelay interbeds</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;        <span class="keywordflow">if</span> (idelay == 0) cycle</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        <span class="comment">! -- skip inactive cells</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) &lt; 1) cycle</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        <span class="comment">! -- evaluate the maximum head change in the interbed</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;        dh = this%dbdhmax(idelay)</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        <span class="comment">! -- evaluate difference between storage changes</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;        <span class="comment">!    in the interbed and exchange between the interbed</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        <span class="comment">!    and the gwf cell</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        area = this%dis%get_area(node)</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        hcell = hnew(node)</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        hcellold = hold(node)</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;        <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <span class="comment">! -- calculate the change in storage</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_dstor(ib, hcell, stoe, stoi)</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        v1 = (stoe + stoi)*area*this%rnb(ib)*tled</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        <span class="comment">! -- add water compressibility to storage term</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_wcomp(ib, dwc)</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        v1 = v1 + dwc*area*this%rnb(ib)</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="comment">! -- calculate the flow between the interbed and the cell</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        <span class="keyword">call </span>this%csub_delay_fc(ib, hcof, rhs)</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        v2 = (-hcof*hcell - rhs)*area*this%rnb(ib)</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        <span class="comment">! -- calculate the difference between the interbed change in</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        <span class="comment">!    storage and the flow between the interbed and the cell</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        df = v2 - v1</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <span class="comment">! -- normalize by cell area and convert to a depth</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        df = df*<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>/area</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <span class="comment">! -- evaluate magnitude of differences</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        <span class="keywordflow">if</span> (ifirst == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;          ifirst = 0</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;          locdhmax = ib</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;          dhmax = dh</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;          locrmax = ib</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;          rmax = df</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;          <span class="keywordflow">if</span> (abs(dh) &gt; abs(dhmax)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;            locdhmax = ib</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;            dhmax = dh</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;          <span class="keywordflow">if</span> (abs(df) &gt; abs(rmax)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;            locrmax = ib</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;            rmax = df</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="keywordflow">      end do</span> final_check</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      <span class="comment">! -- set dpak and cpak</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      <span class="comment">! -- update head error</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      <span class="keywordflow">if</span> (abs(dhmax) &gt; abs(dpak)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        ipak = locdhmax</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        dpak = dhmax</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        <span class="keyword">write</span> (cloc, <span class="stringliteral">&quot;(a,&#39;-&#39;,a)&quot;</span>) trim(this%packName), <span class="stringliteral">&#39;head&#39;</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        cpak = cloc</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      <span class="comment">! -- update storage error</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="keywordflow">if</span> (abs(rmax) &gt; abs(dpak)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        ipak = locrmax</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;        dpak = rmax</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        <span class="keyword">write</span> (cloc, <span class="stringliteral">&quot;(a,&#39;-&#39;,a)&quot;</span>) trim(this%packName), <span class="stringliteral">&#39;storage&#39;</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;        cpak = cloc</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <span class="comment">! -- write convergence data to package csv</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;      <span class="keywordflow">if</span> (this%ipakcsv /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(innertot)</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(<a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>)</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>)</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(kiter)</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(dhmax)</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(locdhmax)</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(rmax)</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%add_term(locrmax)</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        <span class="comment">! -- finalize the package csv</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        <span class="keywordflow">if</span> (iend == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%finalize_table()</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a54be5f032991010dead79b3ed5fe17e6_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a54be5f032991010dead79b3ed5fe17e6_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a54be5f032991010dead79b3ed5fe17e6_cgraph" id="namespacegwfcsubmodule_a54be5f032991010dead79b3ed5fe17e6_cgraph">
<area shape="rect" title="@ brief Final convergence check" alt="" coords="5,5,189,32"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="237,5,401,32"/>
</map>
</div>

</div>
</div>
<a id="a15ed2c5ae1530711a95ae4b952dd6156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15ed2c5ae1530711a95ae4b952dd6156">&#9670;&nbsp;</a></span>csub_cg_calc_comp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_calc_comp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method calculates coarse-grained compaction in a cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp</td><td>coarse-grained compaction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp</td><td>coarse-grained compaction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05378">5378</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">   !&lt; cell node number</span></div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">      !&lt; current head in cell</span></div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">   !&lt; previous head in cell</span></div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: comp<span class="comment">    !&lt; coarse-grained compaction</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcof</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhs</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;    area = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;    tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;    <span class="comment">! -- calculate terms</span></div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;    <span class="keyword">call </span>this%csub_cg_fc(node, tled, area, hcell, hcellold, hcof, rhs)</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;    <span class="comment">! - calculate compaction</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;    comp = hcof*hcell - rhs</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4448d660bfe423c8327c9f3d835348d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4448d660bfe423c8327c9f3d835348d8">&#9670;&nbsp;</a></span>csub_cg_calc_sske()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_calc_sske </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>sske</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method calculates Sske for coarse-grained materials in a cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sske</td><td>coarse-grained Sske </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sske</td><td>coarse grained Sske </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05319">5319</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">      !&lt; cell node number</span></div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: sske<span class="comment">    !&lt; coarse grained Sske</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">      !&lt; current head in cell</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="keywordtype">    real</span>(DP) :: znode</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;<span class="keywordtype">    real</span>(DP) :: f0</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    sske = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    <span class="comment">! -- calculate factor for the head-based case</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;    <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;      f = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;      f0 = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;      <span class="comment">! -- calculate factor for the effective stress case</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;      top = this%dis%top(n)</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;      bot = this%dis%bot(n)</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;      <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;      hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;      <span class="comment">! -- calculate znode</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;      znode = this%csub_calc_znode(top, bot, hbar)</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;      <span class="comment">! -- calculate effective stress and theta</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;      es = this%cg_es(n)</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;      es0 = this%cg_es0(n)</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;      theta = this%cg_thetaini(n)</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <span class="comment">! -- calculate the compression index factors for the delay</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;      <span class="comment">!    node relative to the center of the cell based on the</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;      <span class="comment">!    current and previous head</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;      <span class="keyword">call </span>this%csub_calc_sfacts(n, bot, znode, theta, es, es0, f)</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;    sske = f*this%cg_ske_cr(n)</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a4448d660bfe423c8327c9f3d835348d8_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a4448d660bfe423c8327c9f3d835348d8_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a4448d660bfe423c8327c9f3d835348d8_cgraph" id="namespacegwfcsubmodule_a4448d660bfe423c8327c9f3d835348d8_cgraph">
<area shape="rect" title="@ brief Calculate Sske for a cell" alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="a8b990f1d8726331981c41f505040308a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b990f1d8726331981c41f505040308a">&#9670;&nbsp;</a></span>csub_cg_calc_stress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_calc_stress </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method calculates the geostatic stress, pressure head, and effective stress at the bottom of each cell. The method also applies the overlying geostatic stress (sig0) not represented in the model. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of active model nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current head </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04183">4183</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                !&lt; number of active model nodes</span></div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nodes)</span>, <span class="keywordtype">intent(in)</span> :: hnew<span class="comment">   !&lt; current head</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: m</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iis</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;<span class="keywordtype">    real</span>(DP) :: gs</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="keywordtype">    real</span>(DP) :: va_scale</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcell</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="keywordtype">    real</span>(DP) :: gs_conn</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;<span class="keywordtype">    real</span>(DP) :: area_node</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="keywordtype">    real</span>(DP) :: area_conn</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;<span class="keywordtype">    real</span>(DP) :: phead</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="keywordtype">    real</span>(DP) :: hwva</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;<span class="keywordtype">    real</span>(DP) :: sadd</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;    <span class="comment">! -- calculate geostatic stress if necessary</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <span class="keywordflow">if</span> (this%iupdatestress /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;        <span class="comment">! -- calculate geostatic stress for this node</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;        <span class="comment">!    this represents the geostatic stress component</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;        <span class="comment">!    for the cell</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        top = this%dis%top(node)</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        bot = this%dis%bot(node)</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;        thick = top - bot</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;        <span class="comment">! -- calculate cell contribution to geostatic stress</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;          hcell = hnew(node)</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;          hcell = bot</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;        <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;        hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;        <span class="comment">! -- geostatic stress calculation</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;        <span class="keywordflow">if</span> (hcell &lt; top) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;          gs = (top - hbar)*this%sgm(node) + (hbar - bot)*this%sgs(node)</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;          gs = thick*this%sgs(node)</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        <span class="comment">! -- cell contribution to geostatic stress</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        this%cg_gs(node) = gs</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      <span class="comment">! -- add user specified overlying geostatic stress</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;      <span class="keywordflow">do</span> nn = 1, this%nbound</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;        node = this%nodelistsig0(nn)</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        sadd = this%sig0(nn)</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        this%cg_gs(node) = this%cg_gs(node) + sadd</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;      <span class="comment">! -- calculate geostatic stress above cell</span></div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;        <span class="comment">! -- area of cell</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        area_node = this%dis%get_area(node)</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        <span class="comment">! -- geostatic stress of cell</span></div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;        gs = this%cg_gs(node)</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        <span class="comment">! -- Add geostatic stress of overlying cells (ihc=0)</span></div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;        <span class="comment">!    m &lt; node = m is vertically above node</span></div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        <span class="keywordflow">do</span> ii = this%dis%con%ia(node) + 1, this%dis%con%ia(node + 1) - 1</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;          <span class="comment">! -- Set the m cell number</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;          m = this%dis%con%ja(ii)</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;          iis = this%dis%con%jas(ii)</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;          <span class="comment">! -- vertical connection</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;          <span class="keywordflow">if</span> (this%dis%con%ihc(iis) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;            <span class="comment">! -- node has an overlying cell</span></div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;            <span class="keywordflow">if</span> (m &lt; node) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;              <span class="comment">! -- dis and disv discretization</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;              <span class="keywordflow">if</span> (this%dis%ndim /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;                gs = gs + this%cg_gs(m)</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                <span class="comment">! -- disu discretization</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                <span class="comment">!    *** this needs to be checked ***</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;                area_conn = this%dis%get_area(m)</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;                hwva = this%dis%con%hwva(iis)</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;                va_scale = this%dis%con%hwva(iis)/this%dis%get_area(m)</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                gs_conn = this%cg_gs(m)</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;                gs = gs + (gs_conn*va_scale)</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160; </div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;        <span class="comment">! -- geostatic stress for cell with geostatic stress</span></div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        <span class="comment">!    of overlying cells</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;        this%cg_gs(node) = gs</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    <span class="comment">! -- save effective stress from the last iteration and</span></div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="comment">!    calculate the new effective stress for a cell</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      <span class="keywordflow">if</span> (this%ibound(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;        hcell = hnew(node)</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;        hcell = bot</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;      <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;      hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;      <span class="comment">! -- calculate pressure head</span></div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;      phead = hbar - bot</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      <span class="comment">! -- calculate effective stress</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;      es = this%cg_gs(node) - phead</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;      this%cg_es(node) = es</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a8b990f1d8726331981c41f505040308a_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a8b990f1d8726331981c41f505040308a_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a8b990f1d8726331981c41f505040308a_cgraph" id="namespacegwfcsubmodule_a8b990f1d8726331981c41f505040308a_cgraph">
<area shape="rect" title="@ brief Calculate the stress for model cells" alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="af5faaf5a2d3613e66d1892838e16fbef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5faaf5a2d3613e66d1892838e16fbef">&#9670;&nbsp;</a></span>csub_cg_chk_stress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_chk_stress </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method checks calculated effective stress values to ensure that effective stress values are positive. An error condition and message are issued if calculated effective stress values are less than a small positive value (DEM6). </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04330">4330</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    <span class="keywordtype">character(len=20)</span> :: cellid</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;<span class="keywordtype">    real</span>(DP) :: gs</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcell</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;<span class="keywordtype">    real</span>(DP) :: phead</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    ierr = 0</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    <span class="comment">! -- check geostatic stress if necessary</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    <span class="comment">! -- save effective stress from the last iteration and</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    <span class="comment">!    calculate the new effective stress for a cell</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      <span class="keywordflow">if</span> (this%ibound(node) &lt; 1) cycle</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      gs = this%cg_gs(node)</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      es = this%cg_es(node)</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      phead = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;      <span class="keywordflow">if</span> (this%ibound(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;        phead = gs - es</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      hcell = phead + bot</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      <span class="keywordflow">if</span> (this%lhead_based .EQV. .false.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;        <span class="keywordflow">if</span> (es &lt; dem6) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;          ierr = ierr + 1</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;          <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,g0,a,1x,a,1x,a,4(g0,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;            <span class="stringliteral">&#39;Small to negative effective stress (&#39;</span>, es, <span class="stringliteral">&#39;) in cell&#39;</span>, &amp;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;            trim(adjustl(cellid)), <span class="stringliteral">&#39;. (&#39;</span>, es, <span class="stringliteral">&#39; = &#39;</span>, this%cg_gs(node), &amp;</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;            <span class="stringliteral">&#39; - (&#39;</span>, hcell, <span class="stringliteral">&#39; - &#39;</span>, bot, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <span class="comment">! -- write a summary error message</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <span class="keywordflow">if</span> (ierr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,3(1x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;        <span class="stringliteral">&#39;Solution: small to negative effective stress values in&#39;</span>, ierr, &amp;</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;        <span class="stringliteral">&#39;cells can be eliminated by increasing storage values and/or &#39;</span>, &amp;</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;        <span class="stringliteral">&#39;adding/modifying stress boundaries to prevent water-levels from&#39;</span>, &amp;</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;        <span class="stringliteral">&#39;exceeding the top of the model.&#39;</span></div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_af5faaf5a2d3613e66d1892838e16fbef_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_af5faaf5a2d3613e66d1892838e16fbef_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_af5faaf5a2d3613e66d1892838e16fbef_cgraph" id="namespacegwfcsubmodule_af5faaf5a2d3613e66d1892838e16fbef_cgraph">
<area shape="rect" title="@ brief Check effective stress values" alt="" coords="5,35,168,77"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="216,17,391,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="234,68,373,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="439,27,607,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="439,93,607,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="655,5,849,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="668,57,836,98"/>
</map>
</div>

</div>
</div>
<a id="af6ba2cc610b8fd91243b2d0e3a7cce90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ba2cc610b8fd91243b2d0e3a7cce90">&#9670;&nbsp;</a></span>csub_cg_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the coefficient matrix and right-hand side terms for coarse grained materials in a cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>recripicol of the time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04993">4993</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">    !&lt; cell node number</span></div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">        !&lt; recripicol of the time step length</span></div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">        !&lt; horizontal cell area</span></div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">       !&lt; current head</span></div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">    !&lt; previous head</span></div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">     !&lt; coarse-grained A matrix entry</span></div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">      !&lt; coarse-grained right-hand side entry</span></div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;<span class="keywordtype">    real</span>(DP) :: sske</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho1</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;    <span class="comment">! -- aquifer elevations and thickness</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    tthk = this%cg_thickini(node)</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;    <span class="comment">! -- calculate hcof and rhs terms if coarse-grained materials present</span></div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;    <span class="keywordflow">if</span> (tthk &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;      <span class="comment">! -- calculate aquifer saturation</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="comment">! -- storage coefficients</span></div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;      <span class="keyword">call </span>this%csub_cg_calc_sske(node, sske, hcell)</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;      rho1 = sske*area*tthk*tled</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;      <span class="comment">! -- update sk and ske</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      this%cg_ske(node) = sske*tthk*snold</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      this%cg_sk(node) = sske*tthk*snnew</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      <span class="comment">! -- calculate hcof and rhs term</span></div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      hcof = -rho1*snnew</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      rhs = rho1*snold*this%cg_es0(node) - &amp;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;            rho1*snnew*(this%cg_gs(node) + bot)</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      <span class="comment">! -- calculate and apply the flow correction term</span></div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;      rhs = rhs - rho1*snnew*(hcell - hbar)</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_af6ba2cc610b8fd91243b2d0e3a7cce90_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_af6ba2cc610b8fd91243b2d0e3a7cce90_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_af6ba2cc610b8fd91243b2d0e3a7cce90_cgraph" id="namespacegwfcsubmodule_af6ba2cc610b8fd91243b2d0e3a7cce90_cgraph">
<area shape="rect" title="@ brief Formulate the coefficients for coarse&#45;grained materials" alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="ad317ed87eb5b8b4ad72359c7cfd0d2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad317ed87eb5b8b4ad72359c7cfd0d2c1">&#9670;&nbsp;</a></span>csub_cg_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the coefficient matrix and right-hand side terms for coarse grained materials in a cell when using the Newton-Raphson formulation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>reciprocal of the time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05062">5062</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">  !&lt; node number</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">      !&lt; reciprocal of the time step length</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">      !&lt; horizontal cell area</span></div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">     !&lt; current head in cell</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">   !&lt; coarse-grained A matrix entry</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">    !&lt; coarse-grained right-hand side entry</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;<span class="keywordtype">    real</span>(DP) :: satderv</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbarderv</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;<span class="keywordtype">    real</span>(DP) :: sske</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho1</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;    <span class="comment">! -- aquifer elevations and thickness</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    tthk = this%cg_thickini(node)</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;    <span class="comment">! -- calculate newton terms if coarse-grained materials present</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;    <span class="keywordflow">if</span> (tthk &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;      <span class="comment">! -- calculate aquifer saturation - only need snnew</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;      <span class="keyword">call </span>this%csub_calc_sat(node, hcell, top, snnew, snold)</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      <span class="comment">! -- calculate saturation derivative</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;      satderv = this%csub_calc_sat_derivative(node, hcell)</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;      <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;      hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;      <span class="comment">! -- calculate the derivative of the hbar functions</span></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;      hbarderv = squadratic0spderivative(hcell, bot, this%satomega)</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;      <span class="comment">! -- storage coefficients</span></div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;      <span class="keyword">call </span>this%csub_cg_calc_sske(node, sske, hcell)</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;      rho1 = sske*area*tthk*tled</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;      <span class="comment">! -- calculate hcof term</span></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      hcof = rho1*snnew*(<a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a> - hbarderv) + &amp;</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;             rho1*(this%cg_gs(node) - hbar + bot)*satderv</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;      <span class="comment">! -- Add additional term if using lagged effective stress</span></div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;        hcof = hcof - rho1*this%cg_es0(node)*satderv</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      <span class="comment">! -- calculate rhs term</span></div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      rhs = hcof*hcell</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_ad317ed87eb5b8b4ad72359c7cfd0d2c1_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_ad317ed87eb5b8b4ad72359c7cfd0d2c1_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_ad317ed87eb5b8b4ad72359c7cfd0d2c1_cgraph" id="namespacegwfcsubmodule_ad317ed87eb5b8b4ad72359c7cfd0d2c1_cgraph">
<area shape="rect" title="@ brief Formulate coarse&#45;grained Newton&#45;Raphson terms" alt="" coords="5,23,168,65"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="249,5,488,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#ab9fb2d1fba4997a52d022c47f60e57a6" title=" " alt="" coords="216,56,521,83"/>
</map>
</div>

</div>
</div>
<a id="aa7b742c3ab5529ca58759bbffad470b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7b742c3ab5529ca58759bbffad470b7">&#9670;&nbsp;</a></span>csub_cg_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_update </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method updates coarse-grained material proerties in a cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05410">5410</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">    !&lt; cell node number</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;    <span class="keywordtype">character(len=20)</span> :: cellid</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;<span class="keywordtype">    real</span>(DP) :: comp</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;    <span class="comment">! -- update thickness and theta</span></div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;    comp = this%cg_tcomp(node) + this%cg_comp(node)</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;    <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;    <span class="keywordflow">if</span> (abs(comp) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;      thick = this%cg_thickini(node)</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;      theta = this%cg_thetaini(node)</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      <span class="keyword">call </span>this%csub_adj_matprop(comp, thick, theta)</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      <span class="keywordflow">if</span> (thick &lt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,a,g0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;          <span class="stringliteral">&#39;Adjusted thickness for cell&#39;</span>, trim(adjustl(cellid)), &amp;</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;          <span class="stringliteral">&#39;is less than or equal to 0 (&#39;</span>, thick, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      <span class="keywordflow">if</span> (theta &lt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,a,g0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;          <span class="stringliteral">&#39;Adjusted theta for cell&#39;</span>, trim(adjustl(cellid)), &amp;</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;          <span class="stringliteral">&#39;is less than or equal to 0 (&#39;</span>, theta, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;      this%cg_thick(node) = thick</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      this%cg_theta(node) = theta</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aa7b742c3ab5529ca58759bbffad470b7_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_aa7b742c3ab5529ca58759bbffad470b7_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aa7b742c3ab5529ca58759bbffad470b7_cgraph" id="namespacegwfcsubmodule_aa7b742c3ab5529ca58759bbffad470b7_cgraph">
<area shape="rect" title="@ brief Update coarse&#45;grained material properties" alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="216,13,391,39"/>
</map>
</div>

</div>
</div>
<a id="a09133d8438afb7837770ed2db4db56e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09133d8438afb7837770ed2db4db56e9">&#9670;&nbsp;</a></span>csub_cg_wcomp_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_wcomp_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the standard formulation coefficient matrix and right-hand side terms for water compressibility in coarse-grained sediments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>reciprocal of the time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05458">5458</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">   !&lt; cell node number</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">       !&lt; reciprocal of the time step length</span></div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">       !&lt; horizontal cell area</span></div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">      !&lt; current head in cell</span></div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">   !&lt; previous head in cell</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">    !&lt; coarse-grained A matrix entry</span></div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">     !&lt; coarse-grained right-hand side entry</span></div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk0</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;    <span class="comment">! -- aquifer elevations and thickness</span></div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;    tthk = this%cg_thick(node)</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;    tthk0 = this%cg_thick0(node)</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;    <span class="comment">! -- aquifer saturation</span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;    <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;    <span class="comment">! -- storage coefficients</span></div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;    wc0 = this%brg*area*tthk0*this%cg_theta0(node)*tled</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;    wc = this%brg*area*tthk*this%cg_theta(node)*tled</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;    <span class="comment">! -- calculate hcof term</span></div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;    hcof = -wc*snnew</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;    <span class="comment">! -- calculate rhs term</span></div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;    rhs = -wc0*snold*hcellold</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16905bb4d2ab3b1b01461ef996d3eb44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16905bb4d2ab3b1b01461ef996d3eb44">&#9670;&nbsp;</a></span>csub_cg_wcomp_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cg_wcomp_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the Newton-Raphson formulation coefficient matrix and right-hand side terms for water compressibility in coarse-grained sediments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>reciprocal of the time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coarse-grained A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>coarse-grained right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05515">5515</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">   !&lt; cell node number</span></div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">       !&lt; reciprocal of the time step length</span></div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">       !&lt; horizontal cell area</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">      !&lt; current head in cell</span></div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">   !&lt; previous head in cell</span></div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">    !&lt; coarse-grained A matrix entry</span></div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">     !&lt; coarse-grained right-hand side entry</span></div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk0</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;<span class="keywordtype">    real</span>(DP) :: satderv</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;    <span class="comment">! -- aquifer elevations and thickness</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;    tthk = this%cg_thick(node)</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;    <span class="comment">! -- calculate saturation derivitive</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;    satderv = this%csub_calc_sat_derivative(node, hcell)</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;    <span class="comment">! -- calculate water compressibility factor</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;    f = this%brg*area*tled</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;    <span class="comment">! -- water compressibility coefficient</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    wc = f*tthk*this%cg_theta(node)</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;    <span class="comment">! -- calculate hcof term</span></div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;    hcof = -wc*hcell*satderv</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;    <span class="comment">! -- Add additional term if using lagged effective stress</span></div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      tthk0 = this%cg_thick0(node)</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;      wc0 = f*tthk0*this%cg_theta0(node)</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;      hcof = hcof + wc*hcellold*satderv</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;    <span class="comment">! -- calculate rhs term</span></div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;    rhs = hcof*hcell</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af88936ae36bbf93083c3ce94fa419db9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af88936ae36bbf93083c3ce94fa419db9">&#9670;&nbsp;</a></span>csub_cq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_cq </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flow calculation for the CSUB package components. Components include coarse-grained storage, delay and no-delay interbeds, and water compressibility.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model_budget</td><td>model budget object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of active model nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current head </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hold</td><td>head for the previous time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isuppress_output</td><td>flag indicating if budget output should be suppressed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l03216">3216</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#aa63ca3273e52df46471c4746566f46bd">lenboundname</a>, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                 !&lt; number of active model nodes</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: hnew<span class="comment">    !&lt; current head</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: hold<span class="comment">    !&lt; head for the previous time step</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output<span class="comment">      !&lt; flag indicating if budget output should be suppressed</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ielastic</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iconvert</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho1</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho2</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;<span class="keywordtype">    real</span>(DP) :: tledm</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="keywordtype">    real</span>(DP) :: rrate</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="keywordtype">    real</span>(DP) :: ratein</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="keywordtype">    real</span>(DP) :: rateout</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="keywordtype">    real</span>(DP) :: comp</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="keywordtype">    real</span>(DP) :: compi</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="keywordtype">    real</span>(DP) :: compe</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="keywordtype">    real</span>(DP) :: h0</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcof</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhs</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="keywordtype">    real</span>(DP) :: stoe</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="keywordtype">    real</span>(DP) :: stoi</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="keywordtype">    real</span>(DP) :: b</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="keywordtype">    real</span>(DP) :: q</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="keywordtype">    real</span>(DP) :: rratewc</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="comment">! -- for observations</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iprobslocal</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <span class="comment">! -- Suppress saving of simulated values; they</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    <span class="comment">!    will be saved at end of this procedure.</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    iprobslocal = 0</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    ratein = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    rateout = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <span class="comment">! -- coarse-grained coarse-grained storage</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      idiag = this%dis%con%ia(node)</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      area = this%dis%get_area(node)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      comp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;      rrate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      rratewc = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a> &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;          tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;          tled = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) &gt; 0 .and. this%cg_thickini(node) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;          <span class="comment">! -- calculate coarse-grained storage terms</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;          <span class="keyword">call </span>this%csub_cg_fc(node, tled, area, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                               hcof, rhs)</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;          rrate = hcof*hnew(node) - rhs</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;          <span class="comment">! -- calculate compaction</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;          <span class="keyword">call </span>this%csub_cg_calc_comp(node, hnew(node), hold(node), comp)</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;          <span class="comment">! -- calculate coarse-grained water compressibility storage terms</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;          <span class="keyword">call </span>this%csub_cg_wcomp_fc(node, tled, area, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;                                     hcof, rhs)</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;          rratewc = hcof*hnew(node) - rhs</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      <span class="comment">! -- update coarse-grained storage and water</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      <span class="comment">!    compresion variables</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      this%cg_stor(node) = rrate</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      this%cell_wcstor(node) = rratewc</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      this%cell_thick(node) = this%cg_thick(node)</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      <span class="comment">! -- update incremental coarse-grained compaction</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      this%cg_comp(node) = comp</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <span class="comment">! -- update states if required</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="keywordflow">if</span> (isuppress_output == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <span class="comment">! -- calculate strain and change in coarse-grained void ratio and thickness</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="comment">! todo: consider moving error check in csub_cg_update to ot()</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;          <span class="keyword">call </span>this%csub_cg_update(node)</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        <span class="comment">! -- update total compaction</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        this%cg_tcomp(node) = this%cg_tcomp(node) + comp</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      <span class="comment">! -- update flowja</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      flowja(idiag) = flowja(idiag) + rrate</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      flowja(idiag) = flowja(idiag) + rratewc</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <span class="comment">! -- interbed storage</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="comment">! -- reset delay bed counters for the current time step</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="keywordflow">if</span> (this%ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      this%idb_nconv_count(1) = 0</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    <span class="comment">! -- initialize tled</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    <span class="comment">! -- calculate budget terms for each interbed</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      rratewc = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      ielastic = this%ielastic(ib)</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;      <span class="comment">! -- calculate interbed thickness</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;      <span class="comment">! -- no delay interbeds</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;      <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        b = this%thick(ib)</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        <span class="comment">! -- delay interbeds</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        b = this%thick(ib)*this%rnb(ib)</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;      <span class="comment">! -- set variables required for no-delay and delay interbeds</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      idiag = this%dis%con%ia(node)</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;      area = this%dis%get_area(node)</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;      <span class="comment">! -- add interbed thickness to cell thickness</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;      this%cell_thick(node) = this%cell_thick(node) + b</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <span class="comment">! -- update budget terms if transient stress period</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a> &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;          tledm = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;          tledm = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        <span class="comment">! -- skip inactive and constant head cells</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) &lt; 1) cycle</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;        <span class="comment">! -- no delay interbeds</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;        <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;          iconvert = this%iconvert(ib)</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;          stoi = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;          <span class="comment">! -- calculate compaction</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;          <span class="keyword">call </span>this%csub_nodelay_calc_comp(ib, hnew(node), hold(node), comp, &amp;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                                           rho1, rho2)</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;          <span class="comment">! -- interbed stresses</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;          es = this%cg_es(node)</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;          pcs = this%pcs(ib)</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;          es0 = this%cg_es0(node)</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;          <span class="comment">! -- calculate inelastic and elastic compaction</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;          <span class="keywordflow">if</span> (ielastic &gt; 0 .or. iconvert == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;            stoe = comp</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            stoi = -pcs*rho2 + (rho2*es)</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            stoe = pcs*rho1 - (rho1*es0)</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;          compe = stoe</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;          compi = stoi</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;          stoe = stoe*area</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;          stoi = stoi*area</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;          this%storagee(ib) = stoe*tledm</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;          this%storagei(ib) = stoi*tledm</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;          <span class="comment">! -- update compaction</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;          this%comp(ib) = comp</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;          <span class="comment">! -- update states if required</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;          <span class="keywordflow">if</span> (isuppress_output == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;            <span class="comment">! -- calculate strain and change in interbed void ratio and thickness</span></div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;            <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;              <span class="keyword">call </span>this%csub_nodelay_update(ib)</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;            <span class="comment">! -- update total compaction</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;            this%tcomp(ib) = this%tcomp(ib) + comp</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;            this%tcompe(ib) = this%tcompe(ib) + compe</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;            this%tcompi(ib) = this%tcompi(ib) + compi</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;          <span class="comment">! -- delay interbeds</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;          h = hnew(node)</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;          h0 = hold(node)</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;          <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;          <span class="keyword">call </span>this%csub_calc_sat(node, h, h0, snnew, snold)</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;          <span class="comment">! -- calculate inelastic and elastic storage contributions</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;          <span class="keyword">call </span>this%csub_delay_calc_dstor(ib, h, stoe, stoi)</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;          this%storagee(ib) = stoe*area*this%rnb(ib)*tledm</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;          this%storagei(ib) = stoi*area*this%rnb(ib)*tledm</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;          <span class="comment">! -- calculate flow across the top and bottom of the delay interbed</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;          q = this%csub_calc_delay_flow(ib, 1, h)*area*this%rnb(ib)</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;          this%dbflowtop(idelay) = q</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;          nn = this%ndelaycells</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;          q = this%csub_calc_delay_flow(ib, nn, h)*area*this%rnb(ib)</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;          this%dbflowbot(idelay) = q</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;          <span class="comment">! -- update states if required</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;          <span class="keywordflow">if</span> (isuppress_output == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;            <span class="comment">! -- calculate sum of compaction in delay interbed</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;            <span class="keyword">call </span>this%csub_delay_calc_comp(ib, h, h0, comp, compi, compe)</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            <span class="comment">! - calculate strain and change in interbed void ratio and thickness</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;            <span class="comment">! todo: consider moving error check in csub_delay_update to ot()</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;              <span class="keyword">call </span>this%csub_delay_update(ib)</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            <span class="comment">! -- update total compaction for interbed</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;            this%tcomp(ib) = this%tcomp(ib) + comp</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;            this%tcompi(ib) = this%tcompi(ib) + compi</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            this%tcompe(ib) = this%tcompe(ib) + compe</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;            <span class="comment">! -- update total compaction for each delay bed cell</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;              this%dbtcomp(n, idelay) = this%dbtcomp(n, idelay) + this%dbcomp(n, idelay)</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;            <span class="comment">! -- check delay bed heads relative to the top and bottom of each</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            <span class="comment">!    delay bed cell for convertible and non-convertible gwf cells</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            <span class="keyword">call </span>this%csub_delay_head_check(ib)</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        <span class="comment">! -- interbed water compressibility</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        <span class="comment">! -- no-delay interbed</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;          <span class="keyword">call </span>this%csub_nodelay_wcomp_fc(ib, node, tledm, area, &amp;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                                          hnew(node), hold(node), hcof, rhs)</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;          rratewc = hcof*hnew(node) - rhs</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          <span class="comment">! -- delay interbed</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;          <span class="keyword">call </span>this%csub_delay_calc_wcomp(ib, q)</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;          rratewc = q*area*this%rnb(ib)</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        this%cell_wcstor(node) = this%cell_wcstor(node) + rratewc</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        <span class="comment">! -- flowja</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        flowja(idiag) = flowja(idiag) + rratewc</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        this%storagee(ib) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        this%storagei(ib) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;          this%dbflowtop(idelay) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;          this%dbflowbot(idelay) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;      <span class="comment">! -- flowja</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;      flowja(idiag) = flowja(idiag) + this%storagee(ib)</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      flowja(idiag) = flowja(idiag) + this%storagei(ib)</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <span class="comment">! -- terminate if errors encountered when updating material properties</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_af88936ae36bbf93083c3ce94fa419db9_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_af88936ae36bbf93083c3ce94fa419db9_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_af88936ae36bbf93083c3ce94fa419db9_cgraph" id="namespacegwfcsubmodule_af88936ae36bbf93083c3ce94fa419db9_cgraph">
<area shape="rect" title="@ brief Calculate flows for package" alt="" coords="5,43,191,69"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="239,17,423,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="261,68,400,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="471,27,639,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="471,93,639,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="687,5,881,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="700,57,868,98"/>
</map>
</div>

</div>
</div>
<a id="aadc0a0e9249722a2c4669507d5d073ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadc0a0e9249722a2c4669507d5d073ac">&#9670;&nbsp;</a></span>csub_cr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public gwfcsubmodule::csub_cr </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), pointer&#160;</td>
          <td class="paramname"><em>csubobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>istounit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>stoPckName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new CSUB object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">csubobj</td><td>pointer to default package type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name_model</td><td>model name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunit</td><td>unit number of csub input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">istounit</td><td>unit number of storage package </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stopckname</td><td>name of the storage package </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>unit number of lst output file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l00304">304</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">type</span>(GwfCsubType), <span class="keywordtype">pointer</span> :: csubobj<span class="comment">            !&lt; pointer to default package type</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name_model<span class="comment">       !&lt; model name</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunit<span class="comment">               !&lt; unit number of csub input file</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: istounit<span class="comment">             !&lt; unit number of storage package</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: stoPckName<span class="comment">       !&lt; name of the storage package</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment">                 !&lt; unit number of lst output file</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">! -- allocate the object and assign values to object variables</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">allocate</span> (csubobj)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">! -- create name and memory path</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">call </span>csubobj%set_names(1, name_model, <span class="stringliteral">&#39;CSUB&#39;</span>, <span class="stringliteral">&#39;CSUB&#39;</span>)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">! -- Allocate scalars</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">call </span>csubobj%csub_allocate_scalars()</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">! -- Create memory path to variables from STO package</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    csubobj%stoMemPath = <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a>(name_model, stopckname)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">! -- Set variables</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    csubobj%istounit = istounit</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    csubobj%inunit = inunit</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    csubobj%iout = iout</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">! -- Initialize block parser</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">call </span>csubobj%parser%Initialize(csubobj%inunit, csubobj%iout)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_cgraph" id="namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_cgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="5,43,188,69"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738" title="returns the path to the memory object" alt="" coords="236,35,403,77"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="451,35,617,77"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="665,17,840,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="683,68,822,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="888,27,1056,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="888,93,1056,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="1104,5,1299,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1117,57,1285,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_icgraph.png" border="0" usemap="#namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_icgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_icgraph" id="namespacegwfcsubmodule_aadc0a0e9249722a2c4669507d5d073ac_icgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="1492,31,1675,57"/>
<area shape="rect" href="namespacegwfmodule.html#ab7c4f16fdcabd8814e3649d4950a4c9b" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a0043d2fa8d8b96e41e5e0fdfecaadae7" title=" " alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title=" " alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title=" " alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title=" " alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title=" " alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title=" " alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="ab8d88f964fa12806a3f06686c1627a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8d88f964fa12806a3f06686c1627a39">&#9670;&nbsp;</a></span>csub_da()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Deallocate CSUB package scalars and arrays. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l02250">2250</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="comment">! -- Deallocate arrays if package is active</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">if</span> (this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%unodelist)</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nodelist)</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idelay)</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ielastic)</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iconvert)</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="comment">! -- grid-based storage data</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%buff)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%buffusr)</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sgm)</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sgs)</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_ske_cr)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_gs)</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_es)</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_es0)</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_pcs)</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_comp)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_tcomp)</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_stor)</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_ske)</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_sk)</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <span class="keywordflow">if</span> (this%iupdatematprop == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        <span class="keyword">nullify</span> (this%cg_thick)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <span class="keyword">nullify</span> (this%cg_thick0)</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keyword">nullify</span> (this%cg_theta)</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="keyword">nullify</span> (this%cg_theta0)</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_thick)</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_thick0)</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_theta)</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_theta0)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_thickini)</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cg_thetaini)</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="comment">! -- cell storage</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cell_wcstor)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cell_thick)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      <span class="comment">! -- interbed storage</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%boundname, <span class="stringliteral">&#39;BOUNDNAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%auxname, <span class="stringliteral">&#39;AUXNAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%auxvar)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ci)</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rci)</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%pcs)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rnb)</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%kv)</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%h0)</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%comp)</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%tcomp)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%tcompi)</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%tcompe)</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%storagee)</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%storagei)</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ske)</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sk)</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      <span class="keywordflow">if</span> (this%iupdatematprop == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <span class="keyword">nullify</span> (this%thick)</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        <span class="keyword">nullify</span> (this%thick0)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <span class="keyword">nullify</span> (this%theta)</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="keyword">nullify</span> (this%theta0)</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%thick)</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%thick0)</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%theta)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%theta0)</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%thickini)</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%thetaini)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="comment">! -- delay bed storage</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="keywordflow">if</span> (this%ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          <span class="keyword">nullify</span> (this%dbdz)</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;          <span class="keyword">nullify</span> (this%dbdz0)</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;          <span class="keyword">nullify</span> (this%dbtheta)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;          <span class="keyword">nullify</span> (this%dbtheta0)</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbdz)</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbdz0)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbtheta)</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbtheta0)</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idb_nconv_count)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idbconvert)</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbdhmax)</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbz)</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbrelz)</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbh)</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbh0)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbgeo)</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbes)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbes0)</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbpcs)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbflowtop)</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbflowbot)</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbdzini)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbthetaini)</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbcomp)</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbtcomp)</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <span class="comment">! -- delay interbed solution arrays</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbal)</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbad)</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbau)</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbrhs)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbdh)</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbaw)</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">! -- period data</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nodelistsig0)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sig0)</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      <span class="comment">! -- pointers to gwf variables</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <span class="keyword">nullify</span> (this%gwfiss)</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="comment">! -- pointers to storage variables</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      <span class="keyword">nullify</span> (this%stoiconv)</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <span class="keyword">nullify</span> (this%stoss)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      <span class="comment">! -- input table</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      <span class="keywordflow">if</span> (this%iprpak &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        <span class="keyword">call </span>this%inputtab%table_da()</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <span class="keyword">deallocate</span> (this%inputtab)</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keyword">nullify</span> (this%inputtab)</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="comment">! -- output table</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      <span class="keywordflow">if</span> (this%istrainib &gt; 0 .or. this%istrainsk &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="keyword">call </span>this%outputtab%table_da()</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keyword">deallocate</span> (this%outputtab)</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        <span class="keyword">nullify</span> (this%outputtab)</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="comment">! -- package csv table</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="keywordflow">if</span> (this%ipakcsv &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      <span class="keyword">call </span>this%pakcsvtab%table_da()</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      <span class="keyword">deallocate</span> (this%pakcsvtab)</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      <span class="keyword">nullify</span> (this%pakcsvtab)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="comment">! -- deallocate character variables</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%listlabel, <span class="stringliteral">&#39;LISTLABEL&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%stoMemPath, <span class="stringliteral">&#39;STONAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="comment">! -- deallocate scalars</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%istounit)</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%inobspkg)</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ninterbeds)</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%maxsig0)</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nbound)</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iscloc)</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iauxmultcol)</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ndelaycells)</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ndelaybeds)</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%initialized)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ieslag)</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ipch)</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%lhead_based)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iupdatestress)</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ispecified_pcs)</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ispecified_dbh)</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%inamedbound)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iconvchk)</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%naux)</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%istoragec)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%istrainib)</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%istrainsk)</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ioutcomp)</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ioutcompi)</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ioutcompe)</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ioutcompib)</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ioutcomps)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ioutzdisp)</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ipakcsv)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iupdatematprop)</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%epsilon)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cc_crit)</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%gammaw)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%beta)</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%brg)</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%satomega)</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icellf)</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%gwfiss0)</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="comment">! -- deallocate methods on objects</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keywordflow">if</span> (this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keyword">call </span>this%obs%obs_da()</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="keyword">call </span>this%TsManager%da()</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="comment">! -- deallocate and nullify observations</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keyword">deallocate</span> (this%obs)</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <span class="keyword">nullify</span>(this%obs)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="comment">! -- deallocate TsManager</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keyword">deallocate</span> (this%TsManager)</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="keyword">nullify</span> (this%TsManager)</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="comment">! -- deallocate parent</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%da()</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa935103b95b95beb8a1c40867f9ab08f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa935103b95b95beb8a1c40867f9ab08f">&#9670;&nbsp;</a></span>csub_delay_assemble()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_assemble </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to assemble matrix and right-hand side coefficients for a delay interbed. The method calls the appropriate standard or Newton-Raphson assembly routines and fills all of the entries for a delay interbed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06357">6357</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">   !&lt; interbed number</span></div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">    !&lt; current head in a cell</span></div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;<span class="keywordtype">    real</span>(DP) :: aii</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;<span class="keywordtype">    real</span>(DP) :: au</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;<span class="keywordtype">    real</span>(DP) :: al</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;<span class="keywordtype">    real</span>(DP) :: r</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;    <span class="comment">! -- calculate matrix terms for each delay bed cell</span></div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;    <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;      <span class="comment">! -- assemble terms</span></div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;      <span class="keywordflow">if</span> (this%inewton == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;        <span class="keyword">call </span>this%csub_delay_assemble_fc(ib, n, hcell, aii, au, al, r)</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;        <span class="keyword">call </span>this%csub_delay_assemble_fn(ib, n, hcell, aii, au, al, r)</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;      <span class="comment">! -- add terms</span></div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;      this%dbal(n) = al</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;      this%dbau(n) = au</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;      this%dbad(n) = aii</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;      this%dbrhs(n) = r</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a98d62a1ef47868303e6063594743f7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d62a1ef47868303e6063594743f7d6">&#9670;&nbsp;</a></span>csub_delay_assemble_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_assemble_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>aii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>au</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>al</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to assemble standard formulation matrix and right-hand side coefficients for a delay interbed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>delay interbed cell number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aii</td><td>diagonal in the A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">au</td><td>upper term in the A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">al</td><td>lower term in the A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>right-hand side term </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06397">6397</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">   !&lt; interbed number</span></div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">    !&lt; delay interbed cell number</span></div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">    !&lt; current head in a cell</span></div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: aii<span class="comment">   !&lt; diagonal in the A matrix</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: au<span class="comment">    !&lt; upper term in the A matrix</span></div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: al<span class="comment">    !&lt; lower term in the A matrix</span></div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: r<span class="comment">     !&lt; right-hand side term</span></div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ielastic</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzini</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;<span class="keywordtype">    real</span>(DP) :: c</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;<span class="keywordtype">    real</span>(DP) :: c2</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;<span class="keywordtype">    real</span>(DP) :: c3</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;<span class="keywordtype">    real</span>(DP) :: wcf</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;<span class="keywordtype">    real</span>(DP) :: smult</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;<span class="keywordtype">    real</span>(DP) :: sske</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;<span class="keywordtype">    real</span>(DP) :: ssk</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;<span class="keywordtype">    real</span>(DP) :: z</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;<span class="keywordtype">    real</span>(DP) :: ztop</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;<span class="keywordtype">    real</span>(DP) :: zbot</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz0</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta0</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn0</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;<span class="keywordtype">    real</span>(DP) :: gs</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;<span class="keywordtype">    real</span>(DP) :: h0</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;    <span class="comment">! -- initialize accumulators</span></div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;    aii = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;    au = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;    al = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;    r = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;    ielastic = this%ielastic(ib)</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;    dzini = this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;    dzhalf = dhalf*dzini</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;    tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;    c = this%kv(ib)/dzini</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;    c2 = dtwo*c</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;    c3 = dthree*c</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;    <span class="comment">! -- add qdb terms</span></div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;    aii = aii - c2</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;    <span class="comment">! -- top or bottom cell</span></div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;    <span class="keywordflow">if</span> (n == 1 .or. n == this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;      aii = aii - c</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;      r = r - c2*hcell</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;    <span class="comment">! -- lower qdb term</span></div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;    <span class="keywordflow">if</span> (n &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;      al = c</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;    <span class="comment">! -- upper qdb term</span></div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;    <span class="keywordflow">if</span> (n &lt; this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;      au = c</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;    <span class="comment">! -- current and previous delay cell states</span></div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;    z = this%dbz(n, idelay)</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;    ztop = z + dzhalf</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;    zbot = z - dzhalf</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;    h = this%dbh(n, idelay)</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;    h0 = this%dbh0(n, idelay)</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;    dz = this%dbdz(n, idelay)</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;    dz0 = this%dbdz0(n, idelay)</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;    theta = this%dbtheta(n, idelay)</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;    theta0 = this%dbtheta0(n, idelay)</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;    <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;    hbar = squadratic0sp(h, zbot, this%satomega)</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;    <span class="comment">! -- calculate saturation</span></div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;    <span class="keyword">call </span>this%csub_delay_calc_sat(node, idelay, n, h, h0, dsn, dsn0)</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;    <span class="comment">! -- calculate ssk and sske</span></div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;    <span class="keyword">call </span>this%csub_delay_calc_ssksske(ib, n, hcell, ssk, sske)</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;    <span class="comment">! -- calculate and add storage terms</span></div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;    smult = dzini*tled</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;    gs = this%dbgeo(n, idelay)</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;    es0 = this%dbes0(n, idelay)</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;    pcs = this%dbpcs(n, idelay)</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;    aii = aii - smult*dsn*ssk</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;    <span class="keywordflow">if</span> (ielastic /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;      r = r - smult* &amp;</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;          (dsn*ssk*(gs + zbot) - dsn0*sske*es0)</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;      r = r - smult* &amp;</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;          (dsn*ssk*(gs + zbot - pcs) + dsn0*sske*(pcs - es0))</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;    <span class="comment">! -- add storage correction term</span></div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;    r = r + smult*dsn*ssk*(h - hbar)</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;    <span class="comment">! -- add water compressibility terms</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;    wcf = this%brg*tled</div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;    wc = dz*wcf*theta</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;    wc0 = dz0*wcf*theta0</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;    aii = aii - dsn*wc</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;    r = r - dsn0*wc0*h0</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a98d62a1ef47868303e6063594743f7d6_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a98d62a1ef47868303e6063594743f7d6_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a98d62a1ef47868303e6063594743f7d6_cgraph" id="namespacegwfcsubmodule_a98d62a1ef47868303e6063594743f7d6_cgraph">
<area shape="rect" title="Assemble delay interbed standard formulation coefficients." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="a0d39881d356523dd2fbf75afd55a6044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d39881d356523dd2fbf75afd55a6044">&#9670;&nbsp;</a></span>csub_delay_assemble_fn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_assemble_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>aii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>au</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>al</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to assemble Newton-Raphson formulation matrix and right-hand side coefficients for a delay interbed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>delay interbed cell number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aii</td><td>diagonal in the A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">au</td><td>upper term in the A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">al</td><td>lower term in the A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>right-hand side term </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06532">6532</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">    !&lt; interbed number</span></div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">     !&lt; delay interbed cell number</span></div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">     !&lt; current head in a cell</span></div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: aii<span class="comment">    !&lt; diagonal in the A matrix</span></div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: au<span class="comment">     !&lt; upper term in the A matrix</span></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: al<span class="comment">     !&lt; lower term in the A matrix</span></div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: r<span class="comment">      !&lt; right-hand side term</span></div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ielastic</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzini</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;<span class="keywordtype">    real</span>(DP) :: c</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;<span class="keywordtype">    real</span>(DP) :: c2</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;<span class="keywordtype">    real</span>(DP) :: c3</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;<span class="keywordtype">    real</span>(DP) :: wcf</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;<span class="keywordtype">    real</span>(DP) :: smult</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;<span class="keywordtype">    real</span>(DP) :: sske</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;<span class="keywordtype">    real</span>(DP) :: ssk</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;<span class="keywordtype">    real</span>(DP) :: z</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;<span class="keywordtype">    real</span>(DP) :: ztop</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;<span class="keywordtype">    real</span>(DP) :: zbot</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz0</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta0</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn0</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsnderv</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;<span class="keywordtype">    real</span>(DP) :: h0</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbarderv</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;<span class="keywordtype">    real</span>(DP) :: gs</div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;<span class="keywordtype">    real</span>(DP) :: qsto</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;<span class="keywordtype">    real</span>(DP) :: stoderv</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;<span class="keywordtype">    real</span>(DP) :: qwc</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;<span class="keywordtype">    real</span>(DP) :: wcderv</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;    <span class="comment">! -- initialize accumulators</span></div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;    aii = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;    au = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;    al = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;    r = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;    ielastic = this%ielastic(ib)</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;    dzini = this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;    dzhalf = dhalf*dzini</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;    tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;    c = this%kv(ib)/dzini</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;    c2 = dtwo*c</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;    c3 = dthree*c</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;    <span class="comment">! -- add qdb terms</span></div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;    aii = aii - c2</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;    <span class="comment">! -- top or bottom cell</span></div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;    <span class="keywordflow">if</span> (n == 1 .or. n == this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;      aii = aii - c</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;      r = r - c2*hcell</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;    <span class="comment">! -- lower qdb term</span></div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;    <span class="keywordflow">if</span> (n &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;      al = c</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;    <span class="comment">! -- upper qdb term</span></div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;    <span class="keywordflow">if</span> (n &lt; this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;      au = c</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;    <span class="comment">! -- current and previous delay cell states</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;    z = this%dbz(n, idelay)</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;    ztop = z + dzhalf</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;    zbot = z - dzhalf</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;    h = this%dbh(n, idelay)</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;    h0 = this%dbh0(n, idelay)</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;    dz = this%dbdz(n, idelay)</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;    dz0 = this%dbdz0(n, idelay)</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;    theta = this%dbtheta(n, idelay)</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;    theta0 = this%dbtheta0(n, idelay)</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;    <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;    hbar = squadratic0sp(h, zbot, this%satomega)</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;    <span class="comment">! -- calculate the derivative of the hbar functions</span></div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;    hbarderv = squadratic0spderivative(h, zbot, this%satomega)</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;    <span class="comment">! -- calculate saturation</span></div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;    <span class="keyword">call </span>this%csub_delay_calc_sat(node, idelay, n, h, h0, dsn, dsn0)</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;    <span class="comment">! -- calculate the derivative of the saturation</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;    dsnderv = this%csub_delay_calc_sat_derivative(node, idelay, n, hcell)</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;    <span class="comment">! -- calculate ssk and sske</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;    <span class="keyword">call </span>this%csub_delay_calc_ssksske(ib, n, hcell, ssk, sske)</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;    <span class="comment">! -- calculate storage terms</span></div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;    smult = dzini*tled</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;    gs = this%dbgeo(n, idelay)</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;    es0 = this%dbes0(n, idelay)</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;    pcs = this%dbpcs(n, idelay)</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;    <span class="keywordflow">if</span> (ielastic /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;      qsto = smult*(dsn*ssk*(gs - hbar + zbot) - dsn0*sske*es0)</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;      stoderv = -smult*dsn*ssk*hbarderv + &amp;</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;                smult*ssk*(gs - hbar + zbot)*dsnderv</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;      qsto = smult*(dsn*ssk*(gs - hbar + zbot - pcs) + &amp;</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;                    dsn0*sske*(pcs - es0))</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;      stoderv = -smult*dsn*ssk*hbarderv + &amp;</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;                smult*ssk*(gs - hbar + zbot - pcs)*dsnderv</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;    <span class="comment">! -- Add additional term if using lagged effective stress</span></div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;      <span class="keywordflow">if</span> (ielastic /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;        stoderv = stoderv - smult*sske*es0*dsnderv</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;        stoderv = stoderv + smult*sske*(pcs - es0)*dsnderv</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;    <span class="comment">! -- add newton-raphson storage terms</span></div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;    aii = aii + stoderv</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;    r = r - qsto + stoderv*h</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;    <span class="comment">! -- add water compressibility terms</span></div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;    wcf = this%brg*tled</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;    wc = dz*wcf*theta</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;    wc0 = dz0*wcf*theta0</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;    qwc = dsn0*wc0*h0 - dsn*wc*h</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;    wcderv = -dsn*wc - wc*h*dsnderv</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;    <span class="comment">! -- Add additional term if using lagged effective stress</span></div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;      wcderv = wcderv + wc0*h0*dsnderv</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;    <span class="comment">! -- add newton-raphson water compressibility terms</span></div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;    aii = aii + wcderv</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;    r = r - qwc + wcderv*h</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a0d39881d356523dd2fbf75afd55a6044_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a0d39881d356523dd2fbf75afd55a6044_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a0d39881d356523dd2fbf75afd55a6044_cgraph" id="namespacegwfcsubmodule_a0d39881d356523dd2fbf75afd55a6044_cgraph">
<area shape="rect" title="Assemble delay interbed Newton&#45;Raphson formulation coefficients." alt="" coords="5,23,168,65"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="249,5,488,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#ab9fb2d1fba4997a52d022c47f60e57a6" title=" " alt="" coords="216,56,521,83"/>
</map>
</div>

</div>
</div>
<a id="a6c596b6b35956f54815556b283a493c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c596b6b35956f54815556b283a493c6">&#9670;&nbsp;</a></span>csub_delay_calc_comp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_calc_comp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>compi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>compe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate the compaction in a delay interbed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp</td><td>compaction in delay interbed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">compi</td><td>inelastic compaction in delay interbed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">compe</td><td>elastic compaction in delay interbed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp</td><td>compaction in delay interbed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">compi</td><td>inelastic compaction in delay interbed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">compe</td><td>elastic compaction in delay interbed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06965">6965</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">    !&lt; interbed number</span></div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">     !&lt; current head in cell</span></div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">  !&lt; previous head in cell</span></div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: comp<span class="comment">   !&lt; compaction in delay interbed</span></div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: compi<span class="comment">  !&lt; inelastic compaction in delay interbed</span></div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: compe<span class="comment">  !&lt; elastic compaction in delay interbed</span></div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ielastic</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;<span class="keywordtype">    real</span>(DP) :: sske</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;<span class="keywordtype">    real</span>(DP) :: ssk</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;<span class="keywordtype">    real</span>(DP) :: fmult</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;<span class="keywordtype">    real</span>(DP) :: h0</div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn</div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn0</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;<span class="keywordtype">    real</span>(DP) :: v</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;<span class="keywordtype">    real</span>(DP) :: v1</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;<span class="keywordtype">    real</span>(DP) :: v2</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;    ielastic = this%ielastic(ib)</div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;    comp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;    compi = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;    compe = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;    <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;    <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;    <span class="comment">! -- calculate compaction</span></div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;    <span class="keywordflow">if</span> (this%thickini(ib) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;      fmult = this%dbdzini(1, idelay)</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;      <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;        h = this%dbh(n, idelay)</div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;        h0 = this%dbh0(n, idelay)</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_sat(node, idelay, n, h, h0, dsn, dsn0)</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_ssksske(ib, n, hcell, ssk, sske)</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;        <span class="keywordflow">if</span> (ielastic /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;          v1 = dsn*ssk*this%dbes(n, idelay) - sske*this%dbes0(n, idelay)</div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;          v2 = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;          v1 = dsn*ssk*(this%dbes(n, idelay) - this%dbpcs(n, idelay))</div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;          v2 = dsn0*sske*(this%dbpcs(n, idelay) - this%dbes0(n, idelay))</div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;        v = (v1 + v2)*fmult</div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;        comp = comp + v</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;        <span class="comment">! -- save compaction data</span></div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;        this%dbcomp(n, idelay) = v*snnew</div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;        <span class="comment">! -- calculate inelastic and elastic storage components</span></div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;        <span class="keywordflow">if</span> (this%idbconvert(n, idelay) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;          compi = compi + v1*fmult</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;          compe = compe + v2*fmult</div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;          compe = compe + (v1 + v2)*fmult</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;    <span class="comment">! -- fill compaction</span></div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;    comp = comp*this%rnb(ib)</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;    compi = compi*this%rnb(ib)</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;    compe = compe*this%rnb(ib)</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3d763ef89cbcd53e10ec9d386760034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3d763ef89cbcd53e10ec9d386760034">&#9670;&nbsp;</a></span>csub_delay_calc_dstor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_calc_dstor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>stoe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>stoi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the storage change in a delay interbed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stoe</td><td>current elastic storage change in delay interbed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stoi</td><td>current inelastic storage changes in delay interbed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stoe</td><td>elastic storage change </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stoi</td><td>inelastic storage change </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06821">6821</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">     !&lt; interbed number</span></div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">      !&lt; current head in cell</span></div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: stoe<span class="comment">    !&lt; elastic storage change</span></div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: stoi<span class="comment">    !&lt; inelastic storage change</span></div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ielastic</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;<span class="keywordtype">    real</span>(DP) :: sske</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;<span class="keywordtype">    real</span>(DP) :: ssk</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;<span class="keywordtype">    real</span>(DP) :: fmult</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;<span class="keywordtype">    real</span>(DP) :: v1</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;<span class="keywordtype">    real</span>(DP) :: v2</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;<span class="keywordtype">    real</span>(DP) :: ske</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;<span class="keywordtype">    real</span>(DP) :: sk</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;<span class="keywordtype">    real</span>(DP) :: z</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;<span class="keywordtype">    real</span>(DP) :: zbot</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;<span class="keywordtype">    real</span>(DP) :: h0</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn0</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;    ielastic = this%ielastic(ib)</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;    stoe = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;    stoi = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;    ske = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;    sk = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;    <span class="keywordflow">if</span> (this%thickini(ib) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;      fmult = this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;      dzhalf = dhalf*this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;      <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_ssksske(ib, n, hcell, ssk, sske)</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;        z = this%dbz(n, idelay)</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;        zbot = z - dzhalf</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;        h = this%dbh(n, idelay)</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;        h0 = this%dbh0(n, idelay)</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_sat(node, idelay, n, h, h0, dsn, dsn0)</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;        hbar = squadratic0sp(h, zbot, this%satomega)</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;        <span class="keywordflow">if</span> (ielastic /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;          v1 = dsn*ssk*(this%dbgeo(n, idelay) - hbar + zbot) - &amp;</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;               dsn0*sske*this%dbes0(n, idelay)</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;          v2 = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;          v1 = dsn*ssk*(this%dbgeo(n, idelay) - hbar + zbot - &amp;</div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;                        this%dbpcs(n, idelay))</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;          v2 = dsn0*sske*(this%dbpcs(n, idelay) - this%dbes0(n, idelay))</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;        <span class="comment">! -- calculate inelastic and elastic storage components</span></div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;        <span class="keywordflow">if</span> (this%idbconvert(n, idelay) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;          stoi = stoi + v1*fmult</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;          stoe = stoe + v2*fmult</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;          stoe = stoe + (v1 + v2)*fmult</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;        <span class="comment">! calculate inelastic and elastic storativity</span></div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;        ske = ske + sske*fmult</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;        sk = sk + ssk*fmult</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;    <span class="comment">! -- save ske and sk</span></div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;    this%ske(ib) = ske</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;    this%sk(ib) = sk</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_af3d763ef89cbcd53e10ec9d386760034_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_af3d763ef89cbcd53e10ec9d386760034_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_af3d763ef89cbcd53e10ec9d386760034_cgraph" id="namespacegwfcsubmodule_af3d763ef89cbcd53e10ec9d386760034_cgraph">
<area shape="rect" title="Calculate delay interbed storage change." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="a5de9b5ce7587d84c51e385122b456777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5de9b5ce7587d84c51e385122b456777">&#9670;&nbsp;</a></span>csub_delay_calc_sat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_calc_sat </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idelay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>snnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>snold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the saturation in a delay interbed cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snnew</td><td>current saturation in delay interbed cell n </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snold</td><td>previous saturation in delay interbed cell n </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idelay</td><td>delay interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>delay interbed cell number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in delay interbed cell n </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in delay interbed cell n </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snnew</td><td>current saturation in delay interbed cell n </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snold</td><td>previous saturation in delay interbed cell n </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06745">6745</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">     !&lt; cell node number</span></div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idelay<span class="comment">   !&lt; delay interbed number</span></div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">        !&lt; delay interbed cell number</span></div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">        !&lt; current head in delay interbed cell n</span></div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">     !&lt; previous head in delay interbed cell n</span></div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: snnew<span class="comment">     !&lt; current saturation in delay interbed cell n</span></div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: snold<span class="comment">     !&lt; previous saturation in delay interbed cell n</span></div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;    <span class="comment">! -- calculate delay interbed cell saturation</span></div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;    <span class="keywordflow">if</span> (this%stoiconv(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;      dzhalf = dhalf*this%dbdzini(n, idelay)</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;      top = this%dbz(n, idelay) + dzhalf</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;      bot = this%dbz(n, idelay) - dzhalf</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;      snnew = squadraticsaturation(top, bot, hcell, this%satomega)</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;      snold = squadraticsaturation(top, bot, hcellold, this%satomega)</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;      snnew = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;      snold = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;      snold = snnew</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a5de9b5ce7587d84c51e385122b456777_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a5de9b5ce7587d84c51e385122b456777_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a5de9b5ce7587d84c51e385122b456777_cgraph" id="namespacegwfcsubmodule_a5de9b5ce7587d84c51e385122b456777_cgraph">
<area shape="rect" title="Calculate delay interbed saturation." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#a4be083cd9964c682d55802ff9bc436bc" title=" " alt="" coords="216,13,499,39"/>
</map>
</div>

</div>
</div>
<a id="ab108c26f37ea97eda24bb4305f7cd17e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab108c26f37ea97eda24bb4305f7cd17e">&#9670;&nbsp;</a></span>csub_delay_calc_sat_derivative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfcsubmodule::csub_delay_calc_sat_derivative </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idelay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the derivative of the saturation with respect to the current head in delay interbed cell n.</p>
<dl class="section return"><dt>Returns</dt><dd>satderv derivative of saturation </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idelay</td><td>delay interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>delay interbed cell number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in delay interbed cell n </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06787">6787</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">     !&lt; cell node number</span></div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idelay<span class="comment">   !&lt; delay interbed number</span></div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">        !&lt; delay interbed cell number</span></div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">        !&lt; current head in delay interbed cell n</span></div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;<span class="keywordtype">    real</span>(DP) :: satderv</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;    <span class="keywordflow">if</span> (this%stoiconv(node) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;      dzhalf = dhalf*this%dbdzini(n, idelay)</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;      top = this%dbz(n, idelay) + dzhalf</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;      bot = this%dbz(n, idelay) - dzhalf</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;      satderv = <a class="code" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c">squadraticsaturationderivative</a>(top, bot, hcell, this%satomega)</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;      satderv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_ab108c26f37ea97eda24bb4305f7cd17e_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_ab108c26f37ea97eda24bb4305f7cd17e_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_ab108c26f37ea97eda24bb4305f7cd17e_cgraph" id="namespacegwfcsubmodule_ab108c26f37ea97eda24bb4305f7cd17e_cgraph">
<area shape="rect" title="Calculate the delay interbed cell saturation derivative." alt="" coords="5,5,204,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c" title=" " alt="" coords="252,13,600,39"/>
</map>
</div>

</div>
</div>
<a id="a3dbd720cd8f56b3b389a1742acca0a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dbd720cd8f56b3b389a1742acca0a4c">&#9670;&nbsp;</a></span>csub_delay_calc_ssksske()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_calc_ssksske </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>ssk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>sske</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the ssk and sske value for a node in a delay interbed cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ssk</td><td>skeletal specific storage value dependent on the preconsolidation stress </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sske</td><td>elastic skeletal specific storage value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>delay interbed cell number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ssk</td><td>delay interbed skeletal specific storage </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sske</td><td>delay interbed elastic skeletal specific storage </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06252">6252</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">   !&lt; interbed number</span></div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">    !&lt; delay interbed cell number</span></div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">    !&lt; current head in a cell</span></div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: ssk<span class="comment">   !&lt; delay interbed skeletal specific storage</span></div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: sske<span class="comment">  !&lt; delay interbed elastic skeletal specific storage</span></div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ielastic</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;<span class="keywordtype">    real</span>(DP) :: topcell</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;<span class="keywordtype">    real</span>(DP) :: botcell</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbarcell</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;<span class="keywordtype">    real</span>(DP) :: zcell</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;<span class="keywordtype">    real</span>(DP) :: zcenter</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;<span class="keywordtype">    real</span>(DP) :: znode</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;<span class="keywordtype">    real</span>(DP) :: zbot</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;<span class="keywordtype">    real</span>(DP) :: f0</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    sske = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;    ssk = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;    ielastic = this%ielastic(ib)</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;    <span class="comment">! -- calculate factor for the head-based case</span></div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;    <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;      f = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;      f0 = f</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;      <span class="comment">! -- calculate factor for the effective stress case</span></div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;      theta = this%dbthetaini(n, idelay)</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;      <span class="comment">! -- set top and bottom of layer</span></div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;      topcell = this%dis%top(node)</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;      botcell = this%dis%bot(node)</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;      <span class="comment">! -- calculate corrected head for the cell (hbarcell)</span></div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;      hbarcell = squadratic0sp(hcell, botcell, this%satomega)</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;      <span class="comment">! -- set location of delay node relative to the center</span></div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;      <span class="comment">!    of the cell based on current head</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;      zcell = this%csub_calc_znode(topcell, botcell, hbarcell)</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;      <span class="comment">! -- set variables for delay interbed zcell calulations</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;      zcenter = zcell + this%dbrelz(n, idelay)</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;      dzhalf = dhalf*this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;      top = zcenter + dzhalf</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;      bot = zcenter - dzhalf</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;      h = this%dbh(n, idelay)</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;      <span class="comment">! -- calculate corrected head for the delay interbed cell (hbar)</span></div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;      hbar = squadratic0sp(h, bot, this%satomega)</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;      <span class="comment">! -- calculate the center of the saturated portion of the</span></div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;      <span class="comment">!    delay interbed cell</span></div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;      znode = this%csub_calc_znode(top, bot, hbar)</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;      <span class="comment">! -- set reference point for bottom of delay interbed cell that is used to</span></div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;      <span class="comment">!    scale the effective stress at the bottom of the delay interbed cell</span></div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;      zbot = this%dbz(n, idelay) - dzhalf</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;      <span class="comment">! -- set the effective stress</span></div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;      es = this%dbes(n, idelay)</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;      es0 = this%dbes0(n, idelay)</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;      <span class="comment">! -- calculate the compression index factors for the delay</span></div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;      <span class="comment">!    node relative to the center of the cell based on the</span></div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;      <span class="comment">!    current and previous head</span></div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;      <span class="keyword">call </span>this%csub_calc_sfacts(node, zbot, znode, theta, es, es0, f)</div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;    this%idbconvert(n, idelay) = 0</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;    sske = f*this%rci(ib)</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;    ssk = f*this%rci(ib)</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;    <span class="keywordflow">if</span> (ielastic == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;      <span class="keywordflow">if</span> (this%dbes(n, idelay) &gt; this%dbpcs(n, idelay)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;        this%idbconvert(n, idelay) = 1</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;        ssk = f*this%ci(ib)</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a3dbd720cd8f56b3b389a1742acca0a4c_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a3dbd720cd8f56b3b389a1742acca0a4c_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a3dbd720cd8f56b3b389a1742acca0a4c_cgraph" id="namespacegwfcsubmodule_a3dbd720cd8f56b3b389a1742acca0a4c_cgraph">
<area shape="rect" title="Calculate delay interbed cell storage coefficients." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="a7b3af5c6357365affa1546adad1cc095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3af5c6357365affa1546adad1cc095">&#9670;&nbsp;</a></span>csub_delay_calc_stress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_calc_stress </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the geostatic and effective stress in delay interbed cells using the passed the current head value in a cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06169">6169</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">  !&lt; interbed number</span></div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">   !&lt; current head in a cell</span></div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;<span class="keywordtype">    real</span>(DP) :: sigma</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;<span class="keywordtype">    real</span>(DP) :: topaq</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;<span class="keywordtype">    real</span>(DP) :: botaq</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;<span class="keywordtype">    real</span>(DP) :: sadd</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;<span class="keywordtype">    real</span>(DP) :: sgm</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;<span class="keywordtype">    real</span>(DP) :: sgs</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;<span class="keywordtype">    real</span>(DP) :: z</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;<span class="keywordtype">    real</span>(DP) :: phead</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;    sigma = this%cg_gs(node)</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;    topaq = this%dis%top(node)</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;    botaq = this%dis%bot(node)</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;    dzhalf = dhalf*this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;    top = this%dbz(1, idelay) + dzhalf</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;    <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;    hbar = squadratic0sp(hcell, botaq, this%satomega)</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;    <span class="comment">! -- calculate the geostatic load in the cell at the top of the interbed.</span></div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;    sgm = this%sgm(node)</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;    sgs = this%sgs(node)</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;    <span class="keywordflow">if</span> (hcell &lt; top) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;      sadd = ((top - hbar)*sgm) + ((hbar - botaq)*sgs)</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;      sadd = (top - botaq)*sgs</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;    sigma = sigma - sadd</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;    <span class="comment">! -- calculate geostatic and effective stress for each interbed node.</span></div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;    <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;      h = this%dbh(n, idelay)</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;      <span class="comment">! -- geostatic calculated at the bottom of the delay cell</span></div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;      z = this%dbz(n, idelay)</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;      top = z + dzhalf</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;      bot = z - dzhalf</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;      <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;      hbar = squadratic0sp(h, bot, this%satomega)</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;      <span class="comment">! -- geostatic stress calculation</span></div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;      <span class="keywordflow">if</span> (h &lt; top) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;        sadd = ((top - hbar)*sgm) + ((hbar - bot)*sgs)</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;        sadd = (top - bot)*sgs</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;      sigma = sigma + sadd</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;      phead = hbar - bot</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;      this%dbgeo(n, idelay) = sigma</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;      this%dbes(n, idelay) = sigma - phead</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a7b3af5c6357365affa1546adad1cc095_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a7b3af5c6357365affa1546adad1cc095_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a7b3af5c6357365affa1546adad1cc095_cgraph" id="namespacegwfcsubmodule_a7b3af5c6357365affa1546adad1cc095_cgraph">
<area shape="rect" title="Calculate delay interbed stress values." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="a5b544c7e70fa15d51f64518efff49ccd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b544c7e70fa15d51f64518efff49ccd">&#9670;&nbsp;</a></span>csub_delay_calc_wcomp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_calc_wcomp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>dwc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the change in water compressibility in a delay interbed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dwc</td><td>current water compressibility change in delay interbed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dwc</td><td>water compressibility change </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06909">6909</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">   !&lt; interbed number</span></div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: dwc<span class="comment">   !&lt; water compressibility change</span></div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;<span class="keywordtype">    real</span>(DP) :: h0</div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz0</div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn</div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;<span class="keywordtype">    real</span>(DP) :: dsn0</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;<span class="keywordtype">    real</span>(DP) :: v</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;    dwc = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;    <span class="keywordflow">if</span> (this%thickini(ib) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;      tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;      <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;        h = this%dbh(n, idelay)</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;        h0 = this%dbh0(n, idelay)</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;        dz = this%dbdz(n, idelay)</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;        dz0 = this%dbdz0(n, idelay)</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_sat(node, idelay, n, h, h0, dsn, dsn0)</div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;        wc = dz*this%brg*this%dbtheta(n, idelay)</div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;        wc0 = dz0*this%brg*this%dbtheta0(n, idelay)</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;        v = dsn0*wc0*h0 - dsn*wc*h</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;        dwc = dwc + v*tled</div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dbb0e017f3d64404995ac479d467a92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dbb0e017f3d64404995ac479d467a92">&#9670;&nbsp;</a></span>csub_delay_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the coefficients to calculate the delay interbed contribution to a cell. The product of hcof* h - rhs equals the delay contribution to the cell</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coefficient dependent on current head </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side contributions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>head dependent coefficient </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07131">7131</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">   !&lt; interbed number</span></div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">  !&lt; head dependent coefficient</span></div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">   !&lt; right-hand side</span></div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;<span class="keywordtype">    real</span>(DP) :: c1</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;<span class="keywordtype">    real</span>(DP) :: c2</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;    <span class="keywordflow">if</span> (this%thickini(ib) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;      <span class="comment">! -- calculate terms for gwf matrix</span></div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;      c1 = dtwo*this%kv(ib)/this%dbdzini(1, idelay)</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;      rhs = -c1*this%dbh(1, idelay)</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;      c2 = dtwo* &amp;</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;           this%kv(ib)/this%dbdzini(this%ndelaycells, idelay)</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;      rhs = rhs - c2*this%dbh(this%ndelaycells, idelay)</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;      hcof = c1 + c2</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3a91474ff56376b37f51630c6a94bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3a91474ff56376b37f51630c6a94bf3">&#9670;&nbsp;</a></span>csub_delay_head_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_head_check </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to determine if the delay interbed head in any delay cell in a non-convertible gwf cell is less than the top of each delay interbed cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05814">5814</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">  !&lt; interbed number</span></div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iviolate</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;<span class="keywordtype">    real</span>(DP) :: z</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;<span class="keywordtype">    real</span>(DP) :: h</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;<span class="keywordtype">    real</span>(DP) :: ztop</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;    iviolate = 0</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;    <span class="comment">! -- evaluate every delay cell</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;    idelaycells: <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;      z = this%dbz(n, idelay)</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;      h = this%dbh(n, idelay)</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;      dzhalf = dhalf*this%dbdzini(1, idelay)</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;      <span class="comment">! -- non-convertible cell</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;      <span class="keywordflow">if</span> (this%stoiconv(node) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;        ztop = z + dzhalf</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;        <span class="keywordflow">if</span> (h &lt; ztop) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;          this%idb_nconv_count(1) = this%idb_nconv_count(1) + 1</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;          iviolate = 1</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;      <span class="comment">! -- terminate the loop</span></div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;      <span class="keywordflow">if</span> (iviolate &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;        <span class="keywordflow">exit</span> idelaycells</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;<span class="keywordflow">    end do</span> idelaycells</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36ec51605bc6be2771a65e3e4f1b24fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36ec51605bc6be2771a65e3e4f1b24fd">&#9670;&nbsp;</a></span>csub_delay_init_zcell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_init_zcell </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the initial center of each delay interbed cell, assuming the delay bed head is equal to the top of the delay interbed. The method also calculates the distance of the center of each delay bed cell from the center of the delay interbed (z_offset) that is used to calculate average skeletal specific storage values for a delay interbed centered on the center of the saturated thickness for a cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06108">6108</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">  !&lt; interbed number</span></div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;<span class="keywordtype">    real</span>(DP) :: znode</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzz</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;<span class="keywordtype">    real</span>(DP) :: z</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;<span class="keywordtype">    real</span>(DP) :: zr</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;<span class="keywordtype">    real</span>(DP) :: b</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;<span class="keywordtype">    real</span>(DP) :: dz</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;    b = this%thickini(ib)</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;    top = bot + b</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;    hbar = top</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;    <span class="comment">! -- calculate znode based on assumption that the delay bed bottom</span></div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;    <span class="comment">!    is equal to the cell bottom</span></div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;    znode = this%csub_calc_znode(top, bot, hbar)</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;    dz = dhalf*this%dbdzini(1, idelay)</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;    dzz = dhalf*b</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;    z = znode + dzz</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;    zr = dzz</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    <span class="comment">! -- calculate z and z relative to znode for each delay</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;    <span class="comment">!    interbed node</span></div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;      <span class="comment">! z of node relative to bottom of cell</span></div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;      z = z - dz</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;      this%dbz(n, idelay) = z</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;      z = z - dz</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;      <span class="comment">! z relative to znode</span></div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;      zr = zr - dz</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;      <span class="keywordflow">if</span> (abs(zr) &lt; dz) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;        zr = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;      this%dbrelz(n, idelay) = zr</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;      zr = zr - dz</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4a2c469e98478f9265e269615bc3bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a2c469e98478f9265e269615bc3bed">&#9670;&nbsp;</a></span>csub_delay_sln()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_sln </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate solve the delay interbed continuity equation for a delay interbed. The method encapsulates the non-linear loop and calls the linear solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">update</td><td>optional logical variable indicating if the maximum head change variable in a delay bed should be updated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06011">6011</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">           !&lt; interbed number</span></div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">            !&lt; current head in a cell</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: update<span class="comment">  !&lt; optional logical variable indicating</span></div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;<span class="comment">                                             !! if the maximum head change variable</span></div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;<span class="comment">                                             !! in a delay bed should be updated</span></div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;    <span class="keywordtype">logical</span> :: lupdate</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icnvg</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iter</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;<span class="keywordtype">    real</span>(DP) :: dh</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="keywordtype">    real</span>(DP) :: dhmax</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;<span class="keywordtype">    real</span>(DP) :: dhmax0</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">parameter</span> :: dclose = dhundred*dprec</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(update)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;      lupdate = update</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;      lupdate = .true.</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;    <span class="comment">! -- calculate geostatic and effective stress for each delay bed cell</span></div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;    <span class="keyword">call </span>this%csub_delay_calc_stress(ib, hcell)</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;    <span class="comment">! -- terminate if the aquifer head is below the top of delay interbeds</span></div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;    <span class="comment">! -- solve for delay bed heads</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;    <span class="keywordflow">if</span> (this%thickini(ib) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;      icnvg = 0</div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;      iter = 0</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;        iter = iter + 1</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;        <span class="comment">! -- assemble coefficients</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;        <span class="keyword">call </span>this%csub_delay_assemble(ib, hcell)</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;        <span class="comment">! -- solve for head change in delay interbed cells</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;        <span class="keyword">call </span>csub_delay_solve(this%ndelaycells, &amp;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;                              this%dbal, this%dbad, this%dbau, &amp;</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;                              this%dbrhs, this%dbdh, this%dbaw)</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;        <span class="comment">! -- calculate maximum head change and update delay bed heads</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;        dhmax = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;        <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;          dh = this%dbdh(n) - this%dbh(n, idelay)</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;          <span class="keywordflow">if</span> (abs(dh) &gt; abs(dhmax)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;            dhmax = dh</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;            <span class="keywordflow">if</span> (lupdate) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;              this%dbdhmax(idelay) = dhmax</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;          <span class="comment">! -- update delay bed heads</span></div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;          this%dbh(n, idelay) = this%dbdh(n)</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;        <span class="comment">! -- update delay bed stresses</span></div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_stress(ib, hcell)</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;        <span class="comment">! -- check delay bed convergence</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;        <span class="keywordflow">if</span> (abs(dhmax) &lt; dclose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;          icnvg = 1</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;          <span class="keywordflow">if</span> (abs(dhmax) - abs(dhmax0) &lt; dprec) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;            icnvg = 1</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;        <span class="keywordflow">if</span> (icnvg == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;        dhmax0 = dhmax</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_ad4a2c469e98478f9265e269615bc3bed_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_ad4a2c469e98478f9265e269615bc3bed_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_ad4a2c469e98478f9265e269615bc3bed_cgraph" id="namespacegwfcsubmodule_ad4a2c469e98478f9265e269615bc3bed_cgraph">
<area shape="rect" title="Solve delay interbed continuity equation." alt="" coords="5,57,168,98"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="216,5,400,32"/>
<area shape="rect" href="namespacegwfcsubmodule.html#a3a5310d2e8da71802bc99a1dda4dc2f6" title="Delay interbed linear solution." alt="" coords="227,57,389,98"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="239,123,377,149"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="448,82,616,123"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="448,147,616,189"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="664,60,859,87"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="677,111,845,153"/>
</map>
</div>

</div>
</div>
<a id="a3a5310d2e8da71802bc99a1dda4dc2f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a5310d2e8da71802bc99a1dda4dc2f6">&#9670;&nbsp;</a></span>csub_delay_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_solve </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>tl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>tu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to solve the tridiagonal linear equations for a delay interbed using the Thomas algorithm. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of matrix rows </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tl</td><td>lower matrix terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">td</td><td>diagonal matrix terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>upper matrix terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>right-hand side vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>solution vectot </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w</td><td>work vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l06700">6700</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">                 !&lt; number of matrix rows</span></div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: tl<span class="comment">      !&lt; lower matrix terms</span></div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: td<span class="comment">      !&lt; diagonal matrix terms</span></div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: tu<span class="comment">      !&lt; upper matrix terms</span></div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: b<span class="comment">       !&lt; right-hand side vector</span></div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(inout)</span> :: x<span class="comment">    !&lt; solution vectot</span></div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(inout)</span> :: w<span class="comment">    !&lt; work vector</span></div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;<span class="keywordtype">    real</span>(DP) :: bet</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;<span class="keywordtype">    real</span>(DP) :: beti</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;    w(1) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;    bet = td(1)</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;    beti = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/bet</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;    x(1) = b(1)*beti</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;    <span class="comment">! -- decomposition and forward substitution</span></div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;    <span class="keywordflow">do</span> j = 2, n</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;      w(j) = tu(j - 1)*beti</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;      bet = td(j) - tl(j)*w(j)</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;      beti = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/bet</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;      x(j) = (b(j) - tl(j)*x(j - 1))*beti</div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;    <span class="comment">! -- backsubstitution</span></div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;    <span class="keywordflow">do</span> j = n - 1, 1, -1</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;      x(j) = x(j) - w(j + 1)*x(j + 1)</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a3a5310d2e8da71802bc99a1dda4dc2f6_icgraph.png" border="0" usemap="#namespacegwfcsubmodule_a3a5310d2e8da71802bc99a1dda4dc2f6_icgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a3a5310d2e8da71802bc99a1dda4dc2f6_icgraph" id="namespacegwfcsubmodule_a3a5310d2e8da71802bc99a1dda4dc2f6_icgraph">
<area shape="rect" title="Delay interbed linear solution." alt="" coords="216,5,379,47"/>
<area shape="rect" href="namespacegwfcsubmodule.html#ad4a2c469e98478f9265e269615bc3bed" title="Solve delay interbed continuity equation." alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="a2ff5ca50df375188aae4109b3533447d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ff5ca50df375188aae4109b3533447d">&#9670;&nbsp;</a></span>csub_delay_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_delay_update </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to update the thickness and porosity of each delay interbed cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07048">7048</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">  !&lt; interbed number</span></div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;<span class="keywordtype">    real</span>(DP) :: comp</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthick</div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;<span class="keywordtype">    real</span>(DP) :: wtheta</div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;    comp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;    tthick = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;    wtheta = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;    <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;      <span class="comment">! -- initialize compaction for delay cell</span></div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;      comp = this%dbtcomp(n, idelay) + this%dbcomp(n, idelay)</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;      <span class="comment">! -- scale compaction by rnb to get the compaction for</span></div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;      <span class="comment">!    the interbed system (as opposed to the full system)</span></div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;      comp = comp/this%rnb(ib)</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;      <span class="comment">! -- update thickness and theta</span></div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;      <span class="keywordflow">if</span> (abs(comp) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;        thick = this%dbdzini(n, idelay)</div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;        theta = this%dbthetaini(n, idelay)</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;        <span class="keyword">call </span>this%csub_adj_matprop(comp, thick, theta)</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;        <span class="keywordflow">if</span> (thick &lt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(2(a,i0),a,g0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;            <span class="stringliteral">&#39;Adjusted thickness for delay interbed (&#39;</span>, ib, &amp;</div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;            <span class="stringliteral">&#39;) cell (&#39;</span>, n, <span class="stringliteral">&#39;) is less than or equal to 0 (&#39;</span>, thick, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;        <span class="keywordflow">if</span> (theta &lt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(2(a,i0),a,g0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;            <span class="stringliteral">&#39;Adjusted theta for delay interbed (&#39;</span>, ib, &amp;</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;            <span class="stringliteral">&#39;) cell (&#39;</span>, n, <span class="stringliteral">&#39;is less than or equal to 0 (&#39;</span>, theta, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;        this%dbdz(n, idelay) = thick</div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;        this%dbtheta(n, idelay) = theta</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;        tthick = tthick + thick</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;        wtheta = wtheta + thick*theta</div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;        thick = this%dbdz(n, idelay)</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;        theta = this%dbtheta(n, idelay)</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;        tthick = tthick + thick</div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;        wtheta = wtheta + thick*theta</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;    <span class="comment">! -- calculate thickness weighted theta and save thickness and weighted</span></div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;    <span class="comment">!    theta values for delay interbed</span></div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;    <span class="keywordflow">if</span> (tthick &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;      wtheta = wtheta/tthick</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;      tthick = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;      wtheta = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;    this%thick(ib) = tthick</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;    this%theta(ib) = wtheta</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a2ff5ca50df375188aae4109b3533447d_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a2ff5ca50df375188aae4109b3533447d_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a2ff5ca50df375188aae4109b3533447d_cgraph" id="namespacegwfcsubmodule_a2ff5ca50df375188aae4109b3533447d_cgraph">
<area shape="rect" title="Update delay interbed material properties." alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="216,13,391,39"/>
</map>
</div>

</div>
</div>
<a id="aff7429ef99fb08cfc2407ef45d243600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff7429ef99fb08cfc2407ef45d243600">&#9670;&nbsp;</a></span>csub_df_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_df_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to define the observation types available in the CSUB package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07212">7212</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: indx</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;    <span class="comment">!    for csub observation type.</span></div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;csub&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;    <span class="comment">!    for inelastic-csub observation type.</span></div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;inelastic-csub&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;    <span class="comment">!    for elastic-csub observation type.</span></div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;elastic-csub&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;    <span class="comment">!    for coarse-csub observation type.</span></div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;coarse-csub&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;    <span class="comment">!    for csub-cell observation type.</span></div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;csub-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;    <span class="comment">!    for watercomp-csub observation type.</span></div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;wcomp-csub-cell&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;    <span class="comment">!    for interbed ske observation type.</span></div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;ske&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;    <span class="comment">!    for interbed sk observation type.</span></div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;sk&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;    <span class="comment">!    for ske-cell observation type.</span></div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;ske-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;    <span class="comment">!    for sk-cell observation type.</span></div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;sk-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;    <span class="comment">!    for geostatic-stress-cell observation type.</span></div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;gstress-cell&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;    <span class="comment">!    for effective-stress-cell observation type.</span></div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;estress-cell&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;    <span class="comment">!    for total-compaction observation type.</span></div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;interbed-compaction&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;    <span class="comment">!    for inelastic-compaction observation type.</span></div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;inelastic-compaction&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;    <span class="comment">!    for inelastic-compaction observation type.</span></div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;elastic-compaction&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;    <span class="comment">!    for coarse-compaction observation type.</span></div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;coarse-compaction&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;    <span class="comment">!    for inelastic-compaction-cell observation type.</span></div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;inelastic-compaction-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;    <span class="comment">!    for elastic-compaction-cell observation type.</span></div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;elastic-compaction-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;    <span class="comment">!    for compaction-cell observation type.</span></div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;compaction-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;    <span class="comment">!    for interbed thickness observation type.</span></div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;thickness&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;    <span class="comment">!    for coarse-thickness observation type.</span></div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;coarse-thickness&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;    <span class="comment">!    for thickness-cell observation type.</span></div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;thickness-cell&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;    <span class="comment">!    for interbed theta observation type.</span></div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;theta&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;    <span class="comment">!    for coarse-theta observation type.</span></div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;coarse-theta&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;    <span class="comment">!    for theta-cell observation type.</span></div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;theta-cell&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;    <span class="comment">!    for preconstress-cell observation type.</span></div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;preconstress-cell&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;    <span class="comment">!    for delay-preconstress observation type.</span></div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-preconstress&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;    <span class="comment">!    for delay-head observation type.</span></div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-head&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;    <span class="comment">!    for delay-gstress observation type.</span></div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-gstress&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;    <span class="comment">!    for delay-estress observation type.</span></div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-estress&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;    <span class="comment">!    for delay-compaction observation type.</span></div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-compaction&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;    <span class="comment">!    for delay-thickness observation type.</span></div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-thickness&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;    <span class="comment">!    for delay-theta observation type.</span></div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-theta&#39;</span>, .false., indx)</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;    <span class="comment">!    for delay-flowtop observation type.</span></div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-flowtop&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;    <span class="comment">!    for delay-flowbot observation type.</span></div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;delay-flowbot&#39;</span>, .true., indx)</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; csub_process_obsid</div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_aff7429ef99fb08cfc2407ef45d243600_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_aff7429ef99fb08cfc2407ef45d243600_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_aff7429ef99fb08cfc2407ef45d243600_cgraph" id="namespacegwfcsubmodule_aff7429ef99fb08cfc2407ef45d243600_cgraph">
<area shape="rect" title="Define the observation types available in the package." alt="" coords="5,83,168,124"/>
<area shape="rect" href="namespacegwfcsubmodule.html#ad68ca7f4707c3966465805e2681808ee" title="Process the observation IDs for the package." alt="" coords="216,83,379,124"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a2f708dffa1b89bf951c41031434cc724" title=" " alt="" coords="427,83,631,124"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="679,49,833,91"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title=" " alt="" coords="679,115,833,156"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title=" " alt="" coords="907,5,1062,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1365,71,1533,112"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="897,122,1072,149"/>
<area shape="rect" href="namespacesimmodule.html#a1c78a6fda06b630c738bb654aa6bd816" title=" " alt="" coords="881,173,1088,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="915,223,1054,250"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="1136,136,1304,177"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="1136,216,1304,257"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="1352,143,1547,170"/>
</map>
</div>

</div>
</div>
<a id="a560871903438a5355800128ec18c63c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a560871903438a5355800128ec18c63c8">&#9670;&nbsp;</a></span>csub_fc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>hold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill the coefficient matrix and right-hand side with the CSUB package terms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>outer iteration numbed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hold</td><td>previous heads </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current heads </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>size of the A matrix for the solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amat</td><td>A matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>global index model to solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l02760">2760</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                   !&lt; outer iteration numbed</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: hold<span class="comment">          !&lt; previous heads</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: hnew<span class="comment">          !&lt; current heads</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                  !&lt; size of the A matrix for the solution</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amat<span class="comment">  !&lt; A matrix</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: idxglo<span class="comment">    !&lt; global index model to solution</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: rhs<span class="comment">        !&lt; right-hand side</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcof</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhsterm</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="keywordtype">    real</span>(DP) :: comp</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="comment">! -- update geostatic load calculation</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keyword">call </span>this%csub_cg_calc_stress(this%dis%nodes, hnew)</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="comment">! -- formulate csub terms</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="comment">! -- initialize tled</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="comment">! -- coarse-grained storage</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        idiag = this%dis%con%ia(node)</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        area = this%dis%get_area(node)</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        <span class="comment">! -- skip inactive cells</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) &lt; 1) cycle</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <span class="comment">! -- update coarse-grained material properties</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;          <span class="keywordflow">if</span> (this%ieslag == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            <span class="comment">! -- calculate compaction</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;            <span class="keyword">call </span>this%csub_cg_calc_comp(node, hnew(node), hold(node), comp)</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            this%cg_comp(node) = comp</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            <span class="comment">! -- update coarse-grained thickness and void ratio</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <span class="keyword">call </span>this%csub_cg_update(node)</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        <span class="comment">! -- calculate coarse-grained storage terms</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        <span class="keyword">call </span>this%csub_cg_fc(node, tled, area, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                             hcof, rhsterm)</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        <span class="comment">! -- add coarse-grained storage terms to amat and rhs for coarse-grained storage</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        <span class="comment">! -- calculate coarse-grained water compressibility</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <span class="comment">!    storage terms</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="keywordflow">if</span> (this%brg /= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;          <span class="keyword">call </span>this%csub_cg_wcomp_fc(node, tled, area, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                                     hcof, rhsterm)</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;          <span class="comment">! -- add water compression storage terms to amat and rhs for</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;          <span class="comment">!   coarse-grained storage</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;          amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;          rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      <span class="comment">! -- interbed storage</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      <span class="keywordflow">if</span> (this%ninterbeds /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        <span class="comment">! -- calculate the contribution of interbeds to the</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <span class="comment">!    groundwater flow equation</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;          idelay = this%idelay(ib)</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;          idiag = this%dis%con%ia(node)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;          area = this%dis%get_area(node)</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;          <span class="keyword">call </span>this%csub_interbed_fc(ib, node, area, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                                     hcof, rhsterm)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;          amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;          rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;          <span class="comment">! -- calculate interbed water compressibility terms</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;          <span class="keywordflow">if</span> (this%brg /= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a> .and. idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;            <span class="keyword">call </span>this%csub_nodelay_wcomp_fc(ib, node, tled, area, &amp;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                                            hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                                            hcof, rhsterm)</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            <span class="comment">! -- add water compression storage terms to amat and rhs for interbed</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;            amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;            rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <span class="comment">! -- terminate if errors encountered when updating material properties</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a560871903438a5355800128ec18c63c8_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a560871903438a5355800128ec18c63c8_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a560871903438a5355800128ec18c63c8_cgraph" id="namespacegwfcsubmodule_a560871903438a5355800128ec18c63c8_cgraph">
<area shape="rect" title="@ brief Fill A and r for the package" alt="" coords="5,43,188,69"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="236,17,420,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="259,68,397,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="468,27,636,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="468,93,636,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="684,5,879,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="697,57,865,98"/>
</map>
</div>

</div>
</div>
<a id="a1631b4d58e6f1422074de8de77eb316f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1631b4d58e6f1422074de8de77eb316f">&#9670;&nbsp;</a></span>csub_fn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>hold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill the coefficient matrix and right-hand side with CSUB package with Newton-Raphson terms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amat</td><td>A matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>outer iteration number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hold</td><td>previous heads </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current heads </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>size of the A matrix for the solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amat</td><td>A matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>global index model to solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l02882">2882</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                    !&lt; outer iteration number</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: hold<span class="comment">           !&lt; previous heads</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: hnew<span class="comment">           !&lt; current heads</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                   !&lt; size of the A matrix for the solution</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amat<span class="comment">   !&lt; A matrix</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: idxglo<span class="comment">     !&lt; global index model to solution</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: rhs<span class="comment">         !&lt; right-hand side</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcof</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhsterm</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="comment">! -- formulate csub terms</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;      tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="comment">! -- coarse-grained storage</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;        idiag = this%dis%con%ia(node)</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        area = this%dis%get_area(node)</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;        <span class="comment">! -- skip inactive cells</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) &lt; 1) cycle</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        <span class="comment">! -- calculate coarse-grained storage newton terms</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;        <span class="keyword">call </span>this%csub_cg_fn(node, tled, area, &amp;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                             hnew(node), hcof, rhsterm)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        <span class="comment">! -- add coarse-grained storage newton terms to amat and rhs for</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        <span class="comment">!   coarse-grained storage</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;        rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="comment">! -- calculate coarse-grained water compressibility storage</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <span class="comment">!    newton terms</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="keywordflow">if</span> (this%brg /= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          <span class="keyword">call </span>this%csub_cg_wcomp_fn(node, tled, area, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                                     hcof, rhsterm)</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;          <span class="comment">! -- add water compression storage newton terms to amat and rhs for</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;          <span class="comment">!    coarse-grained storage</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;          amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <span class="comment">! -- interbed storage</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="keywordflow">if</span> (this%ninterbeds /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="comment">! -- calculate the interbed newton terms for the</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;        <span class="comment">!    groundwater flow equation</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;          idelay = this%idelay(ib)</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;          <span class="comment">! -- skip inactive cells</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;          <span class="keywordflow">if</span> (this%ibound(node) &lt; 1) cycle</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;          <span class="comment">! -- calculate interbed newton terms</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;          idiag = this%dis%con%ia(node)</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;          area = this%dis%get_area(node)</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <span class="keyword">call </span>this%csub_interbed_fn(ib, node, hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                                     hcof, rhsterm)</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;          <span class="comment">! -- add interbed newton terms to amat and rhs</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;          amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;          rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;          <span class="comment">! -- calculate interbed water compressibility terms</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;          <span class="keywordflow">if</span> (this%brg /= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a> .and. idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;            <span class="keyword">call </span>this%csub_nodelay_wcomp_fn(ib, node, tled, area, &amp;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                                            hnew(node), hold(node), &amp;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                                            hcof, rhsterm)</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;            <span class="comment">! -- add interbed water compression newton terms to amat and rhs</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            amat(idxglo(idiag)) = amat(idxglo(idiag)) + hcof</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            rhs(node) = rhs(node) + rhsterm</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4ca553966e181a7d0fbd13ff20cebb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4ca553966e181a7d0fbd13ff20cebb2">&#9670;&nbsp;</a></span>csub_fp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_fp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Final processing for the CSUB package. This method generates the final strain tables that are output so that the user can evaluate if calculated strain rates in coarse-grained sediments and interbeds exceed 1 percent. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l01839">1839</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: msg</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordtype">character(len=10)</span> :: ctype</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordtype">character(len=20)</span> :: cellid</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordtype">character(len=10)</span> :: cflag</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexceed</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">parameter</span> :: ncells = 20</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nlen</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipos</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="keywordtype">    real</span>(DP) :: b0</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="keywordtype">    real</span>(DP) :: b1</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="keywordtype">    real</span>(DP) :: strain</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="keywordtype">    real</span>(DP) :: pctcomp</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: imap_sel</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: locs</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: pctcomp_arr</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">! -- initialize locs</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keyword">allocate</span> (locs(this%dis%ndim))</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="comment">! -- calculate and report strain for interbeds</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      nlen = min(ncells, this%ninterbeds)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keyword">allocate</span> (imap_sel(nlen))</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <span class="keyword">allocate</span> (pctcomp_arr(this%ninterbeds))</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      iexceed = 0</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        idelay = this%idelay(ib)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        b0 = this%thickini(ib)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        strain = this%tcomp(ib)/b0</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        pctcomp = dhundred*strain</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        pctcomp_arr(ib) = pctcomp</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="keywordflow">if</span> (pctcomp &gt;= <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;          iexceed = iexceed + 1</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <span class="keyword">call </span>selectn(imap_sel, pctcomp_arr, reverse=.true.)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="comment">! -- summary interbed strain table</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      i0 = max(1, this%ninterbeds - ncells + 1)</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      i1 = this%ninterbeds</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      msg = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keywordflow">if</span> (iexceed /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keyword">write</span> (msg, <span class="stringliteral">&#39;(1x,a,1x,i0,1x,a,1x,i0,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;          <span class="stringliteral">&#39;LARGEST&#39;</span>, (i1 - i0 + 1), <span class="stringliteral">&#39;OF&#39;</span>, this%ninterbeds, &amp;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;          <span class="stringliteral">&#39;INTERBED STRAIN VALUES SHOWN&#39;</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keyword">call </span>sim_message(msg, this%iout, skipbefore=1)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">! -- interbed strain data</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="comment">! -- set title</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        title = trim(adjustl(this%packName))//<span class="stringliteral">&#39; PACKAGE INTERBED STRAIN SUMMARY&#39;</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        ntabrows = nlen</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        ntabcols = 9</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%outputtab, this%packName, title)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keyword">call </span>this%outputtab%table_df(ntabrows, ntabcols, this%iout)</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="comment">! add columns</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        tag = <span class="stringliteral">&#39;INTERBED NUMBER&#39;</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        tag = <span class="stringliteral">&#39;INTERBED TYPE&#39;</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        tag = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tableft)</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        tag = <span class="stringliteral">&#39;INITIAL THICKNESS&#39;</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        tag = <span class="stringliteral">&#39;FINAL THICKNESS&#39;</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        tag = <span class="stringliteral">&#39;TOTAL COMPACTION&#39;</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        tag = <span class="stringliteral">&#39;FINAL STRAIN&#39;</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        tag = <span class="stringliteral">&#39;PERCENT COMPACTION&#39;</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        tag = <span class="stringliteral">&#39;FLAG&#39;</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="comment">! -- write data</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="keywordflow">do</span> i = 1, nlen</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;          ib = imap_sel(i)</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;          idelay = this%idelay(ib)</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;          b0 = this%thickini(ib)</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;          b1 = this%csub_calc_interbed_thickness(ib)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            ctype = <span class="stringliteral">&#39;no-delay&#39;</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            ctype = <span class="stringliteral">&#39;delay&#39;</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            b0 = b0*this%rnb(ib)</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;          strain = this%tcomp(ib)/b0</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;          pctcomp = dhundred*strain</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;          <span class="keywordflow">if</span> (pctcomp &gt;= 5.0_dp) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            cflag = <span class="stringliteral">&#39;**&gt;=5%&#39;</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pctcomp &gt;= <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            cflag = <span class="stringliteral">&#39;*&gt;=1%&#39;</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;            cflag = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;          <span class="comment">! -- fill table line</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(ib)</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(ctype)</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(cellid)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(b0)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(b1)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(this%tcomp(ib))</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(strain)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(pctcomp)</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(cflag)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1X,A,1X,I0,1X,A,1X,I0,1X,A,/1X,A,/1X,A)&#39;</span>) &amp;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;          <span class="stringliteral">&#39;PERCENT COMPACTION IS GREATER THAN OR EQUAL TO 1 PERCENT IN&#39;</span>, &amp;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;          iexceed, <span class="stringliteral">&#39;OF&#39;</span>, this%ninterbeds, <span class="stringliteral">&#39;INTERBED(S).&#39;</span>, &amp;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;          <span class="stringliteral">&#39;USE THE STRAIN_CSV_INTERBED OPTION TO OUTPUT A CSV &#39;</span>// &amp;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;          <span class="stringliteral">&#39;FILE WITH PERCENT COMPACTION &#39;</span>, <span class="stringliteral">&#39;VALUES FOR ALL INTERBEDS.&#39;</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        msg = <span class="stringliteral">&#39;PERCENT COMPACTION WAS LESS THAN 1 PERCENT IN ALL INTERBEDS&#39;</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1X,A)&#39;</span>) trim(adjustl(msg))</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="comment">! -- write csv file</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <span class="keywordflow">if</span> (this%istrainib /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        ntabrows = this%ninterbeds</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        ntabcols = 7</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="keywordflow">if</span> (this%dis%ndim &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;          ntabcols = ntabcols + 1</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        ntabcols = ntabcols + this%dis%ndim</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%outputtab, this%packName, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="keyword">call </span>this%outputtab%table_df(ntabrows, ntabcols, this%istrainib, &amp;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                     lineseparator=.false., separator=<span class="stringliteral">&#39;,&#39;</span>)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="comment">! add columns</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        tag = <span class="stringliteral">&#39;INTERBED_NUMBER&#39;</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        tag = <span class="stringliteral">&#39;INTERBED_TYPE&#39;</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        tag = <span class="stringliteral">&#39;NODE&#39;</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="keywordflow">if</span> (this%dis%ndim == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;          tag = <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;          <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;          tag = <span class="stringliteral">&#39;ICELL2D&#39;</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;          <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          tag = <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;          <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;          tag = <span class="stringliteral">&#39;ROW&#39;</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;          <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;          tag = <span class="stringliteral">&#39;COLUMN&#39;</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;          <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        tag = <span class="stringliteral">&#39;INITIAL_THICKNESS&#39;</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        tag = <span class="stringliteral">&#39;FINAL_THICKNESS&#39;</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        tag = <span class="stringliteral">&#39;TOTAL_COMPACTION&#39;</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        tag = <span class="stringliteral">&#39;TOTAL_STRAIN&#39;</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        tag = <span class="stringliteral">&#39;PERCENT_COMPACTION&#39;</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="comment">! -- write data</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;          idelay = this%idelay(ib)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;          b0 = this%thickini(ib)</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;          b1 = this%csub_calc_interbed_thickness(ib)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;          <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;            ctype = <span class="stringliteral">&#39;no-delay&#39;</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            ctype = <span class="stringliteral">&#39;delay&#39;</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            b0 = b0*this%rnb(ib)</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;          strain = this%tcomp(ib)/b0</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;          pctcomp = dhundred*strain</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;          <span class="keyword">call </span>this%dis%noder_to_array(node, locs)</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;          <span class="comment">! -- fill table line</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(ib)</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(ctype)</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;          <span class="keywordflow">if</span> (this%dis%ndim &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;            <span class="keyword">call </span>this%outputtab%add_term(this%dis%get_nodeuser(node))</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;          <span class="keywordflow">do</span> ipos = 1, this%dis%ndim</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            <span class="keyword">call </span>this%outputtab%add_term(locs(ipos))</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(b0)</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(b1)</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(this%tcomp(ib))</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(strain)</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(pctcomp)</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      <span class="comment">! -- deallocate temporary storage</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keyword">deallocate</span> (imap_sel)</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keyword">deallocate</span> (pctcomp_arr)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">! -- calculate and report strain for coarse-grained materials</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    nlen = min(ncells, this%dis%nodes)</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keyword">allocate</span> (imap_sel(nlen))</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keyword">allocate</span> (pctcomp_arr(this%dis%nodes))</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    iexceed = 0</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      strain = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keywordflow">if</span> (this%cg_thickini(node) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        strain = this%cg_tcomp(node)/this%cg_thickini(node)</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      pctcomp = dhundred*strain</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      pctcomp_arr(node) = pctcomp</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keywordflow">if</span> (pctcomp &gt;= <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        iexceed = iexceed + 1</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keyword">call </span>selectn(imap_sel, pctcomp_arr, reverse=.true.)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="comment">! -- summary coarse-grained strain table</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    i0 = max(1, this%dis%nodes - ncells + 1)</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    i1 = this%dis%nodes</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    msg = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">if</span> (iexceed /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      <span class="keyword">write</span> (msg, <span class="stringliteral">&#39;(a,1x,i0,1x,a,1x,i0,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="stringliteral">&#39;LARGEST &#39;</span>, (i1 - i0 + 1), <span class="stringliteral">&#39;OF&#39;</span>, this%dis%nodes, &amp;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <span class="stringliteral">&#39;CELL COARSE-GRAINED VALUES SHOWN&#39;</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      <span class="keyword">call </span>sim_message(msg, this%iout, skipbefore=1)</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      <span class="comment">! -- set title</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      title = trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;              <span class="stringliteral">&#39; PACKAGE COARSE-GRAINED STRAIN SUMMARY&#39;</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      ntabrows = nlen</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      ntabcols = 7</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%outputtab, this%packName, title)</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      <span class="keyword">call </span>this%outputtab%table_df(ntabrows, ntabcols, this%iout)</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;      <span class="comment">! add columns</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      tag = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tableft)</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      tag = <span class="stringliteral">&#39;INITIAL THICKNESS&#39;</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      tag = <span class="stringliteral">&#39;FINAL THICKNESS&#39;</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      tag = <span class="stringliteral">&#39;TOTAL COMPACTION&#39;</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      tag = <span class="stringliteral">&#39;FINAL STRAIN&#39;</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      tag = <span class="stringliteral">&#39;PERCENT COMPACTION&#39;</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 12, alignment=tabcenter)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      tag = <span class="stringliteral">&#39;FLAG&#39;</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <span class="comment">! -- write data</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keywordflow">do</span> nn = 1, nlen</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        node = imap_sel(nn)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordflow">if</span> (this%cg_thickini(node) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;          strain = this%cg_tcomp(node)/this%cg_thickini(node)</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;          strain = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        pctcomp = dhundred*strain</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <span class="keywordflow">if</span> (pctcomp &gt;= 5.0_dp) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;          cflag = <span class="stringliteral">&#39;**&gt;=5%&#39;</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pctcomp &gt;= <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;          cflag = <span class="stringliteral">&#39;*&gt;=1%&#39;</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;          cflag = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <span class="comment">! -- fill table line</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(cellid)</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(this%cg_thickini(node))</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(this%cg_thick(node))</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(this%cg_tcomp(node))</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(strain)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(pctcomp)</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(cflag)</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1X,A,1X,I0,1X,A,1X,I0,1X,A,/1X,A,/1X,A)&#39;</span>) &amp;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <span class="stringliteral">&#39;COARSE-GRAINED STORAGE PERCENT COMPACTION IS GREATER THAN OR &#39;</span>// &amp;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="stringliteral">&#39;EQUAL TO 1 PERCENT IN&#39;</span>, iexceed, <span class="stringliteral">&#39;OF&#39;</span>, this%dis%nodes, <span class="stringliteral">&#39;CELL(S).&#39;</span>, &amp;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        <span class="stringliteral">&#39;USE THE STRAIN_CSV_COARSE OPTION TO OUTPUT A CSV &#39;</span>// &amp;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        <span class="stringliteral">&#39;FILE WITH PERCENT COMPACTION &#39;</span>, <span class="stringliteral">&#39;VALUES FOR ALL CELLS.&#39;</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      msg = <span class="stringliteral">&#39;COARSE-GRAINED STORAGE PERCENT COMPACTION WAS LESS THAN &#39;</span>// &amp;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            <span class="stringliteral">&#39;1 PERCENT IN ALL CELLS &#39;</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1X,A)&#39;</span>) trim(adjustl(msg))</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">! -- write csv file</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">if</span> (this%istrainsk /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      ntabrows = this%dis%nodes</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      ntabcols = 5</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <span class="keywordflow">if</span> (this%dis%ndim &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        ntabcols = ntabcols + 1</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      ntabcols = ntabcols + this%dis%ndim</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%outputtab, this%packName, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keyword">call </span>this%outputtab%table_df(ntabrows, ntabcols, this%istrainsk, &amp;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                   lineseparator=.false., separator=<span class="stringliteral">&#39;,&#39;</span>)</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="comment">! add columns</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      tag = <span class="stringliteral">&#39;NODE&#39;</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <span class="keywordflow">if</span> (this%dis%ndim == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        tag = <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        tag = <span class="stringliteral">&#39;ICELL2D&#39;</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        tag = <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        tag = <span class="stringliteral">&#39;ROW&#39;</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        tag = <span class="stringliteral">&#39;COLUMN&#39;</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        <span class="keyword">call </span>this%outputtab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      tag = <span class="stringliteral">&#39;INITIAL_THICKNESS&#39;</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      tag = <span class="stringliteral">&#39;FINAL_THICKNESS&#39;</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      tag = <span class="stringliteral">&#39;TOTAL_COMPACTION&#39;</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      tag = <span class="stringliteral">&#39;TOTAL_STRAIN&#39;</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      tag = <span class="stringliteral">&#39;PERCENT_COMPACTION&#39;</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(tag, 20, alignment=tabright)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      <span class="comment">! -- write data</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <span class="keywordflow">if</span> (this%cg_thickini(node) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;          strain = this%cg_tcomp(node)/this%cg_thickini(node)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;          strain = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        pctcomp = dhundred*strain</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_array(node, locs)</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="comment">! -- fill table line</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="keywordflow">if</span> (this%dis%ndim &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(this%dis%get_nodeuser(node))</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="keywordflow">do</span> ipos = 1, this%dis%ndim</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;          <span class="keyword">call </span>this%outputtab%add_term(locs(ipos))</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(this%cg_thickini(node))</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(this%cg_thick(node))</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(this%cg_tcomp(node))</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(strain)</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        <span class="keyword">call </span>this%outputtab%add_term(pctcomp)</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="comment">! -- write a warning message for delay interbeds in non-convertible gwf</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="comment">!    cells that violate minimum head assumptions</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (this%ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      <span class="keywordflow">if</span> (this%idb_nconv_count(2) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keyword">write</span> (warnmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0,1x,a,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;          <span class="stringliteral">&#39;Delay interbed cell heads were less than the top of the interbed&#39;</span>, &amp;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;          <span class="stringliteral">&#39;cell in&#39;</span>, this%idb_nconv_count(2), <span class="stringliteral">&#39;interbed cells in non-convertible&#39;</span>, &amp;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;          <span class="stringliteral">&#39;GWF cells for at least one time step during the simulation.&#39;</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="comment">! -- deallocate temporary storage</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keyword">deallocate</span> (imap_sel)</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="keyword">deallocate</span> (locs)</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keyword">deallocate</span> (pctcomp_arr)</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_ad4ca553966e181a7d0fbd13ff20cebb2_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_ad4ca553966e181a7d0fbd13ff20cebb2_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_ad4ca553966e181a7d0fbd13ff20cebb2_cgraph" id="namespacegwfcsubmodule_ad4ca553966e181a7d0fbd13ff20cebb2_cgraph">
<area shape="rect" title="@ brief Final processing for package" alt="" coords="5,119,188,145"/>
<area shape="rect" href="namespacesortmodule.html#a45570623b0025d95da6c2d816c32af44" title=" " alt="" coords="258,31,409,57"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="249,82,417,123"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title=" " alt="" coords="236,148,431,175"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="251,199,415,225"/>
<area shape="rect" href="namespacesortmodule.html#ad7ae31f19d4fcfcf513ff8f451564259" title=" " alt="" coords="479,5,621,32"/>
<area shape="rect" href="namespacesortmodule.html#a5b63ea70396195fd13413a1c44daf0bc" title=" " alt="" coords="479,56,621,83"/>
</map>
</div>

</div>
</div>
<a id="a291e2e48ad1cadd66cc0e5cb1f70d958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a291e2e48ad1cadd66cc0e5cb1f70d958">&#9670;&nbsp;</a></span>csub_interbed_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_interbed_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the coefficient matrix and right-hand side terms for a interbed in a cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>interbed A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>interbed right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>interbed A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>interbed right-hand side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05137">5137</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">      !&lt; interbed number</span></div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">    !&lt; cell node number</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">        !&lt; horizontal cell area</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">       !&lt; current head in cell</span></div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">    !&lt; previous head in cell</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">     !&lt; interbed A matrix entry</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">      !&lt; interbed right-hand side</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;<span class="keywordtype">    real</span>(DP) :: comp</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;<span class="keywordtype">    real</span>(DP) :: compi</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;<span class="keywordtype">    real</span>(DP) :: compe</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho1</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho2</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;    comp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;    compi = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;    compe = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;    <span class="comment">! -- skip inactive and constant head cells</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    <span class="keywordflow">if</span> (this%ibound(node) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;      <span class="keywordflow">if</span> (this%idelay(ib) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;        <span class="comment">! -- update material properties</span></div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;          <span class="keywordflow">if</span> (this%ieslag == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;            <span class="comment">! -- calculate compaction</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;            <span class="keyword">call </span>this%csub_nodelay_calc_comp(ib, hcell, hcellold, comp, &amp;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                                             rho1, rho2)</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;            this%comp(ib) = comp</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;            <span class="comment">! -- update thickness and void ratio</span></div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;            <span class="keyword">call </span>this%csub_nodelay_update(ib)</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;        <span class="comment">! -- calculate no-delay interbed rho1 and rho2</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;        <span class="keyword">call </span>this%csub_nodelay_fc(ib, hcell, hcellold, rho1, hcof, rhs)</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;        f = area</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;        <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;        <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;        <span class="comment">! -- update material properties</span></div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;          <span class="keywordflow">if</span> (this%ieslag == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;            <span class="comment">! -- calculate compaction</span></div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;            <span class="keyword">call </span>this%csub_delay_calc_comp(ib, hcell, hcellold, &amp;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                                           comp, compi, compe)</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;            this%comp(ib) = comp</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;            <span class="comment">! -- update thickness and void ratio</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;            <span class="keyword">call </span>this%csub_delay_update(ib)</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;        <span class="comment">! -- calculate delay interbed hcof and rhs</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;        <span class="keyword">call </span>this%csub_delay_sln(ib, hcell)</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;        <span class="keyword">call </span>this%csub_delay_fc(ib, hcof, rhs)</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;        f = area*this%rnb(ib)</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      rhs = rhs*f</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;      hcof = -hcof*f</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a99bcf821bdec79c75c9045a455ce9d0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99bcf821bdec79c75c9045a455ce9d0b">&#9670;&nbsp;</a></span>csub_interbed_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_interbed_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the Newton-Raphson formulation coefficient matrix and right-hand side terms for a interbed in a cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>interbed A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>interbed right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in a cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in a cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>interbed A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>interbed right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05226">5226</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">     !&lt; interbed number</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">   !&lt; cell node number</span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">      !&lt; current head in a cell</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">   !&lt; previous head in a cell</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">    !&lt; interbed A matrix entry</span></div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">     !&lt; interbed right-hand side entry</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcofn</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhsn</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;<span class="keywordtype">    real</span>(DP) :: tthk</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;<span class="keywordtype">    real</span>(DP) :: satderv</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbarderv</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho1</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;<span class="keywordtype">    real</span>(DP) :: rho2</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;    rhsn = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;    hcofn = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;    satderv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;    idelay = this%idelay(ib)</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;    <span class="comment">! -- skip inactive and constant head cells</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;    <span class="keywordflow">if</span> (this%ibound(node) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;      tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;      tthk = this%thickini(ib)</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      <span class="comment">! -- no-delay interbeds</span></div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;        <span class="comment">! -- initialize factor</span></div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;        f = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;        <span class="comment">! -- calculate the saturation derivative</span></div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;        satderv = this%csub_calc_sat_derivative(node, hcell)</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;        <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;        <span class="comment">! -- calculate the derivative of the hbar functions</span></div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;        hbarderv = squadratic0spderivative(hcell, bot, this%satomega)</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;        <span class="comment">! -- calculate storage coefficient</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;        <span class="keyword">call </span>this%csub_nodelay_fc(ib, hcell, hcellold, rho1, rho2, rhsn)</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        <span class="comment">! -- calculate hcofn term</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;        hcofn = rho2*(<a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a> - hbarderv)*snnew + &amp;</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;                rho2*(this%cg_gs(node) - hbar + bot)*satderv</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;        <span class="keywordflow">if</span> (this%ielastic(ib) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;          hcofn = hcofn - rho2*this%pcs(ib)*satderv</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;        <span class="comment">! -- Add additional term if using lagged effective stress</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;        <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;          <span class="keywordflow">if</span> (this%ielastic(ib) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;            hcofn = hcofn - rho1*this%cg_es0(node)*satderv</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;            hcofn = hcofn - rho1*(this%pcs(ib) - this%cg_es0(node))*satderv</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a99bcf821bdec79c75c9045a455ce9d0b_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a99bcf821bdec79c75c9045a455ce9d0b_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a99bcf821bdec79c75c9045a455ce9d0b_cgraph" id="namespacegwfcsubmodule_a99bcf821bdec79c75c9045a455ce9d0b_cgraph">
<area shape="rect" title="@ brief Formulate the coefficients for a interbed" alt="" coords="5,23,168,65"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="249,5,488,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#ab9fb2d1fba4997a52d022c47f60e57a6" title=" " alt="" coords="216,56,521,83"/>
</map>
</div>

</div>
</div>
<a id="a85b967992eb3ac29fcaa98cad30d52f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b967992eb3ac29fcaa98cad30d52f8">&#9670;&nbsp;</a></span>csub_nodelay_calc_comp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_nodelay_calc_comp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rho1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rho2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method calculates the compaction for a no-delay interbed. The method also calculates the storage coefficients for the no-delay interbed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp</td><td>no-delay compaction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho1</td><td>no-delay storage value using Sske </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho2</td><td>no-delay storage value using Ssk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head for the cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head for the cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp</td><td>no-delay interbed compaction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho1</td><td>current storage coefficient based on Sske </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho2</td><td>current storage coefficient based on Ssk </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04555">4555</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">         !&lt; interbed number</span></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">          !&lt; current head for the cell</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">       !&lt; previous head for the cell</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: comp<span class="comment">        !&lt; no-delay interbed compaction</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rho1<span class="comment">        !&lt; current storage coefficient based on Sske</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rho2<span class="comment">        !&lt; current storage coefficient based on Ssk</span></div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhs</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;    tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;    es = this%cg_es(node)</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;    es0 = this%cg_es0(node)</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    pcs = this%pcs(ib)</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;    <span class="comment">! -- calculate no-delay interbed rho1 and rho2</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    <span class="keyword">call </span>this%csub_nodelay_fc(ib, hcell, hcellold, rho1, rho2, rhs, argtled=tled)</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;    <span class="comment">! -- calculate no-delay interbed compaction</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;    <span class="keywordflow">if</span> (this%ielastic(ib) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;      comp = rho2*es - rho1*es0</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;      comp = -pcs*(rho2 - rho1) - (rho1*es0) + (rho2*es)</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f3988b40430cbfc8f7f1d2bd41879fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f3988b40430cbfc8f7f1d2bd41879fb">&#9670;&nbsp;</a></span>csub_nodelay_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_nodelay_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rho1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rho2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in), optional&#160;</td>
          <td class="paramname"><em>argtled</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method calculates the skeletal storage coefficients for a no-delay interbed. The method also calculates the contribution of the no-delay interbed to the right-hand side of the groundwater flow equation for the cell.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho1</td><td>no-delay storage value using Sske </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho2</td><td>no-delay storage value using Ssk </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>no-delay right-hand side contribution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in the cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in the cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho1</td><td>current storage coefficient value using Sske </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rho2</td><td>current storage coefficient value based on Ssk </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>no-delay interbed contribution to the right-hand side </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argtled</td><td>optional reciprocal of the time step length </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04444">4444</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">              !&lt; interbed number</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">               !&lt; current head in the cell</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">            !&lt; previous head in the cell</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rho1<span class="comment">             !&lt; current storage coefficient value using Sske</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rho2<span class="comment">             !&lt; current storage coefficient value based on Ssk</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">              !&lt; no-delay interbed contribution to the right-hand side</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: argtled<span class="comment">   !&lt; optional reciprocal of the time step length</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;<span class="keywordtype">    real</span>(DP) :: znode</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;<span class="keywordtype">    real</span>(DP) :: sto_fac</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;<span class="keywordtype">    real</span>(DP) :: sto_fac0</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;<span class="keywordtype">    real</span>(DP) :: es0</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;<span class="keywordtype">    real</span>(DP) :: f0</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;<span class="keywordtype">    real</span>(DP) :: rcorr</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    <span class="comment">! -- process optional variables</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(argtled)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;      tled = argtled</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      tled = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>/<a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    node = this%nodelist(ib)</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;    area = this%dis%get_area(node)</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;    thick = this%thickini(ib)</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;    hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="comment">! -- set iconvert</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    this%iconvert(ib) = 0</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    <span class="comment">! -- aquifer saturation</span></div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;    <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;      f = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;      f0 = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      znode = this%csub_calc_znode(top, bot, hbar)</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      es = this%cg_es(node)</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;      es0 = this%cg_es0(node)</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      theta = this%thetaini(ib)</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;      <span class="comment">! -- calculate the compression index factors for the delay</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;      <span class="comment">!    node relative to the center of the cell based on the</span></div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      <span class="comment">!    current and previous head</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <span class="keyword">call </span>this%csub_calc_sfacts(node, bot, znode, theta, es, es0, f)</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;    sto_fac = tled*snnew*thick*f</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;    sto_fac0 = tled*snold*thick*f</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    <span class="comment">! -- calculate rho1 and rho2</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;    rho1 = this%rci(ib)*sto_fac0</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;    rho2 = this%rci(ib)*sto_fac</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;    <span class="keywordflow">if</span> (this%cg_es(node) &gt; this%pcs(ib)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      this%iconvert(ib) = 1</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      rho2 = this%ci(ib)*sto_fac</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;    <span class="comment">! -- calculate correction term</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    rcorr = rho2*(hcell - hbar)</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;    <span class="comment">! -- fill right-hand side</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    <span class="keywordflow">if</span> (this%ielastic(ib) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      rhs = rho1*this%cg_es0(node) - &amp;</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;            rho2*(this%cg_gs(node) + bot) - &amp;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;            rcorr</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;      rhs = -rho2*(this%cg_gs(node) + bot) + &amp;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;            (this%pcs(ib)*(rho2 - rho1)) + &amp;</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;            (rho1*this%cg_es0(node)) - &amp;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;            rcorr</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    <span class="comment">! -- save ske and sk</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    this%ske(ib) = rho1</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    this%sk(ib) = rho2</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a9f3988b40430cbfc8f7f1d2bd41879fb_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a9f3988b40430cbfc8f7f1d2bd41879fb_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a9f3988b40430cbfc8f7f1d2bd41879fb_cgraph" id="namespacegwfcsubmodule_a9f3988b40430cbfc8f7f1d2bd41879fb_cgraph">
<area shape="rect" title="@ brief Calculate no&#45;delay interbed storage coefficients" alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,13,455,39"/>
</map>
</div>

</div>
</div>
<a id="a37765e933144faa55b0b8017316dd90c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37765e933144faa55b0b8017316dd90c">&#9670;&nbsp;</a></span>csub_nodelay_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_nodelay_update </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method updates no-delay material properties based on the current compaction value. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04396">4396</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: i</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;<span class="keywordtype">    real</span>(DP) :: comp</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="keywordtype">    real</span>(DP) :: thick</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;<span class="keywordtype">    real</span>(DP) :: theta</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    <span class="comment">! -- update thickness and theta</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    comp = this%tcomp(i) + this%comp(i)</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;    <span class="keywordflow">if</span> (abs(comp) &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;      thick = this%thickini(i)</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;      theta = this%thetaini(i)</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      <span class="keyword">call </span>this%csub_adj_matprop(comp, thick, theta)</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      <span class="keywordflow">if</span> (thick &lt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,1x,a,g0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;          <span class="stringliteral">&#39;Adjusted thickness for no-delay interbed&#39;</span>, i, &amp;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;          <span class="stringliteral">&#39;is less than or equal to 0 (&#39;</span>, thick, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      <span class="keywordflow">if</span> (theta &lt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,1x,a,g0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;          <span class="stringliteral">&#39;Adjusted theta for no-delay interbed&#39;</span>, i, &amp;</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;          <span class="stringliteral">&#39;is less than or equal to 0 (&#39;</span>, theta, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      this%thick(i) = thick</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;      this%theta(i) = theta</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a37765e933144faa55b0b8017316dd90c_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a37765e933144faa55b0b8017316dd90c_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a37765e933144faa55b0b8017316dd90c_cgraph" id="namespacegwfcsubmodule_a37765e933144faa55b0b8017316dd90c_cgraph">
<area shape="rect" title="@ brief Update no&#45;delay material properties" alt="" coords="5,5,168,47"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="216,13,391,39"/>
</map>
</div>

</div>
</div>
<a id="a10a63339c738dcc0d9e6f2668e547e61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10a63339c738dcc0d9e6f2668e547e61">&#9670;&nbsp;</a></span>csub_nodelay_wcomp_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_nodelay_wcomp_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the standard formulation coefficient matrix and right-hand side terms for water compressibility in no-delay interbeds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>no-delay A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>no-delay right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>reciprocal of time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>no-delay A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>no-delay right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05581">5581</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">       !&lt; interbed number</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">     !&lt; cell node number</span></div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">         !&lt; reciprocal of time step length</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">         !&lt; horizontal cell area</span></div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">        !&lt; current head in cell</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">     !&lt; previous head in cell</span></div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">      !&lt; no-delay A matrix entry</span></div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">       !&lt; no-delay right-hand side entry</span></div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;<span class="keywordtype">    real</span>(DP) :: snold</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;<span class="keywordtype">    real</span>(DP) :: snnew</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    <span class="comment">! -- aquifer elevations and thickness</span></div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;    <span class="comment">! -- calculate cell saturation</span></div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;    <span class="keyword">call </span>this%csub_calc_sat(node, hcell, hcellold, snnew, snold)</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;    f = this%brg*area*tled</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;    wc0 = f*this%theta0(ib)*this%thick0(ib)</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;    wc = f*this%theta(ib)*this%thick(ib)</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;    hcof = -wc*snnew</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;    rhs = -wc0*snold*hcellold</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a038950db763e2c4ca76e07b99932bc5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a038950db763e2c4ca76e07b99932bc5d">&#9670;&nbsp;</a></span>csub_nodelay_wcomp_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_nodelay_wcomp_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hcellold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method formulates the Newton-Raphson formulation coefficient matrix and right-hand side terms for water compressibility in no-delay interbeds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>no-delay A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>no-delay right-hand side entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>interbed number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>cell node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>reciprocal of time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>horizontal cell area </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcell</td><td>current head in cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hcellold</td><td>previous head in cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>no-delay A matrix entry </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>no-delay right-hand side entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l05634">5634</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ib<span class="comment">      !&lt; interbed number</span></div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">    !&lt; cell node number</span></div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">        !&lt; reciprocal of time step length</span></div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: area<span class="comment">        !&lt; horizontal cell area</span></div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcell<span class="comment">       !&lt; current head in cell</span></div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: hcellold<span class="comment">    !&lt; previous head in cell</span></div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">     !&lt; no-delay A matrix entry</span></div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">      !&lt; no-delay right-hand side entry</span></div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;<span class="keywordtype">    real</span>(DP) :: wc0</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;<span class="keywordtype">    real</span>(DP) :: satderv</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;    rhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;    hcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;    <span class="comment">! -- aquifer elevations and thickness</span></div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;    top = this%dis%top(node)</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;    bot = this%dis%bot(node)</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;    f = this%brg*area*tled</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;    <span class="comment">! -- calculate saturation derivitive</span></div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;    satderv = this%csub_calc_sat_derivative(node, hcell)</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;    <span class="comment">! -- calculate the current water compressibility factor</span></div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;    wc = f*this%theta(ib)*this%thick(ib)</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;    <span class="comment">! -- calculate derivative term</span></div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;    hcof = -wc*hcell*satderv</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    <span class="comment">! -- Add additional term if using lagged effective stress</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;    <span class="keywordflow">if</span> (this%ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;      wc0 = f*this%theta0(ib)*this%thick0(ib)</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;      hcof = hcof + wc0*hcellold*satderv</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    <span class="comment">! -- set rhs</span></div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;    rhs = hcof*hcell</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeae3d4ffc092723193ea954f7a6c1f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae3d4ffc092723193ea954f7a6c1f75">&#9670;&nbsp;</a></span>csub_obs_supported()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function gwfcsubmodule::csub_obs_supported </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to determine if observations are supported by the CSUB package. Observations are supported by the CSUB package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07196">7196</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;    csub_obs_supported = .true.</div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab07d0c233bc82a992e66d3d3136e5818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07d0c233bc82a992e66d3d3136e5818">&#9670;&nbsp;</a></span>csub_ot_dv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_ot_dv </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvprint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method saves cell-by-cell compaction and z-displacement terms. The method also calls the method to process observation output. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idvfl</td><td>flag to save dependent variable data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idvprint</td><td>flag to print dependent variable data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l03639">3639</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this </div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvfl<span class="comment">       !&lt; flag to save dependent variable data</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvprint<span class="comment">    !&lt; flag to print dependent variable data</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    <span class="keywordtype">character(len=1)</span> :: cdatafmp = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;    <span class="keywordtype">character(len=1)</span> :: editdesc = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iprint</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nvaluesp</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nwidthp</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodem</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodeu</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: k</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ncpl</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nlay</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;<span class="keywordtype">    real</span>(DP) :: dinact</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtnconv = &amp;</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    <span class="stringliteral">&quot;(/4x, &#39;DELAY INTERBED CELL HEADS IN &#39;, i0, &#39; INTERBEDS IN&#39;,               &amp;</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="stringliteral"></span><span class="stringliteral">    &amp;&#39; NON-CONVERTIBLE GWF CELLS WERE LESS THAN THE TOP OF THE INTERBED CELL&#39;)&quot;</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    <span class="comment">! -- Save compaction results</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;    <span class="comment">! -- Set unit number for binary compaction and z-displacement output</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    <span class="keywordflow">if</span> (this%ioutcomp /= 0 .or. this%ioutzdisp /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      ibinun = 1</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;    <span class="comment">! -- save compaction results</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;      <span class="comment">! -- fill buff with total compaction</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;        this%buff(node) = this%cg_tcomp(node)</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;        this%buff(node) = this%buff(node) + this%tcomp(ib)</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <span class="comment">! -- write compaction data to binary file</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      <span class="keywordflow">if</span> (this%ioutcomp /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;        ibinun = this%ioutcomp</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;        <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                                   comptxt(1), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                                   nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;      <span class="comment">! -- calculate z-displacement (subsidence) and write data to binary file</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <span class="keywordflow">if</span> (this%ioutzdisp /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;        ibinun = this%ioutzdisp</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;        <span class="comment">! -- initialize buffusr</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;        <span class="keywordflow">do</span> nodeu = 1, this%dis%nodesuser</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;          this%buffusr(nodeu) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        <span class="comment">! -- fill buffusr with buff</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;          nodeu = this%dis%get_nodeuser(node)</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;          this%buffusr(nodeu) = this%buff(node)</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        <span class="comment">! -- calculate z-displacement</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;        ncpl = this%dis%get_ncpl()</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        <span class="comment">! -- disu</span></div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        <span class="keywordflow">if</span> (this%dis%ndim == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;          <span class="comment">! TO DO -</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;          <span class="comment">! -- disv or dis</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;          nlay = this%dis%nodesuser/ncpl</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;          <span class="keywordflow">do</span> k = nlay - 1, 1, -1</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;            <span class="keywordflow">do</span> i = 1, ncpl</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;              node = (k - 1)*ncpl + i</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;              nodem = k*ncpl + i</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;              this%buffusr(node) = this%buffusr(node) + this%buffusr(nodem)</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        <span class="comment">! -- fill buff with data from buffusr</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        <span class="keywordflow">do</span> nodeu = 1, this%dis%nodesuser</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;          node = this%dis%get_nodenumber_idx1(nodeu, 1)</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;          <span class="keywordflow">if</span> (node /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;            this%buff(node) = this%buffusr(nodeu)</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        <span class="comment">! -- write z-displacement</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                                   comptxt(6), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;                                   nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160; </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    <span class="comment">! -- Set unit number for binary inelastic interbed compaction</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    <span class="keywordflow">if</span> (this%ioutcompi /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;      ibinun = this%ioutcompi</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <span class="comment">! -- save inelastic interbed compaction results</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      <span class="comment">! -- fill buff with inelastic interbed compaction</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;        this%buff(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        this%buff(node) = this%buff(node) + this%tcompi(ib)</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;      <span class="comment">! -- write inelastic interbed compaction data to binary file</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;                                 comptxt(2), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    <span class="comment">! -- Set unit number for binary elastic interbed compaction</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    <span class="keywordflow">if</span> (this%ioutcompe /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      ibinun = this%ioutcompe</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;    <span class="comment">! -- save elastic interbed compaction results</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <span class="comment">! -- fill buff with elastic interbed compaction</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        this%buff(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        this%buff(node) = this%buff(node) + this%tcompe(ib)</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;      <span class="comment">! -- write elastic interbed compaction data to binary file</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                                 comptxt(3), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    <span class="comment">! -- Set unit number for binary interbed compaction</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;    <span class="keywordflow">if</span> (this%ioutcompib /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;      ibinun = this%ioutcompib</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    <span class="comment">! -- save interbed compaction results</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      <span class="comment">! -- fill buff with interbed compaction</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;        this%buff(node) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;        this%buff(node) = this%buff(node) + this%tcompe(ib) + this%tcompi(ib)</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <span class="comment">! -- write interbed compaction data to binary file</span></div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                                 comptxt(4), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    <span class="comment">! -- Set unit number for binary coarse-grained compaction</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;    <span class="keywordflow">if</span> (this%ioutcomps /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      ibinun = this%ioutcomps</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;    <span class="comment">! -- save coarse-grained compaction results</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      <span class="comment">! -- fill buff with coarse-grained compaction</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      <span class="keywordflow">do</span> node = 1, this%dis%nodes</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;        this%buff(node) = this%cg_tcomp(node)</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      <span class="comment">! -- write coarse-grained compaction data to binary file</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%buff, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                                 comptxt(5), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;    <span class="comment">! -- check that final effective stress values for the time step</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    <span class="comment">!    are greater than zero</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      <span class="keyword">call </span>this%csub_cg_chk_stress()</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="comment">! -- update maximum count of delay interbeds that violate</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    <span class="comment">!    basic head assumptions for delay beds and write a message</span></div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    <span class="comment">!    for delay interbeds in non-convertible gwf cells that</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;    <span class="comment">!    violate these head assumptions</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;    <span class="keywordflow">if</span> (this%ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <span class="keywordflow">if</span> (this%idb_nconv_count(1) &gt; this%idb_nconv_count(2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        this%idb_nconv_count(2) = this%idb_nconv_count(1)</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      <span class="keywordflow">if</span> (this%idb_nconv_count(1) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;        <span class="keyword">write</span> (this%iout, fmtnconv) this%idb_nconv_count(1)</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad68ca7f4707c3966465805e2681808ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad68ca7f4707c3966465805e2681808ee">&#9670;&nbsp;</a></span>csub_process_obsid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_process_obsid </td>
          <td>(</td>
          <td class="paramtype">type(observetype), intent(inout)&#160;</td>
          <td class="paramname"><em>obsrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disbasetype), intent(in)&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunitobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to process the observation IDs for the CSUB package. This procedure is pointed to by ObsDataTypeProcesssIdPtr. It processes the ID string of an observation definition for csub-package observations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obsrv</td><td>observation type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dis</td><td>pointer to the model discretization </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunitobs</td><td>unit number of the observation file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>unit number to the model listing file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07795">7795</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;    <span class="keywordtype">type</span>(ObserveType), <span class="keywordtype">intent(inout)</span> :: obsrv<span class="comment">   !&lt; observation type</span></div>
<div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;    <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">intent(in)</span>    :: dis<span class="comment">    !&lt; pointer to the model discretization</span></div>
<div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>    :: inunitobs<span class="comment">    !&lt; unit number of the observation file</span></div>
<div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>    :: iout<span class="comment">         !&lt; unit number to the model listing file</span></div>
<div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nn1</div>
<div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nn2</div>
<div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icol, istart, istop</div>
<div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: strng</div>
<div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bndname</div>
<div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;    <span class="keywordtype">logical</span> :: flag_string</div>
<div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;    <span class="comment">!--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;    strng = obsrv%IDstring</div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;    <span class="comment">! -- Extract reach number from strng and store it.</span></div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;    <span class="comment">!    If 1st item is not an integer(I4B), it should be a</span></div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;    <span class="comment">!    boundary name--deal with it.</span></div>
<div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;    icol = 1</div>
<div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;    <span class="comment">! -- get icsubno number or boundary name</span></div>
<div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;    <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;INELASTIC-CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;ELASTIC-CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;SK&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;SKE&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;THETA&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;THICKNESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;INTERBED-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;INELASTIC-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;ELASTIC-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-HEAD&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-GSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-ESTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-PRECONSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-THICKNESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-THETA&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-FLOWTOP&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;        obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-FLOWBOT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;      <span class="keyword">call </span>extract_idnum_or_bndname(strng, icol, istart, istop, nn1, bndname)</div>
<div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;      nn1 = dis%noder_from_string(icol, istart, istop, inunitobs, &amp;</div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;                                  iout, strng, flag_string)</div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;    <span class="keywordflow">if</span> (nn1 == namedboundflag) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;      obsrv%FeatureName = bndname</div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;      <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-HEAD&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;          obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-GSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;          obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-ESTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;          obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-PRECONSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;          obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;          obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-THICKNESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;          obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-THETA&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;        <span class="keyword">call </span>extract_idnum_or_bndname(strng, icol, istart, istop, nn2, bndname)</div>
<div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;        <span class="keywordflow">if</span> (nn2 == namedboundflag) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;          obsrv%FeatureName = bndname</div>
<div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;          <span class="comment">! -- reset nn1</span></div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;          nn1 = nn2</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;          obsrv%NodeNumber2 = nn2</div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;    <span class="comment">! -- store reach number (NodeNumber)</span></div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;    obsrv%NodeNumber = nn1</div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_cgraph" id="namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_cgraph">
<area shape="rect" title="Process the observation IDs for the package." alt="" coords="5,83,168,124"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a2f708dffa1b89bf951c41031434cc724" title=" " alt="" coords="216,83,420,124"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="468,49,623,91"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title=" " alt="" coords="468,115,623,156"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title=" " alt="" coords="697,5,851,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1155,71,1323,112"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="687,122,861,149"/>
<area shape="rect" href="namespacesimmodule.html#a1c78a6fda06b630c738bb654aa6bd816" title=" " alt="" coords="671,173,877,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="705,223,843,250"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="925,136,1093,177"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="925,216,1093,257"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="1141,143,1336,170"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_icgraph.png" border="0" usemap="#namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_icgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_icgraph" id="namespacegwfcsubmodule_ad68ca7f4707c3966465805e2681808ee_icgraph">
<area shape="rect" title="Process the observation IDs for the package." alt="" coords="216,5,379,47"/>
<area shape="rect" href="namespacegwfcsubmodule.html#aff7429ef99fb08cfc2407ef45d243600" title="Define the observation types available in the package." alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="a0cdaf8fb7dd626c1ec18c122e5a3b661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cdaf8fb7dd626c1ec18c122e5a3b661">&#9670;&nbsp;</a></span>csub_read_dimensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_read_dimensions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the number of interbeds and maximum number of cells with a specified overlying geostatic stress. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l01026">1026</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a>, <a class="code" href="namespaceconstantsmodule.html#aa63ca3273e52df46471c4746566f46bd">lenboundname</a></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacekindmodule.html">kindmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacekindmodule.html#a2f6861418b5e7d3d602b77228232a470">i4b</a></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: keyword</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">! -- initialize dimensions to -1</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    this%ninterbeds = -1</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">! -- get dimensions block</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;DIMENSIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">! -- parse dimensions block if detected</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING &#39;</span>//trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="stringliteral">&#39; DIMENSIONS&#39;</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NINTERBEDS&#39;</span>)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          this%ninterbeds = this%parser%GetInteger()</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,i0)&#39;</span>) <span class="stringliteral">&#39;NINTERBEDS = &#39;</span>, this%ninterbeds</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;MAXSIG0&#39;</span>)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          this%maxsig0 = this%parser%GetInteger()</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,i0)&#39;</span>) <span class="stringliteral">&#39;MAXSIG0 = &#39;</span>, this%maxsig0</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,3(1x,a),a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="stringliteral">&#39;Unknown&#39;</span>, trim(this%packName), <span class="stringliteral">&quot;dimension &#39;&quot;</span>, trim(keyword), <span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="stringliteral">&#39;END OF &#39;</span>//trim(adjustl(this%packName))//<span class="stringliteral">&#39; DIMENSIONS&#39;</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(<span class="stringliteral">&#39;Required dimensions block not found.&#39;</span>)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">! -- verify dimensions were set correctly</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (this%ninterbeds &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="stringliteral">&#39;NINTERBEDS was not specified or was specified incorrectly.&#39;</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">! -- stop if errors were encountered in the DIMENSIONS block</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">! -- Call define_listlabel to construct the list label that is written</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">!    when PRINT_INPUT option is used.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keyword">call </span>this%define_listlabel()</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a0cdaf8fb7dd626c1ec18c122e5a3b661_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a0cdaf8fb7dd626c1ec18c122e5a3b661_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a0cdaf8fb7dd626c1ec18c122e5a3b661_cgraph" id="namespacegwfcsubmodule_a0cdaf8fb7dd626c1ec18c122e5a3b661_cgraph">
<area shape="rect" title="@ brief Read dimensions for package" alt="" coords="5,49,168,90"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="216,5,400,32"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="221,56,395,83"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="239,107,377,133"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="448,66,616,107"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="448,131,616,173"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="664,44,859,71"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="677,95,845,137"/>
</map>
</div>

</div>
</div>
<a id="a05a1313609e09b356017ff94bea8f6ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05a1313609e09b356017ff94bea8f6ad">&#9670;&nbsp;</a></span>csub_read_packagedata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_read_packagedata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read delay and no-delay interbed input data for the CSUB package. Method also validates interbed input data. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l01381">1381</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: cellid</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordtype">character(len=20)</span> :: scellid</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordtype">character(len=10)</span> :: text</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bndName</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordtype">character(len=7)</span> :: cdelay</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ival</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: itmp</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ndelaybeds</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keywordtype">    real</span>(DP) :: rval</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="keywordtype">    real</span>(DP) :: baq</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordtype">    real</span>(DP) :: q</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: nboundchk</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">! -- initialize temporary variables</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    ndelaybeds = 0</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">! -- allocate temporary arrays</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keyword">allocate</span> (nboundchk(this%ninterbeds))</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">do</span> n = 1, this%ninterbeds</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      nboundchk(n) = 0</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;PACKAGEDATA&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">! -- parse locations block if detected</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING &#39;</span>//trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="stringliteral">&#39; PACKAGEDATA&#39;</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="comment">! -- get interbed number</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        itmp = this%parser%GetInteger()</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="comment">! -- check for error condition</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keywordflow">if</span> (itmp &lt; 1 .or. itmp &gt; this%ninterbeds) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,2(1x,a),1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="stringliteral">&#39;Interbed number (&#39;</span>, itmp, <span class="stringliteral">&#39;) must be greater than 0 and &#39;</span>, &amp;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <span class="stringliteral">&#39;less than or equal to&#39;</span>, this%ninterbeds, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          cycle</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="comment">! -- increment nboundchk</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        nboundchk(itmp) = nboundchk(itmp) + 1</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="comment">! -- read cellid</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="keyword">call </span>this%parser%GetCellid(this%dis%ndim, cellid)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        nn = this%dis%noder_from_cellid(cellid, &amp;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                        this%parser%iuactive, this%iout)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        n = this%dis%nodeu_from_cellid(cellid, &amp;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                                       this%parser%iuactive, this%iout)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        top = this%dis%top(nn)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        bot = this%dis%bot(nn)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        baq = top - bot</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="comment">! -- determine if a valid cell location was provided</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">if</span> (nn &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <span class="stringliteral">&#39;Invalid cellid for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="comment">! -- set nodelist and unodelist</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        this%nodelist(itmp) = nn</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        this%unodelist(itmp) = n</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="comment">! -- get cdelay</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(cdelay)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">select case</span> (cdelay)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NODELAY&#39;</span>)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          ival = 0</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DELAY&#39;</span>)</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          ndelaybeds = ndelaybeds + 1</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          ival = ndelaybeds</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <span class="stringliteral">&#39;Invalid CDELAY &#39;</span>, trim(adjustl(cdelay)), &amp;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          cycle</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        idelay = ival</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        this%idelay(itmp) = ival</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        <span class="comment">! -- get initial preconsolidation stress</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        this%pcs(itmp) = this%parser%GetDouble()</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        <span class="comment">! -- get thickness or cell fraction</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">if</span> (this%icellf == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          <span class="keywordflow">if</span> (rval &lt; dzero .or. rval &gt; baq) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,g0,2(a,1x),g0,1x,a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;              <span class="stringliteral">&#39;THICK (&#39;</span>, rval, <span class="stringliteral">&#39;) MUST BE greater than or equal to 0 &#39;</span>, &amp;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;              <span class="stringliteral">&#39;and less than or equal to than&#39;</span>, baq, &amp;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;              <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;          <span class="keywordflow">if</span> (rval &lt; dzero .or. rval &gt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;              <span class="stringliteral">&#39;FRAC MUST BE greater than 0 and less than or equal to 1&#39;</span>, &amp;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;              <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;          rval = rval*baq</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        this%thickini(itmp) = rval</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;          this%thick(itmp) = rval</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="comment">! -- get rnb</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordflow">if</span> (idelay &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;          <span class="keywordflow">if</span> (rval &lt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,g0,a,1x,a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;              <span class="stringliteral">&#39;RNB (&#39;</span>, rval, <span class="stringliteral">&#39;) must be greater than or equal to 1&#39;</span>, &amp;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;              <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;          rval = done</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        this%rnb(itmp) = rval</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="comment">! -- get skv or ci</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordflow">if</span> (rval &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(2(a,1x),i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="stringliteral">&#39;(SKV,CI) must be greater than or equal to 0&#39;</span>, &amp;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        this%ci(itmp) = rval</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="comment">! -- get ske or rci</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keywordflow">if</span> (rval &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(2(a,1x),i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="stringliteral">&#39;(SKE,RCI) must be greater than or equal to 0&#39;</span>, &amp;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        this%rci(itmp) = rval</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="comment">! -- set ielastic</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="keywordflow">if</span> (this%ci(itmp) == this%rci(itmp)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;          this%ielastic(itmp) = 1</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;          this%ielastic(itmp) = 0</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="comment">! -- get porosity</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        this%thetaini(itmp) = rval</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;          this%theta(itmp) = rval</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keywordflow">if</span> (rval &lt;= dzero .or. rval &gt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="stringliteral">&#39;THETA must be greater than 0 and less than or equal to 1&#39;</span>, &amp;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            <span class="stringliteral">&#39;for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="comment">! -- get kv</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="keywordflow">if</span> (idelay &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;          <span class="keywordflow">if</span> (rval &lt;= 0.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;              <span class="stringliteral">&#39;KV must be greater than 0 for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        this%kv(itmp) = rval</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">! -- get h0</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        rval = this%parser%GetDouble()</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        this%h0(itmp) = rval</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="comment">! -- get bound names</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(bndname)</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;          <span class="keywordflow">if</span> (len_trim(bndname) &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              <span class="stringliteral">&#39;BOUNDNAME must be specified for packagedata entry&#39;</span>, itmp, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            this%boundname(itmp) = bndname</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="stringliteral">&#39;END OF &#39;</span>//trim(adjustl(this%packName))//<span class="stringliteral">&#39; PACKAGEDATA&#39;</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">! -- write summary of interbed data</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">if</span> (this%iprpak == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="comment">! -- set title</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      title = trim(adjustl(this%packName))//<span class="stringliteral">&#39; PACKAGE INTERBED DATA&#39;</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      ntabrows = this%ninterbeds</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      ntabcols = 11</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        ntabcols = ntabcols + 1</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="keyword">call </span>this%inputtab%table_df(ntabrows, ntabcols, this%iout)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="comment">! add columns</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      tag = <span class="stringliteral">&#39;INTERBED&#39;</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      tag = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 20, alignment=tabcenter)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      tag = <span class="stringliteral">&#39;CDELAY&#39;</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      tag = <span class="stringliteral">&#39;PCS&#39;</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      tag = <span class="stringliteral">&#39;THICK&#39;</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      tag = <span class="stringliteral">&#39;RNB&#39;</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      tag = <span class="stringliteral">&#39;SSV_CC&#39;</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      tag = <span class="stringliteral">&#39;SSV_CR&#39;</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      tag = <span class="stringliteral">&#39;THETA&#39;</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      tag = <span class="stringliteral">&#39;KV&#39;</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      tag = <span class="stringliteral">&#39;H0&#39;</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        tag = <span class="stringliteral">&#39;BOUNDNAME&#39;</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(tag, lenboundname, &amp;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                                             alignment=tableft)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_string(this%nodelist(ib), scellid)</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <span class="keywordflow">if</span> (this%idelay(ib) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;          text = <span class="stringliteral">&#39;NODELAY&#39;</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;          text = <span class="stringliteral">&#39;DELAY&#39;</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(ib)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(scellid)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(text)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%pcs(ib))</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%thickini(ib))</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%rnb(ib))</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%ci(ib))</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%rci(ib))</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%thetaini(ib))</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keywordflow">if</span> (this%idelay(ib) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%kv(ib))</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%h0(ib))</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%boundname(ib))</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">! -- Check to make sure that every interbed is specified and that no</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="comment">!    interbed is specified more than once.</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">if</span> (nboundchk(ib) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;          <span class="stringliteral">&#39;Information for interbed&#39;</span>, ib, <span class="stringliteral">&#39;not specified in packagedata block.&#39;</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nboundchk(ib) &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(2(a,1x,i0),a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          <span class="stringliteral">&#39;Information specified&#39;</span>, nboundchk(ib), <span class="stringliteral">&#39;times for interbed&#39;</span>, ib, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keyword">deallocate</span> (nboundchk)</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">! -- set the number of delay interbeds</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    this%ndelaybeds = ndelaybeds</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">! -- process delay interbeds</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">if</span> (ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <span class="comment">! -- reallocate and initialize delay interbed arrays</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordflow">if</span> (ierr == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idb_nconv_count, 2, &amp;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                          <span class="stringliteral">&#39;IDB_NCONV_COUNT&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idbconvert, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                          <span class="stringliteral">&#39;IDBCONVERT&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbdhmax, ndelaybeds, &amp;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                          <span class="stringliteral">&#39;DBDHMAX&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbz, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                          <span class="stringliteral">&#39;DBZ&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbrelz, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                          <span class="stringliteral">&#39;DBRELZ&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbh, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                          <span class="stringliteral">&#39;DBH&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbh0, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                          <span class="stringliteral">&#39;DBH0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbgeo, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                          <span class="stringliteral">&#39;DBGEO&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbes, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                          <span class="stringliteral">&#39;DBES&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbes0, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                          <span class="stringliteral">&#39;DBES0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbpcs, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                          <span class="stringliteral">&#39;DBPCS&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbflowtop, ndelaybeds, &amp;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                          <span class="stringliteral">&#39;DBFLOWTOP&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbflowbot, ndelaybeds, &amp;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                          <span class="stringliteral">&#39;DBFLOWBOT&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbdzini, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                          <span class="stringliteral">&#39;DBDZINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbthetaini, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                          <span class="stringliteral">&#39;DBTHETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbcomp, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                          <span class="stringliteral">&#39;DBCOMP&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbtcomp, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                          <span class="stringliteral">&#39;DBTCOMP&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="comment">! -- allocate delay bed arrays</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="keywordflow">if</span> (this%iupdatematprop == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%dbdz, <span class="stringliteral">&#39;DBDZINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%dbdz0, <span class="stringliteral">&#39;DBDZINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%dbtheta, <span class="stringliteral">&#39;DBTHETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%dbtheta0, <span class="stringliteral">&#39;DBTHETAINI&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbdz, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                            <span class="stringliteral">&#39;DBDZ&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbdz0, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                            <span class="stringliteral">&#39;DBDZ0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbtheta, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                            <span class="stringliteral">&#39;DBTHETA&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbtheta0, this%ndelaycells, ndelaybeds, &amp;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                            <span class="stringliteral">&#39;DBTHETA0&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="comment">! -- allocate delay interbed solution arrays</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbal, this%ndelaycells, &amp;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                          <span class="stringliteral">&#39;DBAL&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbad, this%ndelaycells, &amp;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                          <span class="stringliteral">&#39;DBAD&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbau, this%ndelaycells, &amp;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                          <span class="stringliteral">&#39;DBAU&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbrhs, this%ndelaycells, &amp;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                          <span class="stringliteral">&#39;DBRHS&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbdh, this%ndelaycells, &amp;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                          <span class="stringliteral">&#39;DBDH&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbaw, this%ndelaycells, &amp;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                          <span class="stringliteral">&#39;DBAW&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="comment">! -- initialize delay bed counters</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <span class="keywordflow">do</span> n = 1, 2</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;          this%idb_nconv_count(n) = 0</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="comment">! -- initialize delay bed storage</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          idelay = this%idelay(ib)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;          <span class="keywordflow">if</span> (idelay == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            cycle</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;          <span class="comment">! -- initialize delay interbed variables</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            rval = this%thickini(ib)/real(this%ndelaycells, dp)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            this%dbdzini(n, idelay) = rval</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            this%dbh(n, idelay) = this%h0(ib)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            this%dbh0(n, idelay) = this%h0(ib)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            this%dbthetaini(n, idelay) = this%thetaini(ib)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            this%dbgeo(n, idelay) = dzero</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            this%dbes(n, idelay) = dzero</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            this%dbes0(n, idelay) = dzero</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            this%dbpcs(n, idelay) = this%pcs(ib)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            this%dbcomp(n, idelay) = dzero</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            this%dbtcomp(n, idelay) = dzero</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="keywordflow">if</span> (this%iupdatematprop /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;              this%dbdz(n, idelay) = this%dbdzini(n, idelay)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;              this%dbdz0(n, idelay) = this%dbdzini(n, idelay)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;              this%dbtheta(n, idelay) = this%theta(ib)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;              this%dbtheta0(n, idelay) = this%theta(ib)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          <span class="comment">! -- initialize elevation of delay bed cells</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;          <span class="keyword">call </span>this%csub_delay_init_zcell(ib)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="comment">! -- initialize delay bed solution arrays</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;          this%dbal(n) = dzero</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;          this%dbad(n) = dzero</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          this%dbau(n) = dzero</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;          this%dbrhs(n) = dzero</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;          this%dbdh(n) = dzero</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;          this%dbaw(n) = dzero</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">! -- check that ndelaycells is odd when using</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">!    the effective stress formulation</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">if</span> (ndelaybeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      q = mod(real(this%ndelaycells, dp), dtwo)</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <span class="keywordflow">if</span> (q == dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,i0,a,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          <span class="stringliteral">&#39;NDELAYCELLS (&#39;</span>, this%ndelaycells, <span class="stringliteral">&#39;) must be an&#39;</span>, &amp;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          <span class="stringliteral">&#39;odd number when using the effective stress formulation.&#39;</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a05a1313609e09b356017ff94bea8f6ad_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a05a1313609e09b356017ff94bea8f6ad_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a05a1313609e09b356017ff94bea8f6ad_cgraph" id="namespacegwfcsubmodule_a05a1313609e09b356017ff94bea8f6ad_cgraph">
<area shape="rect" title="@ brief Read packagedata for package" alt="" coords="5,23,168,65"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="216,5,391,32"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="221,56,385,83"/>
</map>
</div>

</div>
</div>
<a id="a9ccb5ef50fc4b8ec98326239abb68696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ccb5ef50fc4b8ec98326239abb68696">&#9670;&nbsp;</a></span>csub_rp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_rp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method reads and prepares stress period data for the CSUB package. The overlying geostatic stress (sig0) is the only stress period data read by the CSUB package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l02476">2476</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetimeseriesmanagermodule.html">timeseriesmanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordtype">character(len=20)</span> :: cellid</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: jj</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nlist</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">pointer</span> :: bndElem =&gt; null()</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtblkerr = &amp;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                                   <span class="stringliteral">&quot;(&#39;Looking for BEGIN PERIOD iper.  Found &#39;, a, &#39; instead.&#39;)&quot;</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtlsp = &amp;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                                   <span class="stringliteral">&quot;(1X,/1X,&#39;REUSING &#39;,A,&#39;S FROM LAST STRESS PERIOD&#39;)&quot;</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <span class="comment">! -- return if data is not read from file</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="keywordflow">if</span> (this%inunit == 0) <span class="keywordflow">return</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="comment">! -- get stress period data</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">if</span> (this%ionper &lt; <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="comment">! -- get period block</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;PERIOD&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                                supportopenclose=.true.)</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <span class="comment">! -- read ionper and check for increasing period numbers</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <span class="keyword">call </span>this%read_check_ionper()</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        <span class="comment">! -- PERIOD block not found</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <span class="keywordflow">if</span> (ierr &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;          <span class="comment">! -- End of file found; data applies for remainder of simulation.</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;          this%ionper = <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a> + 1</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;          <span class="comment">! -- Found invalid block</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;          <span class="keyword">call </span>this%parser%GetCurrentLine(line)</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;          <span class="keyword">write</span> (errmsg, fmtblkerr) adjustl(trim(line))</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="comment">! -- read data if ionper == kper</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="keywordflow">if</span> (this%ionper == <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="comment">! -- setup table for period data</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        title = <span class="stringliteral">&#39;CSUB&#39;</span>//<span class="stringliteral">&#39; PACKAGE (&#39;</span>// &amp;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                trim(adjustl(this%packName))//<span class="stringliteral">&#39;) DATA FOR PERIOD&#39;</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <span class="keyword">write</span> (title, <span class="stringliteral">&#39;(a,1x,i6)&#39;</span>) trim(adjustl(title)), <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(1, 2, this%iout, finalize=.false.)</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        text = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 20)</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        text = <span class="stringliteral">&#39;SIG0&#39;</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 15, alignment=tableft)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <span class="comment">! -- initialize nlist</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      nlist = 0</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      <span class="comment">! -- Remove all time-series links associated with this package.</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <span class="keyword">call </span>this%TsManager%Reset(this%packName)</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <span class="comment">! -- read data</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      readdata: <span class="keywordflow">do</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        <span class="comment">! -- test for end of block</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;          <span class="keywordflow">exit</span> readdata</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <span class="comment">! -- increment counter</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        nlist = nlist + 1</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <span class="comment">! -- check for error condition with nlist</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        <span class="keywordflow">if</span> (nlist &gt; this%maxsig0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,i0,a,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            <span class="stringliteral">&#39;The number of stress period entries (&#39;</span>, nlist, &amp;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            <span class="stringliteral">&#39;) exceeds the maximum number of stress period entries (&#39;</span>, &amp;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;            this%maxsig0, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;          <span class="keywordflow">exit</span> readdata</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        <span class="comment">! -- get cell i</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        <span class="keyword">call </span>this%parser%GetCellid(this%dis%ndim, cellid)</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        node = this%dis%noder_from_cellid(cellid, &amp;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                                          this%parser%iuactive, this%iout)</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <span class="keywordflow">if</span> (node &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,2(1x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            <span class="stringliteral">&#39;CELLID&#39;</span>, cellid, <span class="stringliteral">&#39;is not in the active model domain.&#39;</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;          cycle readdata</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        this%nodelistsig0(nlist) = node</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <span class="comment">! -- get sig0</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        jj = 1  <span class="comment">! For &#39;SIG0&#39;</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        bndelem =&gt; this%sig0(nlist)</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, nlist, jj, bndelem, this%packName, &amp;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                                           <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak, &amp;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                                           <span class="stringliteral">&#39;SIG0&#39;</span>)</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <span class="comment">! -- write line to table</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;          <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(cellid)</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(bndelem)</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="keywordflow">      end do</span> readdata</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      <span class="comment">! -- set nbound</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      this%nbound = nlist</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      <span class="comment">! -- finalize the table</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        <span class="keyword">call </span>this%inputtab%finalize_table()</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      <span class="comment">! -- reuse data from last stress period</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <span class="keyword">write</span> (this%iout, fmtlsp) trim(this%filtyp)</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="comment">! -- terminate if errors encountered in reach block</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="comment">! -- read observations</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <span class="keyword">call </span>this%csub_rp_obs()</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a9ccb5ef50fc4b8ec98326239abb68696_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a9ccb5ef50fc4b8ec98326239abb68696_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a9ccb5ef50fc4b8ec98326239abb68696_cgraph" id="namespacegwfcsubmodule_a9ccb5ef50fc4b8ec98326239abb68696_cgraph">
<area shape="rect" title="@ brief Read and prepare stress period data for package" alt="" coords="5,129,188,155"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="262,11,446,38"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666" title=" " alt="" coords="236,63,472,104"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="532,126,707,153"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="272,179,436,206"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="285,230,423,257"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#ad1b537cde3acf4d66f1e3db237bdb5c4" title=" " alt="" coords="520,5,719,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="1009,35,1164,76"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a20fd69114074fcbe01dcc8219d4bbd79" title=" " alt="" coords="787,5,941,47"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="535,203,703,244"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="535,268,703,309"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="767,181,961,207"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="780,232,948,273"/>
</map>
</div>

</div>
</div>
<a id="a9a79144a384f3d3685b9ca6a36d81011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a79144a384f3d3685b9ca6a36d81011">&#9670;&nbsp;</a></span>csub_rp_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_rp_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to read and prepare the observations for the CSUB package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07622">7622</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;    <span class="keywordtype">class</span>(ObserveType), <span class="keywordtype">pointer</span> :: obsrv =&gt; null()</div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bname</div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;    <span class="comment">!  -- return if observations are not supported</span></div>
<div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;    <span class="keywordflow">if</span> (.not. this%csub_obs_supported()) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;    <span class="comment">! -- process each package observation</span></div>
<div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;    <span class="comment">!    only done the first stress period since boundaries are fixed</span></div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;    <span class="comment">!    for the simulation</span></div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;      <span class="keywordflow">do</span> i = 1, this%obs%npakobs</div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;        obsrv =&gt; this%obs%pakobs(i)%obsrv</div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;        <span class="comment">! -- initialize BndFound to .false.</span></div>
<div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;        obsrv%BndFound = .false.</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;        bname = obsrv%FeatureName</div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;        <span class="keywordflow">if</span> (bname /= <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;          <span class="comment">! -- Observation location(s) is(are) based on a boundary name.</span></div>
<div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;          <span class="comment">!    Iterate through all boundaries to identify and store</span></div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;          <span class="comment">!    corresponding index(indices) in bound array.</span></div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;          <span class="keywordflow">do</span> j = 1, this%ninterbeds</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;            <span class="keywordflow">if</span> (this%boundname(j) == bname) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;              obsrv%BndFound = .true.</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;              obsrv%CurrentTimeStepEndValue = dzero</div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;          <span class="comment">! -- one value per cell</span></div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;GSTRESS-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;ESTRESS-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;THICKNESS-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;COARSE-CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;WCOMP-CSUB-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;COARSE-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;COARSE-THETA&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;COARSE-THICKNESS&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;          obsrv%BndFound = .true.</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;          obsrv%CurrentTimeStepEndValue = dzero</div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;          <span class="keyword">call </span>obsrv%AddObsIndex(obsrv%NodeNumber)</div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-PRECONSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-HEAD&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-GSTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-ESTRESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-THICKNESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-THETA&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;          <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;            n = obsrv%NodeNumber</div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;            idelay = this%idelay(n)</div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;            <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;              j = (idelay - 1)*this%ndelaycells + 1</div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;              n2 = obsrv%NodeNumber2</div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;              <span class="keywordflow">if</span> (n2 &lt; 1 .or. n2 &gt; this%ndelaycells) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;                <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,2(1x,a),1x,i0,1x,a,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;                  trim(adjustl(obsrv%ObsTypeId)), <span class="stringliteral">&#39;interbed cell must be &#39;</span>, &amp;</div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;                  <span class="stringliteral">&#39;greater than 0 and less than or equal to&#39;</span>, this%ndelaycells, &amp;</div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;                  <span class="stringliteral">&#39;(specified value is &#39;</span>, n2, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;                j = (idelay - 1)*this%ndelaycells + n2</div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;              obsrv%BndFound = .true.</div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;          <span class="comment">! -- interbed value</span></div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;INELASTIC-CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;ELASTIC-CSUB&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;SK&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;SKE&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;THICKNESS&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;THETA&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;INTERBED-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;INELASTIC-COMPACTION&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;ELASTIC-COMPACTION&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;          <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;            j = obsrv%NodeNumber</div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;            <span class="keywordflow">if</span> (j &lt; 1 .or. j &gt; this%ninterbeds) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;              <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,2(1x,a),1x,i0,1x,a,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;                trim(adjustl(obsrv%ObsTypeId)), <span class="stringliteral">&#39;interbed cell must be greater&#39;</span>, &amp;</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;                <span class="stringliteral">&#39;than 0 and less than or equal to&#39;</span>, this%ninterbeds, &amp;</div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;                <span class="stringliteral">&#39;(specified value is &#39;</span>, j, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;              obsrv%BndFound = .true.</div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;              obsrv%CurrentTimeStepEndValue = dzero</div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-FLOWTOP&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;                 obsrv%ObsTypeId == <span class="stringliteral">&#39;DELAY-FLOWBOT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;          <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;            j = obsrv%NodeNumber</div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;            <span class="keywordflow">if</span> (j &lt; 1 .or. j &gt; this%ninterbeds) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;              <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,2(1x,a),1x,i0,1x,a,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;                trim(adjustl(obsrv%ObsTypeId)), <span class="stringliteral">&#39;interbed cell must be greater &#39;</span>, &amp;</div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;                <span class="stringliteral">&#39;than 0 and less than or equal to&#39;</span>, this%ninterbeds, &amp;</div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;                <span class="stringliteral">&#39;(specified value is &#39;</span>, j, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;            idelay = this%idelay(j)</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;            <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;              obsrv%BndFound = .true.</div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;              obsrv%CurrentTimeStepEndValue = dzero</div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;          <span class="comment">! -- Accumulate values in a single cell</span></div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;          <span class="comment">! -- Observation location is a single node number</span></div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;          <span class="comment">! -- save node number in first position</span></div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;          <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;CSUB-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;SKE-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;SK-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;THETA-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;INELASTIC-COMPACTION-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;ELASTIC-COMPACTION-CELL&#39;</span> .or. &amp;</div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;COMPACTION-CELL&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;            <span class="keywordflow">if</span> (.NOT. obsrv%BndFound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;              obsrv%BndFound = .true.</div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;              obsrv%CurrentTimeStepEndValue = dzero</div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(obsrv%NodeNumber)</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;          jloop: <span class="keywordflow">do</span> j = 1, this%ninterbeds</div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;            <span class="keywordflow">if</span> (this%nodelist(j) == obsrv%NodeNumber) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;              obsrv%BndFound = .true.</div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;              obsrv%CurrentTimeStepEndValue = dzero</div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;<span class="keywordflow">          end do</span> jloop</div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;      <span class="comment">! -- evaluate if there are any observation errors</span></div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;        <span class="keyword">call </span>store_error_unit(this%inunit)</div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a9a79144a384f3d3685b9ca6a36d81011_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a9a79144a384f3d3685b9ca6a36d81011_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a9a79144a384f3d3685b9ca6a36d81011_cgraph" id="namespacegwfcsubmodule_a9a79144a384f3d3685b9ca6a36d81011_cgraph">
<area shape="rect" title="Read and prepare the observations." alt="" coords="5,74,168,115"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="227,5,411,32"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="232,56,407,83"/>
<area shape="rect" href="namespacesimmodule.html#a1c78a6fda06b630c738bb654aa6bd816" title=" " alt="" coords="216,107,423,133"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="250,157,389,184"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="471,117,639,158"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="471,182,639,223"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="687,95,881,121"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="700,146,868,187"/>
</map>
</div>

</div>
</div>
<a id="abd1b90b11e50759af854c5b70975c3a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd1b90b11e50759af854c5b70975c3a7">&#9670;&nbsp;</a></span>csub_save_model_flows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_save_model_flows </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save cell-by-cell budget terms for the CSUB package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcfl</td><td>flag to output budget data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcun</td><td>unit number for cell-by-cell file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l03559">3559</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcfl<span class="comment">    !&lt; flag to output budget data</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcun<span class="comment">    !&lt; unit number for cell-by-cell file</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="keywordtype">character(len=1)</span> :: cdatafmp = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    <span class="keywordtype">character(len=1)</span> :: editdesc = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iprint</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nvaluesp</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nwidthp</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="keywordtype">    real</span>(DP) :: dinact</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="keywordtype">    real</span>(DP) :: Q</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <span class="comment">! -- Set unit number for binary output</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <span class="keywordflow">if</span> (this%ipakcb &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      ibinun = icbcun</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <span class="keywordflow">elseif</span> (this%ipakcb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      ibinun = this%ipakcb</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="keywordflow">if</span> (icbcfl == 0) ibinun = 0</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <span class="comment">! -- Record the storage rates if requested</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      iprint = 0</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      dinact = dzero</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <span class="comment">! -- coarse-grained storage (sske)</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%cg_stor, this%iout, iprint, -ibinun, &amp;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                                 budtxt(1), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;      <span class="keywordflow">if</span> (this%ninterbeds &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        naux = 0</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        <span class="comment">! -- interbed elastic storage</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;        <span class="keyword">call </span>this%dis%record_srcdst_list_header(budtxt(2), this%name_model, &amp;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                                                this%name_model, this%name_model, this%packName, naux, &amp;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                                                this%auxname, ibinun, this%ninterbeds, this%iout)</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;          q = this%storagee(ib)</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;          <span class="keyword">call </span>this%dis%record_mf6_list_entry(ibinun, node, node, q, naux, &amp;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                                              this%auxvar(:, ib))</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        <span class="comment">! -- interbed inelastic storage</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;        <span class="keyword">call </span>this%dis%record_srcdst_list_header(budtxt(3), this%name_model, &amp;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                                                this%name_model, this%name_model, this%packName, naux, &amp;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                                                this%auxname, ibinun, this%ninterbeds, this%iout)</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;          q = this%storagei(ib)</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;          <span class="keyword">call </span>this%dis%record_mf6_list_entry(ibinun, node, node, q, naux, &amp;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                                              this%auxvar(:, ib))</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      <span class="comment">! -- water compressibility</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%cell_wcstor, this%iout, iprint, -ibinun, &amp;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                                 budtxt(4), cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a895b630bf8ee96f93d1709b6aae59b0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895b630bf8ee96f93d1709b6aae59b0e">&#9670;&nbsp;</a></span>csub_set_initial_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::csub_set_initial_state </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method sets the initial states for coarse-grained materials and fine- grained sediments in the interbeds. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of active model nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hnew</td><td>current heads </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l04600">4600</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType) :: this</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">               !&lt; number of active model nodes</span></div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nodes)</span>, <span class="keywordtype">intent(in)</span> :: hnew<span class="comment">  !&lt; current heads</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    <span class="keywordtype">character(len=20)</span> :: cellid</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ib</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idelay</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs0</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;<span class="keywordtype">    real</span>(DP) :: pcs</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;<span class="keywordtype">    real</span>(DP) :: fact</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;<span class="keywordtype">    real</span>(DP) :: top</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="keywordtype">    real</span>(DP) :: bot</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;<span class="keywordtype">    real</span>(DP) :: void</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;<span class="keywordtype">    real</span>(DP) :: znode</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcell</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;<span class="keywordtype">    real</span>(DP) :: hbar</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="keywordtype">    real</span>(DP) :: dzhalf</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="keywordtype">    real</span>(DP) :: zbot</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;<span class="keywordtype">    real</span>(DP) :: dbpcs</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;    <span class="comment">! -- update geostatic load calculation</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;    <span class="keyword">call </span>this%csub_cg_calc_stress(nodes, hnew)</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;    <span class="comment">! -- initialize coarse-grained material effective stress</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;    <span class="comment">!    for the previous time step and the previous iteration</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;    <span class="keywordflow">do</span> node = 1, nodes</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      this%cg_es0(node) = this%cg_es(node)</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;    <span class="comment">! -- initialize interbed initial states</span></div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;      hcell = hnew(node)</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      pcs = this%pcs(ib)</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      pcs0 = pcs</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      <span class="keywordflow">if</span> (this%ispecified_pcs == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;        <span class="comment">! relative pcs...subtract head (u) from sigma&#39;</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;        <span class="keywordflow">if</span> (this%ipch /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;          pcs = this%cg_es(node) - pcs0</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;          pcs = this%cg_es(node) + pcs0</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;        <span class="comment">! specified pcs...substract head (u) from sigma</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;        <span class="keywordflow">if</span> (this%ipch /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;          pcs = this%cg_gs(node) - (pcs0 - bot)</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        <span class="keywordflow">if</span> (pcs &lt; this%cg_es(node)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;          pcs = this%cg_es(node)</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;      this%pcs(ib) = pcs</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;      <span class="comment">! -- delay bed initial states</span></div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;      <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;        dzhalf = dhalf*this%dbdzini(1, idelay)</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;        <span class="comment">! -- fill delay bed head with aquifer head or offset from aquifer head</span></div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;        <span class="comment">!    heads need to be filled first since used to calculate</span></div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;        <span class="comment">!    the effective stress for each delay bed</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;        <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;          <span class="keywordflow">if</span> (this%ispecified_dbh == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;            this%dbh(n, idelay) = hcell + this%dbh(n, idelay)</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;            this%dbh(n, idelay) = hcell</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;          this%dbh0(n, idelay) = this%dbh(n, idelay)</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;        <span class="comment">! -- fill delay bed effective stress</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;        <span class="keyword">call </span>this%csub_delay_calc_stress(ib, hcell)</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        <span class="comment">! -- fill delay bed pcs</span></div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        pcs = this%pcs(ib)</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;          zbot = this%dbz(n, idelay) - dzhalf</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;          <span class="comment">! -- adjust pcs to bottom of each delay bed cell</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;          <span class="comment">!    not using csub_calc_adjes() since smoothing not required</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;          dbpcs = pcs - (zbot - bot)*(this%sgs(node) - done)</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;          this%dbpcs(n, idelay) = dbpcs</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;          <span class="comment">! -- initialize effective stress for previous time step</span></div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;          this%dbes0(n, idelay) = this%dbes(n, idelay)</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    <span class="comment">! -- scale coarse-grained materials cr</span></div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;    <span class="keywordflow">do</span> node = 1, nodes</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      <span class="comment">! -- user-specified specific storage</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      <span class="keywordflow">if</span> (this%istoragec == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;        <span class="comment">! -- retain specific storage values since they are constant</span></div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;        <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;          fact = done</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;          <span class="comment">! -- convert specific storage values since they are simulated to</span></div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;          <span class="comment">!    be a function of the average effective stress</span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;          void = this%csub_calc_void(this%cg_theta(node))</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;          es = this%cg_es(node)</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;          hcell = hnew(node)</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;          <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;          hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;          <span class="comment">! -- calculate znode and factor</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;          znode = this%csub_calc_znode(top, bot, hbar)</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;          fact = this%csub_calc_adjes(node, es, bot, znode)</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;          fact = fact*(done + void)</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;        <span class="comment">! -- user-specified compression indices - multiply by dlog10es</span></div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;        fact = dlog10es</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      this%cg_ske_cr(node) = this%cg_ske_cr(node)*fact</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      <span class="comment">! -- write error message if negative compression indices</span></div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;      <span class="keywordflow">if</span> (fact &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;          <span class="stringliteral">&#39;Negative recompression index calculated for cell&#39;</span>, &amp;</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;          trim(adjustl(cellid)), <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;    <span class="comment">! -- scale interbed cc and cr</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;      idelay = this%idelay(ib)</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      node = this%nodelist(ib)</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;      top = this%dis%top(node)</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      bot = this%dis%bot(node)</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;      <span class="comment">! -- user-specified specific storage</span></div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;      <span class="keywordflow">if</span> (this%istoragec == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;        <span class="comment">! -- retain specific storage values since they are constant</span></div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;        <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;          fact = done</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;          <span class="comment">! -- convert specific storage values since they are simulated to</span></div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;          <span class="comment">!    be a function of the average effective stress</span></div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;          void = this%csub_calc_void(this%theta(ib))</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;          es = this%cg_es(node)</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;          hcell = hnew(node)</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;          <span class="comment">! -- calculate corrected head (hbar)</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;          hbar = squadratic0sp(hcell, bot, this%satomega)</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;          <span class="comment">! -- calculate zone and factor</span></div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;          znode = this%csub_calc_znode(top, bot, hbar)</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;          fact = this%csub_calc_adjes(node, es, bot, znode)</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;          fact = fact*(done + void)</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;        <span class="comment">! -- user-specified compression indices - multiply by dlog10es</span></div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        fact = dlog10es</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;      this%ci(ib) = this%ci(ib)*fact</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;      this%rci(ib) = this%rci(ib)*fact</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;      <span class="comment">! -- write error message if negative compression indices</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;      <span class="keywordflow">if</span> (fact &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,1x,i0,2(1x,a),a)&#39;</span>) &amp;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;          <span class="stringliteral">&#39;Negative compression indices calculated for interbed&#39;</span>, ib, &amp;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;          <span class="stringliteral">&#39;in cell&#39;</span>, trim(adjustl(cellid)), <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;    <span class="comment">! -- write current stress and initial preconsolidation stress</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;    <span class="keywordflow">if</span> (this%iprpak == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;      <span class="comment">! -- set title</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;      title = trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;              <span class="stringliteral">&#39; PACKAGE CALCULATED INITIAL INTERBED STRESSES AT THE CELL BOTTOM&#39;</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;      ntabrows = this%ninterbeds</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;      ntabcols = 5</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;        ntabcols = ntabcols + 1</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;      <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;      <span class="keyword">call </span>this%inputtab%table_df(ntabrows, ntabcols, this%iout)</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;      <span class="comment">! add columns</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;      tag = <span class="stringliteral">&#39;INTERBED NUMBER&#39;</span></div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;      tag = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 20)</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      tag = <span class="stringliteral">&#39;GEOSTATIC STRESS&#39;</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      tag = <span class="stringliteral">&#39;EFFECTIVE STRESS&#39;</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      tag = <span class="stringliteral">&#39;PRECONSOLIDATION STRESS&#39;</span></div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;        tag = <span class="stringliteral">&#39;BOUNDNAME&#39;</span></div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(tag, lenboundname, &amp;</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                                             alignment=tableft)</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;      <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;        node = this%nodelist(ib)</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;        <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;        <span class="comment">! -- write the columns</span></div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(ib)</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(cellid)</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%cg_gs(node))</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%cg_es(node))</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;        <span class="keyword">call </span>this%inputtab%add_term(this%pcs(ib))</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%boundname(ib))</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      <span class="comment">! -- write effective stress and preconsolidation stress</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;      <span class="comment">!    for delay beds</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;      <span class="comment">! -- set title</span></div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;      title = trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;              <span class="stringliteral">&#39; PACKAGE CALCULATED INITIAL DELAY INTERBED STRESSES&#39;</span></div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      ntabrows = 0</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;        idelay = this%idelay(ib)</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;        <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;          ntabrows = ntabrows + this%ndelaycells</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      ntabcols = 6</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;        ntabcols = ntabcols + 1</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;      <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      <span class="keyword">call </span>this%inputtab%table_df(ntabrows, ntabcols, this%iout)</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;      <span class="comment">! add columns</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      tag = <span class="stringliteral">&#39;INTERBED NUMBER&#39;</span></div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      tag = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 20)</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;      tag = <span class="stringliteral">&#39;DELAY CELL&#39;</span></div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;      tag = <span class="stringliteral">&#39;GEOSTATIC STRESS&#39;</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;      tag = <span class="stringliteral">&#39;EFFECTIVE STRESS&#39;</span></div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;      tag = <span class="stringliteral">&#39;PRECONSOLIDATION STRESS&#39;</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;        tag = <span class="stringliteral">&#39;BOUNDNAME&#39;</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(tag, lenboundname, &amp;</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;                                             alignment=tableft)</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;      <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;        idelay = this%idelay(ib)</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;        <span class="keywordflow">if</span> (idelay /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;          node = this%nodelist(ib)</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;          <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;          <span class="comment">! -- write the columns</span></div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;          <span class="keywordflow">do</span> n = 1, this%ndelaycells</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;            <span class="keywordflow">if</span> (n == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(ib)</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(cellid)</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%dbgeo(n, idelay))</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%dbes(n, idelay))</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%dbpcs(n, idelay))</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;            <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;              <span class="keywordflow">if</span> (n == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;                <span class="keyword">call </span>this%inputtab%add_term(this%boundname(ib))</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;                <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;      <span class="comment">! -- write calculated compression indices</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;      <span class="keywordflow">if</span> (this%istoragec == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;        <span class="keywordflow">if</span> (this%lhead_based .EQV. .false.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;          <span class="comment">! -- set title</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;          title = trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                  <span class="stringliteral">&#39; PACKAGE COMPRESSION INDICES&#39;</span></div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;          <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;          ntabrows = this%ninterbeds</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;          ntabcols = 4</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;          <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;            ntabcols = ntabcols + 1</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;          <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;          <span class="keyword">call </span>this%inputtab%table_df(ntabrows, ntabcols, this%iout)</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;          <span class="comment">! add columns</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;          tag = <span class="stringliteral">&#39;INTERBED NUMBER&#39;</span></div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;          tag = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(tag, 20)</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;          tag = <span class="stringliteral">&#39;CC&#39;</span></div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;          tag = <span class="stringliteral">&#39;CR&#39;</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(tag, 16)</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;          <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;            tag = <span class="stringliteral">&#39;BOUNDNAME&#39;</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;            <span class="keyword">call </span>this%inputtab%initialize_column(tag, lenboundname, &amp;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                                                 alignment=tableft)</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;          <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;          <span class="keywordflow">do</span> ib = 1, this%ninterbeds</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;            fact = done/dlog10es</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;            node = this%nodelist(ib)</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;            <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;            <span class="comment">! -- write the columns</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(ib)</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(cellid)</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%ci(ib)*fact)</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%rci(ib)*fact)</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(this%boundname(ib))</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    <span class="comment">! -- terminate if any initialization errors have been detected</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    <span class="comment">! -- set initialized</span></div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    this%initialized = 1</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;    <span class="comment">! -- set flag to retain initial stresses for entire simulation</span></div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;    <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;      this%iupdatestress = 0</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a895b630bf8ee96f93d1709b6aae59b0e_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a895b630bf8ee96f93d1709b6aae59b0e_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a895b630bf8ee96f93d1709b6aae59b0e_cgraph" id="namespacegwfcsubmodule_a895b630bf8ee96f93d1709b6aae59b0e_cgraph">
<area shape="rect" title="@ brief Set initial states for the package" alt="" coords="5,99,168,141"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="243,5,427,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#ad0e020e6b2d7b38bfe528f72e41a6a3b" title=" " alt="" coords="216,56,455,83"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="248,107,423,133"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="253,157,417,184"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="266,208,405,235"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="503,167,671,209"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="503,233,671,274"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="719,145,913,172"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="732,197,900,238"/>
</map>
</div>

</div>
</div>
<a id="aac822d74d0679c15790c78ad8abbf546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac822d74d0679c15790c78ad8abbf546">&#9670;&nbsp;</a></span>define_listlabel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::define_listlabel </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method defined the list label for the CSUB package. The list label is the heading that is written to iout when PRINT_INPUT option is used. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l07877">7877</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;    <span class="comment">! -- create the header list label</span></div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;    this%listlabel = trim(this%filtyp)//<span class="stringliteral">&#39; NO.&#39;</span></div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;    <span class="keywordflow">if</span> (this%dis%ndim == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;ROW&#39;</span></div>
<div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;COL&#39;</span></div>
<div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;    <span class="keywordflow">elseif</span> (this%dis%ndim == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;CELL2D&#39;</span></div>
<div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;NODE&#39;</span></div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;    <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a16)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;SIG0&#39;</span></div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;    <span class="keywordflow">if</span> (this%inamedbound == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;      <span class="keyword">write</span> (this%listlabel, <span class="stringliteral">&#39;(a, a16)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;BOUNDARY NAME&#39;</span></div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1576ca3a5da563e697ae4e94e64af607"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1576ca3a5da563e697ae4e94e64af607">&#9670;&nbsp;</a></span>read_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfcsubmodule::read_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfcsubmodule_1_1gwfcsubtype.html">gwfcsubtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read options block for CSUB package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l00584">584</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#ac9c1da291f7c6bfb35a47957c588ab20">maxcharlen</a>, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceopenspecmodule.html">openspecmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99">urdaux</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">class</span>(GwfCsubType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: line</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">character(len=MAXCHARLEN)</span> :: fname</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">character(len=LENAUXNAME)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: caux</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: lloc</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istart</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istop</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inobs</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibrg</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ieslag</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isetgamma</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtts = &amp;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                   <span class="stringliteral">&quot;(4x, &#39;TIME-SERIES DATA WILL BE READ FROM FILE: &#39;, a)&quot;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtflow = &amp;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                   <span class="stringliteral">&quot;(4x, &#39;FLOWS WILL BE SAVED TO FILE: &#39;, a, /4x, &#39;OPENED ON UNIT: &#39;, I7)&quot;</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtflow2 = &amp;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                   <span class="stringliteral">&quot;(4x, &#39;FLOWS WILL BE SAVED TO BUDGET FILE SPECIFIED IN OUTPUT CONTROL&#39;)&quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtssessv = &amp;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                   <span class="stringliteral">&quot;(4x, &#39;USING SSE AND SSV INSTEAD OF CR AND CC.&#39;)&quot;</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtoffset = &amp;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                   <span class="stringliteral">&quot;(4x, &#39;INITIAL_STRESS TREATED AS AN OFFSET.&#39;)&quot;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtopt = &amp;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                   <span class="stringliteral">&quot;(4x, A)&quot;</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtopti = &amp;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                   <span class="stringliteral">&quot;(4x, A, 1X, I0)&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtoptr = &amp;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                   <span class="stringliteral">&quot;(4x, A, 1X, G0)&quot;</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtfileout = &amp;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                   <span class="stringliteral">&quot;(4x, &#39;CSUB &#39;, 1x, a, 1x, &#39; WILL BE SAVED TO FILE: &#39;, a, /4x, &#39;OPENED ON UNIT: &#39;, I7)&quot;</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    ibrg = 0</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    ieslag = 0</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    isetgamma = 0</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, blockrequired=.false., &amp;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING CSUB OPTIONS&#39;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;AUX&#39;</span>, <span class="stringliteral">&#39;AUXILIARY&#39;</span>)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          <span class="keyword">call </span>this%parser%GetRemainingLine(line)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          lloc = 1</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99">urdaux</a>(this%naux, this%parser%iuactive, this%iout, lloc, &amp;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                      istart, istop, caux, line, this%packName)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%auxname, lenauxname, this%naux, &amp;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                            <span class="stringliteral">&#39;AUXNAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="keywordflow">do</span> n = 1, this%naux</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            this%auxname(n) = caux(n)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          <span class="keyword">deallocate</span> (caux)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SAVE_FLOWS&#39;</span>)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          this%ipakcb = -1</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <span class="keyword">write</span> (this%iout, fmtflow2)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRINT_INPUT&#39;</span>)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          this%iprpak = 1</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) <span class="stringliteral">&#39;LISTS OF &#39;</span>//trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="stringliteral">&#39; CELLS WILL BE PRINTED.&#39;</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRINT_FLOWS&#39;</span>)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          this%iprflow = 1</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="stringliteral">&#39; FLOWS WILL BE PRINTED TO LISTING FILE.&#39;</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BOUNDNAMES&#39;</span>)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          this%inamedbound = 1</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) trim(adjustl(this%packName))// &amp;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="stringliteral">&#39; BOUNDARIES HAVE NAMES IN LAST COLUMN.&#39;</span>          <span class="comment">! user specified boundnames</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;TS6&#39;</span>)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(keyword)) /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            errmsg = <span class="stringliteral">&#39;TS6 keyword must be followed by &quot;FILEIN&quot; &#39;</span>// &amp;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                     <span class="stringliteral">&#39;then by filename.&#39;</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="keyword">write</span> (this%iout, fmtts) trim(fname)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          <span class="keyword">call </span>this%TsManager%add_tsfile(fname, this%inunit)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OBS6&#39;</span>)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(keyword)) /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            errmsg = <span class="stringliteral">&#39;OBS6 keyword must be followed by &quot;FILEIN&quot; &#39;</span>// &amp;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                     <span class="stringliteral">&#39;then by filename.&#39;</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="keywordflow">if</span> (this%obs%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            errmsg = <span class="stringliteral">&#39;Multiple OBS6 keywords detected in OPTIONS block. &#39;</span>// &amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                     <span class="stringliteral">&#39;Only one OBS6 entry allowed for a package.&#39;</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          this%obs%active = .true.</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <span class="keyword">call </span>this%parser%GetString(this%obs%inputFilename)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          inobs = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(inobs, this%iout, this%obs%inputFilename, <span class="stringliteral">&#39;OBS&#39;</span>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          this%obs%inUnitObs = inobs</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;          this%inobspkg = inobs</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          <span class="keyword">call </span>this%obs%obs_df(this%iout, this%packName, this%filtyp, this%dis)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          <span class="keyword">call </span>this%csub_df_obs()</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          <span class="comment">! -- CSUB specific options</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GAMMAW&#39;</span>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          this%gammaw = this%parser%GetDouble()</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          ibrg = 1</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BETA&#39;</span>)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          this%beta = this%parser%GetDouble()</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          ibrg = 1</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;HEAD_BASED&#39;</span>)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          this%ipch = 1</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          this%lhead_based = .true.</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INITIAL_PRECONSOLIDATION_HEAD&#39;</span>)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;          this%ipch = 1</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NDELAYCELLS&#39;</span>)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          this%ndelaycells = this%parser%GetInteger()</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;          <span class="comment">! -- compression indicies (CR amd CC) will be specified instead of</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          <span class="comment">!    storage coefficients (SSE and SSV)</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPRESSION_INDICES&#39;</span>)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          this%istoragec = 0</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <span class="comment">! -- variable thickness and void ratio</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UPDATE_MATERIAL_PROPERTIES&#39;</span>)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          this%iupdatematprop = 1</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          <span class="comment">! -- cell fraction will be specified instead of interbed thickness</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CELL_FRACTION&#39;</span>)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          this%icellf = 1</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          <span class="comment">! -- specified initial pcs and delay bed heads</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SPECIFIED_INITIAL_INTERBED_STATE&#39;</span>)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          this%ispecified_pcs = 1</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          this%ispecified_dbh = 1</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          <span class="comment">! -- specified initial pcs</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SPECIFIED_INITIAL_PRECONSOLIDATION_STRESS&#39;</span>)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          this%ispecified_pcs = 1</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="comment">! -- specified initial delay bed heads</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SPECIFIED_INITIAL_DELAY_HEAD&#39;</span>)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          this%ispecified_dbh = 1</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          <span class="comment">! -- lag the effective stress used to calculate storage properties</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;EFFECTIVE_STRESS_LAG&#39;</span>)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          ieslag = 1</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="comment">! -- strain table options</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;STRAIN_CSV_INTERBED&#39;</span>)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            this%istrainib = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%istrainib, this%iout, fname, <span class="stringliteral">&#39;CSV_OUTPUT&#39;</span>, &amp;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>, mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;              <span class="stringliteral">&#39;INTERBED STRAIN CSV&#39;</span>, fname, this%istrainib</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional STRAIN_CSV_INTERBED keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;STRAIN_CSV_COARSE&#39;</span>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            this%istrainsk = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%istrainsk, this%iout, fname, <span class="stringliteral">&#39;CSV_OUTPUT&#39;</span>, &amp;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>, mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;              <span class="stringliteral">&#39;COARSE STRAIN CSV&#39;</span>, fname, this%istrainsk</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional STRAIN_CSV_COARSE keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                     <span class="stringliteral">&#39;followed by fileout.&#39;</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          <span class="comment">! -- compaction output</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPACTION&#39;</span>)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            this%ioutcomp = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutcomp, this%iout, fname, <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, &amp;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                          <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;              <span class="stringliteral">&#39;COMPACTION&#39;</span>, fname, this%ioutcomp</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional COMPACTION keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPACTION_INELASTIC&#39;</span>)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            this%ioutcompi = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutcompi, this%iout, fname, &amp;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                          <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, &amp;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                          mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;              <span class="stringliteral">&#39;COMPACTION_INELASTIC&#39;</span>, fname, this%ioutcompi</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional COMPACTION_INELASTIC keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                     <span class="stringliteral">&#39;followed by fileout.&#39;</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPACTION_ELASTIC&#39;</span>)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            this%ioutcompe = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutcompe, this%iout, fname, &amp;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                          <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, &amp;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                          mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;              <span class="stringliteral">&#39;COMPACTION_ELASTIC&#39;</span>, fname, this%ioutcompe</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional COMPACTION_ELASTIC keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPACTION_INTERBED&#39;</span>)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            this%ioutcompib = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutcompib, this%iout, fname, &amp;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                          <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, &amp;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                          mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;              <span class="stringliteral">&#39;COMPACTION_INTERBED&#39;</span>, fname, this%ioutcompib</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional COMPACTION_INTERBED keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPACTION_COARSE&#39;</span>)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            this%ioutcomps = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutcomps, this%iout, fname, &amp;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                          <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, &amp;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                          mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;              <span class="stringliteral">&#39;COMPACTION_COARSE&#39;</span>, fname, this%ioutcomps</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional COMPACTION_COARSE keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          <span class="comment">! -- zdisplacement output</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ZDISPLACEMENT&#39;</span>)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            this%ioutzdisp = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutzdisp, this%iout, fname, &amp;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                          <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, &amp;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                          mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;              <span class="stringliteral">&#39;ZDISPLACEMENT&#39;</span>, fname, this%ioutzdisp</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional ZDISPLACEMENT keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          <span class="comment">! -- package convergence</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PACKAGE_CONVERGENCE&#39;</span>)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            this%ipakcsv = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ipakcsv, this%iout, fname, <span class="stringliteral">&#39;CSV&#39;</span>, &amp;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>, mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) <span class="stringliteral">&#39;PACKAGE_CONVERGENCE&#39;</span>, fname, this%ipakcsv</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(<span class="stringliteral">&#39;Optional PACKAGE_CONVERGENCE keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                             <span class="stringliteral">&#39;followed by FILEOUT.&#39;</span>)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="comment">! -- right now these are options that are only available in the</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;          <span class="comment">!    development version and are not included in the documentation.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="comment">!    These options are only available when IDEVELOPMODE in</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;          <span class="comment">!    constants module is set to 1</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEV_NO_FINAL_CHECK&#39;</span>)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          this%iconvchk = 0</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="stringliteral">&#39;A FINAL CONVERGENCE CHECK OF THE CHANGE IN DELAY INTERBED &#39;</span>// &amp;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="stringliteral">&#39;HEADS AND FLOWS WILL NOT BE MADE&#39;</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="comment">! default case</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a,3(1x,a),a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="stringliteral">&#39;Unknown&#39;</span>, trim(adjustl(this%packName)), <span class="stringliteral">&quot;option &#39;&quot;</span>, &amp;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            trim(keyword), <span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="stringliteral">&#39;END OF &#39;</span>//trim(adjustl(this%packName))//<span class="stringliteral">&#39; OPTIONS&#39;</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">! -- write messages for options</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(//2(1X,A))&#39;</span>) trim(adjustl(this%packName)), &amp;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="stringliteral">&#39;PACKAGE SETTINGS&#39;</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keyword">write</span> (this%iout, fmtopti) <span class="stringliteral">&#39;NUMBER OF DELAY CELLS =&#39;</span>, &amp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      this%ndelaycells</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (this%lhead_based .EQV. .true.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="stringliteral">&#39;HEAD-BASED FORMULATION&#39;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="stringliteral">&#39;EFFECTIVE-STRESS FORMULATION&#39;</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">if</span> (this%istoragec == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="stringliteral">&#39;COMPRESSION INDICES WILL BE SPECIFIED INSTEAD OF ELASTIC AND&#39;</span>, &amp;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="stringliteral">&#39;INELASTIC SPECIFIC STORAGE COEFFICIENTS&#39;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="stringliteral">&#39;ELASTIC AND INELASTIC SPECIFIC STORAGE COEFFICIENTS WILL BE &#39;</span>, &amp;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="stringliteral">&#39;SPECIFIED&#39;</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">if</span> (this%iupdatematprop /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="stringliteral">&#39;THICKNESS AND VOID RATIO WILL NOT BE ADJUSTED DURING THE&#39;</span>, &amp;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="stringliteral">&#39;SIMULATION&#39;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="stringliteral">&#39;THICKNESS AND VOID RATIO WILL BE ADJUSTED DURING THE SIMULATION&#39;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">if</span> (this%icellf /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="stringliteral">&#39;INTERBED THICKNESS WILL BE SPECIFIED AS A THICKNESS&#39;</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="stringliteral">&#39;INTERBED THICKNESS WILL BE SPECIFIED AS A AS A CELL FRACTION&#39;</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (this%ispecified_pcs /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">if</span> (this%ipch /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;          <span class="stringliteral">&#39;PRECONSOLIDATION HEAD WILL BE SPECIFIED RELATIVE TO INITIAL&#39;</span>, &amp;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;          <span class="stringliteral">&#39;STRESS CONDITIONS&#39;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <span class="stringliteral">&#39;PRECONSOLIDATION STRESS WILL BE SPECIFIED RELATIVE TO INITIAL&#39;</span>, &amp;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          <span class="stringliteral">&#39;STRESS CONDITIONS&#39;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">if</span> (this%ipch /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          <span class="stringliteral">&#39;PRECONSOLIDATION HEAD WILL BE SPECIFIED AS ABSOLUTE VALUES&#39;</span>, &amp;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          <span class="stringliteral">&#39;INSTEAD OF RELATIVE TO INITIAL HEAD CONDITIONS&#39;</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;          <span class="stringliteral">&#39;PRECONSOLIDATION STRESS WILL BE SPECIFIED AS ABSOLUTE VALUES&#39;</span>, &amp;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;          <span class="stringliteral">&#39;INSTEAD OF RELATIVE TO INITIAL STRESS CONDITIONS&#39;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span> (this%ispecified_dbh /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="stringliteral">&#39;DELAY INTERBED HEADS WILL BE SPECIFIED RELATIVE TO INITIAL &#39;</span>, &amp;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="stringliteral">&#39;GWF HEADS&#39;</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="stringliteral">&#39;DELAY INTERBED HEADS WILL BE SPECIFIED AS ABSOLUTE VALUES INSTEAD&#39;</span>, &amp;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="stringliteral">&#39;OF RELATIVE TO INITIAL GWF HEADS&#39;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">! -- process effective_stress_lag, if effective stress formulation</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (this%lhead_based .EQV. .false.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">if</span> (ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;          <span class="stringliteral">&#39;SPECIFIC STORAGE VALUES WILL BE CALCULATED USING THE EFFECTIVE&#39;</span>, &amp;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;          <span class="stringliteral">&#39;STRESS FROM THE PREVIOUS TIME STEP&#39;</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="stringliteral">&#39;SPECIFIC STORAGE VALUES WILL BE CALCULATED USING THE CURRENT&#39;</span>, &amp;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          <span class="stringliteral">&#39;EFFECTIVE STRESS&#39;</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="keywordflow">if</span> (ieslag /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        ieslag = 0</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,2(/,6x,a))&#39;</span>) &amp;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;          <span class="stringliteral">&#39;EFFECTIVE_STRESS_LAG HAS BEEN SPECIFIED BUT HAS NO EFFECT WHEN USING&#39;</span>, &amp;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;          <span class="stringliteral">&#39;THE HEAD-BASED FORMULATION (HEAD_BASED HAS BEEN SPECIFIED IN THE&#39;</span>, &amp;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          <span class="stringliteral">&#39;OPTIONS BLOCK)&#39;</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    this%ieslag = ieslag</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">! -- recalculate BRG if necessary and output</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="comment">!    water compressibility values</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">if</span> (ibrg /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      this%brg = this%gammaw*this%beta</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keyword">write</span> (this%iout, fmtoptr) <span class="stringliteral">&#39;GAMMAW        =&#39;</span>, this%gammaw</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keyword">write</span> (this%iout, fmtoptr) <span class="stringliteral">&#39;BETA          =&#39;</span>, this%beta</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keyword">write</span> (this%iout, fmtoptr) <span class="stringliteral">&#39;GAMMAW * BETA =&#39;</span>, this%brg</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">! -- terminate if errors encountered in reach block</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfcsubmodule_a1576ca3a5da563e697ae4e94e64af607_cgraph.png" border="0" usemap="#namespacegwfcsubmodule_a1576ca3a5da563e697ae4e94e64af607_cgraph" alt=""/></div>
<map name="namespacegwfcsubmodule_a1576ca3a5da563e697ae4e94e64af607_cgraph" id="namespacegwfcsubmodule_a1576ca3a5da563e697ae4e94e64af607_cgraph">
<area shape="rect" title="@ brief Read options for package" alt="" coords="5,141,168,182"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="216,5,400,32"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="231,107,385,149"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title=" " alt="" coords="231,173,385,214"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="667,173,841,200"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="685,316,823,343"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99" title=" " alt="" coords="231,393,385,434"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="448,107,603,149"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="448,225,603,266"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="905,309,1073,350"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="905,243,1073,285"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="1121,316,1316,343"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1135,367,1303,409"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title=" " alt="" coords="448,393,603,434"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title=" " alt="" coords="677,426,831,467"/>
<area shape="rect" href="namespacesimmodule.html#a1c78a6fda06b630c738bb654aa6bd816" title=" " alt="" coords="651,492,857,519"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a136ee84d957d82663b3c6aa37438586a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136ee84d957d82663b3c6aa37438586a">&#9670;&nbsp;</a></span>budtxt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenbudtxt), dimension(4) gwfcsubmodule::budtxt = [' CSUB-CGELASTIC', ' CSUB-ELASTIC', ' CSUB-INELASTIC', ' CSUB-WATERCOMP']</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l00042">42</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(4)</span> :: budtxt = &amp; !&lt; text labels for budget terms</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                            [<span class="stringliteral">&#39; CSUB-CGELASTIC&#39;</span>, &amp;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                             <span class="stringliteral">&#39;   CSUB-ELASTIC&#39;</span>, <span class="stringliteral">&#39; CSUB-INELASTIC&#39;</span>, &amp;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                             <span class="stringliteral">&#39; CSUB-WATERCOMP&#39;</span>]</div>
</div><!-- fragment -->
</div>
</div>
<a id="aecd151aed99f0a2c63cf0129679ca9e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd151aed99f0a2c63cf0129679ca9e2">&#9670;&nbsp;</a></span>comptxt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenbudtxt), dimension(6) gwfcsubmodule::comptxt = ['CSUB-COMPACTION', ' CSUB-INELASTIC', ' CSUB-ELASTIC', ' CSUB-INTERBED', ' CSUB-COARSE', ' CSUB-ZDISPLACE']</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l00046">46</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(6)</span> :: comptxt = &amp; !&lt; text labels for compaction terms</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                            [<span class="stringliteral">&#39;CSUB-COMPACTION&#39;</span>, <span class="stringliteral">&#39; CSUB-INELASTIC&#39;</span>, <span class="stringliteral">&#39;   CSUB-ELASTIC&#39;</span>, &amp;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                             <span class="stringliteral">&#39;  CSUB-INTERBED&#39;</span>, <span class="stringliteral">&#39;    CSUB-COARSE&#39;</span>, <span class="stringliteral">&#39; CSUB-ZDISPLACE&#39;</span>]</div>
</div><!-- fragment -->
</div>
</div>
<a id="a96bf9f5d28ae75e537251a99e0fa1d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96bf9f5d28ae75e537251a99e0fa1d4c">&#9670;&nbsp;</a></span>dlog10es</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), parameter gwfcsubmodule::dlog10es = 0.4342942_DP</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3csub8_8f90_source.html#l00052">52</a> of file <a class="el" href="gwf3csub8_8f90_source.html">gwf3csub8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">parameter</span> :: dlog10es = 0.4342942_dp                                 <span class="comment">!&lt; derivative of the log of effective stress</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacekindmodule_html"><div class="ttname"><a href="namespacekindmodule.html">kindmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="kind_8f90_source.html#l00001">kind.f90:1</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00045">Constants.f90:45</a></div></div>
<div class="ttc" id="anamespacetimeseriesmanagermodule_html"><div class="ttname"><a href="namespacetimeseriesmanagermodule.html">timeseriesmanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_time_series_manager_8f90_source.html#l00001">TimeSeriesManager.f90:1</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a536cb6f0e13fcd33755e414641ff931a"><div class="ttname"><a href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg)</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00107">Sim.f90:107</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html_a917d4897942de165ea88d0c1f0850d8e"><div class="ttname"><a href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">budgetmodule::rate_accumulator</a></div><div class="ttdeci">subroutine, public rate_accumulator(flow, rin, rout)</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00641">Budget.f90:641</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a12462c53c53955327093c22ab7b89d99"><div class="ttname"><a href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99">inputoutputmodule::urdaux</a></div><div class="ttdeci">subroutine, public urdaux(naux, inunit, iout, lloc, istart, istop, auxname, line, text)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l01801">InputOutput.f90:1801</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html"><div class="ttname"><a href="namespaceopenspecmodule.html">openspecmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00001">OpenSpec.f90:1</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_a3791dbc2d4a06a0b9112158cff21f738"><div class="ttname"><a href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:21</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a060d310ded5535ce2dc85bd1ca1afd3d"><div class="ttname"><a href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">constantsmodule::linelength</a></div><div class="ttdeci">integer(i4b), parameter linelength</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00028">Constants.f90:28</a></div></div>
<div class="ttc" id="anamespacetimeseriesmanagermodule_html_a2075a4c123cb1167bfbdaaf4ceae7666"><div class="ttname"><a href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">timeseriesmanagermodule::read_value_or_time_series_adv</a></div><div class="ttdeci">subroutine, public read_value_or_time_series_adv(textInput, ii, jj, bndElem, pkgName, auxOrBnd, tsManager, iprpak, varName)</div><div class="ttdef"><b>Definition:</b> <a href="_time_series_manager_8f90_source.html#l00658">TimeSeriesManager.f90:658</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a0be97214c1d4fcf42bc4ddc27b111b61"><div class="ttname"><a href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">simmodule::ustop</a></div><div class="ttdeci">subroutine, public ustop(stopmess, ioutlocal)</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00324">Sim.f90:324</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00208">InputOutput.f90:208</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_a5f22ad41ccf3be8d4bb899e8a1834ff4"><div class="ttname"><a href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">tdismodule::totim</a></div><div class="ttdeci">real(dp), pointer, public totim</div><div class="ttdoc">time relative to start of simulation</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00032">tdis.f90:32</a></div></div>
<div class="ttc" id="anamespacesmoothingmodule_html_a0ee42e035a1831565d3132d8929eb67c"><div class="ttname"><a href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c">smoothingmodule::squadraticsaturationderivative</a></div><div class="ttdeci">real(dp) function squadraticsaturationderivative(top, bot, x, eps, bmin)</div><div class="ttdef"><b>Definition:</b> <a href="_smoothing_functions_8f90_source.html#l00418">SmoothingFunctions.f90:418</a></div></div>
<div class="ttc" id="anamespacekindmodule_html_a2f6861418b5e7d3d602b77228232a470"><div class="ttname"><a href="namespacekindmodule.html#a2f6861418b5e7d3d602b77228232a470">kindmodule::i4b</a></div><div class="ttdeci">integer, parameter i4b</div><div class="ttdef"><b>Definition:</b> <a href="kind_8f90_source.html#l00009">kind.f90:9</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_aa63ca3273e52df46471c4746566f46bd"><div class="ttname"><a href="namespaceconstantsmodule.html#aa63ca3273e52df46471c4746566f46bd">constantsmodule::lenboundname</a></div><div class="ttdeci">integer(i4b), parameter lenboundname</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00019">Constants.f90:19</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__setptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__setptr.html">memorymanagermodule::mem_setptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00069">MemoryManager.f90:69</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html"><div class="ttname"><a href="namespacebudgetmodule.html">budgetmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00019">Budget.f90:19</a></div></div>
<div class="ttc" id="astructbudgetmodule_1_1budgettype_html"><div class="ttname"><a href="structbudgetmodule_1_1budgettype.html">budgetmodule::budgettype</a></div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00031">Budget.f90:31</a></div></div>
<div class="ttc" id="anamespacetablemodule_html_a7632d784ec9e94277a76705ef56725f2"><div class="ttname"><a href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">tablemodule::table_cr</a></div><div class="ttdeci">subroutine, public table_cr(this, name, title)</div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00084">Table.f90:84</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f"><div class="ttname"><a href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">constantsmodule::mnormal</a></div><div class="ttdeci">@ mnormal</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00140">Constants.f90:140</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00001">Constants.f90:1</a></div></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_afd8781393621765a2e864a230a23da50"><div class="ttname"><a href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">tdismodule::nper</a></div><div class="ttdeci">integer(i4b), pointer, public nper</div><div class="ttdoc">number of stress period</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00022">tdis.f90:22</a></div></div>
<div class="ttc" id="anamespacetimeseriesmanagermodule_html_abd6baa3f1522c5c5dff9f8fd8d53fb58"><div class="ttname"><a href="namespacetimeseriesmanagermodule.html#abd6baa3f1522c5c5dff9f8fd8d53fb58">timeseriesmanagermodule::tsmanager_cr</a></div><div class="ttdeci">subroutine, public tsmanager_cr(this, iout, removeTsLinksOnCompletion, extendTsToEndOfSimulation)</div><div class="ttdef"><b>Definition:</b> <a href="_time_series_manager_8f90_source.html#l00059">TimeSeriesManager.f90:59</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_ade3198b3fa7a2972dae70d888f866536"><div class="ttname"><a href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">openspecmodule::form</a></div><div class="ttdeci">character(len=20) form</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_a5cd9b8ccff306158f81ed8cc744b1e46"><div class="ttname"><a href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">openspecmodule::access</a></div><div class="ttdeci">character(len=20) access</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae9a8dbe15bd2bcb8a85d53d570407ae6"><div class="ttname"><a href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">tdismodule::delt</a></div><div class="ttdeci">real(dp), pointer, public delt</div><div class="ttdoc">length of the current time step</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00030">tdis.f90:30</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00034">InputOutput.f90:34</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_ac9c1da291f7c6bfb35a47957c588ab20"><div class="ttname"><a href="namespaceconstantsmodule.html#ac9c1da291f7c6bfb35a47957c588ab20">constantsmodule::maxcharlen</a></div><div class="ttdeci">integer(i4b), parameter maxcharlen</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00030">Constants.f90:30</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_af918ac22cd0b232deea67660bfbc9ce1"><div class="ttname"><a href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">constantsmodule::done</a></div><div class="ttdeci">real(dp), parameter done</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00056">Constants.f90:56</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegwfcsubmodule.html">gwfcsubmodule</a></li>
    <li class="footer">Generated on Fri Jun 11 2021 22:03:01 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
