<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: gwtistmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacegwtistmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gwtistmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>&ndash; @ brief Immobile Storage and Transfer (IST) Module  
<a href="namespacegwtistmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Immobile storage and transfer  <a href="structgwtistmodule_1_1gwtisttype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a68d5d648825cc85b757caa72dfcf462a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a68d5d648825cc85b757caa72dfcf462a">ist_create</a> (packobj, id, ibcnum, inunit, iout, namemodel, pakname, fmi, mst)</td></tr>
<tr class="memdesc:a68d5d648825cc85b757caa72dfcf462a"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new package object  <a href="namespacegwtistmodule.html#a68d5d648825cc85b757caa72dfcf462a">More...</a><br /></td></tr>
<tr class="separator:a68d5d648825cc85b757caa72dfcf462a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec4957a4392e2394289597478328dd0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aaec4957a4392e2394289597478328dd0">ist_ar</a> (this)</td></tr>
<tr class="memdesc:aaec4957a4392e2394289597478328dd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read method for package  <a href="namespacegwtistmodule.html#aaec4957a4392e2394289597478328dd0">More...</a><br /></td></tr>
<tr class="separator:aaec4957a4392e2394289597478328dd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513b002303b3cb2d9394130bfa927663"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a513b002303b3cb2d9394130bfa927663">ist_rp</a> (this)</td></tr>
<tr class="memdesc:a513b002303b3cb2d9394130bfa927663"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read and prepare method for package  <a href="namespacegwtistmodule.html#a513b002303b3cb2d9394130bfa927663">More...</a><br /></td></tr>
<tr class="separator:a513b002303b3cb2d9394130bfa927663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae036b3aa4f13696f131c99e63b8fed7a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ae036b3aa4f13696f131c99e63b8fed7a">ist_ad</a> (this)</td></tr>
<tr class="memdesc:ae036b3aa4f13696f131c99e63b8fed7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance the ist package  <a href="namespacegwtistmodule.html#ae036b3aa4f13696f131c99e63b8fed7a">More...</a><br /></td></tr>
<tr class="separator:ae036b3aa4f13696f131c99e63b8fed7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c321f840348165c87503d0d1165a6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a37c321f840348165c87503d0d1165a6e">ist_fc</a> (this, rhs, ia, idxglo, amatsln)</td></tr>
<tr class="memdesc:a37c321f840348165c87503d0d1165a6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill coefficient method for package  <a href="namespacegwtistmodule.html#a37c321f840348165c87503d0d1165a6e">More...</a><br /></td></tr>
<tr class="separator:a37c321f840348165c87503d0d1165a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada94becde756a937e3b9e970a31de656"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656">ist_cq</a> (this, x, flowja, iadv)</td></tr>
<tr class="memdesc:ada94becde756a937e3b9e970a31de656"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate package flows.  <a href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656">More...</a><br /></td></tr>
<tr class="separator:ada94becde756a937e3b9e970a31de656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae29f3d0e014cba69c1aa21c6a74afa89"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ae29f3d0e014cba69c1aa21c6a74afa89">ist_bd</a> (this, model_budget)</td></tr>
<tr class="memdesc:ae29f3d0e014cba69c1aa21c6a74afa89"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add package flows to model budget.  <a href="namespacegwtistmodule.html#ae29f3d0e014cba69c1aa21c6a74afa89">More...</a><br /></td></tr>
<tr class="separator:ae29f3d0e014cba69c1aa21c6a74afa89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa763b6b80ea78e794aaa4b1e1d8930ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aa763b6b80ea78e794aaa4b1e1d8930ec">ist_ot_model_flows</a> (this, icbcfl, ibudfl, icbcun, imap)</td></tr>
<tr class="memdesc:aa763b6b80ea78e794aaa4b1e1d8930ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output model flow terms.  <a href="namespacegwtistmodule.html#aa763b6b80ea78e794aaa4b1e1d8930ec">More...</a><br /></td></tr>
<tr class="separator:aa763b6b80ea78e794aaa4b1e1d8930ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeaca165685a01879fb09532d3e5d9e8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#abeaca165685a01879fb09532d3e5d9e8">ist_ot_dv</a> (this, idvsave, idvprint)</td></tr>
<tr class="memdesc:abeaca165685a01879fb09532d3e5d9e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output immobile domain concentration.  <a href="namespacegwtistmodule.html#abeaca165685a01879fb09532d3e5d9e8">More...</a><br /></td></tr>
<tr class="separator:abeaca165685a01879fb09532d3e5d9e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97f641a9ceaed508d1d7a050212ce5f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ab97f641a9ceaed508d1d7a050212ce5f">ist_ot_bdsummary</a> (this, kstp, kper, iout, ibudfl)</td></tr>
<tr class="memdesc:ab97f641a9ceaed508d1d7a050212ce5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output IST package budget summary.  <a href="namespacegwtistmodule.html#ab97f641a9ceaed508d1d7a050212ce5f">More...</a><br /></td></tr>
<tr class="separator:ab97f641a9ceaed508d1d7a050212ce5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f50268c35442b91ea1d8b895ef7271c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a0f50268c35442b91ea1d8b895ef7271c">ist_da</a> (this)</td></tr>
<tr class="memdesc:a0f50268c35442b91ea1d8b895ef7271c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate package memory  <a href="namespacegwtistmodule.html#a0f50268c35442b91ea1d8b895ef7271c">More...</a><br /></td></tr>
<tr class="separator:a0f50268c35442b91ea1d8b895ef7271c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa3a8e269ee0d09d8d4e33b5eb7391e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aaaa3a8e269ee0d09d8d4e33b5eb7391e">allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:aaaa3a8e269ee0d09d8d4e33b5eb7391e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate package scalars  <a href="namespacegwtistmodule.html#aaaa3a8e269ee0d09d8d4e33b5eb7391e">More...</a><br /></td></tr>
<tr class="separator:aaaa3a8e269ee0d09d8d4e33b5eb7391e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad885bba7122d4e3d9b9511ca820f10c8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ad885bba7122d4e3d9b9511ca820f10c8">ist_allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:ad885bba7122d4e3d9b9511ca820f10c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate package arrays  <a href="namespacegwtistmodule.html#ad885bba7122d4e3d9b9511ca820f10c8">More...</a><br /></td></tr>
<tr class="separator:ad885bba7122d4e3d9b9511ca820f10c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8cd450ab5f646649ed562d52cdda268"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#af8cd450ab5f646649ed562d52cdda268">read_options</a> (this)</td></tr>
<tr class="memdesc:af8cd450ab5f646649ed562d52cdda268"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read options for package  <a href="namespacegwtistmodule.html#af8cd450ab5f646649ed562d52cdda268">More...</a><br /></td></tr>
<tr class="separator:af8cd450ab5f646649ed562d52cdda268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8042e00c4dee75f0865a5467509490d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aa8042e00c4dee75f0865a5467509490d">ist_read_dimensions</a> (this)</td></tr>
<tr class="memdesc:aa8042e00c4dee75f0865a5467509490d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read dimensions for package  <a href="namespacegwtistmodule.html#aa8042e00c4dee75f0865a5467509490d">More...</a><br /></td></tr>
<tr class="separator:aa8042e00c4dee75f0865a5467509490d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada17d3ef6a3a0fa2740662cdad8c5e00"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ada17d3ef6a3a0fa2740662cdad8c5e00">read_data</a> (this)</td></tr>
<tr class="memdesc:ada17d3ef6a3a0fa2740662cdad8c5e00"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read data for package  <a href="namespacegwtistmodule.html#ada17d3ef6a3a0fa2740662cdad8c5e00">More...</a><br /></td></tr>
<tr class="separator:ada17d3ef6a3a0fa2740662cdad8c5e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba6bb9e373947549332354cfb94457a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aba6bb9e373947549332354cfb94457a1">get_ddterm</a> (thetaim, vcell, delt, swtpdt, thetaimfrac, rhob, kd, lambda1im, lambda2im, gamma1im, gamma2im, zetaim, ddterm, f)</td></tr>
<tr class="memdesc:aba6bb9e373947549332354cfb94457a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate immobile domain equation terms  <a href="namespacegwtistmodule.html#aba6bb9e373947549332354cfb94457a1">More...</a><br /></td></tr>
<tr class="separator:aba6bb9e373947549332354cfb94457a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e8f00f26c4919ec014f2318ac2d60e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a82e8f00f26c4919ec014f2318ac2d60e">get_hcofrhs</a> (ddterm, f, cimold, hcof, rhs)</td></tr>
<tr class="memdesc:a82e8f00f26c4919ec014f2318ac2d60e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the hcof and rhs terms for immobile domain  <a href="namespacegwtistmodule.html#a82e8f00f26c4919ec014f2318ac2d60e">More...</a><br /></td></tr>
<tr class="separator:a82e8f00f26c4919ec014f2318ac2d60e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51843401d128c303b6b238be12118cb7"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a51843401d128c303b6b238be12118cb7">get_ddconc</a> (ddterm, f, cimold, cnew)</td></tr>
<tr class="memdesc:a51843401d128c303b6b238be12118cb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the immobile domain concentration  <a href="namespacegwtistmodule.html#a51843401d128c303b6b238be12118cb7">More...</a><br /></td></tr>
<tr class="separator:a51843401d128c303b6b238be12118cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c89f1f938ece51e3858ab650f803de"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#ae1c89f1f938ece51e3858ab650f803de">accumulate_budterm</a> (budterm, ddterm, cimnew, cimold, cnew, idcy)</td></tr>
<tr class="memdesc:ae1c89f1f938ece51e3858ab650f803de"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the immobile domain budget terms  <a href="namespacegwtistmodule.html#ae1c89f1f938ece51e3858ab650f803de">More...</a><br /></td></tr>
<tr class="separator:ae1c89f1f938ece51e3858ab650f803de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aacc01093936348bbdb8565f98faad71a"><td class="memItemLeft" align="right" valign="top">character(len=lenftype)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aacc01093936348bbdb8565f98faad71a">ftype</a> = 'IST'</td></tr>
<tr class="separator:aacc01093936348bbdb8565f98faad71a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff073c698fc57a0b26f81614665b8e49"><td class="memItemLeft" align="right" valign="top">character(len=lenpackagename)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#aff073c698fc57a0b26f81614665b8e49">text</a> = ' IMMOBILE DOMAIN'</td></tr>
<tr class="separator:aff073c698fc57a0b26f81614665b8e49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92661d68c115592344e5e54c62b4ac86"><td class="memItemLeft" align="right" valign="top">integer(i4b), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#a92661d68c115592344e5e54c62b4ac86">nbditems</a> = 5</td></tr>
<tr class="separator:a92661d68c115592344e5e54c62b4ac86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7dec5c53d3b8bf6e8041f314cd1e4a3"><td class="memItemLeft" align="right" valign="top">character(len=lenbudtxt), dimension(<a class="el" href="namespacegwtistmodule.html#a92661d68c115592344e5e54c62b4ac86">nbditems</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtistmodule.html#af7dec5c53d3b8bf6e8041f314cd1e4a3">budtxt</a></td></tr>
<tr class="separator:af7dec5c53d3b8bf6e8041f314cd1e4a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The GwtIstModule is contains the GwtIstType, which is the derived type responsible for adding the effects of an immobile domain. In addition to representing transfer of mass between the mobile and immobile domain, the IST Package also represents the following processes within the immobile domain</p><ol type="1">
<li>Changes in dissolved solute mass</li>
<li>Decay of dissolved solute mass</li>
<li>Sorption</li>
<li>Decay of sorbed solute mass </li>
</ol>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae1c89f1f938ece51e3858ab650f803de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c89f1f938ece51e3858ab650f803de">&#9670;&nbsp;</a></span>accumulate_budterm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::accumulate_budterm </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:, :), intent(inout)&#160;</td>
          <td class="paramname"><em>budterm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ddterm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cimnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cimold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idcy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This subroutine calculates and accumulates the immobile domain budget terms into the budterm accumulator </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ddterm</td><td>terms comprising the balance equation of the immobile domain </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cimnew</td><td>immobile domain concenration at the end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cimold</td><td>immobile domain concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>mobile domain concentration at the end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idcy</td><td>order of decay rate (0:none, 1:first, 2:zero) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l01233">1233</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:, :)</span>, <span class="keywordtype">intent(inout)</span> :: budterm<span class="comment">  !&lt; </span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ddterm<span class="comment">         !&lt; terms comprising the balance equation of the immobile domain</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cimnew<span class="comment">                       !&lt; immobile domain concenration at the end of this time step</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cimold<span class="comment">                       !&lt; immobile domain concentration at end of last time step</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cnew<span class="comment">                         !&lt; mobile domain concentration at the end of this time step</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idcy<span class="comment">                     !&lt; order of decay rate (0:none, 1:first, 2:zero)</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">! -- calculate STORAGE-AQUEOUS</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    i = 1</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    rate = - ddterm(1) * cimnew + ddterm(2) * cimold</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">if</span> (rate &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      budterm(1, i) = budterm(1, i) + rate</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      budterm(2, i) = budterm(2, i) - rate</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">! -- calculate STORAGE-SORBED</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    i = 2</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    rate = - ddterm(3) * cimnew + ddterm(4) * cimold</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span> (rate &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      budterm(1, i) = budterm(1, i) + rate</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      budterm(2, i) = budterm(2, i) - rate</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">! -- calculate DECAY-AQUEOUS</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    i = 3</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    rate = dzero</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">if</span> (idcy == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      rate = - ddterm(5) * cimnew</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      rate = - ddterm(7)</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      rate = dzero</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">if</span> (rate &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      budterm(1, i) = budterm(1, i) + rate</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      budterm(2, i) = budterm(2, i) - rate</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">! -- calculate DECAY-SORBED</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    i = 4</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">if</span> (idcy == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      rate = - ddterm(6) * cimnew</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      rate = - ddterm(8)</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      rate = dzero</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordflow">if</span> (rate &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      budterm(1, i) = budterm(1, i) + rate</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      budterm(2, i) = budterm(2, i) - rate</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">! -- calculate MOBILE-DOMAIN</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    i = 5</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    rate = ddterm(9) * cnew - ddterm(9) * cimnew</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">if</span> (rate &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      budterm(1, i) = budterm(1, i) + rate</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      budterm(2, i) = budterm(2, i) - rate</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_ae1c89f1f938ece51e3858ab650f803de_icgraph.png" border="0" usemap="#namespacegwtistmodule_ae1c89f1f938ece51e3858ab650f803de_icgraph" alt=""/></div>
<map name="namespacegwtistmodule_ae1c89f1f938ece51e3858ab650f803de_icgraph" id="namespacegwtistmodule_ae1c89f1f938ece51e3858ab650f803de_icgraph">
<area shape="rect" title="@ brief Calculate the immobile domain budget terms" alt="" coords="211,5,405,47"/>
<area shape="rect" href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656" title="@ brief Calculate package flows." alt="" coords="5,13,163,39"/>
</map>
</div>

</div>
</div>
<a id="aaaa3a8e269ee0d09d8d4e33b5eb7391e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaa3a8e269ee0d09d8d4e33b5eb7391e">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize package scalars. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00711">711</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceoutputcontroldatamodule.html">outputcontroldatamodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceoutputcontroldatamodule.html#ad72aec6cda8603dc2702b9aeedadb413">ocd_cr</a></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">! -- call standard BndType allocate scalars</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keyword">call </span>this%BndType%allocate_scalars()</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icimout, <span class="stringliteral">&#39;ICIMOUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ibudgetout, <span class="stringliteral">&#39;IBUDGETOUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ibudcsv, <span class="stringliteral">&#39;IBUDCSV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%isrb, <span class="stringliteral">&#39;ISRB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idcy, <span class="stringliteral">&#39;IDCY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%kiter, <span class="stringliteral">&#39;KITER&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    this%icimout = 0</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    this%ibudgetout = 0</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    this%ibudcsv = 0</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    this%isrb = 0</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    this%idcy = 0</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    this%kiter = 0</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">! -- Create the ocd object, which is used to manage printing and saving</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">!    of the immobile domain concentrations</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceoutputcontroldatamodule.html#ad72aec6cda8603dc2702b9aeedadb413">ocd_cr</a>(this%ocd)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_aaaa3a8e269ee0d09d8d4e33b5eb7391e_cgraph.png" border="0" usemap="#namespacegwtistmodule_aaaa3a8e269ee0d09d8d4e33b5eb7391e_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_aaaa3a8e269ee0d09d8d4e33b5eb7391e_cgraph" id="namespacegwtistmodule_aaaa3a8e269ee0d09d8d4e33b5eb7391e_cgraph">
<area shape="rect" title="@ brief Allocate package scalars" alt="" coords="5,5,176,47"/>
<area shape="rect" href="namespaceoutputcontroldatamodule.html#ad72aec6cda8603dc2702b9aeedadb413" title="@ brief Create OutputControlDataType" alt="" coords="224,5,411,47"/>
</map>
</div>

</div>
</div>
<a id="a51843401d128c303b6b238be12118cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51843401d128c303b6b238be12118cb7">&#9670;&nbsp;</a></span>get_ddconc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtistmodule::get_ddconc </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ddterm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cimold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function calculates the concentration of the immobile domain. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ddterm</td><td>terms comprising the balance equation of the immobile domain </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>the f term used to calculate the immobile domain concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cimold</td><td>immobile domain concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration of the mobile domain at the end of the time step </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>calculated concentration of the immobile domain </dd></dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l01208">1208</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ddterm<span class="comment">  !&lt; terms comprising the balance equation of the immobile domain</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: f<span class="comment">                     !&lt; the f term used to calculate the immobile domain concentration</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cimold<span class="comment">                !&lt; immobile domain concentration at end of last time step</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cnew<span class="comment">                  !&lt; concentration of the mobile domain at the end of the time step</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">! -- result</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimnew<span class="comment">                            !&lt; calculated concentration of the immobile domain</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">! -- calculate ddconc</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    cimnew = (ddterm(2) + ddterm(4)) * cimold + ddterm(9) * cnew - ddterm(7)    &amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;             - ddterm(8)</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    cimnew = cimnew / f</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_a51843401d128c303b6b238be12118cb7_icgraph.png" border="0" usemap="#namespacegwtistmodule_a51843401d128c303b6b238be12118cb7_icgraph" alt=""/></div>
<map name="namespacegwtistmodule_a51843401d128c303b6b238be12118cb7_icgraph" id="namespacegwtistmodule_a51843401d128c303b6b238be12118cb7_icgraph">
<area shape="rect" title="@ brief Calculate the immobile domain concentration" alt="" coords="211,5,404,32"/>
<area shape="rect" href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656" title="@ brief Calculate package flows." alt="" coords="5,5,163,32"/>
</map>
</div>

</div>
</div>
<a id="aba6bb9e373947549332354cfb94457a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba6bb9e373947549332354cfb94457a1">&#9670;&nbsp;</a></span>get_ddterm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::get_ddterm </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>thetaim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>vcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>swtpdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>thetaimfrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>lambda1im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>lambda2im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>gamma1im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>gamma2im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>zetaim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ddterm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This subroutine calculates the immobile domain (or dual domain) terms. The resulting ddterm and f terms are described in the GWT model report. The terms are concentration coefficients used in the balance equation for the immobile domain. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">thetaim</td><td>immobile domain porosity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vcell</td><td>volume of cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delt</td><td>length of time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swtpdt</td><td>cell saturation at end of time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thetaimfrac</td><td>fraction of total porosity this is immobile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhob</td><td>bulk density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kd</td><td>distribution coefficient for linear isotherm </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lambda1im</td><td>first-order decay rate in aqueous phase </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lambda2im</td><td>first-order decay rate in sorbed phase </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gamma1im</td><td>zero-order decay rate in aqueous phase </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gamma2im</td><td>zero-order decay rate in sorbed phase </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zetaim</td><td>transfer coefficient between mobile and immobile domains </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ddterm</td><td>nine terms comprising the balance equation of the immobile domain </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f</td><td>the f term used to calculate the immobile domain concentration </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l01135">1135</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: thetaim<span class="comment">                      !&lt; immobile domain porosity</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: vcell<span class="comment">                        !&lt; volume of cell</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: delt<span class="comment">                         !&lt; length of time step</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: swtpdt<span class="comment">                       !&lt; cell saturation at end of time step</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: thetaimfrac<span class="comment">                  !&lt; fraction of total porosity this is immobile</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: rhob<span class="comment">                         !&lt; bulk density</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: kd<span class="comment">                           !&lt; distribution coefficient for linear isotherm</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: lambda1im<span class="comment">                    !&lt; first-order decay rate in aqueous phase</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: lambda2im<span class="comment">                    !&lt; first-order decay rate in sorbed phase</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: gamma1im<span class="comment">                     !&lt; zero-order decay rate in aqueous phase</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: gamma2im<span class="comment">                     !&lt; zero-order decay rate in sorbed phase</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: zetaim<span class="comment">                       !&lt; transfer coefficient between mobile and immobile domains</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: ddterm<span class="comment">      !&lt; nine terms comprising the balance equation of the immobile domain</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: f<span class="comment">                         !&lt; the f term used to calculate the immobile domain concentration</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    tled = done / delt</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">! -- Calculate terms.  These terms correspond to the concentration </span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">!    coefficients in equation 7-4 of the GWT model report</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    ddterm(1) = thetaim * vcell * tled</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    ddterm(2) = thetaim * vcell * tled</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    ddterm(3) = thetaimfrac * rhob * vcell * kd * tled</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    ddterm(4) = thetaimfrac * rhob * vcell * kd * tled</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    ddterm(5) = thetaim * lambda1im * vcell</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    ddterm(6) = thetaimfrac * lambda2im * rhob * kd * vcell</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    ddterm(7) = thetaim * gamma1im * vcell</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    ddterm(8) = thetaimfrac * gamma2im * rhob * vcell</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    ddterm(9) = vcell * swtpdt * zetaim</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">! -- calculate denominator term, f</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    f = ddterm(1) + ddterm(3) + ddterm(5) + ddterm(6) + ddterm(9)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_aba6bb9e373947549332354cfb94457a1_icgraph.png" border="0" usemap="#namespacegwtistmodule_aba6bb9e373947549332354cfb94457a1_icgraph" alt=""/></div>
<map name="namespacegwtistmodule_aba6bb9e373947549332354cfb94457a1_icgraph" id="namespacegwtistmodule_aba6bb9e373947549332354cfb94457a1_icgraph">
<area shape="rect" title="@ brief Calculate immobile domain equation terms" alt="" coords="211,31,405,57"/>
<area shape="rect" href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656" title="@ brief Calculate package flows." alt="" coords="5,5,163,32"/>
<area shape="rect" href="namespacegwtistmodule.html#a37c321f840348165c87503d0d1165a6e" title="@ brief Fill coefficient method for package" alt="" coords="7,56,161,83"/>
</map>
</div>

</div>
</div>
<a id="a82e8f00f26c4919ec014f2318ac2d60e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e8f00f26c4919ec014f2318ac2d60e">&#9670;&nbsp;</a></span>get_hcofrhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::get_hcofrhs </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ddterm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cimold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This subroutine calculates the hcof and rhs terms that must be added to the solution system of equations </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ddterm</td><td>terms comprising the balance equation of the immobile domain </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>the f term used to calculate the immobile domain concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cimold</td><td>immobile domain concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>calculated contribution for the a-matrix diagonal position </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>calculated contribution for the solution right-hand side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l01182">1182</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ddterm<span class="comment">  !&lt; terms comprising the balance equation of the immobile domain</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: f<span class="comment">                     !&lt; the f term used to calculate the immobile domain concentration</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cimold<span class="comment">                !&lt; immobile domain concentration at end of last time step</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">               !&lt; calculated contribution for the a-matrix diagonal position</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">                !&lt; calculated contribution for the solution right-hand side</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="comment">! -- calculate hcof</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    hcof = ddterm(9) ** 2 / f - ddterm(9)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">! -- calculate rhs, and switch the sign because this term needs to</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">!    be moved to the left hand side</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    rhs = (ddterm(2) + ddterm(4)) * cimold - ddterm(7) - ddterm(8)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    rhs = rhs * ddterm(9) / f</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    rhs = -rhs</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_a82e8f00f26c4919ec014f2318ac2d60e_icgraph.png" border="0" usemap="#namespacegwtistmodule_a82e8f00f26c4919ec014f2318ac2d60e_icgraph" alt=""/></div>
<map name="namespacegwtistmodule_a82e8f00f26c4919ec014f2318ac2d60e_icgraph" id="namespacegwtistmodule_a82e8f00f26c4919ec014f2318ac2d60e_icgraph">
<area shape="rect" title="@ brief Calculate the hcof and rhs terms for immobile domain" alt="" coords="211,31,405,57"/>
<area shape="rect" href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656" title="@ brief Calculate package flows." alt="" coords="5,5,163,32"/>
<area shape="rect" href="namespacegwtistmodule.html#a37c321f840348165c87503d0d1165a6e" title="@ brief Fill coefficient method for package" alt="" coords="7,56,161,83"/>
</map>
</div>

</div>
</div>
<a id="ae036b3aa4f13696f131c99e63b8fed7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae036b3aa4f13696f131c99e63b8fed7a">&#9670;&nbsp;</a></span>ist_ad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Advance the IST Package and handle the adaptive time stepping feature by copying from new to old or old to new accordingly </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00238">238</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a284e1959b1aa8757d3f107ab44d64e21">ifailedstepretry</a></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">! -- Call parent advance</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">call </span>this%BndType%bnd_ad()</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! -- set independent kiter counter to zero</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    this%kiter = 0</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">! -- copy cimnew into cimold or vice versa if this is a repeat of</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">!    a failed time step</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacesimvariablesmodule.html#a284e1959b1aa8757d3f107ab44d64e21">ifailedstepretry</a> == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        this%cimold(n) = this%cimnew(n)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        this%cimnew(n) = this%cimold(n)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad885bba7122d4e3d9b9511ca820f10c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad885bba7122d4e3d9b9511ca820f10c8">&#9670;&nbsp;</a></span>ist_allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize package arrays. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00751">751</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordtype">class</span>(GwtIstType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">! -- call standard BndType allocate scalars</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">!    nbound and maxbound are 0 in order to keep memory footprint low</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keyword">call </span>this%BndType%allocate_arrays()</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">! -- allocate ist arrays of size nodes</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%strg, this%dis%nodes, <span class="stringliteral">&#39;STRG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cim, this%dis%nodes, <span class="stringliteral">&#39;CIM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cimnew, this%dis%nodes, <span class="stringliteral">&#39;CIMNEW&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cimold, this%dis%nodes, <span class="stringliteral">&#39;CIMOLD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%zetaim, this%dis%nodes, <span class="stringliteral">&#39;ZETAIM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%thetaim, this%dis%nodes, <span class="stringliteral">&#39;THETAIM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (this%isrb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bulk_density, 1, <span class="stringliteral">&#39;BULK_DENSITY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%distcoef,  1, <span class="stringliteral">&#39;DISTCOEF&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bulk_density, this%dis%nodes, <span class="stringliteral">&#39;BULK_DENSITY&#39;</span>,     &amp;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                        this%memoryPath)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%distcoef,  this%dis%nodes, <span class="stringliteral">&#39;DISTCOEF&#39;</span>,            &amp;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        this%memoryPath)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> (this%idcy == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decay, 1, <span class="stringliteral">&#39;DECAY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decaylast, 1, <span class="stringliteral">&#39;DECAYLAST&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decay, this%dis%nodes, <span class="stringliteral">&#39;DECAY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decaylast, this%dis%nodes, <span class="stringliteral">&#39;DECAYLAST&#39;</span>,           &amp;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        this%memoryPath)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (this%isrb == 0 .and. this%idcy == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decayslast, 1, <span class="stringliteral">&#39;DECAYSLAST&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decayslast, this%dis%nodes, <span class="stringliteral">&#39;DECAYSLAST&#39;</span>,         &amp;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                        this%memoryPath)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decay_sorbed, 1, <span class="stringliteral">&#39;DECAY_SORBED&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      this%strg(n) = dzero</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      this%cim(n) = dzero</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      this%cimnew(n) = dzero</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      this%cimold(n) = dzero</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      this%zetaim(n) = dzero</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      this%thetaim(n) = dzero</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(this%decay)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      this%decay(n) = dzero</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      this%decaylast(n) = dzero</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(this%decayslast)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      this%decayslast(n) = dzero</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">! -- Set pointers</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    this%ocd%dis =&gt; this%dis</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaec4957a4392e2394289597478328dd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaec4957a4392e2394289597478328dd0">&#9670;&nbsp;</a></span>ist_ar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to allocate and read static data for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00155">155</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>, <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f">budget_cr</a></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">class</span>(GwtIstType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">     !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtist =                                    &amp;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="stringliteral">&quot;(1x,/1x,&#39;IST -- IMMOBILE DOMAIN STORAGE AND TRANSFER PACKAGE, &#39;,        &amp;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39;VERSION 1, 12/24/2018 INPUT READ FROM UNIT &#39;, i0, //)&quot;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">! --print a message identifying the immobile domain package.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">write</span>(this%iout, fmtist) this%inunit</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">! -- Read immobile domain options</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">call </span>this%read_options()</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">! -- Allocate arrays</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">call </span>this%ist_allocate_arrays()</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">! -- Now that arrays are allocated, check in the cimnew array to </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">!    the output control manager for subsequent printing/saving</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">call </span>this%ocd%init_dbl(<span class="stringliteral">&#39;CIM&#39;</span>, this%cimnew, this%dis, <span class="stringliteral">&#39;PRINT LAST &#39;</span>,        &amp;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                           <span class="stringliteral">&#39;COLUMNS 10 WIDTH 11 DIGITS 4 GENERAL &#39;</span>,            &amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                            this%iout, dhnoflo)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">! -- read the data block</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">call </span>this%read_data()</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">! -- set cimnew to the cim start values read from input</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      this%cimnew(n) = this%cim(n)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">! -- add thetaim to the prsity2 accumulator in mst package</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">call </span>this%mst%addto_prsity2(this%thetaim)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">! -- setup the immobile domain budget</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f">budget_cr</a>(this%budget, this%memoryPath)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">call </span>this%budget%budget_df(nbditems, <span class="stringliteral">&#39;MASS&#39;</span>, <span class="stringliteral">&#39;M&#39;</span>, bdzone=this%packName)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">call </span>this%budget%set_ibudcsv(this%ibudcsv)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">! -- Perform a check to ensure that sorption and decay are set </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!    consistently between the MST and IST packages.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (this%idcy /= this%mst%idcy) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;DECAY MUST BE ACTIVATED CONSISTENTLY BETWEEN THE &amp;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;MST AND IST PACKAGES.  TURN DECAY ON OR OFF FOR BOTH PACKAGES.&#39;</span>)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= this%mst%isrb) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;SORPTION MUST BE ACTIVATED CONSISTENTLY BETWEEN THE &amp;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;MST AND IST PACKAGES.  TURN SORPTION ON OR OFF FOR BOTH PACKAGES.&#39;</span>)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_aaec4957a4392e2394289597478328dd0_cgraph.png" border="0" usemap="#namespacegwtistmodule_aaec4957a4392e2394289597478328dd0_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_aaec4957a4392e2394289597478328dd0_cgraph" id="namespacegwtistmodule_aaec4957a4392e2394289597478328dd0_cgraph">
<area shape="rect" title="@ brief Allocate and read method for package" alt="" coords="5,56,160,83"/>
<area shape="rect" href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f" title="@ brief Create a new budget object" alt="" coords="208,5,396,32"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="210,56,394,83"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="215,107,389,133"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="444,107,583,133"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="631,66,799,107"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="631,131,799,173"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="847,44,1041,71"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="860,95,1028,137"/>
</map>
</div>

</div>
</div>
<a id="ae29f3d0e014cba69c1aa21c6a74afa89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29f3d0e014cba69c1aa21c6a74afa89">&#9670;&nbsp;</a></span>ist_bd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_bd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(budgettype), intent(inout)&#160;</td>
          <td class="paramname"><em>model_budget</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the flow between IST package and the model (ratin and ratout) to the model budget. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtIstType object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model_budget</td><td>model budget object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00505">505</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbudgetmodule_1_1budgettype.html">budgettype</a>, <a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">                            !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">type</span>(BudgetType), <span class="keywordtype">intent(inout)</span> :: model_budget<span class="comment">      !&lt; model budget object</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordtype">    real</span>(DP) :: ratin</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keywordtype">    real</span>(DP) :: ratout</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isuppress_output</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    isuppress_output = 0</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%strg(:), ratin, ratout)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">call </span>model_budget%addentry(ratin, ratout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, this%text,                 &amp;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                               isuppress_output, this%packName)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_ae29f3d0e014cba69c1aa21c6a74afa89_cgraph.png" border="0" usemap="#namespacegwtistmodule_ae29f3d0e014cba69c1aa21c6a74afa89_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_ae29f3d0e014cba69c1aa21c6a74afa89_cgraph" id="namespacegwtistmodule_ae29f3d0e014cba69c1aa21c6a74afa89_cgraph">
<area shape="rect" title="@ brief Add package flows to model budget." alt="" coords="5,13,164,39"/>
<area shape="rect" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e" title="@ brief Rate accumulator subroutine" alt="" coords="212,5,363,47"/>
</map>
</div>

</div>
</div>
<a id="ada94becde756a937e3b9e970a31de656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada94becde756a937e3b9e970a31de656">&#9670;&nbsp;</a></span>ist_cq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_cq </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>iadv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the flow between connected package control volumes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtIstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>current dependent-variable value </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iadv</td><td>flag that indicates if this is an advance package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00382">382</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">class</span>(GwtIstType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">                        !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: x<span class="comment">                         !&lt; current dependent-variable value</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">     !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: iadv<span class="comment">                      !&lt; flag that indicates if this is an advance package</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordtype">    real</span>(DP) :: swt, swtpdt</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetaim</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keywordtype">    real</span>(DP) :: zetaim</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetaimfrac</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordtype">    real</span>(DP) :: kd</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhob</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordtype">    real</span>(DP) :: lambda1im</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">    real</span>(DP) :: lambda2im</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordtype">    real</span>(DP) :: gamma1im</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordtype">    real</span>(DP) :: gamma2im</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimnew</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimold</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimsrbold</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimsrbnew</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(9)</span> :: ddterm</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    this%budterm(:, :) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>    </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">! -- Calculate immobile domain transfer rate</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      rate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      cimnew = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">! -- calculate new and old water volumes</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        swtpdt = this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        swt = this%fmi%gwfsatold(n, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        thetaim = this%thetaim(n)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">! -- set exchange coefficient      </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        zetaim = this%zetaim(n)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">! -- Set thetamfrac and thetaimfrac</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        thetamfrac = this%mst%get_thetamfrac(n)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        thetaimfrac = this%mst%get_thetaimfrac(n, this%thetaim(n))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">! -- Calculate exchange with immobile domain</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        rate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        hhcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        rrhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        kd = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        rhob = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        lambda1im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        lambda2im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        gamma1im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        gamma2im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (this%idcy == 1) lambda1im = this%decay(n)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          gamma1im = get_zero_order_decay(this%decay(n), this%decaylast(n), 0, &amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                          this%cimold(n), this%cimnew(n), <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (this%isrb &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          kd = this%distcoef(n)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          rhob = this%bulk_density(n)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          <span class="keywordflow">if</span> (this%idcy == 1) lambda2im = this%decay_sorbed(n)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          <span class="keywordflow">if</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            cimsrbold = this%cimold(n) * kd</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            cimsrbnew = this%cimnew(n) * kd</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            gamma2im = get_zero_order_decay(this%decay_sorbed(n),                &amp;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                            this%decayslast(n),                  &amp;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                            0, cimsrbold,                        &amp;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                            cimsrbnew, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">! -- calculate the terms and then get the hcof and rhs contributions</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keyword">call </span>get_ddterm(thetaim, vcell, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, swtpdt,                          &amp;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        thetaimfrac, rhob, kd, lambda1im, lambda2im,           &amp;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        gamma1im, gamma2im, zetaim, ddterm, f)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        cimold = this%cimold(n)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keyword">call </span>get_hcofrhs(ddterm, f, cimold, hhcof, rrhs)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">! -- calculate rate from hcof and rhs</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        rate = hhcof * x(n) - rrhs</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">! -- calculate immobile domain concentration</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        cimnew = get_ddconc(ddterm, f, cimold, x(n))</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="comment">! -- accumulate the budget terms</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keyword">call </span>accumulate_budterm(this%budterm, ddterm, cimnew, cimold, x(n),    &amp;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                this%idcy)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">! -- store rate and add to flowja</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      this%strg(n) = rate</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      flowja(idiag) = flowja(idiag) + rate</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">! -- store immobile domain concentration</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      this%cimnew(n) = cimnew</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_ada94becde756a937e3b9e970a31de656_cgraph.png" border="0" usemap="#namespacegwtistmodule_ada94becde756a937e3b9e970a31de656_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_ada94becde756a937e3b9e970a31de656_cgraph" id="namespacegwtistmodule_ada94becde756a937e3b9e970a31de656_cgraph">
<area shape="rect" title="@ brief Calculate package flows." alt="" coords="5,122,163,149"/>
<area shape="rect" href="namespacegwtistmodule.html#ae1c89f1f938ece51e3858ab650f803de" title="@ brief Calculate the immobile domain budget terms" alt="" coords="211,5,405,47"/>
<area shape="rect" href="namespacegwtistmodule.html#a51843401d128c303b6b238be12118cb7" title="@ brief Calculate the immobile domain concentration" alt="" coords="211,71,405,98"/>
<area shape="rect" href="namespacegwtistmodule.html#aba6bb9e373947549332354cfb94457a1" title="@ brief Calculate immobile domain equation terms" alt="" coords="211,122,405,149"/>
<area shape="rect" href="namespacegwtistmodule.html#a82e8f00f26c4919ec014f2318ac2d60e" title="@ brief Calculate the hcof and rhs terms for immobile domain" alt="" coords="211,173,405,199"/>
<area shape="rect" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="216,224,400,265"/>
</map>
</div>

</div>
</div>
<a id="a68d5d648825cc85b757caa72dfcf462a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68d5d648825cc85b757caa72dfcf462a">&#9670;&nbsp;</a></span>ist_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public gwtistmodule::ist_create </td>
          <td>(</td>
          <td class="paramtype">class(bndtype), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibcnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>namemodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>pakname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gwtfmitype), pointer&#160;</td>
          <td class="paramname"><em>fmi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gwtmsttype), pointer&#160;</td>
          <td class="paramname"><em>mst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new IST object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">packobj</td><td>BndType pointer that will point to new IST Package </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>name of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibcnum</td><td>consecutive package number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunit</td><td>unit number of package input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>unit number of model listing file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">namemodel</td><td>name of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pakname</td><td>name of the package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00106">106</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj<span class="comment">            !&lt; BndType pointer that will point to new IST Package</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: id<span class="comment">                 !&lt; name of the model</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: ibcnum<span class="comment">             !&lt; consecutive package number</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: inunit<span class="comment">             !&lt; unit number of package input file</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: iout<span class="comment">               !&lt; unit number of model listing file</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: namemodel<span class="comment">     !&lt; name of the model</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: pakname<span class="comment">       !&lt; name of the package </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">type</span>(GwtIstType), <span class="keywordtype">pointer</span> :: istobj</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">type</span>(GwtFmiType), <span class="keywordtype">pointer</span> :: fmi</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">type</span>(GwtMstType), <span class="keywordtype">pointer</span> :: mst</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">! -- allocate the object and assign values to object variables</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">allocate</span>(istobj)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    packobj =&gt; istobj</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">! -- create name and memory path</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">call </span>packobj%set_names(ibcnum, namemodel, pakname, ftype)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    packobj%text = text</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">! -- allocate scalars</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">call </span>packobj%allocate_scalars()</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">! -- initialize package</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">call </span>packobj%pack_initialize()</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">! -- store values</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    packobj%inunit = inunit</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    packobj%iout = iout</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    packobj%id = id</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    packobj%ibcnum = ibcnum</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    packobj%ncolbnd = 1</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    packobj%iscloc = 1</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">! -- Point IST specific variables</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    istobj%fmi =&gt; fmi</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    istobj%mst =&gt; mst</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_a68d5d648825cc85b757caa72dfcf462a_icgraph.png" border="0" usemap="#namespacegwtistmodule_a68d5d648825cc85b757caa72dfcf462a_icgraph" alt=""/></div>
<map name="namespacegwtistmodule_a68d5d648825cc85b757caa72dfcf462a_icgraph" id="namespacegwtistmodule_a68d5d648825cc85b757caa72dfcf462a_icgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="211,13,393,39"/>
<area shape="rect" href="namespacegwtmodule.html#af18b6e0a8010b0b5ac1eae25d179c0dd" title=" " alt="" coords="5,5,163,47"/>
</map>
</div>

</div>
</div>
<a id="a0f50268c35442b91ea1d8b895ef7271c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f50268c35442b91ea1d8b895ef7271c">&#9670;&nbsp;</a></span>ist_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate package scalars and arrays. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00661">661</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">! -- Deallocate arrays if package was active</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span>(this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icimout)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ibudgetout)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ibudcsv)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idcy)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%isrb)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%kiter)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cim)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cimnew)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cimold)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%zetaim)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%thetaim)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%bulk_density)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%distcoef)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decay)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decaylast)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decayslast)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decay_sorbed)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%strg)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      this%fmi =&gt; null()</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      this%mst =&gt; null()</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">! -- Objects</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keyword">call </span>this%budget%budget_da()</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keyword">deallocate</span>(this%budget)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">call </span>this%ocd%ocd_da()</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">deallocate</span>(this%ocd)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">! -- deallocate parent</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">call </span>this%BndType%bnd_da()</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37c321f840348165c87503d0d1165a6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37c321f840348165c87503d0d1165a6e">&#9670;&nbsp;</a></span>ist_fc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate and fill coefficients for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtIstType object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia</td><td>solution CRS row pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00272">272</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">                              !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">           !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ia<span class="comment">           !&lt; solution CRS row pointers</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: idxglo<span class="comment">       !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">       !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, idiag</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">    real</span>(DP) :: swt, swtpdt</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetaim</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordtype">    real</span>(DP) :: zetaim</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetaimfrac</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordtype">    real</span>(DP) :: kd</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhob</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordtype">    real</span>(DP) :: lambda1im</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">    real</span>(DP) :: lambda2im</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">    real</span>(DP) :: gamma1im</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordtype">    real</span>(DP) :: gamma2im</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimold</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">    real</span>(DP) :: f</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimsrbold</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">    real</span>(DP) :: cimsrbnew</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(9)</span> :: ddterm</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">! -- set variables</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    tled = done / <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    this%kiter = this%kiter + 1</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">! -- loop through and calculate immobile domain contribution to hcof and rhs</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">! -- calculate new and old water volumes</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      swtpdt = this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      swt = this%fmi%gwfsatold(n, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      thetaim = this%thetaim(n)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      idiag = ia(n)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">! -- set exchange coefficient      </span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      zetaim = this%zetaim(n)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">! -- Set thetamfrac and thetaimfrac</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      thetamfrac = this%mst%get_thetamfrac(n)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      thetaimfrac = this%mst%get_thetaimfrac(n, this%thetaim(n))</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">! -- Add dual domain mass transfer contributions to rhs and hcof</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      kd = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      rhob = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      lambda1im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      lambda2im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      gamma1im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      gamma2im = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">! -- setup decay variables</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">if</span> (this%idcy == 1) lambda1im = this%decay(n)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        gamma1im = get_zero_order_decay(this%decay(n), this%decaylast(n),      &amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                        this%kiter, this%cimold(n),            &amp;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                        this%cimnew(n), <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        this%decaylast(n) = gamma1im</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">! -- setup sorption variables</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">if</span> (this%isrb &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        kd = this%distcoef(n)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        rhob = this%bulk_density(n)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (this%idcy == 1) lambda2im = this%decay_sorbed(n)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">if</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          cimsrbold = this%cimold(n) * kd</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          cimsrbnew = this%cimnew(n) * kd</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          gamma2im = get_zero_order_decay(this%decay_sorbed(n),                &amp;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                          this%decayslast(n),                  &amp;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                          this%kiter, cimsrbold,               &amp;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                          cimsrbnew, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          this%decayslast(n) = gamma2im</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">! -- calculate the terms and then get the hcof and rhs contributions</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keyword">call </span>get_ddterm(thetaim, vcell, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, swtpdt,                            &amp;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                      thetaimfrac, rhob, kd, lambda1im, lambda2im,             &amp;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                      gamma1im, gamma2im, zetaim, ddterm, f)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      cimold = this%cimold(n)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keyword">call </span>get_hcofrhs(ddterm, f, cimold, hhcof, rrhs)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">! -- update solution accumulators</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      amatsln(idxglo(idiag)) = amatsln(idxglo(idiag)) + hhcof</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      rhs(n) = rhs(n) + rrhs</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_a37c321f840348165c87503d0d1165a6e_cgraph.png" border="0" usemap="#namespacegwtistmodule_a37c321f840348165c87503d0d1165a6e_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_a37c321f840348165c87503d0d1165a6e_cgraph" id="namespacegwtistmodule_a37c321f840348165c87503d0d1165a6e_cgraph">
<area shape="rect" title="@ brief Fill coefficient method for package" alt="" coords="5,56,160,83"/>
<area shape="rect" href="namespacegwtistmodule.html#aba6bb9e373947549332354cfb94457a1" title="@ brief Calculate immobile domain equation terms" alt="" coords="208,5,403,32"/>
<area shape="rect" href="namespacegwtistmodule.html#a82e8f00f26c4919ec014f2318ac2d60e" title="@ brief Calculate the hcof and rhs terms for immobile domain" alt="" coords="208,56,403,83"/>
<area shape="rect" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="213,107,397,149"/>
</map>
</div>

</div>
</div>
<a id="ab97f641a9ceaed508d1d7a050212ce5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab97f641a9ceaed508d1d7a050212ce5f">&#9670;&nbsp;</a></span>ist_ot_bdsummary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_ot_bdsummary </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibudfl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output advanced boundary package budget summary. This method only needs to be overridden for advanced packages that save budget summaries to the model listing file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtIstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kstp</td><td>time step number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kper</td><td>period number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>flag and unit number for the model listing file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibudfl</td><td>flag indicating budget should be written </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00630">630</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">           !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp<span class="comment">    !&lt; time step number</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper<span class="comment">    !&lt; period number</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment">    !&lt; flag and unit number for the model listing file</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ibudfl<span class="comment">  !&lt; flag indicating budget should be written</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isuppress_output = 0</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">! -- Fill budget terms</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keyword">call </span>this%budget%reset()</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keyword">call </span>this%budget%addentry(this%budterm, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt, isuppress_output)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">! -- Write budget to list file</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span> (ibudfl /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keyword">call </span>this%budget%budget_ot(kstp, kper, iout)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">! -- Write budget csv</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keyword">call </span>this%budget%writecsv(<a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abeaca165685a01879fb09532d3e5d9e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeaca165685a01879fb09532d3e5d9e8">&#9670;&nbsp;</a></span>ist_ot_dv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_ot_dv </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvsave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvprint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>BndType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idvsave</td><td>flag and unit number for dependent-variable output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idvprint</td><td>flag indicating if dependent-variable should be written to the model listing file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00594">594</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#a0752e262e3eacee245bdf84a9331c15c">endofperiod</a></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">              !&lt; BndType object</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvsave<span class="comment">    !&lt; flag and unit number for dependent-variable output</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvprint<span class="comment">   !&lt; flag indicating if dependent-variable should be written to the model listing file</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipflg</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">! -- Save cim to a binary file. ibinun is a flag where 1 indicates that</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">!    cim should be written to a binary file if a binary file is open</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">!    for it.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    ipflg = 0</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    ibinun = 1</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span>(idvsave == 0) ibinun = 0</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keyword">call </span>this%ocd%ocd_ot(ipflg, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#a0752e262e3eacee245bdf84a9331c15c">endofperiod</a>, this%iout,                &amp;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                           iprint_opt=0, isav_opt=ibinun)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">! -- Print immobile domain concentrations to listing file</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (idvprint /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keyword">call </span>this%ocd%ocd_ot(ipflg, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#a0752e262e3eacee245bdf84a9331c15c">endofperiod</a>, this%iout,                &amp;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                           iprint_opt=idvprint, isav_opt=0)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa763b6b80ea78e794aaa4b1e1d8930ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa763b6b80ea78e794aaa4b1e1d8930ec">&#9670;&nbsp;</a></span>ist_ot_model_flows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_ot_model_flows </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibudfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>imap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output flow terms between the IST package and model to a binary file and/or print flows to the model listing file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtIstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcfl</td><td>flag for cell-by-cell output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibudfl</td><td>flag indication if cell-by-cell data should be saved </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcun</td><td>unit number for cell-by-cell output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imap</td><td>mapping vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00529">529</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">                                    !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcfl<span class="comment">                           !&lt; flag for cell-by-cell output</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ibudfl<span class="comment">                           !&lt; flag indication if cell-by-cell data should be saved</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcun<span class="comment">                           !&lt; unit number for cell-by-cell output</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: imap<span class="comment">     !&lt; mapping vector</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">! -- loca</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nbound</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">! -- Set unit number for binary output</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span>(this%ipakcb &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      ibinun = icbcun</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">elseif</span>(this%ipakcb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      ibinun = this%ipakcb</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span>(icbcfl == 0) ibinun = 0</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">! -- Record the storage rate if requested</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">! -- If cell-by-cell flows will be saved as a list, write header.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span>(ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      nbound = this%dis%nodes</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      naux = 0</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keyword">call </span>this%dis%record_srcdst_list_header(this%text, this%name_model,      &amp;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                  this%name_model, this%name_model, this%packName, naux,       &amp;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                  this%auxname, ibinun, nbound, this%iout)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">! -- Calculate immobile domain rhs and hcof</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      rate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">! -- set rate from this%strg</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        rate = this%strg(n)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">! -- If saving cell-by-cell flows in list, write flow</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keyword">call </span>this%dis%record_mf6_list_entry(ibinun, n, n, rate,                &amp;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                            naux, this%auxvar(:,n),            &amp;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                            olconv=.true.,                     &amp;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                            olconv2=.true.)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8042e00c4dee75f0865a5467509490d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8042e00c4dee75f0865a5467509490d">&#9670;&nbsp;</a></span>ist_read_dimensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_read_dimensions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read dimensions for package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00924">924</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordtype">class</span>(GwtIstType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a513b002303b3cb2d9394130bfa927663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a513b002303b3cb2d9394130bfa927663">&#9670;&nbsp;</a></span>ist_rp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::ist_rp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read and prepare package data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00222">222</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">class</span>(GwtIstType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">   !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada17d3ef6a3a0fa2740662cdad8c5e00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada17d3ef6a3a0fa2740662cdad8c5e00">&#9670;&nbsp;</a></span>read_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::read_data </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read data for package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00939">939</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>,   <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>,         <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>, <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__reassignptr.html">mem_reassignptr</a></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">class</span>(GwtIstType) :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg, keyword</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: line</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istart, istop, lloc, ierr</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(7)</span> :: lname</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordtype">character(len=24)</span>, <span class="keywordtype">dimension(7)</span> :: aname</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">! -- data</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keyword">data</span> aname(1) /<span class="stringliteral">&#39;            BULK DENSITY&#39;</span>/</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keyword">data</span> aname(2) /<span class="stringliteral">&#39;DISTRIBUTION COEFFICIENT&#39;</span>/</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keyword">data</span> aname(3) /<span class="stringliteral">&#39;              DECAY RATE&#39;</span>/</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keyword">data</span> aname(4) /<span class="stringliteral">&#39;       DECAY SORBED RATE&#39;</span>/</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keyword">data</span> aname(5) /<span class="stringliteral">&#39;   INITIAL IMMOBILE CONC&#39;</span>/</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keyword">data</span> aname(6) /<span class="stringliteral">&#39;  FIRST ORDER TRANS RATE&#39;</span>/</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keyword">data</span> aname(7) /<span class="stringliteral">&#39;IMMOBILE DOMAIN POROSITY&#39;</span>/</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    isfound = .false.</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    lname(:) = .false.</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">! -- get griddata block</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;GRIDDATA&#39;</span>, isfound, ierr)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span>(isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING GRIDDATA&#39;</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keyword">call </span>this%parser%GetRemainingLine(line)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        lloc = 1</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BULK_DENSITY&#39;</span>)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="keywordflow">if</span> (this%isrb == 0) &amp;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%bulk_density, this%dis%nodes,           &amp;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                  <span class="stringliteral">&#39;BULK_DENSITY&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                         this%parser%iuactive,                 &amp;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                         this%bulk_density, aname(1))</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            lname(1) = .true.</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DISTCOEF&#39;</span>)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">if</span> (this%isrb == 0) &amp;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%distcoef, this%dis%nodes, <span class="stringliteral">&#39;DISTCOEF&#39;</span>,   &amp;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                trim(this%memoryPath))</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                         this%parser%iuactive, this%distcoef,  &amp;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                         aname(2))</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            lname(2) = .true.</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DECAY&#39;</span>)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">if</span> (this%idcy == 0) &amp;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%decay, this%dis%nodes, <span class="stringliteral">&#39;DECAY&#39;</span>,         &amp;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                  trim(this%memoryPath))</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                         this%parser%iuactive, this%decay,     &amp;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                         aname(3))</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            lname(3) = .true.</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DECAY_SORBED&#39;</span>)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%decay_sorbed, this%dis%nodes,             &amp;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                <span class="stringliteral">&#39;DECAY_SORBED&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                         this%parser%iuactive,                 &amp;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                         this%decay_sorbed, aname(4))</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            lname(4) = .true.</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CIM&#39;</span>)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                         this%parser%iuactive, this%cim,       &amp;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                         aname(5))</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            lname(5) = .true.</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ZETAIM&#39;</span>)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                         this%parser%iuactive, this%zetaim,    &amp;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                         aname(6))</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            lname(6) = .true.</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THETAIM&#39;</span>)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                         this%parser%iuactive, this%thetaim,   &amp;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                         aname(7))</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            lname(7) = .true.</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(4x,a,a)&#39;</span>) <span class="stringliteral">&#39;Unknown GRIDDATA tag: &#39;</span>, trim(keyword)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;END PROCESSING GRIDDATA&#39;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;Required GRIDDATA block not found.&#39;</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">! -- Check for required sorption variables</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span> (this%isrb &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">if</span> (.not. lname(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;ERROR.  SORPTION IS ACTIVE BUT BULK_DENSITY &amp;</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;NOT SPECIFIED.  BULK_DENSITY MUST BE SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">if</span> (.not. lname(2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;ERROR.  SORPTION IS ACTIVE BUT DISTRIBUTION &amp;</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;COEFFICIENT NOT SPECIFIED.  DISTCOEF MUST BE SPECIFIED IN &amp;</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">if</span> (lname(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  SORPTION IS NOT ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;BULK_DENSITY WAS SPECIFIED.  BULK_DENSITY WILL HAVE NO AFFECT ON &amp;</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordflow">if</span> (lname(2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  SORPTION IS NOT ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;DISTRIBUTION COEFFICIENT WAS SPECIFIED.  DISTCOEF WILL HAVE &amp;</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;NO AFFECT ON SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">! -- Check for required decay/production rate coefficients</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">if</span> (this%idcy &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">if</span> (.not. lname(3)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;ERROR.  FIRST OR ZERO ORDER DECAY IS &amp;</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;ACTIVE BUT THE FIRST RATE COEFFICIENT IS NOT SPECIFIED.  &amp;</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;DECAY MUST BE SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordflow">if</span> (.not. lname(4)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="comment">! -- If DECAY_SORBED not specified and sorption is active, then set</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="comment">!    decay_sorbed equal to decay</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> (this%isrb &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;DECAY_SORBED not provided in GRIDDATA &amp;</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;block but decay and sorption are active.  Specify DECAY_SORBED &amp;</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;in GRIDDATA block.&#39;</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordflow">if</span> (lname(3)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  FIRST OR ZERO ORER DECAY &amp;</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;IS NOT ACTIVE BUT DECAY WAS SPECIFIED.  DECAY WILL &amp;</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;HAVE NO AFFECT ON SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">if</span> (lname(4)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  FIRST OR ZERO ORER DECAY &amp;</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;IS NOT ACTIVE BUT DECAY_SORBED MUST  WAS SPECIFIED.  &amp;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;DECAY_SORBED MUST  WILL HAVE NO AFFECT ON SIMULATION &amp;</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;RESULTS.&#39;</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">! -- Check for required dual domain arrays or warn if they are specified</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">!    but won&#39;t be used.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">if</span> (.not. lname(5)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  DUAL DOMAIN IS ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;INITIAL IMMOBILE DOMAIN CONCENTRATION WAS NOT SPECIFIED.  &amp;</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;SETTING CIM TO ZERO.&#39;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (.not. lname(6)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;DUAL DOMAIN IS ACTIVE BUT DUAL &amp;</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;DOMAIN MASS TRANSFER RATE (ZETAIM) WAS NOT SPECIFIED.  ZETAIM &amp;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;MUST BE SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (.not. lname(7)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;DUAL DOMAIN IS ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;IMMOBILE DOMAIN POROSITY (THETAIM) WAS NOT SPECIFIED.  THETAIM &amp;</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;MUST BE SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">! -- terminate if errors</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_ada17d3ef6a3a0fa2740662cdad8c5e00_cgraph.png" border="0" usemap="#namespacegwtistmodule_ada17d3ef6a3a0fa2740662cdad8c5e00_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_ada17d3ef6a3a0fa2740662cdad8c5e00_cgraph" id="namespacegwtistmodule_ada17d3ef6a3a0fa2740662cdad8c5e00_cgraph">
<area shape="rect" title="@ brief Read data for package" alt="" coords="5,43,189,69"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="237,17,421,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="242,68,417,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="469,68,608,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="656,27,824,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="656,93,824,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="872,5,1067,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="885,57,1053,98"/>
</map>
</div>

</div>
</div>
<a id="af8cd450ab5f646649ed562d52cdda268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8cd450ab5f646649ed562d52cdda268">&#9670;&nbsp;</a></span>read_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtistmodule::read_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtistmodule_1_1gwtisttype.html">gwtisttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read options for boundary packages. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtIstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00824">824</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>,   <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a>, <a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>,         <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceopenspecmodule.html">openspecmodule</a>,    <span class="keywordtype">only</span>: <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordtype">class</span>(GwtIstType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; GwtIstType object</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg, keyword</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: fname</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: keyword2</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordtype">logical</span> :: found</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtisvflow =                                &amp;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;CELL-BY-CELL FLOW INFORMATION WILL BE SAVED TO BINARY FILE &quot;</span> //    &amp;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="stringliteral">&quot;WHENEVER ICBCFL IS NOT ZERO.&#39;)&quot;</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtisrb =                                   &amp;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;LINEAR SORPTION IS SELECTED. &#39;)&quot;</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtidcy1 =                                  &amp;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;FIRST-ORDER DECAY IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtidcy2 =                                  &amp;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;ZERO-ORDER DECAY IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtistbin = &amp;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="stringliteral">&quot;(4x, &#39;IST &#39;, 1x, a, 1x, &#39; WILL BE SAVED TO FILE: &#39;, a, /4x, &#39;OPENED ON UNIT: &#39;, I0)&quot;</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, blockrequired=.false., &amp;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING IMMOBILE STORAGE AND TRANSFER &amp;</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                                &amp;OPTIONS&#39;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SAVE_FLOWS&#39;</span>)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            this%ipakcb = -1</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keyword">write</span>(this%iout, fmtisvflow)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&#39;CIM&#39;</span>)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keyword">call </span>this%parser%GetRemainingLine(keyword2)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keyword">call </span>this%ocd%set_option(keyword2, this%inunit, this%iout)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&#39;BUDGET&#39;</span>)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;              <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;              this%ibudgetout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;              <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ibudgetout, this%iout, fname, <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>,  &amp;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                            <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, mode_opt=<a class="code" href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">mnormal</a>)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;              <span class="keyword">write</span>(this%iout,fmtistbin) <span class="stringliteral">&#39;BUDGET&#39;</span>, fname, this%ibudgetout</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;              found = .true.</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;OPTIONAL BUDGET KEYWORD MUST BE FOLLOWED BY FILEOUT&#39;</span>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&#39;BUDGETCSV&#39;</span>)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;              <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;              this%ibudcsv = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;              <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ibudcsv, this%iout, fname, <span class="stringliteral">&#39;CSV&#39;</span>, &amp;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;              <span class="keyword">write</span>(this%iout,fmtistbin) <span class="stringliteral">&#39;BUDGET CSV&#39;</span>, fname, this%ibudcsv</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;OPTIONAL BUDGETCSV KEYWORD MUST BE FOLLOWED BY &amp;</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                &amp;FILEOUT&#39;</span>)</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SORBTION&#39;</span>, <span class="stringliteral">&#39;SORPTION&#39;</span>)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            this%isrb = 1</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keyword">write</span>(this%iout, fmtisrb)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;FIRST_ORDER_DECAY&#39;</span>)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            this%idcy = 1</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keyword">write</span>(this%iout, fmtidcy1)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ZERO_ORDER_DECAY&#39;</span>)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            this%idcy = 2</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="keyword">write</span>(this%iout, fmtidcy2)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(4x,a,a)&#39;</span>)<span class="stringliteral">&#39;****ERROR. UNKNOWN IST OPTION: &#39;</span>,         &amp;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                     trim(keyword)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF IMMOBILE STORAGE AND TRANSFER &amp;</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                                &amp;OPTIONS&#39;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtistmodule_af8cd450ab5f646649ed562d52cdda268_cgraph.png" border="0" usemap="#namespacegwtistmodule_af8cd450ab5f646649ed562d52cdda268_cgraph" alt=""/></div>
<map name="namespacegwtistmodule_af8cd450ab5f646649ed562d52cdda268_cgraph" id="namespacegwtistmodule_af8cd450ab5f646649ed562d52cdda268_cgraph">
<area shape="rect" title="@ brief Read options for package" alt="" coords="5,71,153,112"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="201,5,356,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title=" " alt="" coords="201,71,356,112"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="404,137,579,163"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="414,5,569,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="414,71,569,112"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="627,137,765,163"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="813,96,981,137"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="813,161,981,203"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1029,74,1224,101"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1043,125,1211,167"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af7dec5c53d3b8bf6e8041f314cd1e4a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7dec5c53d3b8bf6e8041f314cd1e4a3">&#9670;&nbsp;</a></span>budtxt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenbudtxt), dimension(<a class="el" href="namespacegwtistmodule.html#a92661d68c115592344e5e54c62b4ac86">nbditems</a>) gwtistmodule::budtxt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00034">34</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(NBDITEMS)</span> :: budtxt</div>
</div><!-- fragment -->
</div>
</div>
<a id="aacc01093936348bbdb8565f98faad71a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc01093936348bbdb8565f98faad71a">&#9670;&nbsp;</a></span>ftype</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenftype) gwtistmodule::ftype = 'IST'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00031">31</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">character(len=LENFTYPE)</span>       :: ftype = <span class="stringliteral">&#39;IST&#39;</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92661d68c115592344e5e54c62b4ac86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92661d68c115592344e5e54c62b4ac86">&#9670;&nbsp;</a></span>nbditems</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b), parameter gwtistmodule::nbditems = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00033">33</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">parameter</span> :: NBDITEMS = 5</div>
</div><!-- fragment -->
</div>
</div>
<a id="aff073c698fc57a0b26f81614665b8e49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff073c698fc57a0b26f81614665b8e49">&#9670;&nbsp;</a></span>text</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenpackagename) gwtistmodule::text = ' IMMOBILE DOMAIN'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1ist1_8f90_source.html#l00032">32</a> of file <a class="el" href="gwt1ist1_8f90_source.html">gwt1ist1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">character(len=LENPACKAGENAME)</span> :: text  = <span class="stringliteral">&#39; IMMOBILE DOMAIN&#39;</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__reallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__reallocate.html">memorymanagermodule::mem_reallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00064">MemoryManager.f90:64</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdoc">real constant zero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00054">Constants.f90:54</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_a0752e262e3eacee245bdf84a9331c15c"><div class="ttname"><a href="namespacetdismodule.html#a0752e262e3eacee245bdf84a9331c15c">tdismodule::endofperiod</a></div><div class="ttdeci">logical(lgp), pointer, public endofperiod</div><div class="ttdoc">flag indicating end of stress period</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00028">tdis.f90:28</a></div></div>
<div class="ttc" id="anamespaceoutputcontroldatamodule_html"><div class="ttname"><a href="namespaceoutputcontroldatamodule.html">outputcontroldatamodule</a></div><div class="ttdoc">This module contains the OutputControlDataModule.</div><div class="ttdef"><b>Definition:</b> <a href="_output_control_data_8f90_source.html#l00009">OutputControlData.f90:9</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html_a284e1959b1aa8757d3f107ab44d64e21"><div class="ttname"><a href="namespacesimvariablesmodule.html#a284e1959b1aa8757d3f107ab44d64e21">simvariablesmodule::ifailedstepretry</a></div><div class="ttdeci">integer(i4b) ifailedstepretry</div><div class="ttdoc">current retry for this time step</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00031">SimVariables.f90:31</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html_a917d4897942de165ea88d0c1f0850d8e"><div class="ttname"><a href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">budgetmodule::rate_accumulator</a></div><div class="ttdeci">subroutine, public rate_accumulator(flow, rin, rout)</div><div class="ttdoc">@ brief Rate accumulator subroutine</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00646">Budget.f90:646</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html_a5d07ccf1026ac718f510c44519685c0f"><div class="ttname"><a href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f">budgetmodule::budget_cr</a></div><div class="ttdeci">subroutine, public budget_cr(this, name_model)</div><div class="ttdoc">@ brief Create a new budget object</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00082">Budget.f90:82</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html"><div class="ttname"><a href="namespaceopenspecmodule.html">openspecmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00001">OpenSpec.f90:1</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a4c46e49de78d4498dd4ec106357775e6"><div class="ttname"><a href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">simmodule::count_errors</a></div><div class="ttdeci">integer(i4b) function, public count_errors()</div><div class="ttdoc">Return number of errors.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00059">Sim.f90:59</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__reassignptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__reassignptr.html">memorymanagermodule::mem_reassignptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00080">MemoryManager.f90:80</a></div></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdoc">This module contains simulation methods.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00010">Sim.f90:10</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a060d310ded5535ce2dc85bd1ca1afd3d"><div class="ttname"><a href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">constantsmodule::linelength</a></div><div class="ttdeci">integer(i4b), parameter linelength</div><div class="ttdoc">maximum length of a standard line</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00036">Constants.f90:36</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00204">InputOutput.f90:204</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_a5f22ad41ccf3be8d4bb899e8a1834ff4"><div class="ttname"><a href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">tdismodule::totim</a></div><div class="ttdeci">real(dp), pointer, public totim</div><div class="ttdoc">time relative to start of simulation</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00032">tdis.f90:32</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html"><div class="ttname"><a href="namespacesimvariablesmodule.html">simvariablesmodule</a></div><div class="ttdoc">This module contains simulation variables.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00009">SimVariables.f90:9</a></div></div>
<div class="ttc" id="anamespaceoutputcontroldatamodule_html_ad72aec6cda8603dc2702b9aeedadb413"><div class="ttname"><a href="namespaceoutputcontroldatamodule.html#ad72aec6cda8603dc2702b9aeedadb413">outputcontroldatamodule::ocd_cr</a></div><div class="ttdeci">subroutine, public ocd_cr(ocdobj)</div><div class="ttdoc">@ brief Create OutputControlDataType</div><div class="ttdef"><b>Definition:</b> <a href="_output_control_data_8f90_source.html#l00056">OutputControlData.f90:56</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__setptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__setptr.html">memorymanagermodule::mem_setptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00069">MemoryManager.f90:69</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html"><div class="ttname"><a href="namespacebudgetmodule.html">budgetmodule</a></div><div class="ttdoc">This module contains the BudgetModule.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00020">Budget.f90:20</a></div></div>
<div class="ttc" id="astructbudgetmodule_1_1budgettype_html"><div class="ttname"><a href="structbudgetmodule_1_1budgettype.html">budgetmodule::budgettype</a></div><div class="ttdoc">Derived type for the Budget object.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00039">Budget.f90:39</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f"><div class="ttname"><a href="namespaceconstantsmodule.html#a8f91ce3a7d9214a7dd504a557c9302cbad1cabe51afa7f9201930acec652dc51f">constantsmodule::mnormal</a></div><div class="ttdeci">@ mnormal</div><div class="ttdoc">1</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00163">Constants.f90:163</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdoc">This module contains simulation constants.</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00009">Constants.f90:9</a></div></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_ade3198b3fa7a2972dae70d888f866536"><div class="ttname"><a href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">openspecmodule::form</a></div><div class="ttdeci">character(len=20) form</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_a5cd9b8ccff306158f81ed8cc744b1e46"><div class="ttname"><a href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">openspecmodule::access</a></div><div class="ttdeci">character(len=20) access</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae9a8dbe15bd2bcb8a85d53d570407ae6"><div class="ttname"><a href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">tdismodule::delt</a></div><div class="ttdeci">real(dp), pointer, public delt</div><div class="ttdoc">length of the current time step</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00030">tdis.f90:30</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00033">InputOutput.f90:33</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegwtistmodule.html">gwtistmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:14 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
