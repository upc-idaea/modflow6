<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: gwtssmmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacegwtssmmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gwtssmmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the GwtSsm Module.  
<a href="namespacegwtssmmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derived type for the SSM Package.  <a href="structgwtssmmodule_1_1gwtssmtype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:afa35631e57c7933cd1486e1f961f79f7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#afa35631e57c7933cd1486e1f961f79f7">ssm_cr</a> (ssmobj, name_model, inunit, iout, fmi)</td></tr>
<tr class="memdesc:afa35631e57c7933cd1486e1f961f79f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new SSM package  <a href="namespacegwtssmmodule.html#afa35631e57c7933cd1486e1f961f79f7">More...</a><br /></td></tr>
<tr class="separator:afa35631e57c7933cd1486e1f961f79f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a936904a4fbace23a4705c2b926983d6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a936904a4fbace23a4705c2b926983d6e">ssm_df</a> (this)</td></tr>
<tr class="memdesc:a936904a4fbace23a4705c2b926983d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define SSM Package  <a href="namespacegwtssmmodule.html#a936904a4fbace23a4705c2b926983d6e">More...</a><br /></td></tr>
<tr class="separator:a936904a4fbace23a4705c2b926983d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead67b31e8b96f08634850f34254c28e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#aead67b31e8b96f08634850f34254c28e">ssm_ar</a> (this, dis, ibound, cnew)</td></tr>
<tr class="memdesc:aead67b31e8b96f08634850f34254c28e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read SSM Package  <a href="namespacegwtssmmodule.html#aead67b31e8b96f08634850f34254c28e">More...</a><br /></td></tr>
<tr class="separator:aead67b31e8b96f08634850f34254c28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe403b8e98e94380a25a8cc7664fea28"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#abe403b8e98e94380a25a8cc7664fea28">ssm_rp</a> (this)</td></tr>
<tr class="memdesc:abe403b8e98e94380a25a8cc7664fea28"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read and prepare this SSM Package  <a href="namespacegwtssmmodule.html#abe403b8e98e94380a25a8cc7664fea28">More...</a><br /></td></tr>
<tr class="separator:abe403b8e98e94380a25a8cc7664fea28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedd37a091d60bf04836c2a8cba9920d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#aedd37a091d60bf04836c2a8cba9920d9">ssm_ad</a> (this)</td></tr>
<tr class="memdesc:aedd37a091d60bf04836c2a8cba9920d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance the SSM Package  <a href="namespacegwtssmmodule.html#aedd37a091d60bf04836c2a8cba9920d9">More...</a><br /></td></tr>
<tr class="separator:aedd37a091d60bf04836c2a8cba9920d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb51547347deff193c009905a63f3e5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a4bb51547347deff193c009905a63f3e5">ssm_term</a> (this, ipackage, ientry, rrate, rhsval, hcofval, cssm, qssm)</td></tr>
<tr class="memdesc:a4bb51547347deff193c009905a63f3e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the SSM mass flow rate and hcof and rhs values  <a href="namespacegwtssmmodule.html#a4bb51547347deff193c009905a63f3e5">More...</a><br /></td></tr>
<tr class="separator:a4bb51547347deff193c009905a63f3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac888503b6bbef4277c4da918bd308fe4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#ac888503b6bbef4277c4da918bd308fe4">get_ssm_conc</a> (this, ipackage, ientry, conc, lauxmixed)</td></tr>
<tr class="memdesc:ac888503b6bbef4277c4da918bd308fe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Provide bound concentration and mixed flag  <a href="namespacegwtssmmodule.html#ac888503b6bbef4277c4da918bd308fe4">More...</a><br /></td></tr>
<tr class="separator:ac888503b6bbef4277c4da918bd308fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef5ed233f463adb89ca7bea0abd8b82b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#aef5ed233f463adb89ca7bea0abd8b82b">ssm_fc</a> (this, amatsln, idxglo, rhs)</td></tr>
<tr class="memdesc:aef5ed233f463adb89ca7bea0abd8b82b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill coefficients  <a href="namespacegwtssmmodule.html#aef5ed233f463adb89ca7bea0abd8b82b">More...</a><br /></td></tr>
<tr class="separator:aef5ed233f463adb89ca7bea0abd8b82b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e64bb0a50e63a0279377a53bb99443"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a05e64bb0a50e63a0279377a53bb99443">ssm_cq</a> (this, flowja)</td></tr>
<tr class="memdesc:a05e64bb0a50e63a0279377a53bb99443"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate flow  <a href="namespacegwtssmmodule.html#a05e64bb0a50e63a0279377a53bb99443">More...</a><br /></td></tr>
<tr class="separator:a05e64bb0a50e63a0279377a53bb99443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7b29a29fa2bd07f183abda278114c8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a6c7b29a29fa2bd07f183abda278114c8">ssm_bd</a> (this, isuppress_output, model_budget)</td></tr>
<tr class="memdesc:a6c7b29a29fa2bd07f183abda278114c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the global SSM budget terms  <a href="namespacegwtssmmodule.html#a6c7b29a29fa2bd07f183abda278114c8">More...</a><br /></td></tr>
<tr class="separator:a6c7b29a29fa2bd07f183abda278114c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc5ec52fe4a000ccf8d43d2b578920b1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#afc5ec52fe4a000ccf8d43d2b578920b1">ssm_ot_flow</a> (this, icbcfl, ibudfl, icbcun)</td></tr>
<tr class="memdesc:afc5ec52fe4a000ccf8d43d2b578920b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output flows  <a href="namespacegwtssmmodule.html#afc5ec52fe4a000ccf8d43d2b578920b1">More...</a><br /></td></tr>
<tr class="separator:afc5ec52fe4a000ccf8d43d2b578920b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a542aceee2fd1a663098a9403ac2f08"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a3a542aceee2fd1a663098a9403ac2f08">ssm_da</a> (this)</td></tr>
<tr class="memdesc:a3a542aceee2fd1a663098a9403ac2f08"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate  <a href="namespacegwtssmmodule.html#a3a542aceee2fd1a663098a9403ac2f08">More...</a><br /></td></tr>
<tr class="separator:a3a542aceee2fd1a663098a9403ac2f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f998661deef48591f7355ff8840abf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a14f998661deef48591f7355ff8840abf">allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:a14f998661deef48591f7355ff8840abf"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespacegwtssmmodule.html#a14f998661deef48591f7355ff8840abf">More...</a><br /></td></tr>
<tr class="separator:a14f998661deef48591f7355ff8840abf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad529ffb94236c934b2260415bb090c55"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#ad529ffb94236c934b2260415bb090c55">allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:ad529ffb94236c934b2260415bb090c55"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays  <a href="namespacegwtssmmodule.html#ad529ffb94236c934b2260415bb090c55">More...</a><br /></td></tr>
<tr class="separator:ad529ffb94236c934b2260415bb090c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a189036b91ad0c9e254bd729ddd98cf53"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a189036b91ad0c9e254bd729ddd98cf53">read_options</a> (this)</td></tr>
<tr class="memdesc:a189036b91ad0c9e254bd729ddd98cf53"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read package options  <a href="namespacegwtssmmodule.html#a189036b91ad0c9e254bd729ddd98cf53">More...</a><br /></td></tr>
<tr class="separator:a189036b91ad0c9e254bd729ddd98cf53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad551bfd53cfa5e9eb9da3a312a23ffe4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#ad551bfd53cfa5e9eb9da3a312a23ffe4">read_data</a> (this)</td></tr>
<tr class="memdesc:ad551bfd53cfa5e9eb9da3a312a23ffe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read package data  <a href="namespacegwtssmmodule.html#ad551bfd53cfa5e9eb9da3a312a23ffe4">More...</a><br /></td></tr>
<tr class="separator:ad551bfd53cfa5e9eb9da3a312a23ffe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3854c161e58b7453ce09f8dd2c8f3e4d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a3854c161e58b7453ce09f8dd2c8f3e4d">read_sources_aux</a> (this)</td></tr>
<tr class="memdesc:a3854c161e58b7453ce09f8dd2c8f3e4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read SOURCES block  <a href="namespacegwtssmmodule.html#a3854c161e58b7453ce09f8dd2c8f3e4d">More...</a><br /></td></tr>
<tr class="separator:a3854c161e58b7453ce09f8dd2c8f3e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fb3312dc11dcd59900a89502a29b3e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#ac8fb3312dc11dcd59900a89502a29b3e">read_sources_fileinput</a> (this)</td></tr>
<tr class="memdesc:ac8fb3312dc11dcd59900a89502a29b3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read FILEINPUT block  <a href="namespacegwtssmmodule.html#ac8fb3312dc11dcd59900a89502a29b3e">More...</a><br /></td></tr>
<tr class="separator:ac8fb3312dc11dcd59900a89502a29b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0461270c3f829a995ca433346df1cb33"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a0461270c3f829a995ca433346df1cb33">set_iauxpak</a> (this, ip, packname)</td></tr>
<tr class="memdesc:a0461270c3f829a995ca433346df1cb33"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set iauxpak array value for package ip  <a href="namespacegwtssmmodule.html#a0461270c3f829a995ca433346df1cb33">More...</a><br /></td></tr>
<tr class="separator:a0461270c3f829a995ca433346df1cb33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7a1c537ceecec7c8f1820b9e9cba61"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a3e7a1c537ceecec7c8f1820b9e9cba61">set_ssmivec</a> (this, ip, packname)</td></tr>
<tr class="memdesc:a3e7a1c537ceecec7c8f1820b9e9cba61"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set ssmivec array value for package ip  <a href="namespacegwtssmmodule.html#a3e7a1c537ceecec7c8f1820b9e9cba61">More...</a><br /></td></tr>
<tr class="separator:a3e7a1c537ceecec7c8f1820b9e9cba61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0000cb90bed87ee7262b99fb7638c10a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a0000cb90bed87ee7262b99fb7638c10a">pak_setup_outputtab</a> (this)</td></tr>
<tr class="memdesc:a0000cb90bed87ee7262b99fb7638c10a"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Setup the output table  <a href="namespacegwtssmmodule.html#a0000cb90bed87ee7262b99fb7638c10a">More...</a><br /></td></tr>
<tr class="separator:a0000cb90bed87ee7262b99fb7638c10a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3129cd8550582fe615cde786fb01da61"><td class="memItemLeft" align="right" valign="top">character(len=lenftype)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#a3129cd8550582fe615cde786fb01da61">ftype</a> = 'SSM'</td></tr>
<tr class="separator:a3129cd8550582fe615cde786fb01da61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac598fc55caec60eed6363face90c7f08"><td class="memItemLeft" align="right" valign="top">character(len=lenpackagename)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtssmmodule.html#ac598fc55caec60eed6363face90c7f08">text</a> = ' SOURCE-SINK MIX'</td></tr>
<tr class="separator:ac598fc55caec60eed6363face90c7f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains the code for handling sources and sinks associated with groundwater flow model stress packages.</p>
<p>todo: need observations for SSM terms </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ad529ffb94236c934b2260415bb090c55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad529ffb94236c934b2260415bb090c55">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate array variables for this derived type </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00753">753</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nflowpack</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">!    </span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    nflowpack = this%fmi%nflowpack</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iauxpak, nflowpack, <span class="stringliteral">&#39;IAUXPAK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%isrctype, nflowpack, <span class="stringliteral">&#39;ISRCTYPE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">do</span> i = 1, nflowpack</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      this%iauxpak(i) = 0</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      this%isrctype(i) = 0</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">! -- Allocate the ssmivec array</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keyword">allocate</span>(this%ssmivec(nflowpack))</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14f998661deef48591f7355ff8840abf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f998661deef48591f7355ff8840abf">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate scalar variables for this derived type </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00728">728</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">! -- allocate scalars in NumericalPackageType</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%allocate_scalars()</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nbound, <span class="stringliteral">&#39;NBOUND&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    this%nbound = 0</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac888503b6bbef4277c4da918bd308fe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac888503b6bbef4277c4da918bd308fe4">&#9670;&nbsp;</a></span>get_ssm_conc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::get_ssm_conc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ipackage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ientry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out)&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(lgp), intent(out)&#160;</td>
          <td class="paramname"><em>lauxmixed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SSM concentrations can be provided in auxiliary variables or through separate SPC files. If not provided, the default concentration is zero. This single routine provides the SSM bound concentration based on these different approaches. The mixed flag indicates whether or not </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtSsmType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipackage</td><td>package number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ientry</td><td>bound number </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">conc</td><td>user-specified concentration for this bound </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lauxmixed</td><td>user-specified flag for marking this as a mixed boundary </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00371">371</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">                !&lt; GwtSsmType</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ipackage<span class="comment">     !&lt; package number</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ientry<span class="comment">       !&lt; bound number</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span> :: conc<span class="comment">            !&lt; user-specified concentration for this bound</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">logical(LGP)</span>, <span class="keywordtype">intent(out)</span> :: lauxmixed<span class="comment">   !&lt; user-specified flag for marking this as a mixed boundary</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isrctype</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iauxpos</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    conc = dzero</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    lauxmixed = .false.</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    isrctype = this%isrctype(ipackage)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">select case</span>(isrctype)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">case</span>(1, 2)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      iauxpos = this%iauxpak(ipackage)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      conc = this%fmi%gwfpackages(ipackage)%auxvar(iauxpos, ientry)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (isrctype == 2) lauxmixed = .true.</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">case</span>(3, 4)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      conc = this%ssmivec(ipackage)%get_value(ientry)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">if</span> (isrctype == 4) lauxmixed = .true.</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0000cb90bed87ee7262b99fb7638c10a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0000cb90bed87ee7262b99fb7638c10a">&#9670;&nbsp;</a></span>pak_setup_outputtab()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::pak_setup_outputtab </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup the output table by creating the column headers. </p>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l01205">1205</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordtype">class</span>(GwtSsmtype),<span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcol</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">! -- allocate and initialize the output table</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="comment">! -- dimension table</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      ntabcol = 6</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="comment">!if (this%inamedbound &gt; 0) then</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="comment">!  ntabcol = ntabcol + 1</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="comment">!end if</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="comment">! -- initialize the output table object</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      title = <span class="stringliteral">&#39;SSM PACKAGE (&#39;</span> // trim(this%packName) //     &amp;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;              <span class="stringliteral">&#39;) FLOW RATES&#39;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%outputtab, this%packName, title)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keyword">call </span>this%outputtab%table_df(1, ntabcol, this%iout, transient=.true.)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      text = <span class="stringliteral">&#39;NUMBER&#39;</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      text = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      text = <span class="stringliteral">&#39;BOUND Q&#39;</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(text, 15, alignment=tabcenter)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      text = <span class="stringliteral">&#39;SSM CONC&#39;</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(text, 15, alignment=tabcenter)</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      text = <span class="stringliteral">&#39;RATE&#39;</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(text, 15, alignment=tabcenter)</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      text = <span class="stringliteral">&#39;PACKAGE NAME&#39;</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keyword">call </span>this%outputtab%initialize_column(text, 16, alignment=tabcenter)</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="comment">!if (this%inamedbound &gt; 0) then</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="comment">!  text = &#39;NAME&#39;</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="comment">!  call this%outputtab%initialize_column(text, 20, alignment=TABLEFT)</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="comment">!end if</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_a0000cb90bed87ee7262b99fb7638c10a_cgraph.png" border="0" usemap="#namespacegwtssmmodule_a0000cb90bed87ee7262b99fb7638c10a_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_a0000cb90bed87ee7262b99fb7638c10a_cgraph" id="namespacegwtssmmodule_a0000cb90bed87ee7262b99fb7638c10a_cgraph">
<area shape="rect" title="@ brief Setup the output table" alt="" coords="5,5,203,47"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="251,13,415,39"/>
</map>
</div>

</div>
</div>
<a id="ad551bfd53cfa5e9eb9da3a312a23ffe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad551bfd53cfa5e9eb9da3a312a23ffe4">&#9670;&nbsp;</a></span>read_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::read_data </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read and set the SSM Package data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmtype object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00837">837</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordtype">class</span>(GwtSsmtype) :: this<span class="comment">  !&lt; GwtSsmtype object</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">! -- read and process required SOURCES block</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keyword">call </span>this%read_sources_aux()</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">! -- read and process optional FILEINPUT block</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keyword">call </span>this%read_sources_fileinput()</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a189036b91ad0c9e254bd729ddd98cf53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a189036b91ad0c9e254bd729ddd98cf53">&#9670;&nbsp;</a></span>read_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::read_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read and set the SSM Package options </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00785">785</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordtype">class</span>(GwtSSMType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtiprflow =                                &amp;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;SSM FLOW INFORMATION WILL BE PRINTED TO LISTING FILE &quot;</span> // &amp;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="stringliteral">&quot;WHENEVER ICBCFL IS NOT ZERO.&#39;)&quot;</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtisvflow =                                &amp;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;CELL-BY-CELL FLOW INFORMATION WILL BE SAVED TO BINARY FILE &quot;</span> //    &amp;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="stringliteral">&quot;WHENEVER ICBCFL IS NOT ZERO.&#39;)&quot;</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, blockrequired=.false., &amp;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING SSM OPTIONS&#39;</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRINT_FLOWS&#39;</span>)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            this%iprflow = 1</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="keyword">write</span>(this%iout, fmtiprflow)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SAVE_FLOWS&#39;</span>)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            this%ipakcb = -1</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keyword">write</span>(this%iout, fmtisvflow)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(4x,a,a)&#39;</span>) <span class="stringliteral">&#39;UNKNOWN SSM OPTION: &#39;</span>, trim(keyword)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;END OF SSM OPTIONS&#39;</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_a189036b91ad0c9e254bd729ddd98cf53_cgraph.png" border="0" usemap="#namespacegwtssmmodule_a189036b91ad0c9e254bd729ddd98cf53_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_a189036b91ad0c9e254bd729ddd98cf53_cgraph" id="namespacegwtssmmodule_a189036b91ad0c9e254bd729ddd98cf53_cgraph">
<area shape="rect" title="@ brief Read package options" alt="" coords="5,61,164,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="212,68,387,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,68,573,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,27,789,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,93,789,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,5,1032,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,57,1019,98"/>
</map>
</div>

</div>
</div>
<a id="a3854c161e58b7453ce09f8dd2c8f3e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3854c161e58b7453ce09f8dd2c8f3e4d">&#9670;&nbsp;</a></span>read_sources_aux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::read_sources_aux </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read SOURCES block and look for auxiliary columns in corresponding flow data. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmtype object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00855">855</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordtype">class</span>(GwtSsmtype) :: this<span class="comment">  !&lt; GwtSsmtype object</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">character(len=20)</span> :: srctype</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nflowpack</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isrctype</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordtype">logical</span> :: pakfound</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">logical</span> :: lauxmixed</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">! -- data</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    isfound = .false.</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    lauxmixed = .false.</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    nflowpack = this%fmi%nflowpack</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">! -- get sources block</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;SOURCES&#39;</span>, isfound, ierr,                        &amp;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                              supportopenclose=.true.,                         &amp;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                              blockrequired=.true.)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span>(isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING SOURCES&#39;</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="comment">! -- read package name and make sure it can be found</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        pakfound = .false.</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">do</span> ip = 1, nflowpack</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(this%fmi%gwfpackages(ip)%name)) == keyword) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            pakfound = .true.</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span> (.not. pakfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>) <span class="stringliteral">&#39;FLOW PACKAGE CANNOT BE FOUND: &#39;</span>,      &amp;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                      trim(keyword)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">! -- Ensure package was not specified more than once in SOURCES block</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">if</span> (this%isrctype(ip) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>)                                          &amp;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="stringliteral">&#39;A PACKAGE CANNOT BE SPECIFIED MORE THAN ONCE IN THE SSM SOURCES &amp;</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;BLOCK.  THE FOLLOWING PACKAGE WAS SPECIFIED MORE THAN ONCE: &#39;</span>, &amp;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            trim(keyword)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="comment">! -- read the source type</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(srctype)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">select case</span>(srctype)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;AUX&#39;</span>)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;AUX SOURCE DETECTED.&#39;</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          isrctype = 1</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;AUXMIXED&#39;</span>)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;AUXMIXED SOURCE DETECTED.&#39;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          lauxmixed = .true.</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          isrctype = 2</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>)                                          &amp;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="stringliteral">&#39;SRCTYPE MUST BE AUX OR AUXMIXED.  FOUND: &#39;</span>, trim(srctype)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">! -- Store the source type (1 or 2)</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        this%isrctype(ip) = isrctype</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="comment">! -- Find and store the auxiliary column</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keyword">call </span>this%set_iauxpak(ip, trim(keyword))</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;END PROCESSING SOURCES&#39;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;ERROR.  REQUIRED SOURCES BLOCK NOT FOUND.&#39;</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">! -- terminate if errors</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">if</span>(count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_a3854c161e58b7453ce09f8dd2c8f3e4d_cgraph.png" border="0" usemap="#namespacegwtssmmodule_a3854c161e58b7453ce09f8dd2c8f3e4d_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_a3854c161e58b7453ce09f8dd2c8f3e4d_cgraph" id="namespacegwtssmmodule_a3854c161e58b7453ce09f8dd2c8f3e4d_cgraph">
<area shape="rect" title="@ brief Read SOURCES block" alt="" coords="5,35,164,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="212,17,396,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="217,68,391,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="444,68,583,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="631,27,799,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="631,93,799,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="847,5,1041,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="860,57,1028,98"/>
</map>
</div>

</div>
</div>
<a id="ac8fb3312dc11dcd59900a89502a29b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fb3312dc11dcd59900a89502a29b3e">&#9670;&nbsp;</a></span>read_sources_fileinput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::read_sources_fileinput </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read optional FILEINPUT block and initialize an SPC input file reader for each entry. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmtype object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00958">958</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordtype">class</span>(GwtSsmtype) :: this<span class="comment">  !&lt; GwtSsmtype object</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword2</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">character(len=20)</span> :: srctype</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nflowpack</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isrctype</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">logical</span> :: pakfound</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordtype">logical</span> :: lauxmixed</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="comment">! -- data</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    isfound = .false.</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    lauxmixed = .false.</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    nflowpack = this%fmi%nflowpack</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">! -- get sources_file block</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;FILEINPUT&#39;</span>, isfound, ierr,                   &amp;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                              supportopenclose=.true.,                         &amp;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                              blockrequired=.false.)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span>(isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING FILEINPUT&#39;</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="comment">! -- read package name and make sure it can be found</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        pakfound = .false.</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="keywordflow">do</span> ip = 1, nflowpack</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(this%fmi%gwfpackages(ip)%name)) == keyword) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            pakfound = .true.</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">if</span> (.not. pakfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>) <span class="stringliteral">&#39;FLOW PACKAGE CANNOT BE FOUND: &#39;</span>,      &amp;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                      trim(keyword)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">! -- Ensure package was not specified more than once in SOURCES block</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">if</span> (this%isrctype(ip) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>)                                          &amp;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="stringliteral">&#39;A PACKAGE CANNOT BE SPECIFIED MORE THAN ONCE IN THE SSM SOURCES &amp;</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;AND SOURCES_FILES BLOCKS.  THE FOLLOWING PACKAGE WAS SPECIFIED &amp;</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;MORE THAN ONCE: &#39;</span>, &amp;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            trim(keyword)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="comment">! -- read the source type</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(srctype)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">select case</span>(srctype)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;SPC6&#39;</span>)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;SPC6 SOURCE DETECTED.&#39;</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;          isrctype = 3</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          <span class="comment">! verify filein is next</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword2)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <span class="keywordflow">if</span>(trim(adjustl(keyword2)) /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            errmsg = <span class="stringliteral">&#39;SPC6 keyword must be followed by &quot;FILEIN&quot; &#39;</span> //           &amp;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                      <span class="stringliteral">&#39;then by filename and optionally by &lt;MIXED&gt;.&#39;</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;          <span class="comment">! -- Use set_ssmivec to read file name and set up</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="comment">!    ssmi file object</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          <span class="keyword">call </span>this%set_ssmivec(ip, trim(keyword))</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;          <span class="comment">! -- check for optional MIXED keyword and set isrctype to 4 if found</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword2)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;          <span class="keywordflow">if</span> (trim(keyword2) == <span class="stringliteral">&#39;MIXED&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            isrctype = 4</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a,a)&#39;</span>) <span class="stringliteral">&#39;ASSIGNED MIXED SSM TYPE TO PACKAGE &#39;</span>,&amp;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;              trim(keyword)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>)                                          &amp;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <span class="stringliteral">&#39;SRCTYPE MUST BE SPC6.  FOUND: &#39;</span>, trim(srctype)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">! -- Store the source type (3 or 4)</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        this%isrctype(ip) = isrctype</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;END PROCESSING FILEINPUT&#39;</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)                                                &amp;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="stringliteral">&#39;OPTIONAL FILEINPUT BLOCK NOT FOUND.  CONTINUING.&#39;</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">! -- terminate if errors</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span>(count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_ac8fb3312dc11dcd59900a89502a29b3e_cgraph.png" border="0" usemap="#namespacegwtssmmodule_ac8fb3312dc11dcd59900a89502a29b3e_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_ac8fb3312dc11dcd59900a89502a29b3e_cgraph" id="namespacegwtssmmodule_ac8fb3312dc11dcd59900a89502a29b3e_cgraph">
<area shape="rect" title="@ brief Read FILEINPUT block" alt="" coords="5,35,164,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="212,17,396,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="217,68,391,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="444,68,583,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="631,27,799,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="631,93,799,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="847,5,1041,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="860,57,1028,98"/>
</map>
</div>

</div>
</div>
<a id="a0461270c3f829a995ca433346df1cb33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0461270c3f829a995ca433346df1cb33">&#9670;&nbsp;</a></span>set_iauxpak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::set_iauxpak </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>packname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The next call to parser will return the auxiliary name for package ip in the SSM SOURCES block. The routine searches through the auxiliary names in package ip and sets iauxpak to the column number corresponding to the correct auxiliary column. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtSsmtype </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>package number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">packname</td><td>name of package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l01080">1080</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">class</span>(GwtSsmtype),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; GwtSsmtype</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ip<span class="comment">           !&lt; package number</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: packname<span class="comment"> !&lt; name of package</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordtype">character(len=LENAUXNAME)</span> :: auxname    </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">logical</span> :: auxfound</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iaux</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">! -- read name of auxiliary column</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keyword">call </span>this%parser%GetStringCaps(auxname)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    auxfound = .false.</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">do</span> iaux = 1, this%fmi%gwfpackages(ip)%naux</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">if</span> (trim(this%fmi%gwfpackages(ip)%auxname(iaux)) ==                  &amp;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          trim(auxname)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        auxfound = .true.</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (.not. auxfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x, a, a)&#39;</span>)                                           &amp;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="stringliteral">&#39;AUXILIARY NAME CANNOT BE FOUND: &#39;</span>, trim(auxname)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">! -- set iauxpak and write message</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    this%iauxpak(ip) = iaux</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(4x, a, i0, a, a)&#39;</span>) <span class="stringliteral">&#39;USING AUX COLUMN &#39;</span>,      &amp;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      iaux, <span class="stringliteral">&#39; IN PACKAGE &#39;</span>, trim(packname)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_a0461270c3f829a995ca433346df1cb33_cgraph.png" border="0" usemap="#namespacegwtssmmodule_a0461270c3f829a995ca433346df1cb33_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_a0461270c3f829a995ca433346df1cb33_cgraph" id="namespacegwtssmmodule_a0461270c3f829a995ca433346df1cb33_cgraph">
<area shape="rect" title="@ brief Set iauxpak array value for package ip" alt="" coords="5,68,215,95"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="263,68,437,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="485,68,624,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="672,27,840,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="672,93,840,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="888,5,1083,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="901,57,1069,98"/>
</map>
</div>

</div>
</div>
<a id="a3e7a1c537ceecec7c8f1820b9e9cba61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e7a1c537ceecec7c8f1820b9e9cba61">&#9670;&nbsp;</a></span>set_ssmivec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::set_ssmivec </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>packname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The next call to parser will return the input file name for package ip in the SSM SOURCES block. The routine then initializes the SPC input file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtSsmtype </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>package number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">packname</td><td>name of package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l01171">1171</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="comment">! -- module</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>,   <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>, <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordtype">class</span>(GwtSsmtype),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; GwtSsmtype</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ip<span class="comment">           !&lt; package number</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: packname<span class="comment"> !&lt; name of package</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: filename</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordtype">type</span>(GwtSpcType), <span class="keywordtype">pointer</span> :: ssmiptr</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inunit</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">! -- read file name</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keyword">call </span>this%parser%GetString(filename)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    inunit = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(inunit, this%iout, filename, <span class="stringliteral">&#39;SPC&#39;</span>, filstat_opt=<span class="stringliteral">&#39;OLD&#39;</span>)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">! -- Create the SPC file object</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    ssmiptr =&gt; this%ssmivec(ip)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keyword">call </span>ssmiptr%initialize(this%dis, ip, inunit, this%iout, this%name_model,  &amp;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                            trim(packname))</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(4x, a, a, a, a)&#39;</span>) <span class="stringliteral">&#39;USING SPC INPUT FILE &#39;</span>,              &amp;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      trim(filename), <span class="stringliteral">&#39; TO SET CONCENTRATIONS FOR PACKAGE &#39;</span>, trim(packname)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_a3e7a1c537ceecec7c8f1820b9e9cba61_cgraph.png" border="0" usemap="#namespacegwtssmmodule_a3e7a1c537ceecec7c8f1820b9e9cba61_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_a3e7a1c537ceecec7c8f1820b9e9cba61_cgraph" id="namespacegwtssmmodule_a3e7a1c537ceecec7c8f1820b9e9cba61_cgraph">
<area shape="rect" title="@ brief Set ssmivec array value for package ip" alt="" coords="5,46,216,73"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="264,5,419,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title=" " alt="" coords="264,71,419,112"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="477,7,631,48"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="467,75,641,102"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="477,127,631,168"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="689,75,828,102"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="876,35,1044,76"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="876,100,1044,141"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1092,13,1287,39"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1105,64,1273,105"/>
</map>
</div>

</div>
</div>
<a id="aedd37a091d60bf04836c2a8cba9920d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedd37a091d60bf04836c2a8cba9920d9">&#9670;&nbsp;</a></span>ssm_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine is called from <a class="el" href="namespacegwtmodule.html#abdb2ce002dcc57697f7fed3a45c62640">gwt_ad()</a>. It is called at the beginning of each time step. The total number of flow boundaries is counted and stored in thisnbound. Also, if any SPC input files are used to provide source and sink concentrations and time series are referenced in those files, then ssm concenrations must be interpolated for the time step. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00222">222</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">type</span>(GwtSpcType), <span class="keywordtype">pointer</span> :: ssmiptr</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">! -- Calculate total number of exising flow boundaries. It is possible</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">!    that a node may equal zero.  In this case, the bound should be</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">!    skipped and not written to ssm output.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    this%nbound = 0</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">do</span> i = 1, this%fmi%gwfpackages(ip)%nbound</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        node = this%fmi%gwfpackages(ip)%nodelist(i)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          this%nbound = this%nbound + 1</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">! -- Call the ad method on any ssm input files so that values for </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">!    time-series are interpolated</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (this%isrctype(ip) == 3 .or. this%isrctype(ip) == 4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        ssmiptr =&gt; this%ssmivec(ip)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">call </span>ssmiptr%spc_ad(this%fmi%gwfpackages(ip)%nbound,                   &amp;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                            this%fmi%gwfpackages(ip)%budtxt)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aead67b31e8b96f08634850f34254c28e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead67b31e8b96f08634850f34254c28e">&#9670;&nbsp;</a></span>ssm_ar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disbasetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), pointer, contiguous&#160;</td>
          <td class="paramname"><em>ibound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), pointer, contiguous&#160;</td>
          <td class="paramname"><em>cnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine is called from <a class="el" href="namespacegwtmodule.html#a02903f047eec2a8b3421f29a56b7d4a1">gwt_ar()</a>. It allocates arrays, reads options and data, and sets up the output table. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtSsmType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dis</td><td>discretization package </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ibound</td><td>GWT model ibound </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cnew</td><td>GWT model dependent variable </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00135">135</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">                                   !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: dis<span class="comment">              !&lt; discretization package</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: ibound<span class="comment">   !&lt; GWT model ibound</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: cnew<span class="comment">         !&lt; GWT model dependent variable</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtssm =                                    &amp;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="stringliteral">&quot;(1x,/1x,&#39;SSM -- SOURCE-SINK MIXING PACKAGE, VERSION 1, 8/25/2017&#39;,      &amp;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; INPUT READ FROM UNIT &#39;, i0, //)&quot;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">! --print a message identifying the storage package.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">write</span>(this%iout, fmtssm) this%inunit</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">! -- store pointers to arguments that were passed in</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    this%dis     =&gt; dis</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    this%ibound  =&gt; ibound</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    this%cnew    =&gt; cnew</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">! -- Check to make sure that there are flow packages</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (this%fmi%nflowpack == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SSM PACKAGE DOES NOT HAVE &amp;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                            &amp;BOUNDARY FLOWS.  ACTIVATE GWF-GWT EXCHANGE &amp;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                            &amp;OR TURN ON FMI AND PROVIDE A BUDGET FILE &amp;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                            &amp;THAT CONTAINS BOUNDARY FLOWS.&#39;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">! -- Allocate arrays</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">call </span>this%allocate_arrays()</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">! -- Read ssm options</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">call </span>this%read_options()</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">! -- read the data block</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">call </span>this%read_data()</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">! -- setup the output table</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">call </span>this%pak_setup_outputtab()</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_aead67b31e8b96f08634850f34254c28e_cgraph.png" border="0" usemap="#namespacegwtssmmodule_aead67b31e8b96f08634850f34254c28e_cgraph" alt=""/></div>
<map name="namespacegwtssmmodule_aead67b31e8b96f08634850f34254c28e_cgraph" id="namespacegwtssmmodule_aead67b31e8b96f08634850f34254c28e_cgraph">
<area shape="rect" title="@ brief Allocate and read SSM Package" alt="" coords="5,68,183,95"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="231,68,405,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="453,68,592,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="640,27,808,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="640,93,808,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="856,5,1051,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="869,57,1037,98"/>
</map>
</div>

</div>
</div>
<a id="a6c7b29a29fa2bd07f183abda278114c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c7b29a29fa2bd07f183abda278114c8">&#9670;&nbsp;</a></span>ssm_bd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_bd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(budgettype), intent(inout)&#160;</td>
          <td class="paramname"><em>model_budget</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the global SSM budget terms using separate in and out entries for each flow package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtSsmType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isuppress_output</td><td>flag to suppress output </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model_budget</td><td>budget object for the GWT model </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00492">492</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbudgetmodule_1_1budgettype.html">budgettype</a></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">                           !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output<span class="comment">        !&lt; flag to suppress output</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">type</span>(BudgetType), <span class="keywordtype">intent(inout)</span> :: model_budget<span class="comment">     !&lt; budget object for the GWT model</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">character(len=LENPACKAGENAME)</span> :: rowlabel  = <span class="stringliteral">&#39;SSM&#39;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordtype">    real</span>(DP) :: rin</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keywordtype">    real</span>(DP) :: rout</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">! -- do for each flow package, unless it is being handled by an advanced</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">!    transport package</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="comment">! -- cycle if package is being managed as an advanced package</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">! -- Initialize the rate accumulators</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      rin = dzero</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      rout = dzero</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="comment">! -- do for each boundary</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">do</span> i = 1, this%fmi%gwfpackages(ip)%nbound</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        n = this%fmi%gwfpackages(ip)%nodelist(i)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span> (n &lt;= 0) cycle</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keyword">call </span>this%ssm_term(ip, i, rrate=rate)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span>(rate &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          rout = rout - rate</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          rin = rin + rate</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>,                              &amp;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                 this%fmi%flowpacknamearray(ip),               &amp;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                 isuppress_output, rowlabel=rowlabel)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05e64bb0a50e63a0279377a53bb99443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e64bb0a50e63a0279377a53bb99443">&#9670;&nbsp;</a></span>ssm_cq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_cq </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calulate the resulting mass flow between the boundary and the connected GWT model cell. Update the diagonal position of the flowja array so that it ultimately contains the solute balance residual. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtSsmType object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow across each face in the model grid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00452">452</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">                                     !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">   !&lt; flow across each face in the model grid</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">! -- do for each flow package</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="comment">! -- cycle if package is being managed as an advanced package</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">! -- do for each boundary</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">do</span> i = 1, this%fmi%gwfpackages(ip)%nbound</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        n = this%fmi%gwfpackages(ip)%nodelist(i)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (n &lt;= 0) cycle</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keyword">call </span>this%ssm_term(ip, i, rrate=rate)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        flowja(idiag) = flowja(idiag) + rate</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa35631e57c7933cd1486e1f961f79f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa35631e57c7933cd1486e1f961f79f7">&#9670;&nbsp;</a></span>ssm_cr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public gwtssmmodule::ssm_cr </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>), pointer&#160;</td>
          <td class="paramname"><em>ssmobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gwtfmitype), intent(in), target&#160;</td>
          <td class="paramname"><em>fmi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new SSM package by defining names, allocating scalars and initializing the parser. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ssmobj</td><td>GwtSsmType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name_model</td><td>name of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunit</td><td>fortran unit for input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>fortran unit for output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fmi</td><td>GWT FMI package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00081">81</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">type</span>(GwtSsmType), <span class="keywordtype">pointer</span> :: ssmobj<span class="comment">            !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name_model<span class="comment">     !&lt; name of the model</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunit<span class="comment">             !&lt; fortran unit for input</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment">               !&lt; fortran unit for output</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">type</span>(GwtFmiType), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: fmi<span class="comment">    !&lt; GWT FMI package</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">! -- Create the object</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">allocate</span>(ssmobj)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">! -- create name and memory path</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">call </span>ssmobj%set_names(1, name_model, <span class="stringliteral">&#39;SSM&#39;</span>, <span class="stringliteral">&#39;SSM&#39;</span>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">! -- Allocate scalars</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">call </span>ssmobj%allocate_scalars()</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">! -- Set variables</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    ssmobj%inunit = inunit</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    ssmobj%iout = iout</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    ssmobj%fmi =&gt; fmi</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">! -- Initialize block parser</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">call </span>ssmobj%parser%Initialize(ssmobj%inunit, ssmobj%iout)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtssmmodule_afa35631e57c7933cd1486e1f961f79f7_icgraph.png" border="0" usemap="#namespacegwtssmmodule_afa35631e57c7933cd1486e1f961f79f7_icgraph" alt=""/></div>
<map name="namespacegwtssmmodule_afa35631e57c7933cd1486e1f961f79f7_icgraph" id="namespacegwtssmmodule_afa35631e57c7933cd1486e1f961f79f7_icgraph">
<area shape="rect" title="@ brief Create a new SSM package" alt="" coords="1492,31,1668,57"/>
<area shape="rect" href="namespacegwtmodule.html#ad4f6eefd4112176d49bd99d8944bdef3" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a0043d2fa8d8b96e41e5e0fdfecaadae7" title="Set the models to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a3a542aceee2fd1a663098a9403ac2f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a542aceee2fd1a663098a9403ac2f08">&#9670;&nbsp;</a></span>ssm_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate the memory associated with this derived type </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00678">678</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordtype">type</span>(GwtSpcType), <span class="keywordtype">pointer</span> :: ssmiptr</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">! -- Deallocate the ssmi objects if package was active</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span>(this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keywordflow">do</span> ip = 1, <span class="keyword">size</span>(this%ssmivec)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span> (this%isrctype(ip) == 3 .or. this%isrctype(ip) == 4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          ssmiptr =&gt; this%ssmivec(ip)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="keyword">call </span>ssmiptr%spc_da()</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keyword">deallocate</span>(this%ssmivec)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">! -- Deallocate arrays if package was active</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span>(this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iauxpak)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%isrctype)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      this%ibound =&gt; null()</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      this%fmi =&gt; null()</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">! -- output table object</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%outputtab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keyword">call </span>this%outputtab%table_da()</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keyword">deallocate</span>(this%outputtab)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keyword">nullify</span>(this%outputtab)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nbound)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">! -- deallocate parent</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%da()</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a936904a4fbace23a4705c2b926983d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a936904a4fbace23a4705c2b926983d6e">&#9670;&nbsp;</a></span>ssm_df()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine is called from <a class="el" href="namespacegwtmodule.html#aa8a2c3beb0e2fe4bd28929c010414a29">gwt_df()</a>, but does not do anything because df is typically used to set up dimensions. For the ssm package, the total number of ssm entries is defined by the flow model. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00117">117</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef5ed233f463adb89ca7bea0abd8b82b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef5ed233f463adb89ca7bea0abd8b82b">&#9670;&nbsp;</a></span>ssm_fc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine adds the effects of the SSM to the matrix equations by updating the a matrix and right-hand side vector. </p>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00405">405</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: idxglo</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: rhs</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nflowpack</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nbound</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcofval</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhsval</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">! -- do for each flow package</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    nflowpack = this%fmi%nflowpack</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">do</span> ip = 1, nflowpack</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="comment">! -- do for each entry in package (ip)</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      nbound = this%fmi%gwfpackages(ip)%nbound</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">do</span> i = 1, nbound</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        n = this%fmi%gwfpackages(ip)%nodelist(i)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (n &lt;= 0) cycle</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">call </span>this%ssm_term(ip, i, rhsval=rhsval, hcofval=hcofval)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        idiag = idxglo(this%dis%con%ia(n))</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        amatsln(idiag) = amatsln(idiag) + hcofval</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        rhs(n) = rhs(n) + rhsval</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc5ec52fe4a000ccf8d43d2b578920b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc5ec52fe4a000ccf8d43d2b578920b1">&#9670;&nbsp;</a></span>ssm_ot_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_ot_flow </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibudfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Based on user-specified controls, print SSM mass flow rates to the GWT listing file and/or write the SSM mass flow rates to the GWT binary budget file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtSsmType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcfl</td><td>flag for writing binary budget terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibudfl</td><td>flag for printing budget terms to list file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcun</td><td>fortran unit number for binary budget file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00549">549</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a2e75f10abe62e57d87d7d468c2bf763d">lenpackagename</a>, <a class="code" href="namespaceconstantsmodule.html#aa63ca3273e52df46471c4746566f46bd">lenboundname</a>, <a class="code" href="namespaceconstantsmodule.html#a9ee3f8405321b057b32648a5dc031e20">lenauxname</a>, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">            !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcfl<span class="comment">   !&lt; flag for writing binary budget terms</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ibudfl<span class="comment">   !&lt; flag for printing budget terms to list file </span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcun<span class="comment">   !&lt; fortran unit number for binary budget file</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">character (len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node, nodeu</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordtype">character(len=20)</span> :: nodestr</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: maxrows</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i, n2, ibinun</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordtype">    real</span>(DP) :: rrate</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordtype">    real</span>(DP) :: qssm</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordtype">    real</span>(DP) :: cssm</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(0,0)</span> :: auxvar</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">character(len=LENAUXNAME)</span>, <span class="keywordtype">dimension(0)</span> :: auxname</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">! -- for observations</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bname</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmttkk = &amp;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="stringliteral">&quot;(1X,/1X,A,&#39;   PERIOD &#39;,I0,&#39;   STEP &#39;,I0)&quot;</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">! -- set maxrows</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    maxrows = 0</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (ibudfl /= 0 .and. this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keyword">call </span>this%outputtab%set_kstpkper(<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">! -- do for each boundary</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">do</span> i = 1, this%fmi%gwfpackages(ip)%nbound</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          node = this%fmi%gwfpackages(ip)%nodelist(i)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            maxrows = maxrows + 1</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">if</span> (maxrows &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keyword">call </span>this%outputtab%set_maxbound(maxrows)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      title = <span class="stringliteral">&#39;SSM PACKAGE (&#39;</span> // trim(this%packName) //     &amp;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;              <span class="stringliteral">&#39;) FLOW RATES&#39;</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keyword">call </span>this%outputtab%set_title(title)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">! -- Set unit number for binary output</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">if</span> (this%ipakcb &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      ibinun = icbcun</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%ipakcb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      ibinun = this%ipakcb</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">if</span> (icbcfl == 0) ibinun = 0</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">! -- If cell-by-cell flows will be saved as a list, write header.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span>(ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      naux = 0</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keyword">call </span>this%dis%record_srcdst_list_header(text, this%name_model,           &amp;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                  this%name_model, this%name_model, this%packName, naux,       &amp;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                  auxname, ibinun, this%nbound, this%iout)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">! -- If no boundaries, skip flow calculations.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span>(this%nbound &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">! -- Loop through each boundary calculating flow.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">! -- do for each boundary</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">do</span> i = 1, this%fmi%gwfpackages(ip)%nbound</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="comment">! -- Calculate rate for this entry</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          node = this%fmi%gwfpackages(ip)%nodelist(i)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          <span class="keywordflow">if</span> (node &lt;= 0) cycle</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="keyword">call </span>this%ssm_term(ip, i, rrate=rrate, qssm=qssm, cssm=cssm)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <span class="comment">! -- Print the individual rates if the budget is being printed</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="comment">!    and PRINT_FLOWS was specified (this%iprflow&lt;0)</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          <span class="keywordflow">if</span> (ibudfl /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              <span class="comment">! -- set nodestr and write outputtab table</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;              nodeu = this%dis%get_nodeuser(node)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;              <span class="keyword">call </span>this%dis%nodeu_to_string(nodeu, nodestr)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;              bname = this%fmi%gwfpackages(ip)%name</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              <span class="keyword">call </span>this%outputtab%add_term(i)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;              <span class="keyword">call </span>this%outputtab%add_term(trim(adjustl(nodestr)))</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;              <span class="keyword">call </span>this%outputtab%add_term(qssm)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;              <span class="keyword">call </span>this%outputtab%add_term(cssm)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;              <span class="keyword">call </span>this%outputtab%add_term(rrate)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              <span class="keyword">call </span>this%outputtab%add_term(bname)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          <span class="comment">! -- If saving cell-by-cell flows in list, write flow</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            n2 = i</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keyword">call </span>this%dis%record_mf6_list_entry(ibinun, node, n2, rrate,       &amp;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                naux, auxvar(:,i),             &amp;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                                olconv2=.false.)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">if</span> (ibudfl /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x)&#39;</span>)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe403b8e98e94380a25a8cc7664fea28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe403b8e98e94380a25a8cc7664fea28">&#9670;&nbsp;</a></span>ssm_rp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_rp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine is called from <a class="el" href="namespacegwtmodule.html#acca96b95166226845d54a16ed9c7103a">gwt_rp()</a>. It is called at the beginning of each stress period. If any SPC input files are used to provide source and sink concentrations, then period blocks for the current stress period are read. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtSsmType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00191">191</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">  !&lt; GwtSsmType object</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ip</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">type</span>(GwtSpcType), <span class="keywordtype">pointer</span> :: ssmiptr</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">! -- Call the rp method on any ssm input files</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">do</span> ip = 1, this%fmi%nflowpack</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">if</span> (this%fmi%iatp(ip) /= 0) cycle</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (this%isrctype(ip) == 3 .or. this%isrctype(ip) == 4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        ssmiptr =&gt; this%ssmivec(ip)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keyword">call </span>ssmiptr%spc_rp()</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bb51547347deff193c009905a63f3e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bb51547347deff193c009905a63f3e5">&#9670;&nbsp;</a></span>ssm_term()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtssmmodule::ssm_term </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtssmmodule_1_1gwtssmtype.html">gwtssmtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ipackage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ientry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>rrate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>rhsval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>hcofval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>cssm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>qssm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the primary SSM routine that calculates the matrix coefficient and right-hand-side value for any package and package entry. It returns several different optional variables that are used throughout this package to update matrix terms, budget calculations, and output tables. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtSsmType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipackage</td><td>package number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ientry</td><td>bound number </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rrate</td><td>calculated mass flow rate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhsval</td><td>calculated rhs value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hcofval</td><td>calculated hcof value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cssm</td><td>calculated source concentration depending on flow direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">qssm</td><td>water flow rate into model cell from boundary package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00271">271</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">class</span>(GwtSsmType) :: this<span class="comment">                     !&lt; GwtSsmType</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ipackage<span class="comment">          !&lt; package number</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ientry<span class="comment">            !&lt; bound number</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: rrate<span class="comment">      !&lt; calculated mass flow rate</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: rhsval<span class="comment">     !&lt; calculated rhs value</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: hcofval<span class="comment">    !&lt; calculated hcof value</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: cssm<span class="comment">       !&lt; calculated source concentration depending on flow direction</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: qssm<span class="comment">       !&lt; water flow rate into model cell from boundary package</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: lauxmixed</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">    real</span>(DP) :: qbnd</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">    real</span>(DP) :: ctmp</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">    real</span>(DP) :: omega</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">    real</span>(DP) :: hcoftmp</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhstmp</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">! -- retrieve node number, qbnd and iauxpos</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    hcoftmp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    rhstmp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    ctmp = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    qbnd = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    n = this%fmi%gwfpackages(ipackage)%nodelist(ientry)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">! -- If cell is active (ibound &gt; 0) then calculate values</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (this%ibound(n) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="comment">! -- retrieve qbnd and iauxpos</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      qbnd = this%fmi%gwfpackages(ipackage)%get_flow(ientry)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keyword">call </span>this%get_ssm_conc(ipackage, ientry, ctmp, lauxmixed)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">! -- assign values for hcoftmp, rhstmp, and ctmp for subsequent assigment</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">!    of hcof, rhs, and rate    </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">if</span>(.not. lauxmixed) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">! -- If qbnd is positive, then concentration represents the inflow </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">!    concentration.  If qbnd is negative, then the outflow concentration</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">!    is set equal to the simulated cell concentration</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span> (qbnd &gt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          omega = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>  <span class="comment">! rhs</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          ctmp = this%cnew(n)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          omega = done  <span class="comment">! lhs</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <span class="keywordflow">if</span> (ctmp &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            omega = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a> <span class="comment">! concentration is negative, so set mass flux to zero</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">! -- lauxmixed value indicates that this is a mixed sink type where </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">!    the concentration value represents the injected concentration if </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">!    qbnd is positive. If qbnd is negative, then the withdrawn water </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">!    is equal to the minimum of the aux concentration and the cell </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">!    concentration.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span> (qbnd &gt;= <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          omega = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>  <span class="comment">! rhs (ctmp is aux value)</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <span class="keywordflow">if</span> (ctmp &lt; this%cnew(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            omega = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>  <span class="comment">! rhs (ctmp is aux value)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            omega = done <span class="comment">! lhs (ctmp is cell concentration)</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            ctmp = this%cnew(n)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">! -- Non conservative (advective) formulation considers</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">!      Equation =&gt; qs*(cs-c) if qs&gt;0</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span>(qbnd &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        hcoftmp = -qbnd</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        rhstmp  = -qbnd * ctmp</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">! -- end of active ibound</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">! -- set requested values</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(hcofval)) hcofval = hcoftmp</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(rhsval)) rhsval = rhstmp</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(rrate)) rrate = hcoftmp * ctmp - rhstmp</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cssm)) cssm = ctmp</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(qssm)) qssm = qbnd</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3129cd8550582fe615cde786fb01da61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3129cd8550582fe615cde786fb01da61">&#9670;&nbsp;</a></span>ftype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenftype) gwtssmmodule::ftype = 'SSM'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00026">26</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">character(len=LENFTYPE)</span>       :: ftype = <span class="stringliteral">&#39;SSM&#39;</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac598fc55caec60eed6363face90c7f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac598fc55caec60eed6363face90c7f08">&#9670;&nbsp;</a></span>text</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenpackagename) gwtssmmodule::text = ' SOURCE-SINK MIX'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1ssm1_8f90_source.html#l00027">27</a> of file <a class="el" href="gwt1ssm1_8f90_source.html">gwt1ssm1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">character(len=LENPACKAGENAME)</span> :: text  = <span class="stringliteral">&#39; SOURCE-SINK MIX&#39;</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdoc">real constant zero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00054">Constants.f90:54</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00204">InputOutput.f90:204</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_aa63ca3273e52df46471c4746566f46bd"><div class="ttname"><a href="namespaceconstantsmodule.html#aa63ca3273e52df46471c4746566f46bd">constantsmodule::lenboundname</a></div><div class="ttdeci">integer(i4b), parameter lenboundname</div><div class="ttdoc">maximum length of a bound name</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00027">Constants.f90:27</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__setptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__setptr.html">memorymanagermodule::mem_setptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00069">MemoryManager.f90:69</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html"><div class="ttname"><a href="namespacebudgetmodule.html">budgetmodule</a></div><div class="ttdoc">This module contains the BudgetModule.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00020">Budget.f90:20</a></div></div>
<div class="ttc" id="astructbudgetmodule_1_1budgettype_html"><div class="ttname"><a href="structbudgetmodule_1_1budgettype.html">budgetmodule::budgettype</a></div><div class="ttdoc">Derived type for the Budget object.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00039">Budget.f90:39</a></div></div>
<div class="ttc" id="anamespacetablemodule_html_a7632d784ec9e94277a76705ef56725f2"><div class="ttname"><a href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">tablemodule::table_cr</a></div><div class="ttdeci">subroutine, public table_cr(this, name, title)</div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00084">Table.f90:84</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdoc">This module contains simulation constants.</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00009">Constants.f90:9</a></div></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a2e75f10abe62e57d87d7d468c2bf763d"><div class="ttname"><a href="namespaceconstantsmodule.html#a2e75f10abe62e57d87d7d468c2bf763d">constantsmodule::lenpackagename</a></div><div class="ttdeci">integer(i4b), parameter lenpackagename</div><div class="ttdoc">maximum length of the package name</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00021">Constants.f90:21</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a9ee3f8405321b057b32648a5dc031e20"><div class="ttname"><a href="namespaceconstantsmodule.html#a9ee3f8405321b057b32648a5dc031e20">constantsmodule::lenauxname</a></div><div class="ttdeci">integer(i4b), parameter lenauxname</div><div class="ttdoc">maximum length of a aux variable</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00026">Constants.f90:26</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae9a8dbe15bd2bcb8a85d53d570407ae6"><div class="ttname"><a href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">tdismodule::delt</a></div><div class="ttdeci">real(dp), pointer, public delt</div><div class="ttdoc">length of the current time step</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00030">tdis.f90:30</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00033">InputOutput.f90:33</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegwtssmmodule.html">gwtssmmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:15 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
