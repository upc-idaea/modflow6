<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: spatialmodelconnectionmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacespatialmodelconnectionmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">spatialmodelconnectionmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to manage spatial connection of a model to one or more models of the same type. Spatial connection here means that the model domains (spatial discretization) are adjacent and connected via DisConnExchangeType object(s). The connection itself is a Numerical Exchange as well, and part of a Numerical Solution providing the amat and rhs.  <a href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a300adbd33d8148fdadb60d42afa3665c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a300adbd33d8148fdadb60d42afa3665c">spatialconnection_ctor</a> (this, model, name)</td></tr>
<tr class="memdesc:a300adbd33d8148fdadb60d42afa3665c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the spatial connection base.  <a href="namespacespatialmodelconnectionmodule.html#a300adbd33d8148fdadb60d42afa3665c">More...</a><br /></td></tr>
<tr class="separator:a300adbd33d8148fdadb60d42afa3665c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1cc18618db39996568867611d63046"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#abc1cc18618db39996568867611d63046">addexchangetospatialconnection</a> (this, exchange)</td></tr>
<tr class="memdesc:abc1cc18618db39996568867611d63046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add exchange to the list of local exchanges.  <a href="namespacespatialmodelconnectionmodule.html#abc1cc18618db39996568867611d63046">More...</a><br /></td></tr>
<tr class="separator:abc1cc18618db39996568867611d63046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bf848774c4a590db0f35095e21f84d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a33bf848774c4a590db0f35095e21f84d">spatialcon_df</a> (this)</td></tr>
<tr class="memdesc:a33bf848774c4a590db0f35095e21f84d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define this connection, mostly sets up the grid.  <a href="namespacespatialmodelconnectionmodule.html#a33bf848774c4a590db0f35095e21f84d">More...</a><br /></td></tr>
<tr class="separator:a33bf848774c4a590db0f35095e21f84d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee338ca429ac57486e61429330ae6512"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#aee338ca429ac57486e61429330ae6512">spatialcon_mc</a> (this, iasln, jasln)</td></tr>
<tr class="memdesc:aee338ca429ac57486e61429330ae6512"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the mapping from the local system.  <a href="namespacespatialmodelconnectionmodule.html#aee338ca429ac57486e61429330ae6512">More...</a><br /></td></tr>
<tr class="separator:aee338ca429ac57486e61429330ae6512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73309ec8404db180c2d3050ef33dc68b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a73309ec8404db180c2d3050ef33dc68b">spatialcon_da</a> (this)</td></tr>
<tr class="memdesc:a73309ec8404db180c2d3050ef33dc68b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocation.  <a href="namespacespatialmodelconnectionmodule.html#a73309ec8404db180c2d3050ef33dc68b">More...</a><br /></td></tr>
<tr class="separator:a73309ec8404db180c2d3050ef33dc68b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bcf551fab052ae89d9e711d94d1c671"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a3bcf551fab052ae89d9e711d94d1c671">setupgridconnection</a> (this)</td></tr>
<tr class="memdesc:a3bcf551fab052ae89d9e711d94d1c671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the grid connection.  <a href="namespacespatialmodelconnectionmodule.html#a3bcf551fab052ae89d9e711d94d1c671">More...</a><br /></td></tr>
<tr class="separator:a3bcf551fab052ae89d9e711d94d1c671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5decccd26a66819f75ffa2036bc6378b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a5decccd26a66819f75ffa2036bc6378b">setexchangeconnections</a> (this)</td></tr>
<tr class="memdesc:a5decccd26a66819f75ffa2036bc6378b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the primary connections from the exchange data.  <a href="namespacespatialmodelconnectionmodule.html#a5decccd26a66819f75ffa2036bc6378b">More...</a><br /></td></tr>
<tr class="separator:a5decccd26a66819f75ffa2036bc6378b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8123b74db48f7a7eba19d980b2a65e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#aee8123b74db48f7a7eba19d980b2a65e">findmodelneighbors</a> (this)</td></tr>
<tr class="memdesc:aee8123b74db48f7a7eba19d980b2a65e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the topology of connected models.  <a href="namespacespatialmodelconnectionmodule.html#aee8123b74db48f7a7eba19d980b2a65e">More...</a><br /></td></tr>
<tr class="separator:aee8123b74db48f7a7eba19d980b2a65e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a8e1df135a55011f7471ababe7c6f0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a44a8e1df135a55011f7471ababe7c6f0">allocatescalars</a> (this)</td></tr>
<tr class="memdesc:a44a8e1df135a55011f7471ababe7c6f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocation of scalars.  <a href="namespacespatialmodelconnectionmodule.html#a44a8e1df135a55011f7471ababe7c6f0">More...</a><br /></td></tr>
<tr class="separator:a44a8e1df135a55011f7471ababe7c6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79a984e3e1acb0c770424772c46d8827"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a79a984e3e1acb0c770424772c46d8827">allocatearrays</a> (this)</td></tr>
<tr class="memdesc:a79a984e3e1acb0c770424772c46d8827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocation of arrays.  <a href="namespacespatialmodelconnectionmodule.html#a79a984e3e1acb0c770424772c46d8827">More...</a><br /></td></tr>
<tr class="separator:a79a984e3e1acb0c770424772c46d8827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb3f4a52cda6271ee145014d5a35bc40"><td class="memItemLeft" align="right" valign="top">integer(i4b) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#afb3f4a52cda6271ee145014d5a35bc40">getnrofconnections</a> (this)</td></tr>
<tr class="memdesc:afb3f4a52cda6271ee145014d5a35bc40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns total nr. of primary connections.  <a href="namespacespatialmodelconnectionmodule.html#afb3f4a52cda6271ee145014d5a35bc40">More...</a><br /></td></tr>
<tr class="separator:afb3f4a52cda6271ee145014d5a35bc40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace61fc3d934039f47a0eff6f420c235b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#ace61fc3d934039f47a0eff6f420c235b">createcoefficientmatrix</a> (this, sparse)</td></tr>
<tr class="memdesc:ace61fc3d934039f47a0eff6f420c235b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create connection's matrix (ia,ja,amat) from sparse.  <a href="namespacespatialmodelconnectionmodule.html#ace61fc3d934039f47a0eff6f420c235b">More...</a><br /></td></tr>
<tr class="separator:ace61fc3d934039f47a0eff6f420c235b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0574292d636407e09dae880717f67331"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a0574292d636407e09dae880717f67331">validateconnection</a> (this)</td></tr>
<tr class="memdesc:a0574292d636407e09dae880717f67331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate this connection.  <a href="namespacespatialmodelconnectionmodule.html#a0574292d636407e09dae880717f67331">More...</a><br /></td></tr>
<tr class="separator:a0574292d636407e09dae880717f67331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d289ce9225cf205e6edefdb73f8b827"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a7d289ce9225cf205e6edefdb73f8b827">validatedisconnexchange</a> (this, exchange)</td></tr>
<tr class="memdesc:a7d289ce9225cf205e6edefdb73f8b827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate the exchange, intercepting those cases where two models have to be connected through an interface model, where the individual configurations don't allow this.  <a href="namespacespatialmodelconnectionmodule.html#a7d289ce9225cf205e6edefdb73f8b827">More...</a><br /></td></tr>
<tr class="separator:a7d289ce9225cf205e6edefdb73f8b827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef271cf59d66fe8e5baef704109028fc"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc">castasspatialmodelconnectionclass</a> (obj)</td></tr>
<tr class="memdesc:aef271cf59d66fe8e5baef704109028fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cast to SpatialModelConnectionType.  <a href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc">More...</a><br /></td></tr>
<tr class="separator:aef271cf59d66fe8e5baef704109028fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141064bc892a55a9bd63d64cdf575bbe"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a141064bc892a55a9bd63d64cdf575bbe">addspatialmodelconnectiontolist</a> (list, conn)</td></tr>
<tr class="memdesc:a141064bc892a55a9bd63d64cdf575bbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add connection to a list.  <a href="namespacespatialmodelconnectionmodule.html#a141064bc892a55a9bd63d64cdf575bbe">More...</a><br /></td></tr>
<tr class="separator:a141064bc892a55a9bd63d64cdf575bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab03c81ae159b53ae92e07d83d48cca29"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29">getspatialmodelconnectionfromlist</a> (list, idx)</td></tr>
<tr class="memdesc:ab03c81ae159b53ae92e07d83d48cca29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the connection from a list.  <a href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29">More...</a><br /></td></tr>
<tr class="separator:ab03c81ae159b53ae92e07d83d48cca29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="abc1cc18618db39996568867611d63046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1cc18618db39996568867611d63046">&#9670;&nbsp;</a></span>addexchangetospatialconnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::addexchangetospatialconnection </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disconnexchangetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>exchange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>this connection </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exchange</td><td>the exchange to add </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00111">111</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment">                   !&lt; this connection</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: exchange<span class="comment"> !&lt; the exchange to add</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: exg</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    exg =&gt; exchange</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">call </span>this%localExchanges%Add(exg)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
</div><!-- fragment -->
</div>
</div>
<a id="a141064bc892a55a9bd63d64cdf575bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141064bc892a55a9bd63d64cdf575bbe">&#9670;&nbsp;</a></span>addspatialmodelconnectiontolist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public spatialmodelconnectionmodule::addspatialmodelconnectiontolist </td>
          <td>(</td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">list</td><td>the list </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conn</td><td>the connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00400">400</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">type</span>(ListType),       <span class="keywordtype">intent(inout)</span> :: list<span class="comment">                     !&lt; the list</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: conn<span class="comment">  !&lt; the connection</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: obj</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    obj =&gt; conn</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">call </span>list%Add(obj)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph" id="namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph">
<area shape="rect" title="Add connection to a list." alt="" coords="240,5,483,47"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041" title="Create connections from exchanges." alt="" coords="5,5,192,47"/>
</map>
</div>

</div>
</div>
<a id="a79a984e3e1acb0c770424772c46d8827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79a984e3e1acb0c770424772c46d8827">&#9670;&nbsp;</a></span>allocatearrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::allocatearrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00274">274</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%x, this%neq, <span class="stringliteral">&#39;X&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rhs, this%neq, <span class="stringliteral">&#39;RHS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%active, this%neq, <span class="stringliteral">&#39;IACTIVE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">! c.f. NumericalSolution</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">do</span> i = 1, this%neq</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      this%x(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      this%active(i) = 1 <span class="comment">! default is active</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    </div>
</div><!-- fragment -->
</div>
</div>
<a id="a44a8e1df135a55011f7471ababe7c6f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a8e1df135a55011f7471ababe7c6f0">&#9670;&nbsp;</a></span>allocatescalars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::allocatescalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00260">260</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%neq, <span class="stringliteral">&#39;NEQ&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nja, <span class="stringliteral">&#39;NJA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%internalStencilDepth, <span class="stringliteral">&#39;INTSTDEPTH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%exchangeStencilDepth, <span class="stringliteral">&#39;EXGSTDEPTH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nrOfConnections, <span class="stringliteral">&#39;NROFCONNS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef271cf59d66fe8e5baef704109028fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef271cf59d66fe8e5baef704109028fc">&#9670;&nbsp;</a></span>castasspatialmodelconnectionclass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public spatialmodelconnectionmodule::castasspatialmodelconnectionclass </td>
          <td>(</td>
          <td class="paramtype">class(*), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obj</td><td>object to be cast </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the instance of SpatialModelConnectionType </dd></dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00383">383</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: obj<span class="comment">           !&lt; object to be cast</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: res<span class="comment"> !&lt; the instance of SpatialModelConnectionType </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    res =&gt; null()</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(obj)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">select type</span> (obj)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordflow">    class is</span> (spatialmodelconnectiontype)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      res =&gt; obj</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph" id="namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph">
<area shape="rect" title="Cast to SpatialModelConnectionType." alt="" coords="1213,205,1475,247"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29" title="Get the connection from a list." alt="" coords="907,205,1165,247"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aa5b7a09a35bdd2b85e44caea16bb075e" title="Add global exchanges from a certain numerical solution to the connections." alt="" coords="609,5,842,47"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a70e26711a7029a6847798a6706ab0437" title="This function gets an existing connection for a model, based on the type of exchange...." alt="" coords="632,71,819,112"/>
<area shape="rect" href="namespacemf6coremodule.html#ae17efa5a9e03fd31617a08c08e20ae03" title="Finalize the simulation." alt="" coords="622,238,829,265"/>
<area shape="rect" href="namespacemf6coremodule.html#aab3891c5763fe8a941e6799fe9c82388" title="Finalize time step." alt="" coords="593,137,857,163"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="592,187,859,214"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a70c99123d0984c94b5c28ee5f8cfccfe" title="Set connections to the solution." alt="" coords="629,289,822,331"/>
<area shape="rect" href="namespacemf6coremodule.html#a622ba9fa9473eb16b9f17553d6483ae9" title="Simulation allocate and read." alt="" coords="614,355,837,382"/>
<area shape="rect" href="namespacemf6coremodule.html#a55d3318977ea83a1389aec5f42d5a77f" title="Define the simulation." alt="" coords="614,406,837,433"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041" title="Create connections from exchanges." alt="" coords="343,5,530,47"/>
<area shape="rect" href="namespacemf6bmi.html#ab8397f78e5c3c405656064c227eca26f" title="Clean up the initialized simulation." alt="" coords="357,254,517,281"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,305,281,331"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,305,53,331"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="335,137,539,163"/>
<area shape="rect" href="namespacemf6xmi.html#ac693e2880714e2c5d97a752123b19b7b" title="Finalize the time step." alt="" coords="357,71,517,112"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,137,271,163"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="355,188,518,229"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,355,544,382"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,355,276,382"/>
</map>
</div>

</div>
</div>
<a id="ace61fc3d934039f47a0eff6f420c235b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace61fc3d934039f47a0eff6f420c235b">&#9670;&nbsp;</a></span>createcoefficientmatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::createcoefficientmatrix </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sparsematrix), intent(inout)&#160;</td>
          <td class="paramname"><em>sparse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>this connection </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sparse</td><td>the sparse matrix with the cell connections </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00312">312</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment">   !&lt; this connection</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">type</span>(sparsematrix), <span class="keywordtype">intent(inout)</span> :: sparse<span class="comment"> !&lt; the sparse matrix with the cell connections</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierror</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    this%nja = sparse%nnz</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ia, this%neq + 1, <span class="stringliteral">&#39;IA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ja, this%nja, <span class="stringliteral">&#39;JA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%amat, this%nja, <span class="stringliteral">&#39;AMAT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">call </span>sparse%sort()</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">call </span>sparse%filliaja(this%ia, this%ja, ierror)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (ierror /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keyword">write</span>(*,*) <span class="stringliteral">&#39;Error: cannot fill ia/ja for model connection&#39;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph" id="namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph">
<area shape="rect" title="Create connection&#39;s matrix (ia,ja,amat) from sparse." alt="" coords="5,61,232,102"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="280,68,419,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="467,27,635,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="467,93,635,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="683,5,877,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="696,57,864,98"/>
</map>
</div>

</div>
</div>
<a id="aee8123b74db48f7a7eba19d980b2a65e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee8123b74db48f7a7eba19d980b2a65e">&#9670;&nbsp;</a></span>findmodelneighbors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::findmodelneighbors </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Needed when we deal with cases where the stencil </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00243">243</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">! local   </span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: connEx</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! loop over all exchanges in solution with same conn. type</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">do</span> i=1, this%globalExchanges%Count()</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        connex =&gt; getdisconnexchangefromlist(this%globalExchanges, i)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">! (possibly) add connection between models</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">call </span>this%gridConnection%addModelLink(connex)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_aee8123b74db48f7a7eba19d980b2a65e_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_aee8123b74db48f7a7eba19d980b2a65e_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_aee8123b74db48f7a7eba19d980b2a65e_cgraph" id="namespacespatialmodelconnectionmodule_aee8123b74db48f7a7eba19d980b2a65e_cgraph">
<area shape="rect" title="Create the topology of connected models." alt="" coords="5,5,232,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a63ac91d936c8b44104f8e091a81e7ac2" title=" " alt="" coords="280,5,495,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a9ad5f8b11f95c70aeda06b186754b567" title=" " alt="" coords="543,5,761,47"/>
</map>
</div>

</div>
</div>
<a id="afb3f4a52cda6271ee145014d5a35bc40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb3f4a52cda6271ee145014d5a35bc40">&#9670;&nbsp;</a></span>getnrofconnections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b) function spatialmodelconnectionmodule::getnrofconnections </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00295">295</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nrConns    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">!local</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iex</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">type</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: connEx</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    nrconns = 0</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">do</span> iex = 1, this%localExchanges%Count()</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      connex =&gt; getdisconnexchangefromlist(this%localExchanges, iex)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      nrconns = nrconns + connex%nexg</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_afb3f4a52cda6271ee145014d5a35bc40_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_afb3f4a52cda6271ee145014d5a35bc40_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_afb3f4a52cda6271ee145014d5a35bc40_cgraph" id="namespacespatialmodelconnectionmodule_afb3f4a52cda6271ee145014d5a35bc40_cgraph">
<area shape="rect" title="Returns total nr. of primary connections." alt="" coords="5,5,232,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a63ac91d936c8b44104f8e091a81e7ac2" title=" " alt="" coords="280,5,495,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a9ad5f8b11f95c70aeda06b186754b567" title=" " alt="" coords="543,5,761,47"/>
</map>
</div>

</div>
</div>
<a id="ab03c81ae159b53ae92e07d83d48cca29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab03c81ae159b53ae92e07d83d48cca29">&#9670;&nbsp;</a></span>getspatialmodelconnectionfromlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public spatialmodelconnectionmodule::getspatialmodelconnectionfromlist </td>
          <td>(</td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">list</td><td>the list </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>the index of the connection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the returned connection </dd></dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00416">416</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: list<span class="comment">             !&lt; the list</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idx<span class="comment">                   !&lt; the index of the connection</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: res<span class="comment"> !&lt; the returned connection</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: obj</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    obj =&gt; list%GetItem(idx)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    res =&gt; castasspatialmodelconnectionclass(obj)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph" id="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph">
<area shape="rect" title="Get the connection from a list." alt="" coords="5,5,264,47"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc" title="Cast to SpatialModelConnectionType." alt="" coords="312,5,573,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph" id="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph">
<area shape="rect" title="Get the connection from a list." alt="" coords="907,205,1165,247"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aa5b7a09a35bdd2b85e44caea16bb075e" title="Add global exchanges from a certain numerical solution to the connections." alt="" coords="609,5,842,47"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a70e26711a7029a6847798a6706ab0437" title="This function gets an existing connection for a model, based on the type of exchange...." alt="" coords="632,71,819,112"/>
<area shape="rect" href="namespacemf6coremodule.html#ae17efa5a9e03fd31617a08c08e20ae03" title="Finalize the simulation." alt="" coords="622,238,829,265"/>
<area shape="rect" href="namespacemf6coremodule.html#aab3891c5763fe8a941e6799fe9c82388" title="Finalize time step." alt="" coords="593,137,857,163"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="592,187,859,214"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a70c99123d0984c94b5c28ee5f8cfccfe" title="Set connections to the solution." alt="" coords="629,289,822,331"/>
<area shape="rect" href="namespacemf6coremodule.html#a622ba9fa9473eb16b9f17553d6483ae9" title="Simulation allocate and read." alt="" coords="614,355,837,382"/>
<area shape="rect" href="namespacemf6coremodule.html#a55d3318977ea83a1389aec5f42d5a77f" title="Define the simulation." alt="" coords="614,406,837,433"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041" title="Create connections from exchanges." alt="" coords="343,5,530,47"/>
<area shape="rect" href="namespacemf6bmi.html#ab8397f78e5c3c405656064c227eca26f" title="Clean up the initialized simulation." alt="" coords="357,254,517,281"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,305,281,331"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,305,53,331"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="335,137,539,163"/>
<area shape="rect" href="namespacemf6xmi.html#ac693e2880714e2c5d97a752123b19b7b" title="Finalize the time step." alt="" coords="357,71,517,112"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,137,271,163"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="355,188,518,229"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,355,544,382"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,355,276,382"/>
</map>
</div>

</div>
</div>
<a id="a5decccd26a66819f75ffa2036bc6378b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5decccd26a66819f75ffa2036bc6378b">&#9670;&nbsp;</a></span>setexchangeconnections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::setexchangeconnections </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00223">223</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iex, iconn</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">type</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: connEx</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">! set boundary cells</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">do</span> iex=1, this%localExchanges%Count()</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      connex =&gt; getdisconnexchangefromlist(this%localExchanges, iex)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">do</span> iconn=1, connex%nexg          </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">call </span>this%gridConnection%connectCell(connex%nodem1(iconn), connex%model1, connex%nodem2(iconn), connex%model2)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a5decccd26a66819f75ffa2036bc6378b_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a5decccd26a66819f75ffa2036bc6378b_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a5decccd26a66819f75ffa2036bc6378b_cgraph" id="namespacespatialmodelconnectionmodule_a5decccd26a66819f75ffa2036bc6378b_cgraph">
<area shape="rect" title="Set the primary connections from the exchange data." alt="" coords="5,5,232,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a63ac91d936c8b44104f8e091a81e7ac2" title=" " alt="" coords="280,5,495,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a9ad5f8b11f95c70aeda06b186754b567" title=" " alt="" coords="543,5,761,47"/>
</map>
</div>

</div>
</div>
<a id="a3bcf551fab052ae89d9e711d94d1c671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bcf551fab052ae89d9e711d94d1c671">&#9670;&nbsp;</a></span>setupgridconnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::setupgridconnection </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This works in three steps:</p><ol type="1">
<li>set the primary connections</li>
<li>create the topology of connected models, finding neighbors of neighboring models when required</li>
<li>extend the interface grid, using that information <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>
</li>
</ol>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00206">206</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">! set boundary cells</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">call </span>this%setExchangeConnections()</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">! create topology of models</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">call </span>this%findModelNeighbors()</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">! now scan for nbr-of-nbrs and create final data structures    </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">call </span>this%gridConnection%extendConnection()</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    </div>
</div><!-- fragment -->
</div>
</div>
<a id="a73309ec8404db180c2d3050ef33dc68b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73309ec8404db180c2d3050ef33dc68b">&#9670;&nbsp;</a></span>spatialcon_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00175">175</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%neq)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nja)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%internalStencilDepth)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%exchangeStencilDepth)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nrOfConnections)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ia)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ja)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%amat)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%x)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rhs)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%active)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">call </span>this%gridConnection%destroy()</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">deallocate</span>(this%gridConnection)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">deallocate</span>(this%mapIdxToSln)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  </div>
</div><!-- fragment -->
</div>
</div>
<a id="a33bf848774c4a590db0f35095e21f84d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33bf848774c4a590db0f35095e21f84d">&#9670;&nbsp;</a></span>spatialcon_df()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00124">124</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">! create the grid connection data structure</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    this%nrOfConnections = this%getNrOfConnections()</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">call </span>this%gridConnection%construct(this%owner, this%nrOfConnections, this%name)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    this%gridConnection%internalStencilDepth = this%internalStencilDepth</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    this%gridConnection%exchangeStencilDepth = this%exchangeStencilDepth</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">call </span>this%setupGridConnection()</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    this%neq = this%gridConnection%nrOfCells</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">call </span>this%allocateArrays()</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    </div>
</div><!-- fragment -->
</div>
</div>
<a id="aee338ca429ac57486e61429330ae6512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee338ca429ac57486e61429330ae6512">&#9670;&nbsp;</a></span>spatialcon_mc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_mc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>iasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>jasln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>this connection </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iasln</td><td>global IA array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jasln</td><td>global JA array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00141">141</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacecsrutilsmodule.html">csrutilsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470">getcsrindex</a></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegridconnectionmodule.html">gridconnectionmodule</a></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment">       !&lt; this connection</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: iasln<span class="comment"> !&lt; global IA array</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: jasln<span class="comment"> !&lt; global JA array</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: m, n, mglo, nglo, ipos, csrIdx</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: isOwnedConnection</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">allocate</span>(this%mapIdxToSln(this%nja))</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">do</span> n = 1, this%neq      </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      isownedconnection = <span class="keyword">associated</span>(this%gridConnection%idxToGlobal(n)%model, this%owner)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">do</span> ipos = this%ia(n), this%ia(n+1)-1</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        m = this%ja(ipos)        </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        nglo = this%gridConnection%idxToGlobal(n)%index + this%gridConnection%idxToGlobal(n)%model%moffset</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        mglo = this%gridConnection%idxToGlobal(m)%index + this%gridConnection%idxToGlobal(m)%model%moffset</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        csridx = <a class="code" href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470">getcsrindex</a>(nglo, mglo, iasln, jasln)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">if</span> (csridx == -1 .and. isownedconnection) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <span class="comment">! this should not be possible</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="keyword">write</span>(*,*) <span class="stringliteral">&#39;Error: cannot find cell connection in global system&#39;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        this%mapIdxToSln(ipos) = csridx</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_aee338ca429ac57486e61429330ae6512_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_aee338ca429ac57486e61429330ae6512_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_aee338ca429ac57486e61429330ae6512_cgraph" id="namespacespatialmodelconnectionmodule_aee338ca429ac57486e61429330ae6512_cgraph">
<area shape="rect" title="Creates the mapping from the local system." alt="" coords="5,35,232,77"/>
<area shape="rect" href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470" title="Return index for element i,j in CSR storage,." alt="" coords="280,17,483,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="312,68,451,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="531,27,699,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="531,93,699,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="747,5,941,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="760,57,928,98"/>
</map>
</div>

</div>
</div>
<a id="a300adbd33d8148fdadb60d42afa3665c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a300adbd33d8148fdadb60d42afa3665c">&#9670;&nbsp;</a></span>spatialconnection_ctor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialconnection_ctor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(numericalmodeltype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This constructor is typically called from a derived class. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>the connection </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>the model that owns the connection </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>the connection name (for memory management mostly) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00090">90</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment">               !&lt; the connection</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">pointer</span> :: model<span class="comment"> !&lt; the model that owns the connection</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name<span class="comment">                    !&lt; the connection name (for memory management mostly)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    this%name = name</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    this%memoryPath = <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a>(this%name)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    this%owner =&gt; model</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">allocate</span>(this%localExchanges)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">allocate</span>(this%gridConnection)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">call </span>this%allocateScalars()</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    this%internalStencilDepth = 1</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    this%exchangeStencilDepth = 1</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    this%nrOfConnections = 0</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_cgraph" id="namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_cgraph">
<area shape="rect" title="Construct the spatial connection base." alt="" coords="5,61,232,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738" title="returns the path to the memory object" alt="" coords="280,61,447,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="495,61,661,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="709,68,884,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="932,68,1071,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1119,27,1287,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="1119,93,1287,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1335,5,1529,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1348,57,1516,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_icgraph" id="namespacespatialmodelconnectionmodule_a300adbd33d8148fdadb60d42afa3665c_icgraph">
<area shape="rect" title="Construct the spatial connection base." alt="" coords="280,13,507,54"/>
<area shape="rect" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html#a9a8646d6e793d99f3a83e81a05d8a9f1" title=" " alt="" coords="5,5,232,61"/>
</map>
</div>

</div>
</div>
<a id="a0574292d636407e09dae880717f67331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0574292d636407e09dae880717f67331">&#9670;&nbsp;</a></span>validateconnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::validateconnection </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00336">336</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iex</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: disconnEx</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">! loop over exchanges</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">do</span> iex=1, this%localExchanges%Count()</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      disconnex =&gt; getdisconnexchangefromlist(this%localExchanges, iex)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keyword">call </span>this%validateDisConnExchange(disconnex)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph" id="namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph">
<area shape="rect" title="Validate this connection." alt="" coords="5,5,232,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a63ac91d936c8b44104f8e091a81e7ac2" title=" " alt="" coords="280,5,495,47"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a9ad5f8b11f95c70aeda06b186754b567" title=" " alt="" coords="543,5,761,47"/>
</map>
</div>

</div>
</div>
<a id="a7d289ce9225cf205e6edefdb73f8b827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d289ce9225cf205e6edefdb73f8b827">&#9670;&nbsp;</a></span>validatedisconnexchange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::validatedisconnexchange </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disconnexchangetype)&#160;</td>
          <td class="paramname"><em>exchange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stops with error message on wrong config. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
    <tr><td class="paramname">exchange</td><td>the discretization connection to validate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00356">356</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType) :: exchange<span class="comment">    !&lt; the discretization connection to validate</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (exchange%ixt3d &gt; 0) <span class="keywordflow">then</span>      </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">! if XT3D, we need these angles:</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">if</span> (exchange%model1%dis%con%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>, <span class="stringliteral">&#39;(1x,a,a,a,a,a)&#39;</span>) <span class="stringliteral">&#39;XT3D configured on the exchange &#39;</span>,      &amp;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;              trim(exchange%name), <span class="stringliteral">&#39; but the discretization in model &#39;</span>,          &amp;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;              trim(exchange%model1%name), <span class="stringliteral">&#39; has no ANGLDEGX specified&#39;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">if</span> (exchange%model2%dis%con%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>, <span class="stringliteral">&#39;(1x,a,a,a,a,a)&#39;</span>) <span class="stringliteral">&#39;XT3D configured on the exchange &#39;</span>,      &amp;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;              trim(exchange%name), <span class="stringliteral">&#39; but the discretization in model &#39;</span>,          &amp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;              trim(exchange%model2%name), <span class="stringliteral">&#39; has no ANGLDEGX specified&#39;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a7d289ce9225cf205e6edefdb73f8b827_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a7d289ce9225cf205e6edefdb73f8b827_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a7d289ce9225cf205e6edefdb73f8b827_cgraph" id="namespacespatialmodelconnectionmodule_a7d289ce9225cf205e6edefdb73f8b827_cgraph">
<area shape="rect" title="Validate the exchange, intercepting those cases where two models have to be connected through an inte..." alt="" coords="5,61,232,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="280,68,455,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="503,68,641,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="689,27,857,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="689,93,857,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="905,5,1100,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="919,57,1087,98"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacesimvariablesmodule_html_a08c1a8900029e311ac640e2319c6a234"><div class="ttname"><a href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">simvariablesmodule::errmsg</a></div><div class="ttdeci">character(len=maxcharlen) errmsg</div><div class="ttdoc">error message string</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00017">SimVariables.f90:17</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdoc">real constant zero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00054">Constants.f90:54</a></div></div>
<div class="ttc" id="anamespacegridconnectionmodule_html"><div class="ttname"><a href="namespacegridconnectionmodule.html">gridconnectionmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_grid_connection_8f90_source.html#l00001">GridConnection.f90:1</a></div></div>
<div class="ttc" id="anamespacecsrutilsmodule_html"><div class="ttname"><a href="namespacecsrutilsmodule.html">csrutilsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_csr_utils_8f90_source.html#l00001">CsrUtils.f90:1</a></div></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdoc">This module contains simulation methods.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00010">Sim.f90:10</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_a3791dbc2d4a06a0b9112158cff21f738"><div class="ttname"><a href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:21</a></div></div>
<div class="ttc" id="anamespacecsrutilsmodule_html_a0fbb240524fa0172b9ee6a14844f4470"><div class="ttname"><a href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470">csrutilsmodule::getcsrindex</a></div><div class="ttdeci">integer(i4b) function, public getcsrindex(i, j, ia, ja)</div><div class="ttdoc">Return index for element i,j in CSR storage,.</div><div class="ttdef"><b>Definition:</b> <a href="_csr_utils_8f90_source.html#l00013">CsrUtils.f90:13</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a0be97214c1d4fcf42bc4ddc27b111b61"><div class="ttname"><a href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">simmodule::ustop</a></div><div class="ttdeci">subroutine, public ustop(stopmess, ioutlocal)</div><div class="ttdoc">Stop the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00364">Sim.f90:364</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html"><div class="ttname"><a href="namespacesimvariablesmodule.html">simvariablesmodule</a></div><div class="ttdoc">This module contains simulation variables.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00009">SimVariables.f90:9</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdoc">This module contains simulation constants.</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00009">Constants.f90:9</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacespatialmodelconnectionmodule.html">spatialmodelconnectionmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:22 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
