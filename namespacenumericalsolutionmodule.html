<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: numericalsolutionmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="CustomDoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version6.2.2</span>
   </div>
   <div id="projectbrief">MODFLOW6CodeDocumentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacenumericalsolutionmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">numericalsolutionmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:afe1d36406e23aa824de7b49f7a96a543"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#afe1d36406e23aa824de7b49f7a96a543">solution_create</a> (filename, id)</td></tr>
<tr class="memdesc:afe1d36406e23aa824de7b49f7a96a543"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new solution  <a href="namespacenumericalsolutionmodule.html#afe1d36406e23aa824de7b49f7a96a543">More...</a><br /></td></tr>
<tr class="separator:afe1d36406e23aa824de7b49f7a96a543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed3ab97a33364c36ba3d9395e30b81f1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#aed3ab97a33364c36ba3d9395e30b81f1">allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:aed3ab97a33364c36ba3d9395e30b81f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespacenumericalsolutionmodule.html#aed3ab97a33364c36ba3d9395e30b81f1">More...</a><br /></td></tr>
<tr class="separator:aed3ab97a33364c36ba3d9395e30b81f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2518d004a3f094cc01c98f915b3c225"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ad2518d004a3f094cc01c98f915b3c225">allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:ad2518d004a3f094cc01c98f915b3c225"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays  <a href="namespacenumericalsolutionmodule.html#ad2518d004a3f094cc01c98f915b3c225">More...</a><br /></td></tr>
<tr class="separator:ad2518d004a3f094cc01c98f915b3c225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b3255995926f4887838220f0ea12c40"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a4b3255995926f4887838220f0ea12c40">sln_df</a> (this)</td></tr>
<tr class="memdesc:a4b3255995926f4887838220f0ea12c40"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define the solution  <a href="namespacenumericalsolutionmodule.html#a4b3255995926f4887838220f0ea12c40">More...</a><br /></td></tr>
<tr class="separator:a4b3255995926f4887838220f0ea12c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe804dcafea9bef2ef528e68475ac3ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#abe804dcafea9bef2ef528e68475ac3ec">sln_ar</a> (this)</td></tr>
<tr class="memdesc:abe804dcafea9bef2ef528e68475ac3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read data  <a href="namespacenumericalsolutionmodule.html#abe804dcafea9bef2ef528e68475ac3ec">More...</a><br /></td></tr>
<tr class="separator:abe804dcafea9bef2ef528e68475ac3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0532bb986b3da12da5b753fc999bbe0e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a0532bb986b3da12da5b753fc999bbe0e">sln_calculate_delt</a> (this)</td></tr>
<tr class="memdesc:a0532bb986b3da12da5b753fc999bbe0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate delt  <a href="namespacenumericalsolutionmodule.html#a0532bb986b3da12da5b753fc999bbe0e">More...</a><br /></td></tr>
<tr class="separator:a0532bb986b3da12da5b753fc999bbe0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eac961b7084de083212f76fc6515dff"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a7eac961b7084de083212f76fc6515dff">sln_ad</a> (this)</td></tr>
<tr class="memdesc:a7eac961b7084de083212f76fc6515dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance solution  <a href="namespacenumericalsolutionmodule.html#a7eac961b7084de083212f76fc6515dff">More...</a><br /></td></tr>
<tr class="separator:a7eac961b7084de083212f76fc6515dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4632e3dda1e8c84713288749c18d1b40"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a4632e3dda1e8c84713288749c18d1b40">sln_ot</a> (this)</td></tr>
<tr class="memdesc:a4632e3dda1e8c84713288749c18d1b40"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output solution  <a href="namespacenumericalsolutionmodule.html#a4632e3dda1e8c84713288749c18d1b40">More...</a><br /></td></tr>
<tr class="separator:a4632e3dda1e8c84713288749c18d1b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9158456ae05512c728b125a9c877e1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a2f9158456ae05512c728b125a9c877e1">sln_fp</a> (this)</td></tr>
<tr class="memdesc:a2f9158456ae05512c728b125a9c877e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Finalize solution  <a href="namespacenumericalsolutionmodule.html#a2f9158456ae05512c728b125a9c877e1">More...</a><br /></td></tr>
<tr class="separator:a2f9158456ae05512c728b125a9c877e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748042c7737328020b0453d734a83a7c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a748042c7737328020b0453d734a83a7c">sln_da</a> (this)</td></tr>
<tr class="memdesc:a748042c7737328020b0453d734a83a7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate solution  <a href="namespacenumericalsolutionmodule.html#a748042c7737328020b0453d734a83a7c">More...</a><br /></td></tr>
<tr class="separator:a748042c7737328020b0453d734a83a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c7daf42e56a62cccf6625801a30dcb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ac1c7daf42e56a62cccf6625801a30dcb">sln_ca</a> (this, isgcnvg, isuppress_output)</td></tr>
<tr class="memdesc:ac1c7daf42e56a62cccf6625801a30dcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Solve solution  <a href="namespacenumericalsolutionmodule.html#ac1c7daf42e56a62cccf6625801a30dcb">More...</a><br /></td></tr>
<tr class="separator:ac1c7daf42e56a62cccf6625801a30dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a269ecfdf5d4ba92cb06b49f83c93e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a45a269ecfdf5d4ba92cb06b49f83c93e">writecsvheader</a> (this)</td></tr>
<tr class="memdesc:a45a269ecfdf5d4ba92cb06b49f83c93e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief CSV header  <a href="namespacenumericalsolutionmodule.html#a45a269ecfdf5d4ba92cb06b49f83c93e">More...</a><br /></td></tr>
<tr class="separator:a45a269ecfdf5d4ba92cb06b49f83c93e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96796cf48dfa4040e98467780719861"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ae96796cf48dfa4040e98467780719861">writeptcinfotofile</a> (this, kper)</td></tr>
<tr class="memdesc:ae96796cf48dfa4040e98467780719861"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief PTC header  <a href="namespacenumericalsolutionmodule.html#ae96796cf48dfa4040e98467780719861">More...</a><br /></td></tr>
<tr class="separator:ae96796cf48dfa4040e98467780719861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad38d2c1f3ad4cdb32b3e9e51329d5913"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ad38d2c1f3ad4cdb32b3e9e51329d5913">preparesolve</a> (this)</td></tr>
<tr class="memdesc:ad38d2c1f3ad4cdb32b3e9e51329d5913"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief prepare to solve  <a href="namespacenumericalsolutionmodule.html#ad38d2c1f3ad4cdb32b3e9e51329d5913">More...</a><br /></td></tr>
<tr class="separator:ad38d2c1f3ad4cdb32b3e9e51329d5913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964262851ef62c07577f4b3bbf384e15"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a964262851ef62c07577f4b3bbf384e15">solve</a> (this, kiter)</td></tr>
<tr class="memdesc:a964262851ef62c07577f4b3bbf384e15"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Build and solve the simulation  <a href="namespacenumericalsolutionmodule.html#a964262851ef62c07577f4b3bbf384e15">More...</a><br /></td></tr>
<tr class="separator:a964262851ef62c07577f4b3bbf384e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fcf392bb98599ca511fdf62749e9447"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a7fcf392bb98599ca511fdf62749e9447">finalizesolve</a> (this, kiter, isgcnvg, isuppress_output)</td></tr>
<tr class="memdesc:a7fcf392bb98599ca511fdf62749e9447"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief finalize a solution  <a href="namespacenumericalsolutionmodule.html#a7fcf392bb98599ca511fdf62749e9447">More...</a><br /></td></tr>
<tr class="separator:a7fcf392bb98599ca511fdf62749e9447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a049b24b9778d68a7ba2d6f7e7cd29ac7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a049b24b9778d68a7ba2d6f7e7cd29ac7">convergence_summary</a> (this, iu, im, itertot_timestep)</td></tr>
<tr class="memdesc:a049b24b9778d68a7ba2d6f7e7cd29ac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Solution convergence summary  <a href="namespacenumericalsolutionmodule.html#a049b24b9778d68a7ba2d6f7e7cd29ac7">More...</a><br /></td></tr>
<tr class="separator:a049b24b9778d68a7ba2d6f7e7cd29ac7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2c51dfe927f5da25fea34cf68b4a2ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ac2c51dfe927f5da25fea34cf68b4a2ee">csv_convergence_summary</a> (this, iu, totim, kper, kstp, kouter, niter, istart, kstart)</td></tr>
<tr class="memdesc:ac2c51dfe927f5da25fea34cf68b4a2ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Solution convergence CSV summary  <a href="namespacenumericalsolutionmodule.html#ac2c51dfe927f5da25fea34cf68b4a2ee">More...</a><br /></td></tr>
<tr class="separator:ac2c51dfe927f5da25fea34cf68b4a2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137719ffc7e35092e3c4bd7437443f72"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a137719ffc7e35092e3c4bd7437443f72">save</a> (this, filename)</td></tr>
<tr class="memdesc:a137719ffc7e35092e3c4bd7437443f72"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Save solution data to a file  <a href="namespacenumericalsolutionmodule.html#a137719ffc7e35092e3c4bd7437443f72">More...</a><br /></td></tr>
<tr class="separator:a137719ffc7e35092e3c4bd7437443f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e2dfd5e0ff41ab84ee2829d01b9b83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#af0e2dfd5e0ff41ab84ee2829d01b9b83">add_model</a> (this, mp)</td></tr>
<tr class="memdesc:af0e2dfd5e0ff41ab84ee2829d01b9b83"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add a model  <a href="namespacenumericalsolutionmodule.html#af0e2dfd5e0ff41ab84ee2829d01b9b83">More...</a><br /></td></tr>
<tr class="separator:af0e2dfd5e0ff41ab84ee2829d01b9b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed5ffb5b1c97828ad2f0cb2c8035da0"><td class="memItemLeft" align="right" valign="top">type(listtype) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a7ed5ffb5b1c97828ad2f0cb2c8035da0">get_models</a> (this)</td></tr>
<tr class="memdesc:a7ed5ffb5b1c97828ad2f0cb2c8035da0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a list of models.  <a href="namespacenumericalsolutionmodule.html#a7ed5ffb5b1c97828ad2f0cb2c8035da0">More...</a><br /></td></tr>
<tr class="separator:a7ed5ffb5b1c97828ad2f0cb2c8035da0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af02235be2396e91532acce9a36abee97"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#af02235be2396e91532acce9a36abee97">add_exchange</a> (this, exchange)</td></tr>
<tr class="memdesc:af02235be2396e91532acce9a36abee97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add exchange.  <a href="namespacenumericalsolutionmodule.html#af02235be2396e91532acce9a36abee97">More...</a><br /></td></tr>
<tr class="separator:af02235be2396e91532acce9a36abee97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af64aed80e4521475b814733555b327"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a3af64aed80e4521475b814733555b327">sln_connect</a> (this)</td></tr>
<tr class="memdesc:a3af64aed80e4521475b814733555b327"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Assign solution connections  <a href="namespacenumericalsolutionmodule.html#a3af64aed80e4521475b814733555b327">More...</a><br /></td></tr>
<tr class="separator:a3af64aed80e4521475b814733555b327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6bb33e0aaff92c1244857513eedf312"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ac6bb33e0aaff92c1244857513eedf312">sln_reset</a> (this)</td></tr>
<tr class="memdesc:ac6bb33e0aaff92c1244857513eedf312"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Reset the solution  <a href="namespacenumericalsolutionmodule.html#ac6bb33e0aaff92c1244857513eedf312">More...</a><br /></td></tr>
<tr class="separator:ac6bb33e0aaff92c1244857513eedf312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e6fe297bd0318f1d628ce549bca68d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#aa3e6fe297bd0318f1d628ce549bca68d">sln_ls</a> (this, kiter, kstp, kper, in_iter, iptc, ptcf)</td></tr>
<tr class="memdesc:aa3e6fe297bd0318f1d628ce549bca68d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Solve the linear system of equations  <a href="namespacenumericalsolutionmodule.html#aa3e6fe297bd0318f1d628ce549bca68d">More...</a><br /></td></tr>
<tr class="separator:aa3e6fe297bd0318f1d628ce549bca68d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90145df172cfa4ef4e2e3505659d454e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a90145df172cfa4ef4e2e3505659d454e">sln_setouter</a> (this, ifdparam)</td></tr>
<tr class="memdesc:a90145df172cfa4ef4e2e3505659d454e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set default Picard iteration variables  <a href="namespacenumericalsolutionmodule.html#a90145df172cfa4ef4e2e3505659d454e">More...</a><br /></td></tr>
<tr class="separator:a90145df172cfa4ef4e2e3505659d454e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e4b4c1609f9833296260d4a9deefdd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a61e4b4c1609f9833296260d4a9deefdd">sln_backtracking</a> (this, mp, cp, kiter)</td></tr>
<tr class="memdesc:a61e4b4c1609f9833296260d4a9deefdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Perform backtracking  <a href="namespacenumericalsolutionmodule.html#a61e4b4c1609f9833296260d4a9deefdd">More...</a><br /></td></tr>
<tr class="separator:a61e4b4c1609f9833296260d4a9deefdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd46eaed7689801fb0a957d25939225"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#acbd46eaed7689801fb0a957d25939225">sln_backtracking_xupdate</a> (this, btflag)</td></tr>
<tr class="memdesc:acbd46eaed7689801fb0a957d25939225"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Backtracking update of the dependent variable  <a href="namespacenumericalsolutionmodule.html#acbd46eaed7689801fb0a957d25939225">More...</a><br /></td></tr>
<tr class="separator:acbd46eaed7689801fb0a957d25939225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d6d46a24e32901def02a0b6b553248"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#ab0d6d46a24e32901def02a0b6b553248">sln_l2norm</a> (this, neq, nja, ia, ja, active, amat, rhs, x, l2norm)</td></tr>
<tr class="memdesc:ab0d6d46a24e32901def02a0b6b553248"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the solution L-2 norm  <a href="namespacenumericalsolutionmodule.html#ab0d6d46a24e32901def02a0b6b553248">More...</a><br /></td></tr>
<tr class="separator:ab0d6d46a24e32901def02a0b6b553248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475b3a3dafa811568f0ca944fc69d066"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a475b3a3dafa811568f0ca944fc69d066">sln_maxval</a> (this, nsize, v, vmax)</td></tr>
<tr class="memdesc:a475b3a3dafa811568f0ca944fc69d066"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Get the maximum value from a vector  <a href="namespacenumericalsolutionmodule.html#a475b3a3dafa811568f0ca944fc69d066">More...</a><br /></td></tr>
<tr class="separator:a475b3a3dafa811568f0ca944fc69d066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9b69ce721f9271042d955ac6d21c35f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#aa9b69ce721f9271042d955ac6d21c35f">sln_calcdx</a> (this, neq, active, x, xtemp, dx)</td></tr>
<tr class="memdesc:aa9b69ce721f9271042d955ac6d21c35f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate dependent-variable change  <a href="namespacenumericalsolutionmodule.html#aa9b69ce721f9271042d955ac6d21c35f">More...</a><br /></td></tr>
<tr class="separator:aa9b69ce721f9271042d955ac6d21c35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a714a62a841f370b7472eeed70f030f77"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a714a62a841f370b7472eeed70f030f77">sln_underrelax</a> (this, kiter, bigch, neq, active, x, xtemp)</td></tr>
<tr class="memdesc:a714a62a841f370b7472eeed70f030f77"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Under-relaxation  <a href="namespacenumericalsolutionmodule.html#a714a62a841f370b7472eeed70f030f77">More...</a><br /></td></tr>
<tr class="separator:a714a62a841f370b7472eeed70f030f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3d89607aaac24faece4e0decc96a1e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a8a3d89607aaac24faece4e0decc96a1e">sln_outer_check</a> (this, hncg, lrch)</td></tr>
<tr class="memdesc:a8a3d89607aaac24faece4e0decc96a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Determine maximum dependent-variable change  <a href="namespacenumericalsolutionmodule.html#a8a3d89607aaac24faece4e0decc96a1e">More...</a><br /></td></tr>
<tr class="separator:a8a3d89607aaac24faece4e0decc96a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e536e8da68c7f8a12f3731f27b409c0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a3e536e8da68c7f8a12f3731f27b409c0">sln_get_loc</a> (this, nodesln, str)</td></tr>
<tr class="memdesc:a3e536e8da68c7f8a12f3731f27b409c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Get cell location string  <a href="namespacenumericalsolutionmodule.html#a3e536e8da68c7f8a12f3731f27b409c0">More...</a><br /></td></tr>
<tr class="separator:a3e536e8da68c7f8a12f3731f27b409c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0673b47847b9b33923ecc11dbc2d8359"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#a0673b47847b9b33923ecc11dbc2d8359">sln_get_nodeu</a> (this, nodesln, im, nodeu)</td></tr>
<tr class="memdesc:a0673b47847b9b33923ecc11dbc2d8359"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Get user node number  <a href="namespacenumericalsolutionmodule.html#a0673b47847b9b33923ecc11dbc2d8359">More...</a><br /></td></tr>
<tr class="separator:a0673b47847b9b33923ecc11dbc2d8359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefead85b912cfb79e860d6fe3cb2069c"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#aefead85b912cfb79e860d6fe3cb2069c">castasnumericalsolutionclass</a> (obj)</td></tr>
<tr class="memdesc:aefead85b912cfb79e860d6fe3cb2069c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Cast a object as a Numerical Solution  <a href="namespacenumericalsolutionmodule.html#aefead85b912cfb79e860d6fe3cb2069c">More...</a><br /></td></tr>
<tr class="separator:aefead85b912cfb79e860d6fe3cb2069c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc653881da580b6418122bb466276f63"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumericalsolutionmodule.html#acc653881da580b6418122bb466276f63">getnumericalsolutionfromlist</a> (list, idx)</td></tr>
<tr class="memdesc:acc653881da580b6418122bb466276f63"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Get a numerical solution  <a href="namespacenumericalsolutionmodule.html#acc653881da580b6418122bb466276f63">More...</a><br /></td></tr>
<tr class="separator:acc653881da580b6418122bb466276f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="af02235be2396e91532acce9a36abee97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af02235be2396e91532acce9a36abee97">&#9670;&nbsp;</a></span>add_exchange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::add_exchange </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(baseexchangetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>exchange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add and exchange to thisexchangelist. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exchange</td><td>model exchange instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02187">2187</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">                       !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keywordtype">class</span>(BaseExchangeType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: exchange<span class="comment">   !&lt; model exchange instance</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: num_ex =&gt; null()</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">! -- add exchange</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">select type</span>(exchange)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="keywordflow">    class is</span> (numericalexchangetype)</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      num_ex =&gt; exchange</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <span class="keyword">call </span>addnumericalexchangetolist(this%exchangelist, num_ex)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_af02235be2396e91532acce9a36abee97_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_af02235be2396e91532acce9a36abee97_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_af02235be2396e91532acce9a36abee97_cgraph" id="namespacenumericalsolutionmodule_af02235be2396e91532acce9a36abee97_cgraph">
<area shape="rect" title="Add exchange." alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a56a50d312b63be01db46d31e4992d451" title=" " alt="" coords="241,5,456,47"/>
</map>
</div>

</div>
</div>
<a id="af0e2dfd5e0ff41ab84ee2829d01b9b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0e2dfd5e0ff41ab84ee2829d01b9b83">&#9670;&nbsp;</a></span>add_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::add_model </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(basemodeltype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>mp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a model to s solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mp</td><td>model instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02149">2149</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">             !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keywordtype">class</span>(BaseModelType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: mp<span class="comment">  !&lt; model instance</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: m =&gt; null()</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">! -- add a model</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">select type</span>(mp)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="keywordflow">    class is</span> (numericalmodeltype)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      m =&gt; mp</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="keyword">call </span>addnumericalmodeltolist(this%modellist, m)</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_af0e2dfd5e0ff41ab84ee2829d01b9b83_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_af0e2dfd5e0ff41ab84ee2829d01b9b83_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_af0e2dfd5e0ff41ab84ee2829d01b9b83_cgraph" id="namespacenumericalsolutionmodule_af0e2dfd5e0ff41ab84ee2829d01b9b83_cgraph">
<area shape="rect" title="@ brief Add a model" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a065349973a4697016b21beb9cd1446b2" title=" " alt="" coords="241,5,435,47"/>
</map>
</div>

</div>
</div>
<a id="ad2518d004a3f094cc01c98f915b3c225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2518d004a3f094cc01c98f915b3c225">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate arrays for a new solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l00338">338</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ieq</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">! -- initialize the number of models in the solution</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    this%convnmod = this%modellist%Count()</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">! -- allocate arrays</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ia, this%neq + 1, <span class="stringliteral">&#39;IA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%x, this%neq, <span class="stringliteral">&#39;X&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rhs, this%neq, <span class="stringliteral">&#39;RHS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%active, this%neq, <span class="stringliteral">&#39;IACTIVE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%xtemp, this%neq, <span class="stringliteral">&#39;XTEMP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dxold, this%neq, <span class="stringliteral">&#39;DXOLD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%hncg, 0, <span class="stringliteral">&#39;HNCG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%lrch, 3, 0, <span class="stringliteral">&#39;LRCH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%wsave, 0, <span class="stringliteral">&#39;WSAVE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%hchold, 0, <span class="stringliteral">&#39;HCHOLD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%deold, 0, <span class="stringliteral">&#39;DEOLD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%convmodstart, this%convnmod+1, <span class="stringliteral">&#39;CONVMODSTART&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%locdv, this%convnmod, <span class="stringliteral">&#39;LOCDV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%locdr, this%convnmod, <span class="stringliteral">&#39;LOCDR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%itinner, 0, <span class="stringliteral">&#39;ITINNER&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%convlocdv, this%convnmod, 0, <span class="stringliteral">&#39;CONVLOCDV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%convlocdr, this%convnmod, 0, <span class="stringliteral">&#39;CONVLOCDR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dvmax, this%convnmod, <span class="stringliteral">&#39;DVMAX&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%drmax, this%convnmod, <span class="stringliteral">&#39;DRMAX&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%convdvmax, this%convnmod, 0, <span class="stringliteral">&#39;CONVDVMAX&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%convdrmax, this%convnmod, 0, <span class="stringliteral">&#39;CONVDRMAX&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">! -- initialize allocated arrays</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">do</span> i = 1, this%neq</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      this%x(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      this%xtemp(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      this%dxold(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      this%active(i) = 1 <span class="comment">!default is active</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">do</span> i = 1, this%convnmod</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      this%locdv(i) = 0</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      this%locdr(i) = 0</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      this%dvmax(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      this%drmax(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">! -- initialize convmodstart</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    ieq = 1</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    this%convmodstart(1) = ieq</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">do</span> i = 1, this%modellist%Count()</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, i)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      ieq = ieq + mp%neq</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      this%convmodstart(i+1) = ieq</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_ad2518d004a3f094cc01c98f915b3c225_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_ad2518d004a3f094cc01c98f915b3c225_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_ad2518d004a3f094cc01c98f915b3c225_cgraph" id="namespacenumericalsolutionmodule_ad2518d004a3f094cc01c98f915b3c225_cgraph">
<area shape="rect" title="@ brief Allocate arrays" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
<a id="aed3ab97a33364c36ba3d9395e30b81f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed3ab97a33364c36ba3d9395e30b81f1">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate scalars for a new solution. </p>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l00234">234</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">! -- allocate scalars</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%id, <span class="stringliteral">&#39;ID&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iu, <span class="stringliteral">&#39;IU&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ttform, <span class="stringliteral">&#39;TTFORM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ttsoln, <span class="stringliteral">&#39;TTSOLN&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%neq, <span class="stringliteral">&#39;NEQ&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nja, <span class="stringliteral">&#39;NJA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dvclose, <span class="stringliteral">&#39;DVCLOSE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bigchold, <span class="stringliteral">&#39;BIGCHOLD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bigch, <span class="stringliteral">&#39;BIGCH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%relaxold, <span class="stringliteral">&#39;RELAXOLD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%res_prev, <span class="stringliteral">&#39;RES_PREV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%res_new, <span class="stringliteral">&#39;RES_NEW&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icnvg, <span class="stringliteral">&#39;ICNVG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%itertot_timestep, <span class="stringliteral">&#39;ITERTOT_TIMESTEP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iouttot_timestep, <span class="stringliteral">&#39;IOUTTOT_TIMESTEP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%itertot_sim, <span class="stringliteral">&#39;INNERTOT_SIM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%mxiter, <span class="stringliteral">&#39;MXITER&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%linmeth, <span class="stringliteral">&#39;LINMETH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nonmeth, <span class="stringliteral">&#39;NONMETH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iprims, <span class="stringliteral">&#39;IPRIMS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%theta, <span class="stringliteral">&#39;THETA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%akappa, <span class="stringliteral">&#39;AKAPPA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%gamma, <span class="stringliteral">&#39;GAMMA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%amomentum, <span class="stringliteral">&#39;AMOMENTUM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%breduc, <span class="stringliteral">&#39;BREDUC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%btol, <span class="stringliteral">&#39;BTOL&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%res_lim, <span class="stringliteral">&#39;RES_LIM&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%numtrack, <span class="stringliteral">&#39;NUMTRACK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ibflag, <span class="stringliteral">&#39;IBFLAG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icsvouterout, <span class="stringliteral">&#39;ICSVOUTEROUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icsvinnerout, <span class="stringliteral">&#39;ICSVINNEROUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nitermax, <span class="stringliteral">&#39;NITERMAX&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%convnmod, <span class="stringliteral">&#39;CONVNMOD&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iallowptc, <span class="stringliteral">&#39;IALLOWPTC&#39;</span>, this%memoryPath) </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iptcopt, <span class="stringliteral">&#39;IPTCOPT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iptcout, <span class="stringliteral">&#39;IPTCOUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%l2norm0, <span class="stringliteral">&#39;L2NORM0&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ptcdel, <span class="stringliteral">&#39;PTCDEL&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ptcdel0, <span class="stringliteral">&#39;PTCDEL0&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ptcexp, <span class="stringliteral">&#39;PTCEXP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ptcthresh, <span class="stringliteral">&#39;PTCTHRESH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ptcrat, <span class="stringliteral">&#39;PTCRAT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%atsfrac, <span class="stringliteral">&#39;ATSFRAC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">! -- initialize scalars</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    this%id = 0</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    this%iu = 0</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    this%ttform = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    this%ttsoln = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    this%neq = 0</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    this%nja = 0</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    this%dvclose = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    this%bigchold = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    this%bigch = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    this%relaxold = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    this%res_prev = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    this%icnvg = 0</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    this%itertot_timestep = 0</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    this%iouttot_timestep = 0</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    this%itertot_sim = 0</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    this%mxiter = 0</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    this%linmeth = 1</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    this%nonmeth = 0</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    this%iprims = 0</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    this%theta = done</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    this%akappa = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    this%gamma = done</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    this%amomentum = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    this%breduc = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    this%btol = 0</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    this%res_lim = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    this%numtrack = 0</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    this%ibflag = 0</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    this%icsvouterout = 0</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    this%icsvinnerout = 0</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    this%nitermax = 0</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    this%convnmod = 0</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    this%iallowptc = 1</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    this%iptcopt = 0</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    this%iptcout = 0</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    this%l2norm0 = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    this%ptcdel = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    this%ptcdel0 = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    this%ptcexp = done</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    this%ptcthresh = dem3</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    this%ptcrat = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    this%atsfrac = donethird</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aefead85b912cfb79e860d6fe3cb2069c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefead85b912cfb79e860d6fe3cb2069c">&#9670;&nbsp;</a></span>castasnumericalsolutionclass()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>) function, pointer numericalsolutionmodule::castasnumericalsolutionclass </td>
          <td>(</td>
          <td class="paramtype">class(*), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a numerical solution from a list. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obj</td><td>generic object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>output NumericalSolutionType </dd></dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l03135">3135</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: obj<span class="comment">         !&lt; generic object</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">pointer</span> :: res<span class="comment">    !&lt; output NumericalSolutionType</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <span class="comment">! -- initialize return variable</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    res =&gt; null()</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="comment">! -- determine if obj is associated</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(obj)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    <span class="comment">! -- set res</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordflow">select type</span> (obj)</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="keywordflow">    class is</span> (<a class="code" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;      res =&gt; obj</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_aefead85b912cfb79e860d6fe3cb2069c_icgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_aefead85b912cfb79e860d6fe3cb2069c_icgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_aefead85b912cfb79e860d6fe3cb2069c_icgraph" id="namespacenumericalsolutionmodule_aefead85b912cfb79e860d6fe3cb2069c_icgraph">
<area shape="rect" title="@ brief Cast a object as a Numerical Solution" alt="" coords="705,71,928,112"/>
<area shape="rect" href="namespacenumericalsolutionmodule.html#acc653881da580b6418122bb466276f63" title="@ brief Get a numerical solution" alt="" coords="439,71,657,112"/>
<area shape="rect" href="namespacemf6bmiutil.html#aed42965695d84c9e4b715ff1d013fed4" title="Get the solution object for this index." alt="" coords="216,78,391,105"/>
<area shape="rect" href="namespacemf6xmi.html#acf0c5a0b42fa9e0423156b713b22761b" title="Finalize the solve of the system." alt="" coords="7,5,167,47"/>
<area shape="rect" href="namespacemf6xmi.html#aacc5f2206867e41a039b174c491b5fca" title="Prepare for solving the system." alt="" coords="5,71,168,112"/>
<area shape="rect" href="namespacemf6xmi.html#a9f45fa8ef43555f9fbb049977c1e0de9" title="Build and solve the linear system." alt="" coords="13,137,161,163"/>
</map>
</div>

</div>
</div>
<a id="a049b24b9778d68a7ba2d6f7e7cd29ac7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a049b24b9778d68a7ba2d6f7e7cd29ac7">&#9670;&nbsp;</a></span>convergence_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::convergence_summary </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>itertot_timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save convergence summary to a File. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iu</td><td>file unit number for summary file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>model number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itertot_timestep</td><td>total iteration for the time step </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01902">1902</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>:<a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">          !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iu<span class="comment">                !&lt; file unit number for summary file</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: im<span class="comment">                !&lt; model number</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: itertot_timestep<span class="comment">  !&lt; total iteration for the time step</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: strh</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: strr</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iouter</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: k</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locdv</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locdr</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="keywordtype">    real</span>(DP) :: dv</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="keywordtype">    real</span>(DP) :: dr</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    strh = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    strr = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    iouter = 1</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    locdv = 0</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    locdr = 0</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">! -- initialize inner iteration summary table</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%innertab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="comment">! -- create outer iteration table</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="comment">! -- table dimensions</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      ntabrows = itertot_timestep</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      ntabcols = 7</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="comment">! -- initialize table and define columns</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      title = trim(this%memoryPath) // <span class="stringliteral">&#39; INNER ITERATION SUMMARY&#39;</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%innertab, this%name, title)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keyword">call </span>this%innertab%table_df(ntabrows, ntabcols, iu)</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      tag = <span class="stringliteral">&#39;TOTAL ITERATION&#39;</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      tag = <span class="stringliteral">&#39;OUTER ITERATION&#39;</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      tag = <span class="stringliteral">&#39;INNER ITERATION&#39;</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      tag = <span class="stringliteral">&#39;MAXIMUM CHANGE&#39;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, 15, alignment=tabright)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      tag = <span class="stringliteral">&#39;MAXIMUM CHANGE MODEL-(CELLID)&#39;</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, lenpakloc, alignment=tabright)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      tag = <span class="stringliteral">&#39;MAXIMUM RESIDUAL&#39;</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, 15, alignment=tabright)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      tag = <span class="stringliteral">&#39;MAXIMUM RESIDUAL MODEL-(CELLID)&#39;</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keyword">call </span>this%innertab%initialize_column(tag, lenpakloc, alignment=tabright)</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">! -- reset the output unit and the number of rows (maxbound)</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="keyword">call </span>this%innertab%set_maxbound(itertot_timestep)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keyword">call </span>this%innertab%set_iout(iu)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">! -- write the inner iteration summary to unit iu</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    i0 = 0</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">do</span> k = 1, itertot_timestep</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      i = this%itinner(k)</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="keywordflow">if</span> (i &lt;= i0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        iouter = iouter + 1</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <span class="keywordflow">if</span> (im &gt; this%convnmod) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        dv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        dr = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keywordflow">do</span> j = 1, this%convnmod</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;          <span class="keywordflow">if</span> (abs(this%convdvmax(j, k)) &gt; abs(dv)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            locdv = this%convlocdv(j, k)</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            dv = this%convdvmax(j, k)</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;          <span class="keywordflow">if</span> (abs(this%convdrmax(j, k)) &gt; abs(dr)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            locdr = this%convlocdr(j, k)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            dr = this%convdrmax(j, k)</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        locdv = this%convlocdv(im, k)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        locdr = this%convlocdr(im, k)</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        dv = this%convdvmax(im, k)</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        dr = this%convdrmax(im, k)</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keyword">call </span>this%sln_get_loc(locdv, strh)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="keyword">call </span>this%sln_get_loc(locdr, strr)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="comment">! -- add data to innertab</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(k)</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(iouter)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(i)</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(dv)</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(adjustr(trim(strh)))</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(dr)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keyword">call </span>this%innertab%add_term(adjustr(trim(strr)))</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="comment">! -- update i0</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      i0 = i</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a049b24b9778d68a7ba2d6f7e7cd29ac7_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a049b24b9778d68a7ba2d6f7e7cd29ac7_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a049b24b9778d68a7ba2d6f7e7cd29ac7_cgraph" id="namespacenumericalsolutionmodule_a049b24b9778d68a7ba2d6f7e7cd29ac7_cgraph">
<area shape="rect" title="@ brief Solution convergence summary" alt="" coords="5,35,193,76"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="246,5,401,47"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="241,71,405,98"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="453,5,608,47"/>
</map>
</div>

</div>
</div>
<a id="ac2c51dfe927f5da25fea34cf68b4a2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2c51dfe927f5da25fea34cf68b4a2ee">&#9670;&nbsp;</a></span>csv_convergence_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::csv_convergence_summary </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>totim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kouter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>niter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>istart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstart</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save convergence summary to a comma-separated value file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iu</td><td>file unit number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totim</td><td>total simulation time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kper</td><td>stress period number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kstp</td><td>time step number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kouter</td><td>number of outer (Picard) iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">niter</td><td>number of inner iteration in this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">istart</td><td>starting iteration number for this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kstart</td><td>starting position in the conv* arrays </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02020">2020</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>:<a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">   !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iu<span class="comment">         !&lt; file unit number</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: totim<span class="comment">          !&lt; total simulation time</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper<span class="comment">       !&lt; stress period number</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp<span class="comment">       !&lt; time step number</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kouter<span class="comment">     !&lt; number of outer (Picard) iterations</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: niter<span class="comment">      !&lt; number of inner iteration in this time step</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: istart<span class="comment">     !&lt; starting iteration number for this time step</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstart<span class="comment">     !&lt; starting position in the conv* arrays</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: itot</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: k</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: kpos</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locdv</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locdr</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodeu</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="keywordtype">    real</span>(DP) :: dv</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="keywordtype">    real</span>(DP) :: dr</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    itot = istart</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">! -- write inner iteration results to the inner csv output file</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">do</span> k = 1, niter</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      kpos = kstart + k - 1</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="keyword">write</span>(iu, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>)                                 &amp;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        itot, totim, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, kstp, kouter, k</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      <span class="comment">! -- solution summary</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      dv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      dr = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      <span class="keywordflow">do</span> j = 1, this%convnmod</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="keywordflow">if</span> (abs(this%convdvmax(j, kpos)) &gt; abs(dv)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;          locdv = this%convlocdv(j, kpos)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          dv = this%convdvmax(j, kpos)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="keywordflow">if</span> (abs(this%convdrmax(j, kpos)) &gt; abs(dr)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;          locdr = this%convlocdr(j, kpos)</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;          dr = this%convdrmax(j, kpos)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="comment">! -- get model number and user node number for dv</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keyword">call </span>this%sln_get_nodeu(locdv, im, nodeu)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keyword">write</span>(iu, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) <span class="stringliteral">&#39;&#39;</span>, dv, im, nodeu</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="comment">! -- get model number and user node number for dr</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="keyword">call </span>this%sln_get_nodeu(locdr, im, nodeu)</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keyword">write</span>(iu, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) <span class="stringliteral">&#39;&#39;</span>, dr, im, nodeu</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      <span class="comment">! -- write acceleration parameters</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <span class="keyword">write</span>(iu, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>)                                   &amp;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="stringliteral">&#39;&#39;</span>, trim(adjustl(this%caccel(kpos)))</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      <span class="comment">! -- write information for each model</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <span class="keywordflow">if</span> (this%convnmod &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keywordflow">do</span> j = 1, this%convnmod</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;          locdv = this%convlocdv(j, kpos)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;          dv = this%convdvmax(j, kpos)</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;          locdr = this%convlocdr(j, kpos)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          dr = this%convdrmax(j, kpos)</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;          <span class="comment">! -- get model number and user node number for dv</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;          <span class="keyword">call </span>this%sln_get_nodeu(locdv, im, nodeu)</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;          <span class="keyword">write</span>(iu, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) <span class="stringliteral">&#39;&#39;</span>, dv, nodeu</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;          <span class="comment">! -- get model number and user node number for dr</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;          <span class="keyword">call </span>this%sln_get_nodeu(locdr, im, nodeu)</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;          <span class="keyword">write</span>(iu, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>) <span class="stringliteral">&#39;&#39;</span>, dr, nodeu</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="comment">! -- write line</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      <span class="keyword">write</span>(iu,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <span class="comment">! -- update itot</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;      itot = itot + 1</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_ac2c51dfe927f5da25fea34cf68b4a2ee_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_ac2c51dfe927f5da25fea34cf68b4a2ee_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_ac2c51dfe927f5da25fea34cf68b4a2ee_cgraph" id="namespacenumericalsolutionmodule_ac2c51dfe927f5da25fea34cf68b4a2ee_cgraph">
<area shape="rect" title="@ brief Solution convergence CSV summary" alt="" coords="5,5,216,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="264,5,419,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="467,5,621,47"/>
</map>
</div>

</div>
</div>
<a id="a7fcf392bb98599ca511fdf62749e9447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fcf392bb98599ca511fdf62749e9447">&#9670;&nbsp;</a></span>finalizesolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::finalizesolve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>isgcnvg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finalize the solution. Called after the outer iteration loop. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>Picard iteration number after convergence or failure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">isgcnvg</td><td>solution group convergence flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isuppress_output</td><td>flag for suppressing output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01817">1817</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">         !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">            !&lt; Picard iteration number after convergence or failure</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: isgcnvg<span class="comment">       !&lt; solution group convergence flag</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output<span class="comment"> !&lt; flag for suppressing output</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ic, im</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: cp =&gt; null()</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">! -- formats for convergence info </span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtnocnvg =                                 &amp;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      &amp;<span class="stringliteral">&quot;(1X,&#39;Solution &#39;, i0, &#39; did not converge for stress period &#39;, i0,       &amp;</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; and time step &#39;, i0)&quot;</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    character(len=*), <span class="keywordtype">parameter</span> :: fmtcnvg =                                   &amp;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      &amp;<span class="stringliteral">&quot;(1X, I0, &#39; CALLS TO NUMERICAL SOLUTION &#39;, &#39;IN TIME STEP &#39;, I0,         &amp;</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; STRESS PERIOD &#39;,I0,/1X,I0,&#39; TOTAL ITERATIONS&#39;)&quot;</span> </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">! -- finalize the outer iteration table</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="keyword">call </span>this%outertab%finalize_table()</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">! -- write convergence info</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">! -- convergence was achieved</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">if</span> (this%icnvg /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="keyword">write</span>(iout, fmtcnvg) kiter, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, this%itertot_timestep</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">! -- convergence was not achieved</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keyword">write</span>(iout, fmtnocnvg) this%id, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="comment">! -- write inner iteration convergence summary</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordflow">if</span> (this%iprims == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="comment">! -- write summary for each model</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keyword">call </span>this%convergence_summary(mp%iout, im, this%itertot_timestep)</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="comment">! -- write summary for entire solution</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keyword">call </span>this%convergence_summary(iout, this%convnmod+1, this%itertot_timestep)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">! -- set solution goup convergence flag</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">if</span> (this%icnvg == 0) isgcnvg = 0</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">! -- Calculate flow for each model</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keyword">call </span>mp%model_cq(this%icnvg, isuppress_output)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="comment">! -- Calculate flow for each exchange</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keywordflow">do</span> ic = 1, this%exchangelist%Count()</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keyword">call </span>cp%exg_cq(isgcnvg, isuppress_output, this%id)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">! -- Budget terms for each model</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keyword">call </span>mp%model_bd(this%icnvg, isuppress_output)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">! -- Budget terms for each exchange</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="keywordflow">do</span> ic = 1, this%exchangelist%Count()</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keyword">call </span>cp%exg_bd(isgcnvg, isuppress_output, this%id)</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a7fcf392bb98599ca511fdf62749e9447_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a7fcf392bb98599ca511fdf62749e9447_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a7fcf392bb98599ca511fdf62749e9447_cgraph" id="namespacenumericalsolutionmodule_a7fcf392bb98599ca511fdf62749e9447_cgraph">
<area shape="rect" title="@ brief finalize a solution" alt="" coords="5,39,193,80"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a09ae423b40a16a7841cbb95815029b0f" title=" " alt="" coords="241,5,472,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="253,71,461,112"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#ab1fef9adb89cbcfb556286fba47b988b" title=" " alt="" coords="520,5,753,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="531,71,742,112"/>
</map>
</div>

</div>
</div>
<a id="a7ed5ffb5b1c97828ad2f0cb2c8035da0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed5ffb5b1c97828ad2f0cb2c8035da0">&#9670;&nbsp;</a></span>get_models()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(listtype) function, pointer numericalsolutionmodule::get_models </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a pointer to the list of models in this solution. </p><dl class="section return"><dt>Returns</dt><dd>pointer to the model list </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02172">2172</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">pointer</span> :: models<span class="comment">    !&lt; pointer to the model list</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment"> !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    models =&gt; this%modellist</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="acc653881da580b6418122bb466276f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc653881da580b6418122bb466276f63">&#9670;&nbsp;</a></span>getnumericalsolutionfromlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>) function, pointer, public numericalsolutionmodule::getnumericalsolutionfromlist </td>
          <td>(</td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a numerical solution from a list. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">list</td><td>list of numerical solutions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>value to retrieve from the list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>numerical solution </dd></dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l03162">3162</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: list<span class="comment">         !&lt; list of numerical solutions</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>    :: idx<span class="comment">            !&lt; value to retrieve from the list</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <span class="comment">! -- return variables</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">pointer</span> :: res<span class="comment">  !&lt; numerical solution</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: obj</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    obj =&gt; list%GetItem(idx)</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    res =&gt; <a class="code" href="namespacenumericalsolutionmodule.html#aefead85b912cfb79e860d6fe3cb2069c">castasnumericalsolutionclass</a>(obj)</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_cgraph" id="namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_cgraph">
<area shape="rect" title="@ brief Get a numerical solution" alt="" coords="5,5,224,47"/>
<area shape="rect" href="namespacenumericalsolutionmodule.html#aefead85b912cfb79e860d6fe3cb2069c" title="@ brief Cast a object as a Numerical Solution" alt="" coords="272,5,495,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_icgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_icgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_icgraph" id="namespacenumericalsolutionmodule_acc653881da580b6418122bb466276f63_icgraph">
<area shape="rect" title="@ brief Get a numerical solution" alt="" coords="439,71,657,112"/>
<area shape="rect" href="namespacemf6bmiutil.html#aed42965695d84c9e4b715ff1d013fed4" title="Get the solution object for this index." alt="" coords="216,78,391,105"/>
<area shape="rect" href="namespacemf6xmi.html#acf0c5a0b42fa9e0423156b713b22761b" title="Finalize the solve of the system." alt="" coords="7,5,167,47"/>
<area shape="rect" href="namespacemf6xmi.html#aacc5f2206867e41a039b174c491b5fca" title="Prepare for solving the system." alt="" coords="5,71,168,112"/>
<area shape="rect" href="namespacemf6xmi.html#a9f45fa8ef43555f9fbb049977c1e0de9" title="Build and solve the linear system." alt="" coords="13,137,161,163"/>
</map>
</div>

</div>
</div>
<a id="ad38d2c1f3ad4cdb32b3e9e51329d5913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad38d2c1f3ad4cdb32b3e9e51329d5913">&#9670;&nbsp;</a></span>preparesolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::preparesolve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prepare for the system solve by advancing the simulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01379">1379</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment"> !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ic</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: cp =&gt; null()</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;     <span class="comment">! -- Exchange advance</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keyword">call </span>cp%exg_ad()</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">! -- Model advance</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">do</span> im = 1, this%modellist%Count()</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keyword">call </span>mp%model_ad()</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">! advance solution</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="keyword">call </span>this%sln_ad()</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_ad38d2c1f3ad4cdb32b3e9e51329d5913_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_ad38d2c1f3ad4cdb32b3e9e51329d5913_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_ad38d2c1f3ad4cdb32b3e9e51329d5913_cgraph" id="namespacenumericalsolutionmodule_ad38d2c1f3ad4cdb32b3e9e51329d5913_cgraph">
<area shape="rect" title="@ brief prepare to solve" alt="" coords="5,39,193,80"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a09ae423b40a16a7841cbb95815029b0f" title=" " alt="" coords="241,5,472,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="253,71,461,112"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#ab1fef9adb89cbcfb556286fba47b988b" title=" " alt="" coords="520,5,753,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="531,71,742,112"/>
</map>
</div>

</div>
</div>
<a id="a137719ffc7e35092e3c4bd7437443f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a137719ffc7e35092e3c4bd7437443f72">&#9670;&nbsp;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::save </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save solution ia vector, ja vector , coefficient matrix, right-hand side vector, and the dependent-variable vector to a file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>filename to save solution data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02116">2116</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>:<a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">      !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: filename<span class="comment">  !&lt; filename to save solution data</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inunit</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    inunit = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keyword">open</span>(unit=inunit,file=filename,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keyword">write</span>(inunit,*) <span class="stringliteral">&#39;ia&#39;</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keyword">write</span>(inunit,*) this%ia</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keyword">write</span>(inunit,*) <span class="stringliteral">&#39;ja&#39;</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keyword">write</span>(inunit,*) this%ja</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keyword">write</span>(inunit,*) <span class="stringliteral">&#39;amat&#39;</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keyword">write</span>(inunit,*) this%amat</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keyword">write</span>(inunit,*) <span class="stringliteral">&#39;rhs&#39;</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keyword">write</span>(inunit,*) this%rhs</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keyword">write</span>(inunit,*) <span class="stringliteral">&#39;x&#39;</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="keyword">write</span>(inunit,*) this%x</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="keyword">close</span>(inunit)</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a137719ffc7e35092e3c4bd7437443f72_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a137719ffc7e35092e3c4bd7437443f72_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a137719ffc7e35092e3c4bd7437443f72_cgraph" id="namespacenumericalsolutionmodule_a137719ffc7e35092e3c4bd7437443f72_cgraph">
<area shape="rect" title="@ brief Save solution data to a file" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="241,5,396,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="444,5,599,47"/>
</map>
</div>

</div>
</div>
<a id="a7eac961b7084de083212f76fc6515dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eac961b7084de083212f76fc6515dff">&#9670;&nbsp;</a></span>sln_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01053">1053</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="comment">! -- write headers to CSV file</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> == 1 .and. <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keyword">call </span>this%writeCSVHeader()</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">! write PTC info on models to iout</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keyword">call </span>this%writePTCInfoToFile(<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">! reset convergence flag and inner solve counter</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    this%icnvg = 0</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    this%itertot_timestep = 0   </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    this%iouttot_timestep = 0   </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe804dcafea9bef2ef528e68475ac3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe804dcafea9bef2ef528e68475ac3ec">&#9670;&nbsp;</a></span>sln_ar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and read data for a solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l00459">459</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>, <a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>, <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>,                       &amp;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                         <a class="code" href="namespacesimmodule.html#a6c8d05246b2eddf358b9f81a147ebdd8">deprecation_warning</a></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">   !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: cp =&gt; null()</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordtype">character(len=linelength)</span> :: errmsg</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">character(len=linelength)</span> :: warnmsg</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">character(len=linelength)</span> :: keyword</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">character(len=linelength)</span> :: fname</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">character(len=linelength)</span> :: msg</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ifdparam, mxvl, npp</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: imslinear</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: isymflg=1</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ival</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordtype">    real</span>(DP) :: rval</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtcsvout = &amp;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="stringliteral">&quot;(4x, &#39;CSV OUTPUT WILL BE SAVED TO FILE: &#39;, a, /4x, &#39;OPENED ON UNIT: &#39;, I7)&quot;</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtptcout = &amp;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="stringliteral">&quot;(4x, &#39;PTC OUTPUT WILL BE SAVED TO FILE: &#39;, a, /4x, &#39;OPENED ON UNIT: &#39;, I7)&quot;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmterrasym = &amp;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="stringliteral">&quot;(a,&#39; **&#39;,a,&#39;** PRODUCES AN ASYMMETRIC COEFFICIENT MATRIX, BUT THE       &amp;</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;CONJUGATE GRADIENT METHOD WAS SELECTED. USE BICGSTAB INSTEAD. &#39;)&quot;</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">! identify package and initialize.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,1) this%iu</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;00001 <span class="keyword">FORMAT</span>(1x,/1x,<span class="stringliteral">&#39;IMS -- ITERATIVE MODEL SOLUTION PACKAGE, VERSION 6&#39;</span>,      &amp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    &amp;  <span class="stringliteral">&#39;, 4/28/2017&#39;</span>,/,9x,<span class="stringliteral">&#39;INPUT READ FROM UNIT&#39;</span>,i5)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    i = 1</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    ifdparam = 1</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    npp = 0</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    mxvl = 0</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      supportopenclose=.true., blockrequired=.false.)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(/1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING IMS OPTIONS&#39;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRINT_OPTION&#39;</span>)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;NONE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            this%iprims = 0</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;SUMMARY&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            this%iprims = 1</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;ALL&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            this%iprims = 2</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(3a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="stringliteral">&#39;UNKNOWN IMS PRINT OPTION (&#39;</span>, trim(keyword), <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;COMPLEXITY&#39;</span>)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;SIMPLE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            ifdparam = 1</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,21)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;MODERATE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            ifdparam = 2</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,23)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;COMPLEX&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            ifdparam = 3</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,25)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(3a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;              <span class="stringliteral">&#39;UNKNOWN IMS COMPLEXITY OPTION (&#39;</span>, trim(keyword), <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CSV_OUTER_OUTPUT&#39;</span>)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            this%icsvouterout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%icsvouterout, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fname, <span class="stringliteral">&#39;CSV_OUTER_OUTPUT&#39;</span>,    &amp;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,fmtcsvout) trim(fname), this%icsvouterout</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;OPTIONAL CSV_OUTER_OUTPUT &#39;</span> //                  &amp;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;              <span class="stringliteral">&#39;KEYWORD MUST BE FOLLOWED BY FILEOUT&#39;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CSV_INNER_OUTPUT&#39;</span>)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            this%icsvinnerout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%icsvinnerout, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fname, <span class="stringliteral">&#39;CSV_INNER_OUTPUT&#39;</span>,    &amp;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,fmtcsvout) trim(fname), this%icsvinnerout</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;OPTIONAL CSV_INNER_OUTPUT &#39;</span> //                  &amp;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;              <span class="stringliteral">&#39;KEYWORD MUST BE FOLLOWED BY FILEOUT&#39;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NO_PTC&#39;</span>)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          <span class="keywordflow">select case</span>(keyword)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ALL&#39;</span>)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;              ival = 0</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;              msg = <span class="stringliteral">&#39;ALL&#39;</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">case</span> (<span class="stringliteral">&#39;FIRST&#39;</span>)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;              ival = -1</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;              msg = <span class="stringliteral">&#39;THE FIRST&#39;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordflow">            case default</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;              ival = 0</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;              msg = <span class="stringliteral">&#39;ALL&#39;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          this%iallowptc = ival</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A)&#39;</span>) <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION DISABLED FOR&#39;</span> // &amp;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="stringliteral">&#39; &#39;</span> // trim(adjustl(msg)) // <span class="stringliteral">&#39; STRESS-PERIOD(S)&#39;</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;ATS_OUTER_MAXIMUM_FRACTION&#39;</span>)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          rval = this%parser%GetDouble()</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <span class="keywordflow">if</span> (rval &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a> .or. rval &gt; dhalf) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,G0)&#39;</span>) <span class="stringliteral">&#39;VALUE FOR ATS_OUTER_MAXIMUM_FRAC MUST BE &amp;</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;BETWEEN 0 AND 0.5.  FOUND &#39;</span>, rval</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          this%atsfrac = rval</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A,G0)&#39;</span>) <span class="stringliteral">&#39;ADAPTIVE TIME STEP SETTING FOUND.  FRACTION &amp;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;OF OUTER MAXIMUM USED TO INCREASE OR DECREASE TIME STEP SIZE IS &#39;</span>,&amp;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            &amp;this%atsfrac</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">! -- DEPRECATED OPTIONS</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CSV_OUTPUT&#39;</span>)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            this%icsvouterout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%icsvouterout, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fname, <span class="stringliteral">&#39;CSV_OUTPUT&#39;</span>,          &amp;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,fmtcsvout) trim(fname), this%icsvouterout</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="comment">! -- create warning message</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keyword">write</span>(warnmsg,<span class="stringliteral">&#39;(a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;              <span class="stringliteral">&#39;OUTER ITERATION INFORMATION WILL BE SAVED TO &#39;</span> // trim(fname)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="comment">! -- create deprecation warning</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a6c8d05246b2eddf358b9f81a147ebdd8">deprecation_warning</a>(<span class="stringliteral">&#39;OPTIONS&#39;</span>, <span class="stringliteral">&#39;CSV_OUTPUT&#39;</span>, <span class="stringliteral">&#39;6.1.1&#39;</span>,            &amp;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                     warnmsg, this%parser%GetUnit())</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;OPTIONAL CSV_OUTPUT &#39;</span> //                        &amp;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;              <span class="stringliteral">&#39;KEYWORD MUST BE FOLLOWED BY FILEOUT&#39;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">! -- right now these are options that are only available in the</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">!    development version and are not included in the documentation.</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">!    These options are only available when IDEVELOPMODE in</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">!    constants module is set to 1</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEV_PTC&#39;</span>)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          this%iallowptc = 1</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A)&#39;</span>) <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION ENABLED&#39;</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;DEV_PTC_OUTPUT&#39;</span>)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          this%iallowptc = 1</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            this%iptcout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%iptcout, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fname, <span class="stringliteral">&#39;PTC-OUT&#39;</span>,                  &amp;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,fmtptcout) trim(fname), this%iptcout</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>)                                                  &amp;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              <span class="stringliteral">&#39;OPTIONAL PTC_OUTPUT KEYWORD MUST BE FOLLOWED BY FILEOUT&#39;</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEV_PTC_OPTION&#39;</span>)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          this%iallowptc = 1</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          this%iptcopt = 1</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A)&#39;</span>)                                                   &amp;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION USES BNORM AND L2NORM TO &#39;</span> //         &amp;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="stringliteral">&#39;SET INITIAL VALUE&#39;</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEV_PTC_EXPONENT&#39;</span>)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          rval = this%parser%GetDouble()</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          <span class="keywordflow">if</span> (rval &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;PTC_EXPONENT MUST BE &gt; 0.&#39;</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            this%iallowptc = 1</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            this%ptcexp = rval</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A,1x,g15.7)&#39;</span>)                                        &amp;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;              <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION EXPONENT&#39;</span>, this%ptcexp</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEV_PTC_THRESHOLD&#39;</span>)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          rval = this%parser%GetDouble()</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          <span class="keywordflow">if</span> (rval &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;PTC_THRESHOLD MUST BE &gt; 0.&#39;</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            this%iallowptc = 1</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            this%ptcthresh = rval</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A,1x,g15.7)&#39;</span>)                                        &amp;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;              <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION THRESHOLD&#39;</span>, this%ptcthresh</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEV_PTC_DEL0&#39;</span>)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          rval = this%parser%GetDouble()</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          <span class="keywordflow">if</span> (rval &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>)<span class="stringliteral">&#39;IMS sln_ar: PTC_DEL0 MUST BE &gt; 0.&#39;</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            this%iallowptc = 1</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            this%ptcdel0 = rval</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,A,1x,g15.7)&#39;</span>)                                        &amp;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;              <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION INITIAL TIMESTEP&#39;</span>, this%ptcdel0</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,2(1x,a))&#39;</span>)                                            &amp;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="stringliteral">&#39;UNKNOWN IMS OPTION  (&#39;</span>, trim(keyword), <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;END OF IMS OPTIONS&#39;</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;NO IMS OPTION BLOCK DETECTED.&#39;</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;00021 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;SIMPLE OPTION:&#39;</span>,/,                                              &amp;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    &amp;       1x,<span class="stringliteral">&#39;DEFAULT SOLVER INPUT VALUES FOR FAST SOLUTIONS&#39;</span>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;00023 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;MODERATE OPTION:&#39;</span>,/,1x,<span class="stringliteral">&#39;DEFAULT SOLVER&#39;</span>,                        &amp;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    &amp;          <span class="stringliteral">&#39; INPUT VALUES REFLECT MODERETELY NONLINEAR MODEL&#39;</span>)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;00025 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;COMPLEX OPTION:&#39;</span>,/,1x,<span class="stringliteral">&#39;DEFAULT SOLVER&#39;</span>,                         &amp;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    &amp; <span class="stringliteral">&#39; INPUT VALUES REFLECT STRONGLY NONLINEAR MODEL&#39;</span>)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">!-------READ NONLINEAR ITERATION PARAMETERS AND LINEAR SOLVER SELECTION INDEX</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">! -- set default nonlinear parameters</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keyword">call </span>this%sln_setouter(ifdparam)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">! -- get NONLINEAR block</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;NONLINEAR&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      supportopenclose=.true., blockrequired=.false.)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">! -- parse NONLINEAR block if detected</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(/1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING IMS NONLINEAR&#39;</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">! -- parse keyword</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OUTER_DVCLOSE&#39;</span>)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          this%dvclose  = this%parser%GetDouble()</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OUTER_MAXIMUM&#39;</span>)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          this%mxiter  = this%parser%GetInteger()</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UNDER_RELAXATION&#39;</span>)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          ival = 0</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;NONE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            ival = 0</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;SIMPLE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            ival = 1</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;COOLEY&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            ival = 2</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;DBD&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            ival = 3</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(3a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;              <span class="stringliteral">&#39;UNKNOWN UNDER_RELAXATION SPECIFIED (&#39;</span>, trim(keyword), <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          this%nonmeth = ival</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;LINEAR_SOLVER&#39;</span>)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          ival = 1</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="keywordflow">if</span> (keyword.eq.<span class="stringliteral">&#39;DEFAULT&#39;</span> .or.                                          &amp;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;              keyword.eq.<span class="stringliteral">&#39;LINEAR&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            ival = 1</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(3a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;              <span class="stringliteral">&#39;UNKNOWN LINEAR_SOLVER SPECIFIED (&#39;</span>, trim(keyword), <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          this%linmeth = ival</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UNDER_RELAXATION_THETA&#39;</span>)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          this%theta = this%parser%GetDouble()</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UNDER_RELAXATION_KAPPA&#39;</span>)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          this%akappa = this%parser%GetDouble()</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UNDER_RELAXATION_GAMMA&#39;</span>)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          this%gamma = this%parser%GetDouble()</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UNDER_RELAXATION_MOMENTUM&#39;</span>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          this%amomentum  = this%parser%GetDouble()</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BACKTRACKING_NUMBER&#39;</span>)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          this%numtrack = this%parser%GetInteger()</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          <span class="keywordflow">IF</span> (this%numtrack &gt; 0) this%ibflag = 1</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BACKTRACKING_TOLERANCE&#39;</span>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          this%btol = this%parser%GetDouble()</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BACKTRACKING_REDUCTION_FACTOR&#39;</span>)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          this%breduc = this%parser%GetDouble()</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BACKTRACKING_RESIDUAL_LIMIT&#39;</span>)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;          this%res_lim = this%parser%GetDouble()</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">! -- deprecated variables</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OUTER_HCLOSE&#39;</span>)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;          this%dvclose  = this%parser%GetDouble()</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;          <span class="comment">! -- create warning message</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <span class="keyword">write</span>(warnmsg,<span class="stringliteral">&#39;(a)&#39;</span>)                                                   &amp;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="stringliteral">&#39;SETTING OUTER_DVCLOSE TO OUTER_HCLOSE VALUE&#39;</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          <span class="comment">! -- create deprecation warning</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a6c8d05246b2eddf358b9f81a147ebdd8">deprecation_warning</a>(<span class="stringliteral">&#39;NONLINEAR&#39;</span>, <span class="stringliteral">&#39;OUTER_HCLOSE&#39;</span>, <span class="stringliteral">&#39;6.1.1&#39;</span>,         &amp;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                   warnmsg, this%parser%GetUnit())</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OUTER_RCLOSEBND&#39;</span>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <span class="comment">! -- create warning message</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          <span class="keyword">write</span>(warnmsg,<span class="stringliteral">&#39;(a)&#39;</span>)                                                   &amp;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="stringliteral">&#39;OUTER_DVCLOSE IS USED TO EVALUATE PACKAGE CONVERGENCE&#39;</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          <span class="comment">! -- create deprecation warning</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a6c8d05246b2eddf358b9f81a147ebdd8">deprecation_warning</a>(<span class="stringliteral">&#39;NONLINEAR&#39;</span>, <span class="stringliteral">&#39;OUTER_RCLOSEBND&#39;</span>, <span class="stringliteral">&#39;6.1.1&#39;</span>,      &amp;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                   warnmsg, this%parser%GetUnit())</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(3a)&#39;</span>)                                                   &amp;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="stringliteral">&#39;UNKNOWN IMS NONLINEAR KEYWORD (&#39;</span>, trim(keyword), <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF IMS NONLINEAR DATA&#39;</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">if</span> (ifdparam.EQ.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;NO IMS NONLINEAR BLOCK DETECTED.&#39;</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (this%THETA &lt; dem3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      this%theta = dem3</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">! -- backtracking should only be used if this%nonmeth &gt; 0</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">if</span> (this%nonmeth &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      this%ibflag = 0</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">! -- check that MXITER is greater than zero</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">if</span> (this%mxiter &lt;= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;OUTER ITERATION NUMBER MUST BE &gt; 0.&#39;</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    isymflg = 1</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> ( this%nonmeth &gt; 0 )<span class="keywordflow">then</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,*) <span class="stringliteral">&#39;**UNDER-RELAXATION WILL BE USED***&#39;</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,*)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      isymflg = 0</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">elseif</span> ( this%nonmeth == 0 )<span class="keywordflow">then</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,*) <span class="stringliteral">&#39;***UNDER-RELAXATION WILL NOT BE USED***&#39;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,*)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keyword">WRITE</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>)                                                      &amp;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="stringliteral">&#39;INCORRECT VALUE FOR VARIABLE NONMETH WAS SPECIFIED.&#39;</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">! -- ensure gamma is &gt; 0 for simple</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">if</span> (this%nonmeth == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">if</span> (this%gamma == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keyword">WRITE</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>)                                                   &amp;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          <span class="stringliteral">&#39;GAMMA must be greater than zero if SIMPLE under-relaxation is used.&#39;</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">! -- call secondary subroutine to initialize and read linear </span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">!    solver parameters IMSLINEAR solver</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> ( this%linmeth == 1 )<span class="keywordflow">then</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keyword">allocate</span>(this%imslinear)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,*) <span class="stringliteral">&#39;***IMS LINEAR SOLVER WILL BE USED***&#39;</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keyword">call </span>this%imslinear%imslinear_allocate(this%name, this%iu, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,           &amp;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                             this%iprims, this%mxiter,           &amp;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                             ifdparam, imslinear,                &amp;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                             this%neq, this%nja, this%ia,        &amp;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                             this%ja, this%amat, this%rhs,       &amp;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                             this%x, this%nitermax)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,*)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      isymflg = 0</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">if</span> ( imslinear.eq.1 ) isymflg = 1</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">! -- incorrect linear solver flag</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keyword">WRITE</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>)                                                       &amp;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="stringliteral">&#39;INCORRECT VALUE FOR LINEAR SOLUTION METHOD SPECIFIED.&#39;</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">! -- If CG, then go through each model and each exchange and check</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">!    for asymmetry</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (isymflg == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="comment">! -- Models</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">do</span> i = 1, this%modellist%Count()</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, i)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">if</span> (mp%get_iasym() /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="keyword">write</span>(errmsg, fmterrasym) <span class="stringliteral">&#39;MODEL&#39;</span>, trim(adjustl(mp%name))</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="comment">! -- Exchanges</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">do</span> i = 1, this%exchangelist%Count()</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        cp =&gt; getnumericalexchangefromlist(this%exchangelist, i)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">if</span> (cp%get_iasym() /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          <span class="keyword">write</span>(errmsg, fmterrasym) <span class="stringliteral">&#39;EXCHANGE&#39;</span>, trim(adjustl(cp%name))</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">store_error</a>(errmsg)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">! -- write solver data to output file</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">! -- non-linear solver data</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keyword">WRITE</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,9002) this%dvclose, this%mxiter,                                &amp;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                     this%iprims, this%nonmeth, this%linmeth</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">! -- standard outer iteration formats</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;9002 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;OUTER ITERATION CONVERGENCE CRITERION    (DVCLOSE) = &#39;</span>, e15.6, &amp;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;MAXIMUM NUMBER OF OUTER ITERATIONS        (MXITER) = &#39;</span>, i0,    &amp;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;SOLVER PRINTOUT INDEX                     (IPRIMS) = &#39;</span>, i0,    &amp;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;NONLINEAR ITERATION METHOD            (NONLINMETH) = &#39;</span>, i0,    &amp;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;LINEAR SOLUTION METHOD                   (LINMETH) = &#39;</span>, i0)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (this%nonmeth == 1) <span class="keywordflow">then</span> <span class="comment">! simple</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, 9003) this%gamma</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%nonmeth == 2) <span class="keywordflow">then</span> <span class="comment">! cooley</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, 9004) this%gamma</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%nonmeth == 3) <span class="keywordflow">then</span> <span class="comment">! delta bar delta</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, 9005) this%theta, this%akappa, this%gamma, this%amomentum</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">! -- write backtracking information</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span>(this%numtrack /= 0) <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, 9006) this%numtrack, this%btol,       &amp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                             this%breduc,this%res_lim</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">! -- under-relaxation formats (simple, cooley, dbd)</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;9003 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;UNDER-RELAXATION FACTOR                    (GAMMA) = &#39;</span>, e15.6)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;9004 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;UNDER-RELAXATION PREVIOUS HISTORY FACTOR   (GAMMA) = &#39;</span>, e15.6)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;9005 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;UNDER-RELAXATION WEIGHT REDUCTION FACTOR   (THETA) = &#39;</span>, e15.6, &amp;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;UNDER-RELAXATION WEIGHT INCREASE INCREMENT (KAPPA) = &#39;</span>, e15.6, &amp;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;UNDER-RELAXATION PREVIOUS HISTORY FACTOR   (GAMMA) = &#39;</span>, e15.6, &amp;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;UNDER-RELAXATION MOMENTUM TERM         (AMOMENTUM) = &#39;</span>, e15.6)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">! -- backtracking formats</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;9006 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;MAXIMUM NUMBER OF BACKTRACKS            (NUMTRACK) = &#39;</span>, i0,    &amp;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;BACKTRACKING TOLERANCE FACTOR               (BTOL) = &#39;</span>, e15.6, &amp;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;BACKTRACKING REDUCTION FACTOR             (BREDUC) = &#39;</span>, e15.6, &amp;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    &amp;      /1x,<span class="stringliteral">&#39;BACKTRACKING RESIDUAL LIMIT              (RES_LIM) = &#39;</span>, e15.6)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">! -- linear solver data</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keyword">call </span>this%imslinear%imslinear_summary(this%mxiter)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">! -- write summary of solver error messages</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    ierr = <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>()</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span> (ierr&gt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">! reallocate space for nonlinear arrays and initialize</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%hncg, this%mxiter, <span class="stringliteral">&#39;HNCG&#39;</span>, this%name)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%lrch, 3, this%mxiter, <span class="stringliteral">&#39;LRCH&#39;</span>, this%name)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">! delta-bar-delta under-relaxation</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span>(this%nonmeth == 3)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%wsave, this%neq, <span class="stringliteral">&#39;WSAVE&#39;</span>, this%name)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%hchold, this%neq, <span class="stringliteral">&#39;HCHOLD&#39;</span>, this%name)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%deold, this%neq, <span class="stringliteral">&#39;DEOLD&#39;</span>, this%name)</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">do</span> i = 1, this%neq</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        this%wsave(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        this%hchold(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        this%deold(i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    this%hncg = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    this%lrch = 0</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">! allocate space for saving solver convergence history</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">if</span> (this%iprims == 2 .or. this%icsvinnerout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      this%nitermax = this%nitermax * this%mxiter</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      this%nitermax = 1</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keyword">allocate</span>(this%caccel(this%nitermax))</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    im = this%convnmod</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%itinner, this%nitermax, <span class="stringliteral">&#39;ITINNER&#39;</span>,                &amp;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                        trim(this%name))</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%convlocdv, im, this%nitermax, <span class="stringliteral">&#39;CONVLOCDV&#39;</span>,        &amp;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        trim(this%name))</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%convlocdr, im, this%nitermax, <span class="stringliteral">&#39;CONVLOCDR&#39;</span>,        &amp;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        trim(this%name))</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%convdvmax, im, this%nitermax, <span class="stringliteral">&#39;CONVDVMAX&#39;</span>,        &amp;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        trim(this%name))</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%convdrmax, im, this%nitermax, <span class="stringliteral">&#39;CONVDRMAX&#39;</span>,        &amp;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        trim(this%name))</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nitermax</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      this%itinner(i) = 0</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">do</span> im = 1, this%convnmod</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        this%convlocdv(im, i) = 0</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        this%convlocdr(im, i) = 0</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        this%convdvmax(im, i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        this%convdrmax(im, i) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">! -- check for numerical solution errors</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    ierr = <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>()</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">if</span> (ierr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="comment">! -- close ims input file</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keyword">call </span>this%parser%Clear()</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_abe804dcafea9bef2ef528e68475ac3ec_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_abe804dcafea9bef2ef528e68475ac3ec_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_abe804dcafea9bef2ef528e68475ac3ec_cgraph" id="namespacenumericalsolutionmodule_abe804dcafea9bef2ef528e68475ac3ec_cgraph">
<area shape="rect" title="@ brief Allocate and read data" alt="" coords="5,221,193,262"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title=" " alt="" coords="265,5,449,32"/>
<area shape="rect" href="namespacesimmodule.html#a6c8d05246b2eddf358b9f81a147ebdd8" title=" " alt="" coords="267,57,447,98"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a09ae423b40a16a7841cbb95815029b0f" title=" " alt="" coords="241,122,472,163"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="253,187,461,229"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="279,253,434,294"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title=" " alt="" coords="279,370,434,411"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="549,319,724,345"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="567,436,706,463"/>
<area shape="rect" href="namespacesimmodule.html#a8caad8ba9aaacfbc94f08b98ab770eea" title=" " alt="" coords="543,64,731,91"/>
<area shape="rect" href="namespacedefinedmacros.html#afc9b290c56584c273f369dac8aa026d5" title="Get operating system." alt="" coords="801,64,971,91"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#ab1fef9adb89cbcfb556286fba47b988b" title=" " alt="" coords="520,122,753,163"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="531,187,742,229"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="559,253,714,294"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="559,370,714,411"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="802,461,970,502"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="802,395,970,437"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="1019,439,1213,465"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1032,490,1200,531"/>
</map>
</div>

</div>
</div>
<a id="a61e4b4c1609f9833296260d4a9deefdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e4b4c1609f9833296260d4a9deefdd">&#9670;&nbsp;</a></span>sln_backtracking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_backtracking </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(numericalmodeltype), pointer&#160;</td>
          <td class="paramname"><em>mp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(numericalexchangetype), pointer&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform backtracking on the solution in the maximum number of backtrack iterations (nbtrack) is greater than 0 and the backtracking criteria are exceeded. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mp</td><td>model pointer (currently null()) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cp</td><td>exchange pointer (currently null()) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>Picard iteration number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02561">2561</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp<span class="comment">             !&lt; model pointer (currently null())</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: cp<span class="comment">          !&lt; exchange pointer (currently null())</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                    !&lt; Picard iteration number</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordtype">character(len=7)</span> :: cmsg</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ic</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nb</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: btflag</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibflag</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibtcnt</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="keywordtype">    real</span>(DP) :: resin</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    ibflag = 0</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="comment">! -- refill amat and rhs with standard conductance</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="comment">! -- Set amat and rhs to zero</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="keyword">call </span>this%sln_reset()</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="comment">! -- Calculate matrix coefficients (CF) for each exchange</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keyword">call </span>cp%exg_cf(kiter)</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="comment">! -- Calculate matrix coefficients (CF) for each model</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <span class="keyword">call </span>mp%model_cf(kiter)</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="comment">! -- Fill coefficients (FC) for each exchange</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="keyword">call </span>cp%exg_fc(kiter, this%ia, this%amat, this%rhs, 0)</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">! -- Fill coefficients (FC) for each model</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      <span class="keyword">call </span>mp%model_fc(kiter, this%amat, this%nja, 0)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="comment">! -- calculate initial l2 norm</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="keywordflow">if</span> (kiter == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <span class="keyword">call </span>this%sln_l2norm(this%neq, this%nja,                                 &amp;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                            this%ia, this%ja, this%active,                     &amp;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                            this%amat, this%rhs, this%x, this%res_prev)</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      resin = this%res_prev</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      ibflag = 0</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keyword">call </span>this%sln_l2norm(this%neq, this%nja,                                 &amp;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                            this%ia, this%ja, this%active,                     &amp;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                            this%amat, this%rhs, this%x, this%res_new)</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      resin = this%res_new</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    ibtcnt = 0</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="keywordflow">if</span> (kiter &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      <span class="keywordflow">if</span> (this%res_new &gt; this%res_prev * this%btol) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <span class="comment">! -- iterate until backtracking complete</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        btloop: <span class="keywordflow">do</span> nb = 1, this%numtrack</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;          <span class="comment">! -- backtrack the dependent variable</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;          <span class="keyword">call </span>this%sln_backtracking_xupdate(btflag)</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;          <span class="comment">! -- dependent-variable change less than dvclose</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;          <span class="keywordflow">if</span> (btflag == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;            ibflag = 4</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            <span class="keywordflow">exit</span> btloop</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;          ibtcnt = nb</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;          <span class="comment">! -- Set amat and rhs to zero</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;          <span class="keyword">call </span>this%sln_reset()</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;          <span class="comment">! -- Calculate matrix coefficients (CF) for each exchange</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;          <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;            cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            <span class="keyword">call </span>cp%exg_cf(kiter)</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;          <span class="comment">! -- Calculate matrix coefficients (CF) for each model</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;          <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            <span class="keyword">call </span>mp%model_cf(kiter)</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;          <span class="comment">! -- Fill coefficients (FC) for each exchange</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;          <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;            cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            <span class="keyword">call </span>cp%exg_fc(kiter, this%ia, this%amat, this%rhs, 0)</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;          <span class="comment">! -- Fill coefficients (FC) for each model</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;          <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;            mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            <span class="keyword">call </span>mp%model_fc(kiter, this%amat, this%nja, 0)</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;          <span class="comment">! -- calculate updated l2norm</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;          <span class="keyword">call </span>this%sln_l2norm(this%neq, this%nja,                             &amp;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                               this%ia, this%ja, this%active,                  &amp;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                                this%amat, this%rhs, this%x, this%res_new)</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;          <span class="comment">! -- evaluate if back tracking can be terminated</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;          <span class="keywordflow">if</span> (nb == this%numtrack) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            ibflag = 2</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            <span class="keywordflow">exit</span> btloop</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;          <span class="keywordflow">if</span> (this%res_new &lt; this%res_prev * this%btol) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;              ibflag = 1</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="keywordflow">exit</span> btloop</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;          <span class="keywordflow">if</span> (this%res_new &lt; this%res_lim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            <span class="keywordflow">exit</span> btloop</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="keywordflow">        end do</span> btloop</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="comment">! -- save new residual</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      this%res_prev = this%res_new</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">! -- write back backtracking results</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <span class="keywordflow">if</span> (ibtcnt &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        cmsg = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        cmsg = <span class="stringliteral">&#39;*&#39;</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="comment">! -- add data to outertab</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <span class="keyword">call </span>this%outertab%add_term( <span class="stringliteral">&#39;Backtracking&#39;</span>)</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(kiter)</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(ibflag)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(ibtcnt)</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(resin)</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(this%res_prev)</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(cmsg)</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a61e4b4c1609f9833296260d4a9deefdd_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a61e4b4c1609f9833296260d4a9deefdd_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a61e4b4c1609f9833296260d4a9deefdd_cgraph" id="namespacenumericalsolutionmodule_a61e4b4c1609f9833296260d4a9deefdd_cgraph">
<area shape="rect" title="@ brief Perform backtracking" alt="" coords="5,39,193,80"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a09ae423b40a16a7841cbb95815029b0f" title=" " alt="" coords="241,5,472,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="253,71,461,112"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#ab1fef9adb89cbcfb556286fba47b988b" title=" " alt="" coords="520,5,753,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="531,71,742,112"/>
</map>
</div>

</div>
</div>
<a id="acbd46eaed7689801fb0a957d25939225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbd46eaed7689801fb0a957d25939225">&#9670;&nbsp;</a></span>sln_backtracking_xupdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_backtracking_xupdate </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>btflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Backtracking update of the dependent variable if the calculated backtracking update exceeds the dependent variable closure critera. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">btflag</td><td>backtracking flag (1) backtracking performed (0) backtracking not performed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02722">2722</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment"> !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: btflag<span class="comment">               !&lt; backtracking flag (1) backtracking performed (0) backtracking not performed</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="keywordtype">    real</span>(DP) :: delx</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="keywordtype">    real</span>(DP) :: absdelx</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="keywordtype">    real</span>(DP) :: chmax</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <span class="comment">! -- initialize dummy variables</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    btflag = 0</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="comment">! -- no backtracking if maximum change is less than closure so return</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    chmax = 0.0</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <span class="keywordflow">do</span> n = 1, this%neq</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <span class="keywordflow">if</span> (this%active(n) &lt; 1) cycle</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      delx = this%breduc*(this%x(n) - this%xtemp(n))</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      absdelx = abs(delx)</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="keywordflow">if</span> (absdelx &gt; chmax) chmax = absdelx</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <span class="comment">! -- perform backtracking if free of constraints and set counter and flag</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="keywordflow">if</span> (chmax &gt;= this%dvclose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      btflag = 1</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      <span class="keywordflow">do</span> n = 1, this%neq</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <span class="keywordflow">if</span> (this%active(n) &lt; 1) cycle</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        delx = this%breduc*(this%x(n) - this%xtemp(n))</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        this%x(n) = this%xtemp(n) + delx</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1c7daf42e56a62cccf6625801a30dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1c7daf42e56a62cccf6625801a30dcb">&#9670;&nbsp;</a></span>sln_ca()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_ca </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>isgcnvg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve the models in this solution for kper and kstp. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">isgcnvg</td><td>solution group convergence flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isuppress_output</td><td>flag for suppressing output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01231">1231</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">            !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: isgcnvg<span class="comment">          !&lt; solution group convergence flag</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output<span class="comment">    !&lt; flag for suppressing output</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: fmt</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: kiter   <span class="comment">! non-linear iteration counter</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">! advance the models, exchanges, and solution</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keyword">call </span>this%prepareSolve()</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">select case</span> (isim_mode)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keywordflow">case</span> (mvalidate)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        line = <span class="stringliteral">&#39;mode=&quot;validation&quot; -- Skipping matrix assembly and solution.&#39;</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        fmt = <span class="stringliteral">&quot;(/,1x,a,/)&quot;</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">do</span> im = 1, this%modellist%Count()</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          <span class="keyword">call </span>mp%model_message(line, fmt=fmt)</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">case</span>(mnormal)</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="comment">! nonlinear iteration loop for this solution</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        outerloop: <span class="keywordflow">do</span> kiter = 1, this%mxiter</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;           </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;          <span class="comment">! perform a single iteration</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="keyword">call </span>this%solve(kiter)     </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;          <span class="comment">! exit if converged</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          <span class="keywordflow">if</span> (this%icnvg == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">exit</span> outerloop</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="keywordflow">        end do</span> outerloop</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="comment">! finish up, write convergence info, CSV file, budgets and flows, ...</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keyword">call </span>this%finalizeSolve(kiter, isgcnvg, isuppress_output)   </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_ac1c7daf42e56a62cccf6625801a30dcb_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_ac1c7daf42e56a62cccf6625801a30dcb_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_ac1c7daf42e56a62cccf6625801a30dcb_cgraph" id="namespacenumericalsolutionmodule_ac1c7daf42e56a62cccf6625801a30dcb_cgraph">
<area shape="rect" title="@ brief Solve solution" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
<a id="aa9b69ce721f9271042d955ac6d21c35f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9b69ce721f9271042d955ac6d21c35f">&#9670;&nbsp;</a></span>sln_calcdx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_calcdx </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>neq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>xtemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(inout)&#160;</td>
          <td class="paramname"><em>dx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the dependent-variable change for every cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neq</td><td>number of equations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">active</td><td>active cell flag (1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>current dependent-variable </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xtemp</td><td>previous dependent-variable </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dx</td><td>dependent-variable change </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02847">2847</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: neq<span class="comment">                      !&lt; number of equations</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: active<span class="comment">   !&lt; active cell flag (1)</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: x<span class="comment">            !&lt; current dependent-variable </span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: xtemp<span class="comment">        !&lt; previous dependent-variable</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(inout)</span> :: dx<span class="comment">        !&lt; dependent-variable change</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="comment">! -- calculate dependent-variable change</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <span class="keywordflow">do</span> n = 1, neq</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      <span class="comment">! -- skip inactive nodes</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      <span class="keywordflow">if</span> (active(n) &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        dx(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        dx(n) = x(n) - xtemp(n)</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0532bb986b3da12da5b753fc999bbe0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0532bb986b3da12da5b753fc999bbe0e">&#9670;&nbsp;</a></span>sln_calculate_delt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_calculate_delt </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate time step length. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01009">1009</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceadaptivetimestepmodule.html">adaptivetimestepmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375">ats_submit_delt</a></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#adc3d56c06695509e95078d706508e83f">dtwo</a>, <a class="code" href="namespaceconstantsmodule.html#af78a42d4fd58cef4835c0bbd973ccf59">dthree</a></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idir</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="keywordtype">    real</span>(DP) :: delt_temp</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="keywordtype">    real</span>(DP) :: fact_lower</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="keywordtype">    real</span>(DP) :: fact_upper</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">! -- increase or decrease delt based on kiter fraction.  atsfrac should be</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">!    a value of about 1/3.  If the number of outer iterations is less than</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">!    1/3 of mxiter, then increase step size.  If the number of outer</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">!    iterations is greater than 2/3 of mxiter, then decrease step size.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> (this%atsfrac &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      delt_temp = <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      fact_lower = this%mxiter * this%atsfrac</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      fact_upper = this%mxiter - fact_lower</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">if</span> (this%iouttot_timestep &lt; int(fact_lower)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="comment">! -- increase delt according to tsfactats</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        idir = 1 </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%iouttot_timestep &gt; int(fact_upper)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <span class="comment">! -- decrease delt according to tsfactats</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        idir = -1 </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="comment">! -- do not change delt</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        idir = 0  </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">! -- submit stable dt for upcoming step</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375">ats_submit_delt</a>(<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, delt_temp, this%memoryPath, idir=idir)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a0532bb986b3da12da5b753fc999bbe0e_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a0532bb986b3da12da5b753fc999bbe0e_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a0532bb986b3da12da5b753fc999bbe0e_cgraph" id="namespacenumericalsolutionmodule_a0532bb986b3da12da5b753fc999bbe0e_cgraph">
<area shape="rect" title="@ brief Calculate delt" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375" title="@ brief Allow and external caller to submit preferred time step" alt="" coords="241,5,428,47"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a95cd63bed2962fac3da7f09aaddbf7de" title="@ brief Determine if period is adaptive" alt="" coords="476,5,663,47"/>
</map>
</div>

</div>
</div>
<a id="a3af64aed80e4521475b814733555b327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3af64aed80e4521475b814733555b327">&#9670;&nbsp;</a></span>sln_connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_connect </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assign solution connections. This is the main workhorse method for a solution. The method goes through all the models and all the connections and builds up the sparse matrix. Steps are (1) add internal model connections, (2) add cross terms, (3) allocate solution arrays, (4) create mapping arrays, and (5) fill cross term values if necessary. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02214">2214</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">   !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: cp =&gt; null()</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ic</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierror</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="comment">! -- Add internal model connections to sparse</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keyword">call </span>mp%model_ac(this%sparse)</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="comment">! -- Add the cross terms to sparse</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keyword">call </span>cp%exg_ac(this%sparse)</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="comment">! -- The number of non-zero array values are now known so</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="comment">! -- ia and ja can be created from sparse. then destroy sparse</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    this%nja=this%sparse%nnz</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ja, this%nja, <span class="stringliteral">&#39;JA&#39;</span>, this%name)</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%amat, this%nja, <span class="stringliteral">&#39;AMAT&#39;</span>, this%name)</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keyword">call </span>this%sparse%sort()</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <span class="keyword">call </span>this%sparse%filliaja(this%ia,this%ja,ierror)</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keyword">call </span>this%sparse%destroy()</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="comment">! -- Create mapping arrays for each model.  Mapping assumes</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="comment">! -- that each row has the diagonal in the first position,</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="comment">! -- however, rows do not need to be sorted.</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <span class="keyword">call </span>mp%model_mc(this%ia, this%ja)</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="comment">! -- Create arrays for mapping exchange connections to global solution</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keyword">call </span>cp%exg_mc(this%ia, this%ja)</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a3af64aed80e4521475b814733555b327_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a3af64aed80e4521475b814733555b327_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a3af64aed80e4521475b814733555b327_cgraph" id="namespacenumericalsolutionmodule_a3af64aed80e4521475b814733555b327_cgraph">
<area shape="rect" title="@ brief Assign solution connections" alt="" coords="5,39,193,80"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a09ae423b40a16a7841cbb95815029b0f" title=" " alt="" coords="241,5,472,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="253,71,461,112"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#ab1fef9adb89cbcfb556286fba47b988b" title=" " alt="" coords="520,5,753,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="531,71,742,112"/>
</map>
</div>

</div>
</div>
<a id="a748042c7737328020b0453d734a83a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a748042c7737328020b0453d734a83a7c">&#9670;&nbsp;</a></span>sln_da()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Deallocate a solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01119">1119</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">! -- IMSLinearModule</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keyword">call </span>this%imslinear%imslinear_da()</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keyword">deallocate</span>(this%imslinear)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="comment">! -- lists</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keyword">call </span>this%modellist%Clear()</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keyword">call </span>this%exchangelist%Clear()</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keyword">deallocate</span>(this%modellist)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keyword">deallocate</span>(this%exchangelist)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="comment">! -- character arrays</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keyword">deallocate</span>(this%caccel)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">! -- inner iteration table object</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%innertab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keyword">call </span>this%innertab%table_da()</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keyword">deallocate</span>(this%innertab)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keyword">nullify</span>(this%innertab)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">! -- outer iteration table object</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%outertab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keyword">call </span>this%outertab%table_da()</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keyword">deallocate</span>(this%outertab)</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keyword">nullify</span>(this%outertab)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">! -- arrays</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ja)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%amat)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ia)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%x)</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rhs)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%active)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%xtemp)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dxold)</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%hncg)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%lrch)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%wsave)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%hchold)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%deold)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%convmodstart)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%locdv)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%locdr)</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%itinner)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%convlocdv)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%convlocdr)</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dvmax)</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%drmax)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%convdvmax)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%convdrmax)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%id)</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iu)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ttform)</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ttsoln)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%neq)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nja)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dvclose)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%bigchold)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%bigch)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%relaxold)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%res_prev)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%res_new)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icnvg)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%itertot_timestep)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iouttot_timestep)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%itertot_sim)</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%mxiter)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%linmeth)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nonmeth)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iprims)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%theta)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%akappa)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%gamma)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%amomentum)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%breduc)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%btol)</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%res_lim)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%numtrack)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ibflag)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icsvouterout)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icsvinnerout)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nitermax)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%convnmod)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iallowptc)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iptcopt)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iptcout)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%l2norm0)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ptcdel)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ptcdel0)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ptcexp)</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ptcthresh)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ptcrat)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%atsfrac)</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b3255995926f4887838220f0ea12c40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b3255995926f4887838220f0ea12c40">&#9670;&nbsp;</a></span>sln_df()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define a new solution. Must be called after the models and exchanges have been added to solution. The order of the steps is (1) Allocate neq and nja, (2) Assign model offsets and solution ids, (3) Allocate and initialize the solution arrays, (4) Point each model's x and rhs arrays, and (5) Initialize the sparsematrix instance </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l00410">410</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">! modules</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: rowmaxnnz</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">! -- calculate and set offsets</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">do</span> i = 1, this%modellist%Count()</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, i)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keyword">call </span>mp%set_idsoln(this%id)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keyword">call </span>mp%set_moffset(this%neq)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      this%neq = this%neq + mp%neq</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">! -- Allocate and initialize solution arrays</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">call </span>this%allocate_arrays()</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">! -- Go through each model and point x, ibound, and rhs to solution</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">do</span> i = 1, this%modellist%Count()</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, i)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keyword">call </span>mp%set_xptr(this%x, <span class="stringliteral">&#39;X&#39;</span>, this%name)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keyword">call </span>mp%set_rhsptr(this%rhs, <span class="stringliteral">&#39;RHS&#39;</span>, this%name)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keyword">call </span>mp%set_iboundptr(this%active, <span class="stringliteral">&#39;IBOUND&#39;</span>, this%name)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">! -- Create the sparsematrix instance</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keyword">allocate</span>(rowmaxnnz(this%neq))</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">do</span> i=1,this%neq</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        rowmaxnnz(i)=4</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">call </span>this%sparse%init(this%neq, this%neq, rowmaxnnz)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">deallocate</span>(rowmaxnnz)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">! -- Assign connections, fill ia/ja, map connections</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keyword">call </span>this%sln_connect()</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a4b3255995926f4887838220f0ea12c40_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a4b3255995926f4887838220f0ea12c40_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a4b3255995926f4887838220f0ea12c40_cgraph" id="namespacenumericalsolutionmodule_a4b3255995926f4887838220f0ea12c40_cgraph">
<area shape="rect" title="@ brief Define the solution" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
<a id="a2f9158456ae05512c728b125a9c877e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9158456ae05512c728b125a9c877e1">&#9670;&nbsp;</a></span>sln_fp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_fp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finalize a solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01095">1095</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">! -- write timer output </span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceversionmodule.html#ab82d1ea64df56737f03bbbe06c1499bd">idevelopmode</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keyword">write</span>(this%imslinear%iout, <span class="stringliteral">&#39;(//1x,a,1x,a,1x,a)&#39;</span>)                         &amp;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="stringliteral">&#39;Solution&#39;</span>, trim(adjustl(this%name)), <span class="stringliteral">&#39;summary&#39;</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="keyword">write</span>(this%imslinear%iout, <span class="stringliteral">&quot;(1x,70(&#39;-&#39;))&quot;</span>)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keyword">write</span>(this%imslinear%iout, <span class="stringliteral">&#39;(1x,a,1x,g0,1x,a)&#39;</span>)                          &amp;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="stringliteral">&#39;Total formulate time: &#39;</span>, this%ttform, <span class="stringliteral">&#39;seconds&#39;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keyword">write</span>(this%imslinear%iout, <span class="stringliteral">&#39;(1x,a,1x,g0,1x,a,/)&#39;</span>)                        &amp;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="stringliteral">&#39;Total solution time:  &#39;</span>, this%ttsoln, <span class="stringliteral">&#39;seconds&#39;</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e536e8da68c7f8a12f3731f27b409c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e536e8da68c7f8a12f3731f27b409c0">&#9670;&nbsp;</a></span>sln_get_loc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_get_loc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodesln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(inout)&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the cell location string for the provided solution node number. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodesln</td><td>solution node number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">str</td><td>string with user node number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l03056">3056</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodesln<span class="comment">                  !&lt; solution node number</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(inout)</span> :: str<span class="comment">               !&lt; string with user node number</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp=&gt; null()</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istart</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iend</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: noder</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="comment">! -- initialize dummy variables</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    str = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    noder = 0</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    <span class="comment">! -- calculate and set offsets</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <span class="keywordflow">do</span> i = 1, this%modellist%Count()</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, i)</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      istart = 0</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      iend = 0</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      <span class="keyword">call </span>mp%get_mrange(istart, iend)</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <span class="keywordflow">if</span> (nodesln &gt;= istart .and. nodesln &lt;= iend) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;        noder = nodesln - istart + 1</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;        <span class="keyword">call </span>mp%get_mcellid(noder, str)</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a3e536e8da68c7f8a12f3731f27b409c0_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a3e536e8da68c7f8a12f3731f27b409c0_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a3e536e8da68c7f8a12f3731f27b409c0_cgraph" id="namespacenumericalsolutionmodule_a3e536e8da68c7f8a12f3731f27b409c0_cgraph">
<area shape="rect" title="@ brief Get cell location string" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
<a id="a0673b47847b9b33923ecc11dbc2d8359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0673b47847b9b33923ecc11dbc2d8359">&#9670;&nbsp;</a></span>sln_get_nodeu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_get_nodeu </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodesln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>nodeu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the user node number from a model for the provided solution node number. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodesln</td><td>solution node number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">im</td><td>solution model number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nodeu</td><td>user node number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l03096">3096</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodesln<span class="comment">                  !&lt; solution node number</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: im<span class="comment">                    !&lt; solution model number</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: nodeu<span class="comment">                 !&lt; user node number</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType),<span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istart</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iend</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: noder</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    noder = 0</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="comment">! -- calculate and set offsets</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <span class="keywordflow">do</span> i = 1, this%modellist%Count()</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, i)</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      istart = 0</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      iend = 0</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <span class="keyword">call </span>mp%get_mrange(istart, iend)</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;      <span class="keywordflow">if</span> (nodesln &gt;= istart .and. nodesln &lt;= iend) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        noder = nodesln - istart + 1</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="keyword">call </span>mp%get_mnodeu(noder, nodeu)</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        im = i</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a0673b47847b9b33923ecc11dbc2d8359_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a0673b47847b9b33923ecc11dbc2d8359_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a0673b47847b9b33923ecc11dbc2d8359_cgraph" id="namespacenumericalsolutionmodule_a0673b47847b9b33923ecc11dbc2d8359_cgraph">
<area shape="rect" title="@ brief Get user node number" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
<a id="ab0d6d46a24e32901def02a0b6b553248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0d6d46a24e32901def02a0b6b553248">&#9670;&nbsp;</a></span>sln_l2norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_l2norm </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>neq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(neq+1), intent(in)&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>ja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>amat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>l2norm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the solution L-2 norm using the coefficient matrix, the right-hand side vector, and the current dependent-variable vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neq</td><td>number of equations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nja</td><td>number of non-zero entries </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia</td><td>CRS row pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ja</td><td>CRS column pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">active</td><td>active cell flag vector (1) inactive (0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">amat</td><td>coefficient matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhs</td><td>right-hand side vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>dependent-variable vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">l2norm</td><td>calculated L-2 norm </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02764">2764</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: neq<span class="comment">                      !&lt; number of equations</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nja<span class="comment">                      !&lt; number of non-zero entries</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(neq+1)</span>, <span class="keywordtype">intent(in)</span> :: ia<span class="comment">     !&lt; CRS row pointers</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(nja)</span>, <span class="keywordtype">intent(in)</span> :: ja<span class="comment">       !&lt; CRS column pointers</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: active<span class="comment">   !&lt; active cell flag vector (1) inactive (0)</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nja)</span>, <span class="keywordtype">intent(in)</span> :: amat<span class="comment">         !&lt; coefficient matrix</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: rhs<span class="comment">          !&lt; right-hand side vector</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: x<span class="comment">            !&lt; dependent-variable vector</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: l2norm<span class="comment">                    !&lt; calculated L-2 norm</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: jcol</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="keywordtype">    real</span>(DP) :: rowsum</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="keywordtype">    real</span>(DP) :: residual</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    residual = dzero</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="comment">! -- calculate the L-2 norm</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keywordflow">do</span> n = 1, neq</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keywordflow">if</span> (active(n) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        rowsum = dzero</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="keywordflow">do</span> j = ia(n), ia(n+1)-1</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;          jcol = ja(j)</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;          rowsum = rowsum + amat(j) * x(jcol)</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        <span class="comment">! compute mean square residual from q of each node</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        residual = residual + (rowsum - rhs(n))**2</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="comment">! -- The L-2 norm is the square root of the sum of the square of the residuals</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    l2norm = sqrt(residual)</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3e6fe297bd0318f1d628ce549bca68d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e6fe297bd0318f1d628ce549bca68d">&#9670;&nbsp;</a></span>sln_ls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_ls </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>in_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>iptc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>ptcf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Solve the linear system of equations. Steps include (1) matrix cleanup, (2) add pseudo-transient continuation terms, and (3) residual reduction. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02295">2295</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: in_iter</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: iptc</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: ptcf</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordtype">logical</span> :: lsame</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: itestmat</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i2</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iptct</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iallowptc</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="keywordtype">    real</span>(DP) :: adiag</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="keywordtype">    real</span>(DP) :: diagval</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="keywordtype">    real</span>(DP) :: l2norm</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="keywordtype">    real</span>(DP) :: ptcval</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="keywordtype">    real</span>(DP) :: diagmin</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="keywordtype">    real</span>(DP) :: bnorm</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keywordtype">character(len=50)</span> :: fname</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtfname = <span class="stringliteral">&quot;(&#39;mf6mat_&#39;, i0, &#39;_&#39;, i0, &amp;</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39;_&#39;, i0, &#39;_&#39;, i0, &#39;.txt&#39;)&quot;</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="comment">! -- take care of loose ends for all nodes before call to solver</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keywordflow">do</span> n = 1, this%neq</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="comment">! -- store x in temporary location</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      this%xtemp(n) = this%x(n)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="comment">! -- set dirichlet boundary and no-flow condition</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="keywordflow">if</span> (this%active(n) &lt;= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        this%amat(this%ia(n)) = done</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        this%rhs(n) = this%x(n)</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        i1 = this%ia(n) + 1</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        i2 = this%ia(n + 1) - 1</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">do</span> i = i1, i2</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;          this%amat(i) = dzero</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="comment">! -- take care of the case where there is a zero on the row diagonal</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        diagval = -done</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        adiag = abs(this%amat(this%ia(n)))</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="keywordflow">if</span> (adiag &lt; dem15) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;          this%amat(this%ia(n)) = diagval</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;          this%rhs(n) = this%rhs(n) + diagval * this%x(n) </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="comment">! -- pseudo transient continuation</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="comment">! -- set iallowptc</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <span class="comment">! -- no_ptc_option is FIRST</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="keywordflow">if</span> (this%iallowptc &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        iallowptc = 1</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        iallowptc = 0</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="comment">! -- no_ptc_option is ALL (0) or using PTC (1)</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      iallowptc = this%iallowptc</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="comment">! -- set iptct</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    iptct = iptc * iallowptc</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="comment">! -- calculate or modify pseudo transient continuation terms and add</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="comment">!    to amat diagonals</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordflow">if</span> (iptct /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      <span class="keyword">call </span>this%sln_l2norm(this%neq, this%nja,                                 &amp;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                           this%ia, this%ja, this%active,                      &amp;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                           this%amat, this%rhs, this%x, l2norm)</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="comment">! -- confirm that the l2norm exceeds previous l2norm</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="comment">!    if not, there is no need to add ptc terms</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      <span class="keywordflow">if</span> (kiter == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> &gt; 1 .or. <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a> &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;          <span class="keywordflow">if</span> (l2norm &lt;= this%l2norm0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            iptc = 0</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        lsame = is_same(l2norm, this%l2norm0)</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="keywordflow">if</span> (lsame) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;          iptc = 0</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    iptct = iptc * iallowptc</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordflow">if</span> (iptct /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="keywordflow">if</span> (kiter == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="keywordflow">if</span> (this%iptcout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;          <span class="keyword">write</span>(this%iptcout, <span class="stringliteral">&#39;(A10,6(1x,A15),2(1x,A15))&#39;</span>) <span class="stringliteral">&#39;OUTER ITER&#39;</span>,       &amp;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            <span class="stringliteral">&#39;         PTCDEL&#39;</span>, <span class="stringliteral">&#39;        L2NORM0&#39;</span>, <span class="stringliteral">&#39;         L2NORM&#39;</span>,           &amp;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            <span class="stringliteral">&#39;        RHSNORM&#39;</span>, <span class="stringliteral">&#39;       1/PTCDEL&#39;</span>, <span class="stringliteral">&#39;  DIAGONAL MIN.&#39;</span>,           &amp;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;            <span class="stringliteral">&#39; RHSNORM/L2NORM&#39;</span>, <span class="stringliteral">&#39; STOPPING CRIT.&#39;</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordflow">if</span> (this%ptcdel0 &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;          this%ptcdel = this%ptcdel0</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;          <span class="keywordflow">if</span> (this%iptcopt == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;            <span class="comment">! -- ptcf is the reciprocal of the pseudo-time step</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;            this%ptcdel = done / ptcf</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            bnorm = dzero</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            <span class="keywordflow">do</span> n = 1, this%neq</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;              <span class="keywordflow">if</span> (this%active(n).gt.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                bnorm = bnorm + this%rhs(n) * this%rhs(n)</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            bnorm = sqrt(bnorm)</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            this%ptcdel = bnorm / l2norm</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <span class="keywordflow">if</span> (l2norm &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;          this%ptcdel = this%ptcdel * (this%l2norm0 / l2norm)**this%ptcexp</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;          this%ptcdel = dzero</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      <span class="keywordflow">if</span> (this%ptcdel &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        ptcval = done / this%ptcdel</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        ptcval = done</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      diagmin = dep20</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      bnorm = dzero</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keywordflow">do</span> n = 1, this%neq</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        <span class="keywordflow">if</span> (this%active(n) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;          diagval = abs(this%amat(this%ia(n)))</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;          bnorm = bnorm + this%rhs(n) * this%rhs(n)</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;          <span class="keywordflow">if</span> (diagval &lt; diagmin) diagmin = diagval</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;          this%amat(this%ia(n)) = this%amat(this%ia(n)) - ptcval</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;          this%rhs(n) = this%rhs(n) - ptcval * this%x(n)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      bnorm = sqrt(bnorm)</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <span class="keywordflow">if</span> (this%iptcout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        <span class="keyword">write</span>(this%iptcout, <span class="stringliteral">&#39;(i10,6(1x,e15.7),2(1x,f15.6))&#39;</span>)                   &amp;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;          kiter, this%ptcdel, this%l2norm0, l2norm, bnorm,                     &amp;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;          ptcval, diagmin, bnorm/l2norm, ptcval / diagmin</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      this%l2norm0 = l2norm</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="comment">! -- save rhs, amat to a file</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="comment">!    to enable set itestmat to 1 and recompile</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    itestmat = 0</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <span class="keywordflow">if</span> (itestmat == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      <span class="keyword">write</span>(fname, fmtfname) this%id, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, kiter</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      print *, <span class="stringliteral">&#39;Saving amat to: &#39;</span>, trim(adjustl(fname))</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <span class="keyword">open</span>(99,file=trim(adjustl(fname)))</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <span class="keyword">WRITE</span>(99,*)<span class="stringliteral">&#39;NODE, RHS, AMAT FOLLOW&#39;</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <span class="keywordflow">DO</span> n = 1, this%NEQ</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        i1 = this%IA(n)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        i2 = this%IA(n+1)-1</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        <span class="keyword">WRITE</span>(99,<span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>) n, this%RHS(n), (this%ja(i),i=i1,i2), &amp;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                      (this%AMAT(i),i=i1,i2)</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <span class="keyword">close</span>(99)</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      <span class="comment">!stop</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="comment">! -- call appropriate linear solver</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="comment">! -- ims linear solver - linmeth option 1</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordflow">if</span> (this%linmeth == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <span class="keyword">call </span>this%imslinear%imslinear_apply(this%icnvg, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, kiter, in_iter,    &amp;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                                          this%nitermax,                       &amp;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                                          this%convnmod, this%convmodstart,    &amp;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                                          this%locdv, this%locdr,              &amp;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                                          this%caccel, this%itinner,           &amp;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                                          this%convlocdv, this%convlocdr,      &amp;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                                          this%dvmax, this%drmax,              &amp;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                                          this%convdvmax, this%convdrmax)</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="comment">! -- ptc finalize - set ratio of ptc value added to the diagonal and the</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="comment">!                   minimum value on the diagonal. This value will be used</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="comment">!                   to determine if the make sure the ptc value has decayed</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="comment">!                   sufficiently</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordflow">if</span> (iptct /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      this%ptcrat = ptcval / diagmin</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_aa3e6fe297bd0318f1d628ce549bca68d_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_aa3e6fe297bd0318f1d628ce549bca68d_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_aa3e6fe297bd0318f1d628ce549bca68d_cgraph" id="namespacenumericalsolutionmodule_aa3e6fe297bd0318f1d628ce549bca68d_cgraph">
<area shape="rect" title="@ brief Solve the linear system of equations" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#aa6f1e09d5f419107a1e51aeecc9c12b4" title=" " alt="" coords="241,5,409,47"/>
</map>
</div>

</div>
</div>
<a id="a475b3a3dafa811568f0ca944fc69d066"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475b3a3dafa811568f0ca944fc69d066">&#9670;&nbsp;</a></span>sln_maxval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_maxval </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nsize), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>vmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the maximum value in a vector using a normalized form. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsize</td><td>length of vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>input vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vmax</td><td>maximum value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02810">2810</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nsize<span class="comment">                    !&lt; length of vector</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(nsize)</span>, <span class="keywordtype">intent(in)</span> :: v<span class="comment">          !&lt; input vector</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: vmax<span class="comment">                      !&lt; maximum value</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="keywordtype">    real</span>(DP) :: d</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="keywordtype">    real</span>(DP) :: denom</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="keywordtype">    real</span>(DP) :: dnorm</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="comment">! -- determine maximum value</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    vmax = v(1)</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <span class="keywordflow">do</span> n = 2, nsize</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      d = v(n)</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      denom = abs(vmax)</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <span class="keywordflow">if</span> (denom == dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        denom = dprec</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="comment">! -- calculate normalized value</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;      dnorm = abs(d) / denom</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      <span class="keywordflow">if</span> (dnorm &gt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        vmax = d</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4632e3dda1e8c84713288749c18d1b40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4632e3dda1e8c84713288749c18d1b40">&#9670;&nbsp;</a></span>sln_ot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_ot </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output solution data. Currently does nothing. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01080">1080</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">! -- Nothing to do here</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a3d89607aaac24faece4e0decc96a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3d89607aaac24faece4e0decc96a1e">&#9670;&nbsp;</a></span>sln_outer_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_outer_check </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hncg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>lrch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Determine the maximum dependent-variable change at the end of a Picard iteration. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hncg</td><td>maximum dependent-variable change </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lrch</td><td>location of the maximum dependent-variable change </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l03015">3015</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hncg<span class="comment">                      !&lt; maximum dependent-variable change</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: lrch<span class="comment">                  !&lt; location of the maximum dependent-variable change</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nb</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="keywordtype">    real</span>(DP) :: bigch</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="keywordtype">    real</span>(DP) :: abigch</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="keywordtype">    real</span>(DP) :: hdif</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="keywordtype">    real</span>(DP) :: ahdif</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="comment">! -- determine the maximum change</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    nb = 1</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    bigch = dzero</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    abigch = dzero</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keywordflow">do</span> n = 1, this%neq</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      <span class="keywordflow">if</span>(this%active(n) &lt; 1) cycle</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      hdif = this%x(n) - this%xtemp(n)</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      ahdif = abs(hdif)</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">if</span> (ahdif &gt;= abigch) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        bigch = hdif</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        abigch = ahdif</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        nb = n</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    <span class="comment">!-----store maximum change value and location</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    hncg = bigch</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    lrch = nb</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6bb33e0aaff92c1244857513eedf312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6bb33e0aaff92c1244857513eedf312">&#9670;&nbsp;</a></span>sln_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_reset </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset the solution by setting the coefficient matrix and right-hand side vectors to zero. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02271">2271</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="comment">! -- reset the solution</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nja</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      this%amat(i) = dzero</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keywordflow">do</span> i = 1, this%neq</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      this%rhs(i) = dzero</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90145df172cfa4ef4e2e3505659d454e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90145df172cfa4ef4e2e3505659d454e">&#9670;&nbsp;</a></span>sln_setouter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_setouter </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ifdparam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set default Picard iteration variables based on passed complexity option. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifdparam</td><td>complexity option (1) simple (2) moderate (3) complex </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02501">2501</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ifdparam<span class="comment">                 !&lt; complexity option (1) simple (2) moderate (3) complex</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="comment">! -- simple option</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <span class="keywordflow">select case</span> ( ifdparam )</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="keywordflow">case</span> ( 1 )</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      this%dvclose = dem3</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      this%mxiter = 25</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      this%nonmeth = 0</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      this%theta = done</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      this%akappa = dzero</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      this%gamma = done</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      this%amomentum = dzero</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      this%numtrack = 0</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      this%btol = dzero</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      this%breduc = dzero</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      this%res_lim = dzero</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="comment">! -- moderate</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">case</span> ( 2 )</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      this%dvclose = dem2</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      this%mxiter = 50</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      this%nonmeth = 3</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      this%theta = 0.9d0</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      this%akappa = 0.0001d0</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      this%gamma = dzero</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      this%amomentum = dzero</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      this%numtrack = 0</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      this%btol = dzero</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      this%breduc = dzero</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      this%res_lim = dzero</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="comment">! -- complex</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="keywordflow">case</span> ( 3 )</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      this%dvclose = dem1</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      this%mxiter = 100</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      this%nonmeth = 3</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      this%theta = 0.8d0</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      this%akappa = 0.0001d0</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      this%gamma = dzero</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;      this%amomentum = dzero</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      this%numtrack = 20</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      this%btol = 1.05d0</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      this%breduc = 0.1d0</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      this%res_lim = 0.002d0</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a714a62a841f370b7472eeed70f030f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a714a62a841f370b7472eeed70f030f77">&#9670;&nbsp;</a></span>sln_underrelax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::sln_underrelax </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>bigch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>neq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(neq), intent(in)&#160;</td>
          <td class="paramname"><em>xtemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Under relax using the simple, cooley, or delta-bar-delta methods. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>Picard iteration number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bigch</td><td>maximum dependent-variable change </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neq</td><td>number of equations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">active</td><td>active cell flag (1) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>current dependent-variable </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xtemp</td><td>previous dependent-variable </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l02878">2878</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                    !&lt; Picard iteration number</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: bigch<span class="comment">                        !&lt; maximum dependent-variable change</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: neq<span class="comment">                      !&lt; number of equations</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: active<span class="comment">   !&lt; active cell flag (1)</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(inout)</span> :: x<span class="comment">         !&lt; current dependent-variable</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(neq)</span>, <span class="keywordtype">intent(in)</span> :: xtemp<span class="comment">        !&lt; previous dependent-variable</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="keywordtype">    real</span>(DP) :: ww</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="keywordtype">    real</span>(DP) :: delx</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="keywordtype">    real</span>(DP) :: relax</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="keywordtype">    real</span>(DP) :: es</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="keywordtype">    real</span>(DP) :: aes</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="keywordtype">    real</span>(DP) :: amom</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="comment">! -- option for using simple dampening (as done by MODFLOW-2005 PCG)</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">if</span> (this%nonmeth == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">do</span> n = 1, neq</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        <span class="comment">! -- skip inactive nodes</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        <span class="keywordflow">if</span> (active(n) &lt; 1) cycle</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        <span class="comment">! -- compute step-size (delta x)</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        delx = x(n) - xtemp(n)</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        this%dxold(n) = delx</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160; </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        <span class="comment">! -- dampen dependent variable solution</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        x(n) = xtemp(n) + this%gamma * delx</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <span class="comment">! -- option for using cooley underrelaxation</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%nonmeth == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="comment">! -- set bigch</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;      this%bigch = bigch</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <span class="comment">! -- initialize values for first iteration</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="keywordflow">if</span> (kiter == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        relax = done</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        this%relaxold = done</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        this%bigchold = bigch</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="comment">! -- compute relaxation factor</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        es = this%bigch / (this%bigchold * this%relaxold)</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        aes = abs(es)</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keywordflow">if</span> (es &lt; -done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          relax = dhalf / aes</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;          relax = (<a class="code" href="namespaceconstantsmodule.html#af78a42d4fd58cef4835c0bbd973ccf59">dthree</a> + es) / (<a class="code" href="namespaceconstantsmodule.html#af78a42d4fd58cef4835c0bbd973ccf59">dthree</a> + aes)</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      this%relaxold = relax</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      <span class="comment">! -- modify cooley to use weighted average of past changes</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      this%bigchold = (done - this%gamma) * this%bigch  + this%gamma *         &amp;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                      this%bigchold</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="comment">! -- compute new dependent variable after under-relaxation</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="keywordflow">if</span> (relax &lt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;        <span class="keywordflow">do</span> n = 1, neq</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;          <span class="comment">! -- skip inactive nodes</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          <span class="keywordflow">if</span> (active(n) &lt; 1) cycle</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;          <span class="comment">! -- update dependent variable</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;          delx = x(n) - xtemp(n)</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          this%dxold(n) = delx</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;          x(n) = xtemp(n) + relax * delx</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="comment">! -- option for using delta-bar-delta scheme to under-relax for all equations</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%nonmeth == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      <span class="keywordflow">do</span> n = 1, neq</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        <span class="comment">! -- skip inactive nodes</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <span class="keywordflow">if</span> (active(n) &lt; 1) cycle</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="comment">! -- compute step-size (delta x) and initialize d-b-d parameters</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        delx = x(n) - xtemp(n)</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        <span class="comment">! -- initialize values for first iteration</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        <span class="keywordflow">if</span> ( kiter == 1 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;          this%wsave(n) = done</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;          this%hchold(n) = dem20</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          this%deold(n) = dzero</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="comment">! -- compute new relaxation term as per delta-bar-delta</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;        ww = this%wsave(n)</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;        <span class="comment">! for flip-flop condition, decrease factor</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        <span class="keywordflow">if</span> ( this%deold(n)*delx &lt; dzero ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;          ww = this%theta * this%wsave(n)</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;          <span class="comment">! -- when change is of same sign, increase factor</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;          ww = this%wsave(n) + this%akappa</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        <span class="keywordflow">if</span> ( ww &gt; done ) ww = done</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        this%wsave(n) = ww</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="comment">! -- compute weighted average of past changes in hchold</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="keywordflow">if</span> (kiter == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;          this%hchold(n) = delx</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;          this%hchold(n) = (done - this%gamma) * delx +                        &amp;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                           this%gamma * this%hchold(n)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="comment">! -- store slope (change) term for next iteration</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        this%deold(n) = delx</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        this%dxold(n) = delx</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        <span class="comment">! -- compute accepted step-size and new dependent variable</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        amom = dzero</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <span class="keywordflow">if</span> (kiter &gt; 4) amom = this%amomentum</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        delx = delx * ww + amom * this%hchold(n)</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        x(n) = xtemp(n) + delx</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe1d36406e23aa824de7b49f7a96a543"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1d36406e23aa824de7b49f7a96a543">&#9670;&nbsp;</a></span>solution_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public numericalsolutionmodule::solution_create </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new solution using the data in filename, assign this new solution an id number and store the solution in the basesolutionlist. Also open the filename for later reading. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>solution input file name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>solution id </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l00183">183</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>,  <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">intent(in)</span> :: filename<span class="comment">    !&lt; solution input file name</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: id<span class="comment">              !&lt; solution id</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inunit</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">type</span>(NumericalSolutionType), <span class="keywordtype">pointer</span> :: solution =&gt; null()</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">class</span>(BaseSolutionType), <span class="keywordtype">pointer</span> :: solbase =&gt; null()</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">character(len=LENSOLUTIONNAME)</span> :: solutionname</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">! -- Create a new solution and add it to the basesolutionlist container</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">allocate</span>(solution)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    solbase =&gt; solution</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">write</span>(solutionname,<span class="stringliteral">&#39;(a, i0)&#39;</span>) <span class="stringliteral">&#39;SLN_&#39;</span>, id</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    solution%name = solutionname</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    solution%memoryPath = <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a>(solutionname)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">allocate</span>(solution%modellist)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">allocate</span>(solution%exchangelist)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">call </span>solution%allocate_scalars()</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">call </span>addbasesolutiontolist(basesolutionlist, solbase)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    solution%id = id</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">! -- Open solution input file for reading later after problem size is known</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!    Check to see if the file is already opened, which can happen when</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">!    running in single model mode</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">inquire</span>(file=filename, number=inunit)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span>(inunit &lt; 0) inunit = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    solution%iu = inunit</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,<span class="stringliteral">&#39;(/a,a)&#39;</span>) <span class="stringliteral">&#39; Creating solution: &#39;</span>, solution%name</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(solution%iu, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, filename, <span class="stringliteral">&#39;IMS&#39;</span>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">! -- Initialize block parser</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">call </span>solution%parser%Initialize(solution%iu, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_cgraph" id="namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_cgraph">
<area shape="rect" title="@ brief Create a new solution" alt="" coords="5,130,193,171"/>
<area shape="rect" href="namespacebasesolutionmodule.html#a325c28d7b2f545c1febe4491f9dcc811" title=" " alt="" coords="241,31,412,73"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738" title="returns the path to the memory object" alt="" coords="243,97,410,138"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="249,241,404,282"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title=" " alt="" coords="249,162,404,203"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="460,31,627,73"/>
<area shape="rect" href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a" title=" " alt="" coords="675,152,849,179"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title=" " alt="" coords="693,68,831,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title=" " alt="" coords="897,27,1065,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="897,93,1065,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title=" " alt="" coords="1113,5,1308,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1127,57,1295,98"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="466,266,621,307"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="466,149,621,190"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_icgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_icgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_icgraph" id="namespacenumericalsolutionmodule_afe1d36406e23aa824de7b49f7a96a543_icgraph">
<area shape="rect" title="@ brief Create a new solution" alt="" coords="1297,23,1485,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aa6d30418b28eb07e46b20c32e8805806" title=" " alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title=" " alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title=" " alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title=" " alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title=" " alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title=" " alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a964262851ef62c07577f4b3bbf384e15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a964262851ef62c07577f4b3bbf384e15">&#9670;&nbsp;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::solve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds and solve the system for this numerical solution. It roughly consists of the following steps (1) backtracking, (2) reset amat and rhs (3) calculate matrix terms (*_cf), (4) add coefficients to matrix (*_fc), (6) newton-raphson, (6) PTC, (7) linear solve, (8) convergence checks, (9) write output, and (10) underrelaxation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>Picard iteration number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01415">1415</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">    !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">       !&lt; Picard iteration number</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordtype">class</span>(NumericalExchangeType), <span class="keywordtype">pointer</span> :: cp =&gt; null()    </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: cmod</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: cpak</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: cpakout</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordtype">character(len=LENPAKLOC)</span> :: strh</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordtype">character(len=25)</span> :: cval</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordtype">character(len=7)</span> :: cmsg</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ic</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im    </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icsv0</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: kcsv0</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i0, i1    </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: itestmat, n</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iter    </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inewtonur    </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: locmax_nur    </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iend</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icnvgmod</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iptc</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodeu</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipak</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipos0</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipos1</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="keywordtype">    real</span>(DP) :: dxmax_nur</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="keywordtype">    real</span>(DP) :: dxmax</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="keywordtype">    real</span>(DP) :: ptcf</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="keywordtype">    real</span>(DP) :: ttform</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="keywordtype">    real</span>(DP) :: ttsoln</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="keywordtype">    real</span>(DP) :: dpak</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="keywordtype">    real</span>(DP) :: outer_hncg</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    icsv0 = max(1, this%itertot_sim + 1)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    kcsv0 = max(1, this%itertot_timestep + 1)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">! -- create header for outer iteration table</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%outertab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="comment">! -- create outer iteration table</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="comment">! -- table dimensions</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        ntabrows = 1</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        ntabcols = 6</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          ntabcols = ntabcols + 4</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="comment">! -- initialize table and define columns</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        title = trim(this%memoryPath) // <span class="stringliteral">&#39; OUTER ITERATION SUMMARY&#39;</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%outertab, this%name, title)</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keyword">call </span>this%outertab%table_df(ntabrows, ntabcols, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>,        &amp;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                    finalize=.false.)</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        tag = <span class="stringliteral">&#39;OUTER ITERATION STEP&#39;</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="keyword">call </span>this%outertab%initialize_column(tag, 25, alignment=tableft)</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        tag = <span class="stringliteral">&#39;OUTER ITERATION&#39;</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keyword">call </span>this%outertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        tag = <span class="stringliteral">&#39;INNER ITERATION&#39;</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="keyword">call </span>this%outertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          tag = <span class="stringliteral">&#39;BACKTRACK FLAG&#39;</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          <span class="keyword">call </span>this%outertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;          tag = <span class="stringliteral">&#39;BACKTRACK ITERATIONS&#39;</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          <span class="keyword">call </span>this%outertab%initialize_column(tag, 10, alignment=tabright)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          tag = <span class="stringliteral">&#39;INCOMING RESIDUAL&#39;</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;          <span class="keyword">call </span>this%outertab%initialize_column(tag, 15, alignment=tabright)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          tag = <span class="stringliteral">&#39;OUTGOING RESIDUAL&#39;</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          <span class="keyword">call </span>this%outertab%initialize_column(tag, 15, alignment=tabright)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        tag = <span class="stringliteral">&#39;MAXIMUM CHANGE&#39;</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keyword">call </span>this%outertab%initialize_column(tag, 15, alignment=tabright)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        tag = <span class="stringliteral">&#39;STEP SUCCESS&#39;</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keyword">call </span>this%outertab%initialize_column(tag, 7, alignment=tabright)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        tag = <span class="stringliteral">&#39;MAXIMUM CHANGE MODEL-(CELLID) OR MODEL-PACKAGE-(NUMBER)&#39;</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keyword">call </span>this%outertab%initialize_column(tag, 34, alignment=tabright)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">! -- backtracking</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keyword">call </span>this%sln_backtracking(mp, cp, kiter)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="comment">! -- Set amat and rhs to zero</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keyword">call </span>this%sln_reset()</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keyword">call </span>code_timer(0, ttform, this%ttform)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">! -- Calculate the matrix terms for each exchange</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keyword">call </span>cp%exg_cf(kiter)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">! -- Calculate the matrix terms for each model</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keyword">call </span>mp%model_cf(kiter)</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">! -- Add exchange coefficients to the solution</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="keyword">call </span>cp%exg_fc(kiter, this%ia, this%amat, this%rhs, 1)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">! -- Add model coefficients to the solution</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <span class="keyword">call </span>mp%model_fc(kiter, this%amat, this%nja, 1)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">! -- Add exchange Newton-Raphson terms to solution</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="keyword">call </span>cp%exg_nr(kiter, this%ia, this%amat)</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">! -- Calculate pseudo-transient continuation factor for each model</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    iptc = 0</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    ptcf = dzero</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="keyword">call </span>mp%model_ptc(kiter, this%neq, this%nja,                         &amp;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                        this%ia, this%ja, this%x,                          &amp;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                        this%rhs, this%amat,                               &amp;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                        iptc, ptcf)</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">! -- Add model Newton-Raphson terms to solution</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keyword">call </span>mp%model_nr(kiter, this%amat, this%nja, 1)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keyword">call </span>code_timer(1, ttform, this%ttform)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">! -- linear solve</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="keyword">call </span>code_timer(0, ttsoln, this%ttsoln)</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keyword">CALL </span>this%sln_ls(kiter, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, iter, iptc, ptcf)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keyword">call </span>code_timer(1, ttsoln, this%ttsoln)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="comment">! -- increment counters storing the total number of linear and </span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="comment">!    non-linear iterations for this timestep and the total </span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="comment">!    number of linear iterations for all timesteps</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    this%itertot_timestep = this%itertot_timestep + iter</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    this%iouttot_timestep = this%iouttot_timestep + 1</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    this%itertot_sim = this%itertot_sim + iter</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">! -- save matrix to a file</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="comment">!    to enable set itestmat to 1 and recompile</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    itestmat = 0</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span> (itestmat /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keyword">open</span>(99,file=<span class="stringliteral">&#39;sol_MF6.TXT&#39;</span>)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="keyword">WRITE</span>(99,*) <span class="stringliteral">&#39;MATRIX SOLUTION FOLLOWS&#39;</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keyword">WRITE</span>(99,<span class="stringliteral">&#39;(10(I8,G15.4))&#39;</span>)  (n, this%x(n), n = 1, this%NEQ)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keyword">close</span>(99)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keyword">call </span>stop_with_error()</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">!    </span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">! -- check convergence of solution</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keyword">call </span>this%sln_outer_check(this%hncg(kiter), this%lrch(1,kiter))</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">if</span> (this%icnvg /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      this%icnvg = 0</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">if</span> (abs(this%hncg(kiter)) &lt;= this%dvclose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        this%icnvg = 1</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="comment">! -- set failure flag</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">if</span> (this%icnvg == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      cmsg = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      cmsg = <span class="stringliteral">&#39;*&#39;</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">! -- set flag if this is the last outer iteration</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    iend = 0</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keywordflow">if</span> (kiter == this%mxiter) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      iend = 1</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">! -- Additional convergence check for pseudo-transient continuation</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">!    term. Evaluate if the ptc value added to the diagonal has</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">!    decayed sufficiently.</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">if</span> (iptc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordflow">if</span> (this%icnvg /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <span class="keywordflow">if</span> (this%ptcrat &gt; this%ptcthresh) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          this%icnvg = 0</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          cmsg = trim(cmsg) // <span class="stringliteral">&#39;PTC&#39;</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;          <span class="keywordflow">if</span> (iend /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keyword">write</span>(line, <span class="stringliteral">&#39;(a)&#39;</span>)                                                   &amp;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;              <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION CAUSED CONVERGENCE FAILURE&#39;</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            <span class="keyword">call </span>sim_message(line)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">! -- write maximum dependent-variable change from linear solver to list file</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      cval = <span class="stringliteral">&#39;Model&#39;</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keyword">call </span>this%sln_get_loc(this%lrch(1,kiter), strh)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="comment">! -- add data to outertab</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(cval)</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(kiter)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(iter)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(this%hncg(kiter))</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(cmsg)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keyword">call </span>this%outertab%add_term(trim(strh))</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="comment">! -- Additional convergence check for exchanges</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">do</span> ic=1,this%exchangelist%Count()</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      cp =&gt; getnumericalexchangefromlist(this%exchangelist, ic)</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="keyword">call </span>cp%exg_cc(this%icnvg)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">! -- additional convergence check for model packages</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    icnvgmod = this%icnvg</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    cpak = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    ipak = 0</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    dpak = dzero</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">do</span> im = 1, this%modellist%Count()</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keyword">call </span>mp%get_mcellid(0, cmod)</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keyword">call </span>mp%model_cc(this%itertot_sim, kiter, iend, icnvgmod,                  &amp;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                       cpak, ipak, dpak)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordflow">if</span> (ipak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        ipos0 = index(cpak, <span class="stringliteral">&#39;-&#39;</span>, back=.true.)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        ipos1 = len_trim(cpak)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keyword">write</span>(cpakout, <span class="stringliteral">&#39;(a,a,&quot;-(&quot;,i0,&quot;)&quot;,a)&#39;</span>)                                    &amp;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;          trim(cmod), cpak(1:ipos0-1), ipak, cpak(ipos0:ipos1) </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        cpakout = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="comment">! -- evaluate package convergence</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">if</span> (abs(dpak) &gt; this%dvclose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      this%icnvg = 0</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="comment">! -- write message to stdout</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">if</span> (iend /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="keyword">write</span>(line, <span class="stringliteral">&#39;(3a)&#39;</span>)                                                       &amp;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;          <span class="stringliteral">&#39;PACKAGE (&#39;</span>, trim(cpakout), <span class="stringliteral">&#39;) CAUSED CONVERGENCE FAILURE&#39;</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="keyword">call </span>sim_message(line)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">! -- write maximum change in package convergence check</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      cval = <span class="stringliteral">&#39;Package&#39;</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">if</span> (this%icnvg /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        cmsg = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        cmsg = <span class="stringliteral">&#39;*&#39;</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">if</span> (len_trim(cpakout) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="comment">! -- add data to outertab</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(cval)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(kiter)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;          <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;          <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;          <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;          <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(dpak)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(cmsg)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keyword">call </span>this%outertab%add_term(cpakout)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">! -- under-relaxation - only done if convergence not achieved</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">if</span> (this%icnvg /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="keywordflow">if</span> (this%nonmeth &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="keyword">call </span>this%sln_underrelax(kiter, this%hncg(kiter), this%neq,              &amp;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                 this%active, this%x, this%xtemp)</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keyword">call </span>this%sln_calcdx(this%neq, this%active,                              &amp;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                              this%x, this%xtemp, this%dxold)</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="comment">! -- adjust heads by newton under-relaxation, if necessary</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      inewtonur = 0</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      dxmax_nur = dzero</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      locmax_nur = 0</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        i0 = mp%moffset + 1</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        i1 = i0 + mp%neq - 1</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <span class="keyword">call </span>mp%model_nur(mp%neq, this%x(i0:i1), this%xtemp(i0:i1),              &amp;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                          this%dxold(i0:i1), inewtonur, dxmax_nur, locmax_nur)</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      <span class="comment">! -- check for convergence if newton under-relaxation applied</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keywordflow">if</span> (inewtonur /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="comment">! -- calculate maximum change in heads in cells that have</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="comment">!    not been adjusted by newton under-relxation</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="keyword">call </span>this%sln_maxval(this%neq, this%dxold, dxmax)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="comment">! -- evaluate convergence</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="keywordflow">if</span> (abs(dxmax) &lt;= this%dvclose .and.                                     &amp;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            abs(this%hncg(kiter)) &lt;= this%dvclose .and.                          &amp;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            abs(dpak) &lt;= this%dvclose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          this%icnvg = 1</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;          <span class="comment">! -- reset outer dependent-variable change and location for output</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;          <span class="keyword">call </span>this%sln_outer_check(this%hncg(kiter), this%lrch(1,kiter))</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          <span class="comment">! -- write revised dependent-variable change data after </span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;          <span class="comment">!    newton under-relaxation</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;          <span class="keywordflow">if</span> (this%iprims &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            cval = <span class="stringliteral">&#39;Newton under-relaxation&#39;</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            cmsg = <span class="stringliteral">&#39;*&#39;</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            <span class="keyword">call </span>this%sln_get_loc(this%lrch(1,kiter), strh)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="comment">! -- add data to outertab</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            <span class="keyword">call </span>this%outertab%add_term(cval)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <span class="keyword">call </span>this%outertab%add_term(kiter)</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <span class="keyword">call </span>this%outertab%add_term(iter)</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            <span class="keywordflow">if</span> (this%numtrack &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;              <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;              <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;              <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;              <span class="keyword">call </span>this%outertab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            <span class="keyword">call </span>this%outertab%add_term(this%hncg(kiter))</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="keyword">call </span>this%outertab%add_term(cmsg)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="keyword">call </span>this%outertab%add_term(trim(strh))</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">! -- write to outer iteration csv file</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">if</span> (this%icsvouterout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="comment">! -- set outer dependent-variable change variable</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      outer_hncg = this%hncg(kiter)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="comment">! -- model convergence error </span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordflow">if</span> (abs(outer_hncg) &gt; abs(dpak)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="comment">! -- get model number and user node number</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keyword">call </span>this%sln_get_nodeu(this%lrch(1,kiter), im, nodeu)</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        cpakout = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <span class="comment">! -- package convergence error</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="comment">! -- set convergence error, model number, user node number,</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="comment">!    and package name</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        outer_hncg = dpak</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        ipos0 = index(cmod, <span class="stringliteral">&#39;_&#39;</span>)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keyword">read</span>(cmod(1:ipos0-1), *) im</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        nodeu = ipak</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        ipos0 = index(cpak, <span class="stringliteral">&#39;-&#39;</span>, back=.true.)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        cpakout = cpak(1:ipos0-1)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="comment">! -- write line to outer iteration csv file</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keyword">write</span>(this%icsvouterout, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>)                                  &amp;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          this%itertot_sim, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, kiter, iter,                      &amp;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;          outer_hncg, im, trim(cpakout), nodeu</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">! -- write to inner iteration csv file</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">if</span> (this%icsvinnerout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keyword">call </span>this%csv_convergence_summary(this%icsvinnerout, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>,    &amp;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                                        kiter, iter, icsv0, kcsv0)</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a964262851ef62c07577f4b3bbf384e15_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a964262851ef62c07577f4b3bbf384e15_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a964262851ef62c07577f4b3bbf384e15_cgraph" id="namespacenumericalsolutionmodule_a964262851ef62c07577f4b3bbf384e15_cgraph">
<area shape="rect" title="@ brief Build and solve the simulation" alt="" coords="5,155,193,197"/>
<area shape="rect" href="namespacetimermodule.html#a38a274d978e44672bdb28134abec206a" title=" " alt="" coords="263,5,450,32"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#a09ae423b40a16a7841cbb95815029b0f" title=" " alt="" coords="241,57,472,98"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="253,122,461,163"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="273,187,441,229"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="273,253,441,294"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="275,319,439,345"/>
<area shape="rect" href="namespacenumericalexchangemodule.html#ab1fef9adb89cbcfb556286fba47b988b" title=" " alt="" coords="520,57,753,98"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="531,122,742,163"/>
</map>
</div>

</div>
</div>
<a id="a45a269ecfdf5d4ba92cb06b49f83c93e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a269ecfdf5d4ba92cb06b49f83c93e">&#9670;&nbsp;</a></span>writecsvheader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::writecsvheader </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write header for solver output to comma-separated value files. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01283">1283</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment">  !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">! local variables</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: im</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">! -- outer iteration csv header</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">if</span> (this%icsvouterout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keyword">write</span>(this%icsvouterout, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>)                              &amp;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="stringliteral">&#39;total_inner_iterations&#39;</span>, <span class="stringliteral">&#39;totim&#39;</span>, <span class="stringliteral">&#39;kper&#39;</span>, <span class="stringliteral">&#39;kstp&#39;</span>, <span class="stringliteral">&#39;nouter&#39;</span>,         &amp;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="stringliteral">&#39;inner_iterations&#39;</span>, <span class="stringliteral">&#39;solution_outer_dvmax&#39;</span>,                          &amp;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="stringliteral">&#39;solution_outer_dvmax_model&#39;</span>, <span class="stringliteral">&#39;solution_outer_dvmax_package&#39;</span>,        &amp;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="stringliteral">&#39;solution_outer_dvmax_node&#39;</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="comment">! -- inner iteration csv header</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (this%icsvinnerout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keyword">write</span>(this%icsvinnerout, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>)                &amp;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="stringliteral">&#39;total_inner_iterations&#39;</span>, <span class="stringliteral">&#39;totim&#39;</span>, <span class="stringliteral">&#39;kper&#39;</span>, <span class="stringliteral">&#39;kstp&#39;</span>, <span class="stringliteral">&#39;nouter&#39;</span>,         &amp;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="stringliteral">&#39;ninner&#39;</span>, <span class="stringliteral">&#39;solution_inner_dvmax&#39;</span>, <span class="stringliteral">&#39;solution_inner_dvmax_model&#39;</span>,      &amp;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="stringliteral">&#39;solution_inner_dvmax_node&#39;</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keyword">write</span>(this%icsvinnerout, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>)              &amp;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;solution_inner_drmax&#39;</span>, <span class="stringliteral">&#39;solution_inner_drmax_model&#39;</span>,          &amp;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="stringliteral">&#39;solution_inner_drmax_node&#39;</span>, <span class="stringliteral">&#39;solution_inner_alpha&#39;</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">if</span> (this%imslinear%ilinmeth == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keyword">write</span>(this%icsvinnerout, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>)            &amp;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;solution_inner_omega&#39;</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="comment">! -- check for more than one model</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">if</span> (this%convnmod &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">do</span> im=1,this%modellist%Count()</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;          mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          <span class="keyword">write</span>(this%icsvinnerout, <span class="stringliteral">&#39;(*(G0,:,&quot;,&quot;))&#39;</span>, advance=<span class="stringliteral">&#39;NO&#39;</span>)          &amp;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="stringliteral">&#39;&#39;</span>, trim(adjustl(mp%name)) // <span class="stringliteral">&#39;_inner_dvmax&#39;</span>,                  &amp;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            trim(adjustl(mp%name)) // <span class="stringliteral">&#39;_inner_dvmax_node&#39;</span>,                 &amp;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            trim(adjustl(mp%name)) // <span class="stringliteral">&#39;_inner_drmax&#39;</span>,                      &amp;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            trim(adjustl(mp%name)) // <span class="stringliteral">&#39;_inner_drmax_node&#39;</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keyword">write</span>(this%icsvinnerout,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_a45a269ecfdf5d4ba92cb06b49f83c93e_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_a45a269ecfdf5d4ba92cb06b49f83c93e_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_a45a269ecfdf5d4ba92cb06b49f83c93e_cgraph" id="namespacenumericalsolutionmodule_a45a269ecfdf5d4ba92cb06b49f83c93e_cgraph">
<area shape="rect" title="@ brief CSV header" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
<a id="ae96796cf48dfa4040e98467780719861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96796cf48dfa4040e98467780719861">&#9670;&nbsp;</a></span>writeptcinfotofile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine numericalsolutionmodule::writeptcinfotofile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write header for pseudo-transient continuation information to a file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>NumericalSolutionType instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kper</td><td>current stress period number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_numerical_solution_8f90_source.html#l01334">1334</a> of file <a class="el" href="_numerical_solution_8f90_source.html">NumericalSolution.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType) :: this<span class="comment"> !&lt; NumericalSolutionType instance</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper<span class="comment">     !&lt; current stress period number</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="comment">! -- local variable</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, im, iallowptc, iptc</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: mp =&gt; null()</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="comment">! -- determine if PTC will be used in any model</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    n = 1</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordflow">do</span> im = 1, this%modellist%Count()</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      mp =&gt; <a class="code" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">getnumericalmodelfromlist</a>(this%modellist, im)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keyword">call </span>mp%model_ptcchk(iptc)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="comment">! -- set iallowptc</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="comment">! -- no_ptc_option is FIRST</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="keywordflow">if</span> (this%iallowptc &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          iallowptc = 1</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          iallowptc = 0</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="comment">! -- no_ptc_option is ALL (0) or using PTC (1)</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        iallowptc = this%iallowptc</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      iptc = iptc * iallowptc</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keywordflow">if</span> (iptc /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">if</span> (n == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, <span class="stringliteral">&#39;(//)&#39;</span>)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;          n = 0</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keyword">write</span>(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, <span class="stringliteral">&#39;(1x,a,1x,i0,1x,3a)&#39;</span>)                                           &amp;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          <span class="stringliteral">&#39;PSEUDO-TRANSIENT CONTINUATION WILL BE APPLIED TO MODEL&#39;</span>, im, <span class="stringliteral">&#39;(&quot;&#39;</span>,        &amp;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;          trim(adjustl(mp%name)), <span class="stringliteral">&#39;&quot;) DURING THIS TIME STEP&#39;</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenumericalsolutionmodule_ae96796cf48dfa4040e98467780719861_cgraph.png" border="0" usemap="#namespacenumericalsolutionmodule_ae96796cf48dfa4040e98467780719861_cgraph" alt=""/></div>
<map name="namespacenumericalsolutionmodule_ae96796cf48dfa4040e98467780719861_cgraph" id="namespacenumericalsolutionmodule_ae96796cf48dfa4040e98467780719861_cgraph">
<area shape="rect" title="@ brief PTC header" alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d" title=" " alt="" coords="241,5,449,47"/>
<area shape="rect" href="namespacenumericalmodelmodule.html#a8bf90d83eebb9a967b5ad13d395d4c85" title=" " alt="" coords="497,5,708,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacenumericalmodelmodule_html_a4d031f0a98348529066eef37676f018d"><div class="ttname"><a href="namespacenumericalmodelmodule.html#a4d031f0a98348529066eef37676f018d">numericalmodelmodule::getnumericalmodelfromlist</a></div><div class="ttdeci">class(numericalmodeltype) function, pointer, public getnumericalmodelfromlist(list, idx)</div><div class="ttdef"><b>Definition:</b> <a href="_numerical_model_8f90_source.html#l00433">NumericalModel.f90:433</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__reallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__reallocate.html">memorymanagermodule::mem_reallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00064">MemoryManager.f90:64</a></div></div>
<div class="ttc" id="astructnumericalsolutionmodule_1_1numericalsolutiontype_html"><div class="ttname"><a href="structnumericalsolutionmodule_1_1numericalsolutiontype.html">numericalsolutionmodule::numericalsolutiontype</a></div><div class="ttdef"><b>Definition:</b> <a href="_numerical_solution_8f90_source.html#l00040">NumericalSolution.f90:40</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_af78a42d4fd58cef4835c0bbd973ccf59"><div class="ttname"><a href="namespaceconstantsmodule.html#af78a42d4fd58cef4835c0bbd973ccf59">constantsmodule::dthree</a></div><div class="ttdeci">real(dp), parameter dthree</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00060">Constants.f90:60</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00045">Constants.f90:45</a></div></div>
<div class="ttc" id="anamespaceadaptivetimestepmodule_html"><div class="ttname"><a href="namespaceadaptivetimestepmodule.html">adaptivetimestepmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="ats_8f90_source.html#l00005">ats.f90:5</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a536cb6f0e13fcd33755e414641ff931a"><div class="ttname"><a href="namespacesimmodule.html#a536cb6f0e13fcd33755e414641ff931a">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg)</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00107">Sim.f90:107</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a4c46e49de78d4498dd4ec106357775e6"><div class="ttname"><a href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">simmodule::count_errors</a></div><div class="ttdeci">integer(i4b) function, public count_errors()</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00043">Sim.f90:43</a></div></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00001">Sim.f90:1</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_adc3d56c06695509e95078d706508e83f"><div class="ttname"><a href="namespaceconstantsmodule.html#adc3d56c06695509e95078d706508e83f">constantsmodule::dtwo</a></div><div class="ttdeci">real(dp), parameter dtwo</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00059">Constants.f90:59</a></div></div>
<div class="ttc" id="anamespaceadaptivetimestepmodule_html_ad192ff605722888a8838928df3598375"><div class="ttname"><a href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375">adaptivetimestepmodule::ats_submit_delt</a></div><div class="ttdeci">subroutine, public ats_submit_delt(kstp, kper, dt, sloc, idir)</div><div class="ttdoc">@ brief Allow and external caller to submit preferred time step</div><div class="ttdef"><b>Definition:</b> <a href="ats_8f90_source.html#l00524">ats.f90:524</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_a3791dbc2d4a06a0b9112158cff21f738"><div class="ttname"><a href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:21</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a0be97214c1d4fcf42bc4ddc27b111b61"><div class="ttname"><a href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">simmodule::ustop</a></div><div class="ttdeci">subroutine, public ustop(stopmess, ioutlocal)</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00324">Sim.f90:324</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00208">InputOutput.f90:208</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_a5f22ad41ccf3be8d4bb899e8a1834ff4"><div class="ttname"><a href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">tdismodule::totim</a></div><div class="ttdeci">real(dp), pointer, public totim</div><div class="ttdoc">time relative to start of simulation</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00032">tdis.f90:32</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html"><div class="ttname"><a href="namespacesimvariablesmodule.html">simvariablesmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00001">SimVariables.f90:1</a></div></div>
<div class="ttc" id="anamespacenumericalsolutionmodule_html_aefead85b912cfb79e860d6fe3cb2069c"><div class="ttname"><a href="namespacenumericalsolutionmodule.html#aefead85b912cfb79e860d6fe3cb2069c">numericalsolutionmodule::castasnumericalsolutionclass</a></div><div class="ttdeci">class(numericalsolutiontype) function, pointer castasnumericalsolutionclass(obj)</div><div class="ttdoc">@ brief Cast a object as a Numerical Solution</div><div class="ttdef"><b>Definition:</b> <a href="_numerical_solution_8f90_source.html#l03135">NumericalSolution.f90:3135</a></div></div>
<div class="ttc" id="anamespaceversionmodule_html_ab82d1ea64df56737f03bbbe06c1499bd"><div class="ttname"><a href="namespaceversionmodule.html#ab82d1ea64df56737f03bbbe06c1499bd">versionmodule::idevelopmode</a></div><div class="ttdeci">integer(i4b), parameter idevelopmode</div><div class="ttdef"><b>Definition:</b> <a href="version_8f90_source.html#l00006">version.f90:6</a></div></div>
<div class="ttc" id="anamespacetablemodule_html_a7632d784ec9e94277a76705ef56725f2"><div class="ttname"><a href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">tablemodule::table_cr</a></div><div class="ttdeci">subroutine, public table_cr(this, name, title)</div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00084">Table.f90:84</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html_a70ea2f76b35a03119367efdd0dd88ccc"><div class="ttname"><a href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">simvariablesmodule::iout</a></div><div class="ttdeci">integer(i4b) iout</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00014">SimVariables.f90:14</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00001">Constants.f90:1</a></div></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a6c8d05246b2eddf358b9f81a147ebdd8"><div class="ttname"><a href="namespacesimmodule.html#a6c8d05246b2eddf358b9f81a147ebdd8">simmodule::deprecation_warning</a></div><div class="ttdeci">subroutine, public deprecation_warning(cblock, cvar, cver, endmsg, iunit)</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00249">Sim.f90:249</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae9a8dbe15bd2bcb8a85d53d570407ae6"><div class="ttname"><a href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">tdismodule::delt</a></div><div class="ttdeci">real(dp), pointer, public delt</div><div class="ttdoc">length of the current time step</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00030">tdis.f90:30</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00034">InputOutput.f90:34</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenumericalsolutionmodule.html">numericalsolutionmodule</a></li>
    <li class="footer">Generated on Fri Jun 11 2021 22:03:09 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
