<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: sfrmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacesfrmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sfrmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the SFR package methods.  
<a href="namespacesfrmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a64718b1d9b7025a4763ed4e29ce34578"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a64718b1d9b7025a4763ed4e29ce34578">sfr_create</a> (packobj, id, ibcnum, inunit, iout, namemodel, pakname)</td></tr>
<tr class="memdesc:a64718b1d9b7025a4763ed4e29ce34578"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new package object  <a href="namespacesfrmodule.html#a64718b1d9b7025a4763ed4e29ce34578">More...</a><br /></td></tr>
<tr class="separator:a64718b1d9b7025a4763ed4e29ce34578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb4a7f609b36b1437fcee3f4ab3b85be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#acb4a7f609b36b1437fcee3f4ab3b85be">sfr_allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:acb4a7f609b36b1437fcee3f4ab3b85be"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespacesfrmodule.html#acb4a7f609b36b1437fcee3f4ab3b85be">More...</a><br /></td></tr>
<tr class="separator:acb4a7f609b36b1437fcee3f4ab3b85be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78f2dc5ccc3d0f9dc00393fc6c82cd38"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a78f2dc5ccc3d0f9dc00393fc6c82cd38">sfr_allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:a78f2dc5ccc3d0f9dc00393fc6c82cd38"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays  <a href="namespacesfrmodule.html#a78f2dc5ccc3d0f9dc00393fc6c82cd38">More...</a><br /></td></tr>
<tr class="separator:a78f2dc5ccc3d0f9dc00393fc6c82cd38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad513a31368de41f3044a63ab67e1df2f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ad513a31368de41f3044a63ab67e1df2f">sfr_read_dimensions</a> (this)</td></tr>
<tr class="memdesc:ad513a31368de41f3044a63ab67e1df2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read dimensions for package  <a href="namespacesfrmodule.html#ad513a31368de41f3044a63ab67e1df2f">More...</a><br /></td></tr>
<tr class="separator:ad513a31368de41f3044a63ab67e1df2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba3494107dd3b9909fc6dcefb4468e9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a6ba3494107dd3b9909fc6dcefb4468e9">sfr_options</a> (this, option, found)</td></tr>
<tr class="memdesc:a6ba3494107dd3b9909fc6dcefb4468e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read additional options for package  <a href="namespacesfrmodule.html#a6ba3494107dd3b9909fc6dcefb4468e9">More...</a><br /></td></tr>
<tr class="separator:a6ba3494107dd3b9909fc6dcefb4468e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89376a2749bd62ff96179c10284f840c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a89376a2749bd62ff96179c10284f840c">sfr_ar</a> (this)</td></tr>
<tr class="memdesc:a89376a2749bd62ff96179c10284f840c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read method for package  <a href="namespacesfrmodule.html#a89376a2749bd62ff96179c10284f840c">More...</a><br /></td></tr>
<tr class="separator:a89376a2749bd62ff96179c10284f840c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4bc981e816db62637f0ec03dd07b17"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a9a4bc981e816db62637f0ec03dd07b17">sfr_read_packagedata</a> (this)</td></tr>
<tr class="memdesc:a9a4bc981e816db62637f0ec03dd07b17"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read packagedata for the package  <a href="namespacesfrmodule.html#a9a4bc981e816db62637f0ec03dd07b17">More...</a><br /></td></tr>
<tr class="separator:a9a4bc981e816db62637f0ec03dd07b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad915fc4ef5fcef0cfd2525617de6c63b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ad915fc4ef5fcef0cfd2525617de6c63b">sfr_read_crossection</a> (this)</td></tr>
<tr class="memdesc:ad915fc4ef5fcef0cfd2525617de6c63b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read crosssection block for the package  <a href="namespacesfrmodule.html#ad915fc4ef5fcef0cfd2525617de6c63b">More...</a><br /></td></tr>
<tr class="separator:ad915fc4ef5fcef0cfd2525617de6c63b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e43e3ecbd62de751259b7395031c72"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a44e43e3ecbd62de751259b7395031c72">sfr_read_connectiondata</a> (this)</td></tr>
<tr class="memdesc:a44e43e3ecbd62de751259b7395031c72"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read connectiondata for the package  <a href="namespacesfrmodule.html#a44e43e3ecbd62de751259b7395031c72">More...</a><br /></td></tr>
<tr class="separator:a44e43e3ecbd62de751259b7395031c72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305f842f1a320a487511a19262ab3420"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a305f842f1a320a487511a19262ab3420">sfr_read_diversions</a> (this)</td></tr>
<tr class="memdesc:a305f842f1a320a487511a19262ab3420"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read diversions for the package  <a href="namespacesfrmodule.html#a305f842f1a320a487511a19262ab3420">More...</a><br /></td></tr>
<tr class="separator:a305f842f1a320a487511a19262ab3420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8384c7cbe28ad9a362df94f26295481c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a8384c7cbe28ad9a362df94f26295481c">sfr_rp</a> (this)</td></tr>
<tr class="memdesc:a8384c7cbe28ad9a362df94f26295481c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read and prepare period data for package  <a href="namespacesfrmodule.html#a8384c7cbe28ad9a362df94f26295481c">More...</a><br /></td></tr>
<tr class="separator:a8384c7cbe28ad9a362df94f26295481c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc05ae3a236bf4c4a4884bfe51a3d1fe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#afc05ae3a236bf4c4a4884bfe51a3d1fe">sfr_ad</a> (this)</td></tr>
<tr class="memdesc:afc05ae3a236bf4c4a4884bfe51a3d1fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance the package  <a href="namespacesfrmodule.html#afc05ae3a236bf4c4a4884bfe51a3d1fe">More...</a><br /></td></tr>
<tr class="separator:afc05ae3a236bf4c4a4884bfe51a3d1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e647aebe799daa24b7fc145a1f425d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a9e647aebe799daa24b7fc145a1f425d9">sfr_cf</a> (this, reset_mover)</td></tr>
<tr class="memdesc:a9e647aebe799daa24b7fc145a1f425d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate the package hcof and rhs terms.  <a href="namespacesfrmodule.html#a9e647aebe799daa24b7fc145a1f425d9">More...</a><br /></td></tr>
<tr class="separator:a9e647aebe799daa24b7fc145a1f425d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad15971981bf4723e1f9b2af0280fa884"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ad15971981bf4723e1f9b2af0280fa884">sfr_fc</a> (this, rhs, ia, idxglo, amatsln)</td></tr>
<tr class="memdesc:ad15971981bf4723e1f9b2af0280fa884"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Copy hcof and rhs terms into solution.  <a href="namespacesfrmodule.html#ad15971981bf4723e1f9b2af0280fa884">More...</a><br /></td></tr>
<tr class="separator:ad15971981bf4723e1f9b2af0280fa884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec5f1ca9cd19982426b70000c431141"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#afec5f1ca9cd19982426b70000c431141">sfr_fn</a> (this, rhs, ia, idxglo, amatsln)</td></tr>
<tr class="memdesc:afec5f1ca9cd19982426b70000c431141"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add Newton-Raphson terms for package into solution.  <a href="namespacesfrmodule.html#afec5f1ca9cd19982426b70000c431141">More...</a><br /></td></tr>
<tr class="separator:afec5f1ca9cd19982426b70000c431141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19fcebfb4dc1f317beaf82d9bf5af7a4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a19fcebfb4dc1f317beaf82d9bf5af7a4">sfr_cc</a> (this, innertot, kiter, iend, icnvgmod, cpak, ipak, dpak)</td></tr>
<tr class="memdesc:a19fcebfb4dc1f317beaf82d9bf5af7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Convergence check for package.  <a href="namespacesfrmodule.html#a19fcebfb4dc1f317beaf82d9bf5af7a4">More...</a><br /></td></tr>
<tr class="separator:a19fcebfb4dc1f317beaf82d9bf5af7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cecc4054c571877f6b14d2beaab7356"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a1cecc4054c571877f6b14d2beaab7356">sfr_cq</a> (this, x, flowja, iadv)</td></tr>
<tr class="memdesc:a1cecc4054c571877f6b14d2beaab7356"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate package flows.  <a href="namespacesfrmodule.html#a1cecc4054c571877f6b14d2beaab7356">More...</a><br /></td></tr>
<tr class="separator:a1cecc4054c571877f6b14d2beaab7356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b0ec222b7529d8ff451c39732978ce"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a23b0ec222b7529d8ff451c39732978ce">sfr_ot_package_flows</a> (this, icbcfl, ibudfl)</td></tr>
<tr class="memdesc:a23b0ec222b7529d8ff451c39732978ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output package flow terms.  <a href="namespacesfrmodule.html#a23b0ec222b7529d8ff451c39732978ce">More...</a><br /></td></tr>
<tr class="separator:a23b0ec222b7529d8ff451c39732978ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506c1fd74d4c4c8a1965b9b50d7d4205"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a506c1fd74d4c4c8a1965b9b50d7d4205">sfr_ot_dv</a> (this, idvsave, idvprint)</td></tr>
<tr class="memdesc:a506c1fd74d4c4c8a1965b9b50d7d4205"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output package dependent-variable terms.  <a href="namespacesfrmodule.html#a506c1fd74d4c4c8a1965b9b50d7d4205">More...</a><br /></td></tr>
<tr class="separator:a506c1fd74d4c4c8a1965b9b50d7d4205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae824e3dd1ae4113f3313e79316bf4b8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#aae824e3dd1ae4113f3313e79316bf4b8">sfr_ot_bdsummary</a> (this, kstp, kper, iout, ibudfl)</td></tr>
<tr class="memdesc:aae824e3dd1ae4113f3313e79316bf4b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output advanced package budget summary.  <a href="namespacesfrmodule.html#aae824e3dd1ae4113f3313e79316bf4b8">More...</a><br /></td></tr>
<tr class="separator:aae824e3dd1ae4113f3313e79316bf4b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df712db96a8dca145df5d98736db677"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a2df712db96a8dca145df5d98736db677">sfr_da</a> (this)</td></tr>
<tr class="memdesc:a2df712db96a8dca145df5d98736db677"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate package memory  <a href="namespacesfrmodule.html#a2df712db96a8dca145df5d98736db677">More...</a><br /></td></tr>
<tr class="separator:a2df712db96a8dca145df5d98736db677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69bccbdc4a96b0df4b0c32d08ccbe35b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a69bccbdc4a96b0df4b0c32d08ccbe35b">define_listlabel</a> (this)</td></tr>
<tr class="memdesc:a69bccbdc4a96b0df4b0c32d08ccbe35b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define the list label for the package  <a href="namespacesfrmodule.html#a69bccbdc4a96b0df4b0c32d08ccbe35b">More...</a><br /></td></tr>
<tr class="separator:a69bccbdc4a96b0df4b0c32d08ccbe35b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9d59e830cf2a82a2b2d09bd094b418"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#acd9d59e830cf2a82a2b2d09bd094b418">sfr_obs_supported</a> (this)</td></tr>
<tr class="memdesc:acd9d59e830cf2a82a2b2d09bd094b418"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if observations are supported.  <a href="namespacesfrmodule.html#acd9d59e830cf2a82a2b2d09bd094b418">More...</a><br /></td></tr>
<tr class="separator:acd9d59e830cf2a82a2b2d09bd094b418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2744b945481221fbaaf48acabd8186"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a6a2744b945481221fbaaf48acabd8186">sfr_df_obs</a> (this)</td></tr>
<tr class="memdesc:a6a2744b945481221fbaaf48acabd8186"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the observation types available in the package.  <a href="namespacesfrmodule.html#a6a2744b945481221fbaaf48acabd8186">More...</a><br /></td></tr>
<tr class="separator:a6a2744b945481221fbaaf48acabd8186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a985422530d8f633587ef61d5faa1cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a7a985422530d8f633587ef61d5faa1cd">sfr_bd_obs</a> (this)</td></tr>
<tr class="memdesc:a7a985422530d8f633587ef61d5faa1cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save observations for the package.  <a href="namespacesfrmodule.html#a7a985422530d8f633587ef61d5faa1cd">More...</a><br /></td></tr>
<tr class="separator:a7a985422530d8f633587ef61d5faa1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f92e161b51b34427f1b12cfbb79815"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ad9f92e161b51b34427f1b12cfbb79815">sfr_rp_obs</a> (this)</td></tr>
<tr class="memdesc:ad9f92e161b51b34427f1b12cfbb79815"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and prepare observations for a package.  <a href="namespacesfrmodule.html#ad9f92e161b51b34427f1b12cfbb79815">More...</a><br /></td></tr>
<tr class="separator:ad9f92e161b51b34427f1b12cfbb79815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685d2a55b16bd60a12a2aaedbea9d620"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a685d2a55b16bd60a12a2aaedbea9d620">sfr_process_obsid</a> (obsrv, dis, inunitobs, iout)</td></tr>
<tr class="memdesc:a685d2a55b16bd60a12a2aaedbea9d620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process observation IDs for a package.  <a href="namespacesfrmodule.html#a685d2a55b16bd60a12a2aaedbea9d620">More...</a><br /></td></tr>
<tr class="separator:a685d2a55b16bd60a12a2aaedbea9d620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be68d7b3767ac5f38ca10a65cc9b9ea"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a4be68d7b3767ac5f38ca10a65cc9b9ea">sfr_set_stressperiod</a> (this, n, ichkustrm, crossfile)</td></tr>
<tr class="memdesc:a4be68d7b3767ac5f38ca10a65cc9b9ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set period data.  <a href="namespacesfrmodule.html#a4be68d7b3767ac5f38ca10a65cc9b9ea">More...</a><br /></td></tr>
<tr class="separator:a4be68d7b3767ac5f38ca10a65cc9b9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4744f90a4cc1281e6536c5068d1c7a4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ad4744f90a4cc1281e6536c5068d1c7a4">sfr_solve</a> (this, n, h, hcof, rhs, update)</td></tr>
<tr class="memdesc:ad4744f90a4cc1281e6536c5068d1c7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve reach continuity equation.  <a href="namespacesfrmodule.html#ad4744f90a4cc1281e6536c5068d1c7a4">More...</a><br /></td></tr>
<tr class="separator:ad4744f90a4cc1281e6536c5068d1c7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bfa2634514f23a92277fc718952915b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a9bfa2634514f23a92277fc718952915b">sfr_update_flows</a> (this, n, qd, qgwf)</td></tr>
<tr class="memdesc:a9bfa2634514f23a92277fc718952915b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update flow terms.  <a href="namespacesfrmodule.html#a9bfa2634514f23a92277fc718952915b">More...</a><br /></td></tr>
<tr class="separator:a9bfa2634514f23a92277fc718952915b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f26e22eac11fe58a67d375cf2bb9b25"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a9f26e22eac11fe58a67d375cf2bb9b25">sfr_calc_qd</a> (this, n, depth, hgwf, qgwf, qd)</td></tr>
<tr class="memdesc:a9f26e22eac11fe58a67d375cf2bb9b25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate downstream flow term.  <a href="namespacesfrmodule.html#a9f26e22eac11fe58a67d375cf2bb9b25">More...</a><br /></td></tr>
<tr class="separator:a9f26e22eac11fe58a67d375cf2bb9b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf2c5c93011287606794460a53ee2c52"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#abf2c5c93011287606794460a53ee2c52">sfr_calc_qsource</a> (this, n, depth, qsrc)</td></tr>
<tr class="memdesc:abf2c5c93011287606794460a53ee2c52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate sum of sources.  <a href="namespacesfrmodule.html#abf2c5c93011287606794460a53ee2c52">More...</a><br /></td></tr>
<tr class="separator:abf2c5c93011287606794460a53ee2c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bea0c1a6342ebff08051f67b38cc64d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a8bea0c1a6342ebff08051f67b38cc64d">sfr_calc_qman</a> (this, n, depth, qman)</td></tr>
<tr class="memdesc:a8bea0c1a6342ebff08051f67b38cc64d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate streamflow.  <a href="namespacesfrmodule.html#a8bea0c1a6342ebff08051f67b38cc64d">More...</a><br /></td></tr>
<tr class="separator:a8bea0c1a6342ebff08051f67b38cc64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe126a78d9becdbf0327c4204b6075a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#aafe126a78d9becdbf0327c4204b6075a">sfr_calc_qgwf</a> (this, n, depth, hgwf, qgwf, gwfhcof, gwfrhs)</td></tr>
<tr class="memdesc:aafe126a78d9becdbf0327c4204b6075a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate reach-aquifer exchange.  <a href="namespacesfrmodule.html#aafe126a78d9becdbf0327c4204b6075a">More...</a><br /></td></tr>
<tr class="separator:aafe126a78d9becdbf0327c4204b6075a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187716af19623eca7c6cb5e6ac234d11"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a187716af19623eca7c6cb5e6ac234d11">sfr_calc_cond</a> (this, n, depth, cond)</td></tr>
<tr class="memdesc:a187716af19623eca7c6cb5e6ac234d11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate reach-aquifer conductance.  <a href="namespacesfrmodule.html#a187716af19623eca7c6cb5e6ac234d11">More...</a><br /></td></tr>
<tr class="separator:a187716af19623eca7c6cb5e6ac234d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafddc50496348f677e8f00ca1d2342cc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#aafddc50496348f677e8f00ca1d2342cc">sfr_calc_div</a> (this, n, i, qd, qdiv)</td></tr>
<tr class="memdesc:aafddc50496348f677e8f00ca1d2342cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate diversion flow.  <a href="namespacesfrmodule.html#aafddc50496348f677e8f00ca1d2342cc">More...</a><br /></td></tr>
<tr class="separator:aafddc50496348f677e8f00ca1d2342cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ab5e2cac3005b9e128cf1c528d3f59"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a30ab5e2cac3005b9e128cf1c528d3f59">sfr_calc_reach_depth</a> (this, n, q1, d1)</td></tr>
<tr class="memdesc:a30ab5e2cac3005b9e128cf1c528d3f59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the depth at the midpoint.  <a href="namespacesfrmodule.html#a30ab5e2cac3005b9e128cf1c528d3f59">More...</a><br /></td></tr>
<tr class="separator:a30ab5e2cac3005b9e128cf1c528d3f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08f5e33e5eb5e9b52aad706ed12196c7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a08f5e33e5eb5e9b52aad706ed12196c7">sfr_calc_npoint_depth</a> (this, n, qrch, d)</td></tr>
<tr class="memdesc:a08f5e33e5eb5e9b52aad706ed12196c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the depth at the midpoint of a n-point cross-section.  <a href="namespacesfrmodule.html#a08f5e33e5eb5e9b52aad706ed12196c7">More...</a><br /></td></tr>
<tr class="separator:a08f5e33e5eb5e9b52aad706ed12196c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982f769cc3bd67789b08e3823384cafd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a982f769cc3bd67789b08e3823384cafd">sfr_check_reaches</a> (this)</td></tr>
<tr class="memdesc:a982f769cc3bd67789b08e3823384cafd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check reach data.  <a href="namespacesfrmodule.html#a982f769cc3bd67789b08e3823384cafd">More...</a><br /></td></tr>
<tr class="separator:a982f769cc3bd67789b08e3823384cafd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72ae02795191b6875226f19aebd056ad"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a72ae02795191b6875226f19aebd056ad">sfr_check_connections</a> (this)</td></tr>
<tr class="memdesc:a72ae02795191b6875226f19aebd056ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check connection data.  <a href="namespacesfrmodule.html#a72ae02795191b6875226f19aebd056ad">More...</a><br /></td></tr>
<tr class="separator:a72ae02795191b6875226f19aebd056ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d8c519f90b35fd498f1006b22267c2c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a4d8c519f90b35fd498f1006b22267c2c">sfr_check_diversions</a> (this)</td></tr>
<tr class="memdesc:a4d8c519f90b35fd498f1006b22267c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check diversions data.  <a href="namespacesfrmodule.html#a4d8c519f90b35fd498f1006b22267c2c">More...</a><br /></td></tr>
<tr class="separator:a4d8c519f90b35fd498f1006b22267c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341aafee87310288ad4e23da535d9a27"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a341aafee87310288ad4e23da535d9a27">sfr_check_ustrf</a> (this)</td></tr>
<tr class="memdesc:a341aafee87310288ad4e23da535d9a27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check upstream fraction data.  <a href="namespacesfrmodule.html#a341aafee87310288ad4e23da535d9a27">More...</a><br /></td></tr>
<tr class="separator:a341aafee87310288ad4e23da535d9a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa3402fe639ad226e2ade9195cc66b3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a7fa3402fe639ad226e2ade9195cc66b3">sfr_setup_budobj</a> (this)</td></tr>
<tr class="memdesc:a7fa3402fe639ad226e2ade9195cc66b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup budget object for package.  <a href="namespacesfrmodule.html#a7fa3402fe639ad226e2ade9195cc66b3">More...</a><br /></td></tr>
<tr class="separator:a7fa3402fe639ad226e2ade9195cc66b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b629c40e77f49df978c81616ec873c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#aa4b629c40e77f49df978c81616ec873c">sfr_fill_budobj</a> (this)</td></tr>
<tr class="memdesc:aa4b629c40e77f49df978c81616ec873c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy flow terms into budget object for package.  <a href="namespacesfrmodule.html#aa4b629c40e77f49df978c81616ec873c">More...</a><br /></td></tr>
<tr class="separator:aa4b629c40e77f49df978c81616ec873c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126527f0b5361bc25a93acfd502b01cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a126527f0b5361bc25a93acfd502b01cd">sfr_setup_tableobj</a> (this)</td></tr>
<tr class="memdesc:a126527f0b5361bc25a93acfd502b01cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup stage table object for package.  <a href="namespacesfrmodule.html#a126527f0b5361bc25a93acfd502b01cd">More...</a><br /></td></tr>
<tr class="separator:a126527f0b5361bc25a93acfd502b01cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d467292e7c1a65e3cbd3198393e2b4"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ad6d467292e7c1a65e3cbd3198393e2b4">calc_area_wet</a> (this, n, depth)</td></tr>
<tr class="memdesc:ad6d467292e7c1a65e3cbd3198393e2b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate wetted area.  <a href="namespacesfrmodule.html#ad6d467292e7c1a65e3cbd3198393e2b4">More...</a><br /></td></tr>
<tr class="separator:ad6d467292e7c1a65e3cbd3198393e2b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e5f0f033753a0b9c4d617f911e9628"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a98e5f0f033753a0b9c4d617f911e9628">calc_perimeter_wet</a> (this, n, depth)</td></tr>
<tr class="memdesc:a98e5f0f033753a0b9c4d617f911e9628"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate wetted perimeter.  <a href="namespacesfrmodule.html#a98e5f0f033753a0b9c4d617f911e9628">More...</a><br /></td></tr>
<tr class="separator:a98e5f0f033753a0b9c4d617f911e9628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3140f1fab77886b40ea39d7a45fd8e40"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a3140f1fab77886b40ea39d7a45fd8e40">calc_surface_area</a> (this, n)</td></tr>
<tr class="memdesc:a3140f1fab77886b40ea39d7a45fd8e40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate maximum surface area.  <a href="namespacesfrmodule.html#a3140f1fab77886b40ea39d7a45fd8e40">More...</a><br /></td></tr>
<tr class="separator:a3140f1fab77886b40ea39d7a45fd8e40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed9fa3204145944941a4e7ac8ed91750"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#aed9fa3204145944941a4e7ac8ed91750">calc_surface_area_wet</a> (this, n, depth)</td></tr>
<tr class="memdesc:aed9fa3204145944941a4e7ac8ed91750"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate wetted surface area.  <a href="namespacesfrmodule.html#aed9fa3204145944941a4e7ac8ed91750">More...</a><br /></td></tr>
<tr class="separator:aed9fa3204145944941a4e7ac8ed91750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1030f2f2e5de1cfaad1463b1b6cd4104"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a1030f2f2e5de1cfaad1463b1b6cd4104">calc_top_width_wet</a> (this, n, depth)</td></tr>
<tr class="memdesc:a1030f2f2e5de1cfaad1463b1b6cd4104"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate wetted top width.  <a href="namespacesfrmodule.html#a1030f2f2e5de1cfaad1463b1b6cd4104">More...</a><br /></td></tr>
<tr class="separator:a1030f2f2e5de1cfaad1463b1b6cd4104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada816d9da42d771a0b92682bfc82996c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ada816d9da42d771a0b92682bfc82996c">sfr_activate_density</a> (this)</td></tr>
<tr class="memdesc:ada816d9da42d771a0b92682bfc82996c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activate density terms.  <a href="namespacesfrmodule.html#ada816d9da42d771a0b92682bfc82996c">More...</a><br /></td></tr>
<tr class="separator:ada816d9da42d771a0b92682bfc82996c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560d50d24cedfb00dbd54443afd65a73"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#a560d50d24cedfb00dbd54443afd65a73">sfr_calculate_density_exchange</a> (this, n, stage, head, cond, bots, flow, gwfhcof, gwfrhs)</td></tr>
<tr class="memdesc:a560d50d24cedfb00dbd54443afd65a73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate density terms.  <a href="namespacesfrmodule.html#a560d50d24cedfb00dbd54443afd65a73">More...</a><br /></td></tr>
<tr class="separator:a560d50d24cedfb00dbd54443afd65a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab14c292fd351befba8b2ed33a9cb65dd"><td class="memItemLeft" align="right" valign="top">character(len=lenftype)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#ab14c292fd351befba8b2ed33a9cb65dd">ftype</a> = 'SFR'</td></tr>
<tr class="memdesc:ab14c292fd351befba8b2ed33a9cb65dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">package ftype string  <a href="namespacesfrmodule.html#ab14c292fd351befba8b2ed33a9cb65dd">More...</a><br /></td></tr>
<tr class="separator:ab14c292fd351befba8b2ed33a9cb65dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe1408ea8d05f91dcfac95cc8e579853"><td class="memItemLeft" align="right" valign="top">character(len=lenpackagename)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesfrmodule.html#abe1408ea8d05f91dcfac95cc8e579853">text</a> = ' SFR'</td></tr>
<tr class="memdesc:abe1408ea8d05f91dcfac95cc8e579853"><td class="mdescLeft">&#160;</td><td class="mdescRight">package budget string  <a href="namespacesfrmodule.html#abe1408ea8d05f91dcfac95cc8e579853">More...</a><br /></td></tr>
<tr class="separator:abe1408ea8d05f91dcfac95cc8e579853"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains the overridden methods for the streamflow routing (SFR) package. Most of the methods in the base Boundary Package are overridden. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ad6d467292e7c1a65e3cbd3198393e2b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d467292e7c1a65e3cbd3198393e2b4">&#9670;&nbsp;</a></span>calc_area_wet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function sfrmodule::calc_area_wet </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the wetted area for a SFR package reach. </p><dl class="section return"><dt>Returns</dt><dd>wetted area </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05198">5198</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;      <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;<span class="keywordtype">      real</span>(DP) :: calc_area_wet<span class="comment">       !&lt; wetted area</span></div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">          !&lt; SfrType object</span></div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">   !&lt; reach number</span></div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">   !&lt; reach depth</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: npts</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;      <span class="comment">! -- Calculate wetted area</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;      npts = this%ncrosspts(n)</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;      i0 = this%iacross(n)</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;      i1 = this%iacross(n + 1) - 1</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;      <span class="keywordflow">if</span> (npts &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;        calc_area_wet = <a class="code" href="namespacegwfsfrcrosssectionutilsmodule.html#acdfa709bd613cffad96ab7f6806ba7a7">get_cross_section_area</a>(npts, this%station(i0:i1)<span class="comment">, &amp;</span></div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;<span class="comment"></span>                                               this%xsdepths(i0:i1), depth<span class="comment">)</span></div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;<span class="comment"></span>      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;        calc_area_wet = this%station(i0) * depth</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_ad6d467292e7c1a65e3cbd3198393e2b4_cgraph.png" border="0" usemap="#namespacesfrmodule_ad6d467292e7c1a65e3cbd3198393e2b4_cgraph" alt=""/></div>
<map name="namespacesfrmodule_ad6d467292e7c1a65e3cbd3198393e2b4_cgraph" id="namespacesfrmodule_ad6d467292e7c1a65e3cbd3198393e2b4_cgraph">
<area shape="rect" title="Calculate wetted area." alt="" coords="5,13,195,39"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#acdfa709bd613cffad96ab7f6806ba7a7" title="Calculate the cross&#45;sectional area for a reach." alt="" coords="243,5,464,47"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#a12e8455b0ffc208658d1e6091d8c647e" title="Calculate the cross&#45;sectional areas for each line segment." alt="" coords="512,5,733,47"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#a37e8faa52bc7cf1544c73b24f45a3de0" title="Calculate the station values for the wetted portion of the cross&#45;section." alt="" coords="781,5,1003,47"/>
</map>
</div>

</div>
</div>
<a id="a98e5f0f033753a0b9c4d617f911e9628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98e5f0f033753a0b9c4d617f911e9628">&#9670;&nbsp;</a></span>calc_perimeter_wet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function sfrmodule::calc_perimeter_wet </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the wetted perimeter for a SFR package reach. </p><dl class="section return"><dt>Returns</dt><dd>wetted perimeter </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05231">5231</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;      <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="keywordtype">      real</span>(DP) :: calc_perimeter_wet<span class="comment">   !&lt; wetted perimeter</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">           !&lt; SfrType object</span></div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">    !&lt; reach number</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">    !&lt; reach depth</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: npts</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;      <span class="comment">! -- Calculate wetted perimeter</span></div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;      npts = this%ncrosspts(n)</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;      i0 = this%iacross(n)</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;      i1 = this%iacross(n + 1) - 1</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <span class="keywordflow">if</span> (npts &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;        calc_perimeter_wet = get_wetted_perimeter(npts, this%station(i0:i1<span class="comment">), &amp;</span></div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;<span class="comment"></span>                                                  this%xsdepths(i0:i1), depth<span class="comment">)</span></div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="comment"></span>      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;        calc_perimeter_wet = this%station(i0) <span class="comment">! no depth dependence in original implementation</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a98e5f0f033753a0b9c4d617f911e9628_cgraph.png" border="0" usemap="#namespacesfrmodule_a98e5f0f033753a0b9c4d617f911e9628_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a98e5f0f033753a0b9c4d617f911e9628_cgraph" id="namespacesfrmodule_a98e5f0f033753a0b9c4d617f911e9628_cgraph">
<area shape="rect" title="Calculate wetted perimeter." alt="" coords="5,13,229,39"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#ae1e48079e6f159b70efe898b1e48a750" title="Calculate the wetted perimeter for a reach." alt="" coords="277,5,499,47"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#af347b4cf532e2dac6e47058552c0e39c" title="Calculate the wetted perimeters for each line segment." alt="" coords="547,5,768,47"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#a37e8faa52bc7cf1544c73b24f45a3de0" title="Calculate the station values for the wetted portion of the cross&#45;section." alt="" coords="816,5,1037,47"/>
</map>
</div>

</div>
</div>
<a id="a3140f1fab77886b40ea39d7a45fd8e40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3140f1fab77886b40ea39d7a45fd8e40">&#9670;&nbsp;</a></span>calc_surface_area()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function sfrmodule::calc_surface_area </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the maximum surface area for a SFR package reach. </p><dl class="section return"><dt>Returns</dt><dd>surface area </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05263">5263</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;<span class="keywordtype">      real</span>(DP) :: calc_surface_area<span class="comment">  !&lt; surface area</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">         !&lt; SfrType object</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">  !&lt; reach number</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: npts</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;<span class="keywordtype">      real</span>(DP) :: top_width</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;      <span class="comment">! -- Calculate surface area</span></div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;      npts = this%ncrosspts(n)</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      i0 = this%iacross(n)</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;      i1 = this%iacross(n + 1) - 1</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;      <span class="keywordflow">if</span> (npts &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        top_width = get_saturated_topwidth(npts, this%station(i0:i1))</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        top_width = this%station(i0)</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;      calc_surface_area = top_width * this%length(n)</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a3140f1fab77886b40ea39d7a45fd8e40_cgraph.png" border="0" usemap="#namespacesfrmodule_a3140f1fab77886b40ea39d7a45fd8e40_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a3140f1fab77886b40ea39d7a45fd8e40_cgraph" id="namespacesfrmodule_a3140f1fab77886b40ea39d7a45fd8e40_cgraph">
<area shape="rect" title="Calculate maximum surface area." alt="" coords="5,13,219,39"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#ac9a1724cea87d478c7a77bc76f5c83ba" title="Calculate the saturated top width for a reach." alt="" coords="267,5,488,47"/>
</map>
</div>

</div>
</div>
<a id="aed9fa3204145944941a4e7ac8ed91750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9fa3204145944941a4e7ac8ed91750">&#9670;&nbsp;</a></span>calc_surface_area_wet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function sfrmodule::calc_surface_area_wet </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the wetted surface area for a SFR package reach. </p><dl class="section return"><dt>Returns</dt><dd>wetted surface area </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05295">5295</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;      <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;<span class="keywordtype">      real</span>(DP) :: calc_surface_area_wet<span class="comment"> !&lt; wetted surface area</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">            !&lt; SfrType object</span></div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">     !&lt; reach number</span></div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">     !&lt; reach depth</span></div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;<span class="keywordtype">      real</span>(DP) :: top_width</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;      <span class="comment">! -- Calculate wetted surface area</span></div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      top_width = this%calc_top_width_wet(n, depth)</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;      calc_surface_area_wet = top_width * this%length(n)</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1030f2f2e5de1cfaad1463b1b6cd4104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1030f2f2e5de1cfaad1463b1b6cd4104">&#9670;&nbsp;</a></span>calc_top_width_wet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function sfrmodule::calc_top_width_wet </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate the wetted top width for a SFR package reach. </p><dl class="section return"><dt>Returns</dt><dd>wetted top width </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05318">5318</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;      <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;<span class="keywordtype">      real</span>(DP) :: calc_top_width_wet<span class="comment">  !&lt; wetted top width</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">          !&lt; SfrType object</span></div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">   !&lt; reach number</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">   !&lt; reach depth</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: npts</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="keywordtype">      real</span>(DP) :: sat</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;      <span class="comment">! -- Calculate wetted top width</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;      npts = this%ncrosspts(n)</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;      i0 = this%iacross(n)</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;      i1 = this%iacross(n + 1) - 1</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;      sat = scubicsaturation(dem5, dzero, depth, dem5)</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;      <span class="keywordflow">if</span> (npts &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;        calc_top_width_wet = sat * get_wetted_topwidth(npts, &amp;</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;                                                       this%station(i0:i1<span class="comment">), &amp;</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;<span class="comment"></span>                                                       this%xsdepths(i0:i1<span class="comment">), &amp;</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="comment"></span>                                                       depth)        </div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;        calc_top_width_wet = sat * this%station(i0)</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a1030f2f2e5de1cfaad1463b1b6cd4104_cgraph.png" border="0" usemap="#namespacesfrmodule_a1030f2f2e5de1cfaad1463b1b6cd4104_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a1030f2f2e5de1cfaad1463b1b6cd4104_cgraph" id="namespacesfrmodule_a1030f2f2e5de1cfaad1463b1b6cd4104_cgraph">
<area shape="rect" title="Calculate wetted top width." alt="" coords="5,35,156,76"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#a9b3640c77e9e7692aeaf0fa8690058b6" title="Calculate the wetted top width for a reach." alt="" coords="221,5,442,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#a2fe24293993c45ad47ac9a124b16a6d7" title=" " alt="" coords="204,71,459,98"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#a75de53763056a7eee26f40e2b6a3f462" title="Calculate the wetted top widths for each line segment." alt="" coords="507,5,728,47"/>
<area shape="rect" href="namespacegwfsfrcrosssectionutilsmodule.html#a37e8faa52bc7cf1544c73b24f45a3de0" title="Calculate the station values for the wetted portion of the cross&#45;section." alt="" coords="776,5,997,47"/>
</map>
</div>

</div>
</div>
<a id="a69bccbdc4a96b0df4b0c32d08ccbe35b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69bccbdc4a96b0df4b0c32d08ccbe35b">&#9670;&nbsp;</a></span>define_listlabel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::define_listlabel </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method defined the list label for the SFR package. The list label is the heading that is written to iout when PRINT_INPUT option is used. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02531">2531</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <span class="keywordtype">class</span>(SfrType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      <span class="comment">! -- create the header list label</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      this%listlabel = trim(this%filtyp) // <span class="stringliteral">&#39; NO.&#39;</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="keywordflow">if</span>(this%dis%ndim == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;ROW&#39;</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;COL&#39;</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      <span class="keywordflow">elseif</span>(this%dis%ndim == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;LAYER&#39;</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;CELL2D&#39;</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a7)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;NODE&#39;</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a16)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;STRESS RATE&#39;</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keywordflow">if</span>(this%inamedbound == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <span class="keyword">write</span>(this%listlabel, <span class="stringliteral">&#39;(a, a16)&#39;</span>) trim(this%listlabel), <span class="stringliteral">&#39;BOUNDARY NAME&#39;</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada816d9da42d771a0b92682bfc82996c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada816d9da42d771a0b92682bfc82996c">&#9670;&nbsp;</a></span>sfr_activate_density()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_activate_density </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to activate addition of density terms for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05354">5354</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a></div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;      <span class="comment">! -- Set idense and reallocate denseterms to be of size MAXBOUND</span></div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;      this%idense = 1</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%denseterms, 3, this%MAXBOUND, <span class="stringliteral">&#39;DENSETERMS&#39;</span><span class="comment">, &amp;</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;<span class="comment"></span>                          this%memoryPath)</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;      <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;        <span class="keywordflow">do</span> j = 1, 3</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;          this%denseterms(j, i) = dzero</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(/1x,a)&#39;</span>) <span class="stringliteral">&#39;DENSITY TERMS HAVE BEEN ACTIVATED FOR SFR &amp;</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;PACKAGE: &#39;</span> // trim(adjustl(this%packName))</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc05ae3a236bf4c4a4884bfe51a3d1fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc05ae3a236bf4c4a4884bfe51a3d1fe">&#9670;&nbsp;</a></span>sfr_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance data in the SFR package. The method sets advances time series, time array series, and observation data. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01738">1738</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetimeseriesmanagermodule.html">timeseriesmanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetimeseriesmanagermodule.html#a709444fc8810a44dd181f632d2a4eb14">var_timeseries</a></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iaux</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="comment">! -- Most advanced package AD routines have to restore state if</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="comment">!    the solution failed and the time step is being retried with a smaller</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="comment">!    step size.  This is not needed here because there is no old stage</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <span class="comment">!    or storage effects in the stream.</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="comment">! -- Advance the time series manager</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <span class="keyword">call </span>this%TsManager%ad()</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="comment">! -- check upstream fractions if time series are being used to</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="comment">!    define this variable</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetimeseriesmanagermodule.html#a709444fc8810a44dd181f632d2a4eb14">var_timeseries</a>(this%tsManager, this%packName, <span class="stringliteral">&#39;USTRF&#39;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keyword">call </span>this%sfr_check_ustrf()</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <span class="comment">! -- update auxiliary variables by copying from the derived-type time</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <span class="comment">!    series variable into the bndpackage auxvar variable so that this</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="comment">!    information is properly written to the GWF budget file</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keywordflow">if</span> (this%naux &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;          <span class="keywordflow">do</span> iaux = 1, this%naux</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            <span class="keywordflow">if</span> (this%noupdateauxvar(iaux) /= 0) cycle</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            this%auxvar(iaux, n) = this%rauxvar(iaux, n)</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="comment">! -- reset upstream flow to zero and set specified stage</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        this%usflow(n) = dzero</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">if</span> (this%iboundpak(n) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          this%stage(n) = this%sstage(n)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="comment">! -- pakmvrobj ad</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="keywordflow">if</span>(this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <span class="keyword">call </span>this%pakmvrobj%ad()</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="comment">! -- For each observation, push simulated value and corresponding</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <span class="comment">!    simulation time from &quot;current&quot; to &quot;preceding&quot; and reset</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="comment">!    &quot;current&quot; value.</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keyword">call </span>this%obs%obs_ad()</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_afc05ae3a236bf4c4a4884bfe51a3d1fe_cgraph.png" border="0" usemap="#namespacesfrmodule_afc05ae3a236bf4c4a4884bfe51a3d1fe_cgraph" alt=""/></div>
<map name="namespacesfrmodule_afc05ae3a236bf4c4a4884bfe51a3d1fe_cgraph" id="namespacesfrmodule_afc05ae3a236bf4c4a4884bfe51a3d1fe_cgraph">
<area shape="rect" title="@ brief Advance the package" alt="" coords="5,13,141,39"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#a709444fc8810a44dd181f632d2a4eb14" title=" " alt="" coords="189,5,388,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a20fd69114074fcbe01dcc8219d4bbd79" title=" " alt="" coords="436,5,591,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="639,5,793,47"/>
</map>
</div>

</div>
</div>
<a id="a78f2dc5ccc3d0f9dc00393fc6c82cd38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78f2dc5ccc3d0f9dc00393fc6c82cd38">&#9670;&nbsp;</a></span>sfr_allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize array for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00328">328</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordtype">class</span>(SfrType),   <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="comment">! -- allocate character array for budget text</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keyword">allocate</span>(this%csfrbudget(this%bditems))</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sfrname, lenboundname, this%maxbound,      <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span>                        <span class="stringliteral">&#39;SFRNAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="comment">! -- variables originally in SfrDataType</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iboundpak, this%maxbound, <span class="stringliteral">&#39;IBOUNDPAK&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%igwfnode, this%maxbound, <span class="stringliteral">&#39;IGWFNODE&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%igwftopnode, this%maxbound, <span class="stringliteral">&#39;IGWFTOPNODE&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%length, this%maxbound, <span class="stringliteral">&#39;LENGTH&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%width, this%maxbound, <span class="stringliteral">&#39;WIDTH&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%strtop, this%maxbound, <span class="stringliteral">&#39;STRTOP&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bthick, this%maxbound, <span class="stringliteral">&#39;BTHICK&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%hk, this%maxbound, <span class="stringliteral">&#39;HK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%slope, this%maxbound, <span class="stringliteral">&#39;SLOPE&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nconnreach, this%maxbound, <span class="stringliteral">&#39;NCONNREACH&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ustrf, this%maxbound, <span class="stringliteral">&#39;USTRF&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ftotnd, this%maxbound, <span class="stringliteral">&#39;FTOTND&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ndiv, this%maxbound, <span class="stringliteral">&#39;NDIV&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%usflow, this%maxbound, <span class="stringliteral">&#39;USFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dsflow, this%maxbound, <span class="stringliteral">&#39;DSFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%depth, this%maxbound, <span class="stringliteral">&#39;DEPTH&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%stage, this%maxbound, <span class="stringliteral">&#39;STAGE&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%gwflow, this%maxbound, <span class="stringliteral">&#39;GWFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%simevap, this%maxbound, <span class="stringliteral">&#39;SIMEVAP&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%simrunoff, this%maxbound, <span class="stringliteral">&#39;SIMRUNOFF&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%stage0, this%maxbound, <span class="stringliteral">&#39;STAGE0&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%usflow0, this%maxbound, <span class="stringliteral">&#39;USFLOW0&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">! -- connection data</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ia, this%maxbound+1, <span class="stringliteral">&#39;IA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ja, 0, <span class="stringliteral">&#39;JA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idir, 0, <span class="stringliteral">&#39;IDIR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idiv, 0, <span class="stringliteral">&#39;IDIV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%qconn, 0, <span class="stringliteral">&#39;QCONN&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">! -- boundary data</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rough, this%maxbound, <span class="stringliteral">&#39;ROUGH&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rain, this%maxbound, <span class="stringliteral">&#39;RAIN&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%evap, this%maxbound, <span class="stringliteral">&#39;EVAP&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%inflow, this%maxbound, <span class="stringliteral">&#39;INFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%runoff, this%maxbound, <span class="stringliteral">&#39;RUNOFF&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sstage, this%maxbound, <span class="stringliteral">&#39;SSTAGE&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="comment">! -- aux variables</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%rauxvar, this%naux, this%maxbound,         <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span>                        <span class="stringliteral">&#39;RAUXVAR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="comment">! -- diversion variables</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iadiv, this%maxbound+1, <span class="stringliteral">&#39;IADIV&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%divreach, 0, <span class="stringliteral">&#39;DIVREACH&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%divflow, 0, <span class="stringliteral">&#39;DIVFLOW&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%divq, 0, <span class="stringliteral">&#39;DIVQ&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="comment">! -- cross-section data</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ncrosspts, this%maxbound, <span class="stringliteral">&#39;NCROSSPTS&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iacross, this%maxbound+1, <span class="stringliteral">&#39;IACROSS&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%station, this%ncrossptstot, <span class="stringliteral">&#39;STATION&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%xsdepths, this%ncrossptstot, <span class="stringliteral">&#39;XSDEPTHS&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      this%iacross(1) = 0</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        this%iboundpak(i) = 1</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        this%igwfnode(i) = 0</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        this%igwftopnode(i) = 0</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        this%length(i) = dzero</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        this%width(i) = dzero</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        this%strtop(i) = dzero</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        this%bthick(i) = dzero</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        this%hk(i) = dzero</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        this%slope(i) = dzero</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        this%nconnreach(i) = 0</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        this%ustrf(i) = dzero</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        this%ftotnd(i) = dzero</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        this%ndiv(i) = 0</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        this%usflow(i) = dzero</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        this%dsflow(i) = dzero</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        this%depth(i) = dzero</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        this%stage(i) = dzero</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        this%gwflow(i) = dzero</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        this%simevap(i) = dzero</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        this%simrunoff(i) = dzero</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        this%stage0(i) = dzero</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        this%usflow0(i) = dzero</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">! -- boundary data</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        this%rough(i) = dzero</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        this%rain(i) = dzero</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        this%evap(i) = dzero</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        this%inflow(i) = dzero</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        this%runoff(i) = dzero</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        this%sstage(i) = dzero</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">! -- aux variables</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">do</span> j = 1, this%naux</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          this%rauxvar(j, i) = dzero</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">! -- cross-section data</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        this%ncrosspts(i) = 0</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        this%iacross(i+1) = 0</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="comment">! -- initialize additional cross-section data</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">do</span> i = 1, this%ncrossptstot</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        this%station(i) = dzero</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        this%xsdepths(i) = dzero</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="comment">!-- fill csfrbudget</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      this%csfrbudget(1) = <span class="stringliteral">&#39;        RAINFALL&#39;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      this%csfrbudget(2) = <span class="stringliteral">&#39;     EVAPORATION&#39;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      this%csfrbudget(3) = <span class="stringliteral">&#39;          RUNOFF&#39;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      this%csfrbudget(4) = <span class="stringliteral">&#39;      EXT-INFLOW&#39;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      this%csfrbudget(5) = <span class="stringliteral">&#39;             GWF&#39;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      this%csfrbudget(6) = <span class="stringliteral">&#39;     EXT-OUTFLOW&#39;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      this%csfrbudget(7) = <span class="stringliteral">&#39;        FROM-MVR&#39;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      this%csfrbudget(8) = <span class="stringliteral">&#39;          TO-MVR&#39;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="comment">! -- allocate and initialize budget output data</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%qoutflow, this%maxbound, <span class="stringliteral">&#39;QOUTFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%qextoutflow, this%maxbound, <span class="stringliteral">&#39;QEXTOUTFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"></span>      <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        this%qoutflow(i) = dzero</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        this%qextoutflow(i) = dzero</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">! -- allocate and initialize dbuff</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">if</span> (this%istageout &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbuff, this%maxbound, <span class="stringliteral">&#39;DBUFF&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span>        <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          this%dbuff(i) = dzero</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dbuff, 0, <span class="stringliteral">&#39;DBUFF&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="comment">! -- allocate character array for budget text</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">allocate</span>(this%cauxcbc(this%cbcauxitems))</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="comment">! -- allocate and initialize qauxcbc</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%qauxcbc, this%cbcauxitems, <span class="stringliteral">&#39;QAUXCBC&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span>      <span class="keywordflow">do</span> i = 1, this%cbcauxitems</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        this%qauxcbc(i) = dzero</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="comment">!-- fill cauxcbc</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      this%cauxcbc(1) = <span class="stringliteral">&#39;FLOW-AREA       &#39;</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">! -- allocate denseterms to size 0</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%denseterms, 3, 0, <span class="stringliteral">&#39;DENSETERMS&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb4a7f609b36b1437fcee3f4ab3b85be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb4a7f609b36b1437fcee3f4ab3b85be">&#9670;&nbsp;</a></span>sfr_allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize scalars for the SFR package. The base model allocate scalars method is also called. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00264">264</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememoryhelpermodule.html">memoryhelpermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordtype">class</span>(SfrType),   <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">! -- call standard BndType allocate scalars</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keyword">call </span>this%BndType%allocate_scalars()</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">! -- allocate the object and assign values to object variables</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iprhed, <span class="stringliteral">&#39;IPRHED&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%istageout, <span class="stringliteral">&#39;ISTAGEOUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ibudgetout, <span class="stringliteral">&#39;IBUDGETOUT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ibudcsv, <span class="stringliteral">&#39;IBUDCSV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ipakcsv, <span class="stringliteral">&#39;IPAKCSV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idiversions, <span class="stringliteral">&#39;IDIVERSIONS&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%maxsfrpicard, <span class="stringliteral">&#39;MAXSFRPICARD&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%maxsfrit, <span class="stringliteral">&#39;MAXSFRIT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bditems, <span class="stringliteral">&#39;BDITEMS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cbcauxitems, <span class="stringliteral">&#39;CBCAUXITEMS&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span>      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%unitconv, <span class="stringliteral">&#39;UNITCONV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%dmaxchg, <span class="stringliteral">&#39;DMAXCHG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%deps, <span class="stringliteral">&#39;DEPS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%nconn, <span class="stringliteral">&#39;NCONN&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icheck, <span class="stringliteral">&#39;ICHECK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iconvchk, <span class="stringliteral">&#39;ICONVCHK&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idense, <span class="stringliteral">&#39;IDENSE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ianynone, <span class="stringliteral">&#39;IANYNONE&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ncrossptstot, <span class="stringliteral">&#39;NCROSSPTSTOT&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">! -- set pointer to gwf iss</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a>(this%gwfiss, <span class="stringliteral">&#39;ISS&#39;</span>, <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a>(this%name_model<span class="comment">))</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">! -- Set values</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      this%iprhed = 0</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      this%istageout = 0</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      this%ibudgetout = 0</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      this%ibudcsv = 0</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      this%ipakcsv = 0</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      this%idiversions = 0</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      this%maxsfrpicard = 100</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      this%maxsfrit = 100</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      this%bditems = 8</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      this%cbcauxitems = 1</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      this%unitconv = done</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      this%dmaxchg = dem5</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      this%deps = dp999 * this%dmaxchg</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      this%nconn = 0</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      this%icheck = 1</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      this%iconvchk = 1</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      this%idense = 0</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      this%ianynone = 0</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      this%ncrossptstot = 0</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_acb4a7f609b36b1437fcee3f4ab3b85be_cgraph.png" border="0" usemap="#namespacesfrmodule_acb4a7f609b36b1437fcee3f4ab3b85be_cgraph" alt=""/></div>
<map name="namespacesfrmodule_acb4a7f609b36b1437fcee3f4ab3b85be_cgraph" id="namespacesfrmodule_acb4a7f609b36b1437fcee3f4ab3b85be_cgraph">
<area shape="rect" title="@ brief Allocate scalars" alt="" coords="5,61,177,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738" title="returns the path to the memory object" alt="" coords="225,61,392,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="440,61,607,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="655,68,829,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="877,68,1016,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1064,27,1232,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="1064,93,1232,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1280,5,1475,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1293,57,1461,98"/>
</map>
</div>

</div>
</div>
<a id="a89376a2749bd62ff96179c10284f840c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89376a2749bd62ff96179c10284f840c">&#9670;&nbsp;</a></span>sfr_ar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read and prepare period data for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00729">729</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">! -- allocate and read observations</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keyword">call </span>this%obs%obs_ar()</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="comment">! -- call standard BndType allocate scalars</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keyword">call </span>this%BndType%allocate_arrays()</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="comment">! -- set boundname for each connection</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          this%boundname(n) = this%sfrname(n)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="comment">! -- copy igwfnode into nodelist</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        this%nodelist(n) = this%igwfnode(n)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">! -- check the sfr data</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keyword">call </span>this%sfr_check_reaches()</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="comment">! -- check the connection data</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keyword">call </span>this%sfr_check_connections()</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="comment">! -- check the diversion data</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keywordflow">if</span> (this%idiversions /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keyword">call </span>this%sfr_check_diversions()</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="comment">! -- terminate if errors were detected in any of the static sfr data</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      ierr = count_errors()</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">if</span> (ierr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="comment">! -- setup pakmvrobj</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">if</span> (this%imover /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keyword">allocate</span>(this%pakmvrobj)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keyword">call </span>this%pakmvrobj%ar(this%maxbound, this%maxbound, this%memoryPath)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a89376a2749bd62ff96179c10284f840c_cgraph.png" border="0" usemap="#namespacesfrmodule_a89376a2749bd62ff96179c10284f840c_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a89376a2749bd62ff96179c10284f840c_cgraph" id="namespacesfrmodule_a89376a2749bd62ff96179c10284f840c_cgraph">
<area shape="rect" title="@ brief Allocate and read method for package" alt="" coords="5,5,139,32"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="187,5,371,32"/>
</map>
</div>

</div>
</div>
<a id="a7a985422530d8f633587ef61d5faa1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a985422530d8f633587ef61d5faa1cd">&#9670;&nbsp;</a></span>sfr_bd_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_bd_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to save simulated values for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02685">2685</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="keywordtype">      real</span>(DP) :: v</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      <span class="keywordtype">character(len=100)</span> :: msg</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      <span class="keywordtype">type</span>(ObserveType), <span class="keywordtype">pointer</span> :: obsrv =&gt; null()</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="comment">! Write simulated values for all sfr observations</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="keywordflow">if</span> (this%obs%npakobs &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keyword">call </span>this%obs%obs_bd_clear()</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <span class="keywordflow">do</span> i=1 ,this%obs%npakobs</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;          obsrv =&gt; this%obs%pakobs(i)%obsrv</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;          <span class="keywordflow">do</span> j = 1, obsrv%indxbnds_count</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            n = obsrv%indxbnds(j)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            v = dzero</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;            <span class="keywordflow">select case</span> (obsrv%ObsTypeId)</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;STAGE&#39;</span>)</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                v = this%stage(n)</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;TO-MVR&#39;</span>)</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                v = dnodata</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                  v = this%pakmvrobj%get_qtomvr(n)</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                  <span class="keywordflow">if</span> (v &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                    v = -v</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;FROM-MVR&#39;</span>)</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                v = dnodata</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                  v = this%pakmvrobj%get_qfrommvr(n)</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;EXT-INFLOW&#39;</span>)</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                v = this%inflow(n)</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INFLOW&#39;</span>)</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                v = this%usflow(n)</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OUTFLOW&#39;</span>)</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                v = this%qoutflow(n)</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;EXT-OUTFLOW&#39;</span>)</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                v = this%qextoutflow(n)</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;RAINFALL&#39;</span>)</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                v = this%rain(n)</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;RUNOFF&#39;</span>)</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                v = this%simrunoff(n)</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;EVAPORATION&#39;</span>)</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                v = this%simevap(n)</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SFR&#39;</span>)</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                v = this%gwflow(n)</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UPSTREAM-FLOW&#39;</span>)</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                v = this%usflow(n)</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                  v = v + this%pakmvrobj%get_qfrommvr(n)</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DOWNSTREAM-FLOW&#39;</span>)</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                v = this%dsflow(n)</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                <span class="keywordflow">if</span> (v &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                  v = -v</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DEPTH&#39;</span>)</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                v = this%depth(n)</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;WET-PERIMETER&#39;</span>)</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                v = this%calc_perimeter_wet(n, this%depth(n))</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;WET-AREA&#39;</span>)</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                v = this%calc_area_wet(n, this%depth(n))</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;              <span class="keywordflow">case</span> (<span class="stringliteral">&#39;WET-WIDTH&#39;</span>)</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                v = this%calc_top_width_wet(n, this%depth(n))</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="keywordflow">              case default</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                msg = <span class="stringliteral">&#39;Unrecognized observation type: &#39;</span> // trim(obsrv%ObsTypeId)</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(msg)</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="keywordflow">            end select</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;            <span class="keyword">call </span>this%obs%SaveOneSimval(obsrv, v)</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        <span class="comment">! -- write summary of package error messages</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a7a985422530d8f633587ef61d5faa1cd_cgraph.png" border="0" usemap="#namespacesfrmodule_a7a985422530d8f633587ef61d5faa1cd_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a7a985422530d8f633587ef61d5faa1cd_cgraph" id="namespacesfrmodule_a7a985422530d8f633587ef61d5faa1cd_cgraph">
<area shape="rect" title="Save observations for the package." alt="" coords="5,43,172,69"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="220,17,404,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="225,68,399,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="452,68,591,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="639,27,807,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="639,93,807,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="855,5,1049,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="868,57,1036,98"/>
</map>
</div>

</div>
</div>
<a id="a187716af19623eca7c6cb5e6ac234d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a187716af19623eca7c6cb5e6ac234d11">&#9670;&nbsp;</a></span>sfr_calc_cond()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_cond </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>cond</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the reach-aquifer conductance for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cond</td><td>reach-aquifer conductance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03853">3853</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">           !&lt; SfrType object</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">    !&lt; reach number</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">    !&lt; reach depth</span></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: cond<span class="comment">  !&lt; reach-aquifer conductance</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;<span class="keywordtype">      real</span>(DP) :: wp</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      <span class="comment">! -- initialize conductance</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      cond = dzero</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      <span class="comment">! -- calculate conductance if GWF cell is active</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;      node = this%igwfnode(n)</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;        <span class="keywordflow">if</span> (this%ibound(node) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;          wp = this%calc_perimeter_wet(n, depth)</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;          cond = this%hk(n) * this%length(n) * wp / this%bthick(n)</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aafddc50496348f677e8f00ca1d2342cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafddc50496348f677e8f00ca1d2342cc">&#9670;&nbsp;</a></span>sfr_calc_div()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_div </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qdiv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the diversion flow for a diversion connected to a SFR package reach. The downstream flow for a reach is passed in and adjusted by the diversion flow amount calculated in this method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>diversion number in reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qd</td><td>remaining downstream flow for reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qdiv</td><td>diversion flow for diversion i </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03888">3888</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">              !&lt; SfrType object</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">       !&lt; reach number</span></div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: i<span class="comment">       !&lt; diversion number in reach</span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qd<span class="comment">       !&lt; remaining downstream flow for reach</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qdiv<span class="comment">     !&lt; diversion flow for diversion i</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cp</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jpos</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="keywordtype">      real</span>(DP) :: v</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      <span class="comment">! -- set local variables</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      jpos = this%iadiv(n) + i - 1</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      n2 = this%divreach(jpos)</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      cp = this%divcprior(jpos)</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;      v = this%divflow(jpos)</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      <span class="comment">! -- calculate diversion</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      <span class="keywordflow">select case</span>(cp)</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        <span class="comment">! -- flood diversion</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;EXCESS&#39;</span>)</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;          <span class="keywordflow">if</span> (qd &lt; v) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;            v = dzero</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;            v = qd - v</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        <span class="comment">! -- diversion percentage</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;FRACTION&#39;</span>)</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;          v = qd * v</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;        <span class="comment">! -- STR priority algorithm</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THRESHOLD&#39;</span>)</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;          <span class="keywordflow">if</span> (qd &lt; v) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;            v = dzero</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        <span class="comment">! -- specified diversion</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UPTO&#39;</span>)</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;          <span class="keywordflow">if</span> (v &gt; qd) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;            v = qd</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;          v = dzero</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      <span class="comment">! -- update upstream from for downstream reaches</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;      qd = qd - v</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;      qdiv = v</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08f5e33e5eb5e9b52aad706ed12196c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08f5e33e5eb5e9b52aad706ed12196c7">&#9670;&nbsp;</a></span>sfr_calc_npoint_depth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_npoint_depth </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>qrch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the depth at the midpoint of a reach with a n-point cross-section using Newton-Raphson. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qrch</td><td>streamflow </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>stream depth at midpoint of reach </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03988">3988</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">          !&lt; SfrType object</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">   !&lt; reach number</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: qrch<span class="comment">    !&lt; streamflow</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: d<span class="comment">    !&lt; stream depth at midpoint of reach</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iter</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="keywordtype">      real</span>(DP) :: q0</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="keywordtype">      real</span>(DP) :: q1</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="keywordtype">      real</span>(DP) :: dq</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="keywordtype">      real</span>(DP) :: derv</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="keywordtype">      real</span>(DP) :: dd</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="keywordtype">      real</span>(DP) :: residual</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;      <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      d = dzero</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      q0 = dzero</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      residual = q0 - qrch</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;      <span class="comment">! -- Newton-Raphson iteration</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;      nriter: <span class="keywordflow">do</span> iter = 1, this%maxsfrit</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="keyword">call </span>this%sfr_calc_qman(n, d + this%deps, q1)</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;        dq = (q1 - q0)</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        <span class="keywordflow">if</span> (dq /= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;            derv = this%deps / (q1 - q0)</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;            derv = dzero</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        dd = derv * residual</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        d = d - dd</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        <span class="keyword">call </span>this%sfr_calc_qman(n, d, q0)</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        residual = q0 - qrch</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <span class="comment">! -- check for convergence</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        <span class="keywordflow">if</span> (abs(dd) &lt; this%dmaxchg) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;          <span class="keywordflow">exit</span> nriter</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="keywordflow">      end do</span> nriter</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f26e22eac11fe58a67d375cf2bb9b25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f26e22eac11fe58a67d375cf2bb9b25">&#9670;&nbsp;</a></span>sfr_calc_qd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_qd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hgwf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qgwf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate downstream flow for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hgwf</td><td>groundwater head in connected GWF cell </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qgwf</td><td>groundwater leakage for reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qd</td><td>residual </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03635">3635</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">             !&lt; SfrType object</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">      !&lt; reach number</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">      !&lt; reach depth</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: hgwf<span class="comment">       !&lt; groundwater head in connected GWF cell</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qgwf<span class="comment">    !&lt; groundwater leakage for reach</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qd<span class="comment">      !&lt; residual</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="keywordtype">      real</span>(DP) :: qsrc</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      <span class="comment">! -- initialize residual</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      qd = dzero</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      <span class="comment">! -- calculate total water sources excluding groundwater leakage</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="keyword">call </span>this%sfr_calc_qsource(n, depth, qsrc)</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      <span class="comment">! -- estimate groundwater leakage</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <span class="keyword">call </span>this%sfr_calc_qgwf(n, depth, hgwf, qgwf)</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      <span class="keywordflow">if</span> (-qgwf &gt; qsrc) qgwf = -qsrc</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <span class="comment">! -- calculate down stream flow</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      qd = qsrc + qgwf</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      <span class="comment">! -- limit downstream flow to a positive value</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      <span class="keywordflow">if</span> (qd &lt; dem30) qd = dzero</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aafe126a78d9becdbf0327c4204b6075a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafe126a78d9becdbf0327c4204b6075a">&#9670;&nbsp;</a></span>sfr_calc_qgwf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_qgwf </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>hgwf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qgwf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout), optional&#160;</td>
          <td class="paramname"><em>gwfhcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout), optional&#160;</td>
          <td class="paramname"><em>gwfrhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the reach-aquifer exchange for a SFR package reach. The reach-aquifer exchange is relative to the reach. Calculated flow is positive if flow is from the aquifer to the reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hgwf</td><td>head in GWF cell connected to reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qgwf</td><td>reach-aquifer exchange </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gwfhcof</td><td>diagonal coefficient term for reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gwfrhs</td><td>right-hand side term for reach </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03785">3785</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">                         !&lt; SfrType object</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">                  !&lt; reach number</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">                  !&lt; reach depth</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: hgwf<span class="comment">                   !&lt; head in GWF cell connected to reach</span></div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qgwf<span class="comment">                !&lt; reach-aquifer exchange</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: gwfhcof<span class="comment">   !&lt; diagonal coefficient term for reach </span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: gwfrhs<span class="comment">    !&lt; right-hand side term for reach</span></div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="keywordtype">      real</span>(DP) :: tp</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;<span class="keywordtype">      real</span>(DP) :: bt</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;<span class="keywordtype">      real</span>(DP) :: hsfr</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;<span class="keywordtype">      real</span>(DP) :: htmp</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="keywordtype">      real</span>(DP) :: cond</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="keywordtype">      real</span>(DP) :: sat</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;<span class="keywordtype">      real</span>(DP) :: derv</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="keywordtype">      real</span>(DP) :: gwfhcof0</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="keywordtype">      real</span>(DP) :: gwfrhs0</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      <span class="comment">! -- initialize qgwf</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;      qgwf = dzero</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;      <span class="comment">! -- skip sfr-aquifer exchange in external cells</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;      node = this%igwfnode(n)</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      <span class="keywordflow">if</span> (node &lt; 1) <span class="keywordflow">return</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      <span class="comment">! -- skip sfr-aquifer exchange in inactive cells</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      <span class="keywordflow">if</span> (this%ibound(node) == 0) <span class="keywordflow">return</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      <span class="comment">! -- calculate saturation</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      <span class="keyword">call </span>schsmooth(depth, sat, derv)</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;      <span class="comment">! -- calculate conductance</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;      <span class="keyword">call </span>this%sfr_calc_cond(n, depth, cond)</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;      <span class="comment">! -- calculate groundwater leakage</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      tp = this%strtop(n)</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      bt = tp - this%bthick(n)</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      hsfr = tp + depth</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;      htmp = hgwf</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;      <span class="keywordflow">if</span> (htmp &lt; bt) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;        htmp = bt</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      qgwf = sat * cond * (htmp - hsfr)</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      gwfrhs0 = -sat * cond * hsfr</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      gwfhcof0 = -sat * cond</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <span class="comment">! Add density contributions, if active</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <span class="keywordflow">if</span> (this%idense /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;        <span class="keyword">call </span>this%sfr_calculate_density_exchange(n, hsfr, hgwf, cond, tp,        &amp;</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                                                qgwf, gwfhcof0, gwfrhs0)</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      <span class="comment">! -- Set gwfhcof and gwfrhs if present</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(gwfhcof)) gwfhcof = gwfhcof0</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(gwfrhs)) gwfrhs = gwfrhs0</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_aafe126a78d9becdbf0327c4204b6075a_cgraph.png" border="0" usemap="#namespacesfrmodule_aafe126a78d9becdbf0327c4204b6075a_cgraph" alt=""/></div>
<map name="namespacesfrmodule_aafe126a78d9becdbf0327c4204b6075a_cgraph" id="namespacesfrmodule_aafe126a78d9becdbf0327c4204b6075a_cgraph">
<area shape="rect" title="Calculate reach&#45;aquifer exchange." alt="" coords="5,5,191,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#aa2bd453c7d7697853962a1d09f29f99a" title=" " alt="" coords="239,5,457,32"/>
</map>
</div>

</div>
</div>
<a id="a8bea0c1a6342ebff08051f67b38cc64d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bea0c1a6342ebff08051f67b38cc64d">&#9670;&nbsp;</a></span>sfr_calc_qman()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_qman </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qman</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the streamflow using Manning's equation for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qman</td><td>streamflow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03741">3741</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">           !&lt; SfrType object</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">    !&lt; reach number</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">    !&lt; reach depth</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qman<span class="comment">  !&lt; streamflow</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="keywordtype">      real</span>(DP) :: sat</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="keywordtype">      real</span>(DP) :: derv</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="keywordtype">      real</span>(DP) :: s</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="keywordtype">      real</span>(DP) :: r</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="keywordtype">      real</span>(DP) :: aw</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="keywordtype">      real</span>(DP) :: wp</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="keywordtype">      real</span>(DP) :: rh</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      <span class="comment">! -- initialize streamflow</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      qman = dzero</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      <span class="comment">! -- calculate terms for Manning&#39;s equation</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      <span class="keyword">call </span>schsmooth(depth, sat, derv)</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      s = this%slope(n)</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      r = this%rough(n)</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      aw = this%calc_area_wet(n, depth)</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      wp = this%calc_perimeter_wet(n, depth)</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      rh = dzero</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;      <span class="keywordflow">if</span> (wp &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;        rh = aw / wp</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <span class="comment">! -- calculate stream flow</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      qman = sat * this%unitconv * aw * (rh**<a class="code" href="namespaceconstantsmodule.html#a1dd99b36c8013b13af6abf45ed99bf3d">dtwothirds</a>) * sqrt(s) / r</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a8bea0c1a6342ebff08051f67b38cc64d_cgraph.png" border="0" usemap="#namespacesfrmodule_a8bea0c1a6342ebff08051f67b38cc64d_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a8bea0c1a6342ebff08051f67b38cc64d_cgraph" id="namespacesfrmodule_a8bea0c1a6342ebff08051f67b38cc64d_cgraph">
<area shape="rect" title="Calculate streamflow." alt="" coords="5,5,196,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#aa2bd453c7d7697853962a1d09f29f99a" title=" " alt="" coords="244,5,463,32"/>
</map>
</div>

</div>
</div>
<a id="abf2c5c93011287606794460a53ee2c52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf2c5c93011287606794460a53ee2c52">&#9670;&nbsp;</a></span>sfr_calc_qsource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_qsource </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qsrc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the sum of sources for reach, excluding reach leakage, for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>reach depth </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qsrc</td><td>sum of sources for reach </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03672">3672</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">            !&lt; SfrType object</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">     !&lt; reach number</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: depth<span class="comment">     !&lt; reach depth</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qsrc<span class="comment">   !&lt; sum of sources for reach</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="keywordtype">      real</span>(DP) :: qu</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="keywordtype">      real</span>(DP) :: qi</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;<span class="keywordtype">      real</span>(DP) :: qr</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="keywordtype">      real</span>(DP) :: qe</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="keywordtype">      real</span>(DP) :: qro</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="keywordtype">      real</span>(DP) :: qfrommvr</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="keywordtype">      real</span>(DP) :: qt</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="keywordtype">      real</span>(DP) :: a</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="keywordtype">      real</span>(DP) :: ae</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <span class="comment">! -- initialize residual</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      qsrc = dzero</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;      <span class="comment">! -- calculate flow terms</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      qu = this%usflow(n)</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      qi = this%inflow(n)</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      qro = this%runoff(n)</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;      <span class="comment">! -- calculate rainfall and evap</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      a = this%calc_surface_area(n)</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      ae = this%calc_surface_area_wet(n, depth)</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;      qr = this%rain(n) * a</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;      qe = this%evap(n) * a</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;      <span class="comment">! -- calculate mover term</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      qfrommvr = dzero</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        qfrommvr = this%pakmvrobj%get_qfrommvr(n)</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;      <span class="comment">! -- calculate down stream flow</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;      qsrc = qu + qi + qr - qe + qro + qfrommvr</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <span class="comment">! -- adjust runoff or evaporation if sum of sources is negative</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="keywordflow">if</span> (qsrc &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        <span class="comment">! -- calculate sources without et</span></div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        qt = qu + qi + qr + qro + qfrommvr</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;        <span class="comment">! -- runoff exceeds sources of water for reach</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;        <span class="keywordflow">if</span> (qt &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;          qro = -(qu + qi + qr + qfrommvr)</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;          qe = dzero</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;        <span class="comment">! -- evaporation exceeds sources of water for reach</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;          qe = qu + qi + qr + qro + qfrommvr</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;        qsrc = qu + qi + qr - qe + qro + qfrommvr</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30ab5e2cac3005b9e128cf1c528d3f59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30ab5e2cac3005b9e128cf1c528d3f59">&#9670;&nbsp;</a></span>sfr_calc_reach_depth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calc_reach_depth </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>d1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to calculate the depth at the midpoint of a reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>streamflow </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d1</td><td>stream depth at midpoint of reach </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03947">3947</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">          !&lt; SfrType object</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">   !&lt; reach number</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: q1<span class="comment">      !&lt; streamflow</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: d1<span class="comment">   !&lt; stream depth at midpoint of reach</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;<span class="keywordtype">      real</span>(DP) :: w</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="keywordtype">      real</span>(DP) :: s</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="keywordtype">      real</span>(DP) :: r</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="keywordtype">      real</span>(DP) :: qconst</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      <span class="comment">! -- initialize slope and roughness</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;      s = this%slope(n)</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;      r = this%rough(n)</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      <span class="comment">! -- calculate stream depth at the midpoint</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      <span class="keywordflow">if</span> (q1 &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;        <span class="keywordflow">if</span> (this%ncrosspts(n) &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;          <span class="keyword">call </span>this%sfr_calc_npoint_depth(n, q1, d1)</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;          w = this%station(this%iacross(n))</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;          qconst = this%unitconv * w * sqrt(s) / r</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;          d1 = (q1 / qconst)**dp6</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;        d1 = dzero</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      <span class="keywordflow">if</span> (d1 &lt; dem30) d1 = dzero <span class="comment">! test removal of this check</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a560d50d24cedfb00dbd54443afd65a73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a560d50d24cedfb00dbd54443afd65a73">&#9670;&nbsp;</a></span>sfr_calculate_density_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_calculate_density_exchange </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>bots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>gwfhcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>gwfrhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to galculate groundwater-reach density exchange terms for a SFR package reach.</p>
<p>Member variable used here denseterms : shape (3, MAXBOUND), filled by buoyancy package col 1 is relative density of sfr (densesfr / denseref) col 2 is relative density of gwf cell (densegwf / denseref) col 3 is elevation of gwf cell </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stage</td><td>reach stage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">head</td><td>head in connected GWF cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cond</td><td>reach conductance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bots</td><td>bottom elevation of reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flow</td><td>calculated flow, updated here with density terms </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gwfhcof</td><td>GWF diagonal coefficient, updated here with density terms </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gwfrhs</td><td>GWF right-hand-side value, updated here with density terms </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05392">5392</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">         !&lt; reach number</span></div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: stage<span class="comment">         !&lt; reach stage</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: head<span class="comment">          !&lt; head in connected GWF cell</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: cond<span class="comment">          !&lt; reach conductance</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: bots<span class="comment">          !&lt; bottom elevation of reach</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: flow<span class="comment">       !&lt; calculated flow, updated here with density terms</span></div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: gwfhcof<span class="comment">    !&lt; GWF diagonal coefficient, updated here with density terms</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: gwfrhs<span class="comment">     !&lt; GWF right-hand-side value, updated here with density terms</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;<span class="keywordtype">      real</span>(DP) :: ss</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;<span class="keywordtype">      real</span>(DP) :: hh</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;<span class="keywordtype">      real</span>(DP) :: havg</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;<span class="keywordtype">      real</span>(DP) :: rdensesfr</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;<span class="keywordtype">      real</span>(DP) :: rdensegwf</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;<span class="keywordtype">      real</span>(DP) :: rdenseavg</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;<span class="keywordtype">      real</span>(DP) :: elevsfr</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;<span class="keywordtype">      real</span>(DP) :: elevgwf</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;<span class="keywordtype">      real</span>(DP) :: elevavg</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;<span class="keywordtype">      real</span>(DP) :: d1</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;<span class="keywordtype">      real</span>(DP) :: d2</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      <span class="keywordtype">logical</span> :: stage_below_bot</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;      <span class="keywordtype">logical</span> :: head_below_bot</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      <span class="comment">! -- Set sfr density to sfr density or gwf density</span></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      <span class="keywordflow">if</span> (stage &gt;= bots) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;        ss = stage</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;        stage_below_bot = .false.</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;        rdensesfr = this%denseterms(1, n)  <span class="comment">! sfr rel density</span></div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;        ss = bots</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;        stage_below_bot = .true.</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;        rdensesfr = this%denseterms(2, n)  <span class="comment">! gwf rel density</span></div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;      <span class="comment">! -- set hh to head or bots</span></div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;      <span class="keywordflow">if</span> (head &gt;= bots) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        hh = head</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;        head_below_bot = .false.</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;        rdensegwf = this%denseterms(2, n)  <span class="comment">! gwf rel density</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;        hh = bots</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;        head_below_bot = .true.</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;        rdensegwf = this%denseterms(1, n)  <span class="comment">! sfr rel density</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      <span class="comment">! -- todo: hack because denseterms not updated in a cf calculation</span></div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;      <span class="keywordflow">if</span> (rdensegwf == dzero) <span class="keywordflow">return</span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      <span class="comment">! -- Update flow</span></div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      <span class="keywordflow">if</span> (stage_below_bot .and. head_below_bot) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;        <span class="comment">! -- flow is zero, so no terms are updated</span></div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;        <span class="comment">! -- calulate average relative density</span></div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;        rdenseavg = dhalf * (rdensesfr + rdensegwf)</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;        <span class="comment">! -- Add contribution of first density term: </span></div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;        <span class="comment">!      cond * (denseavg/denseref - 1) * (hgwf - hsfr)</span></div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;        d1 = cond * (rdenseavg - done) </div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;        gwfhcof = gwfhcof - d1</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;        gwfrhs = gwfrhs - d1 * ss</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;        d1 = d1 * (hh - ss)</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;        flow = flow + d1</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;        <span class="comment">! -- Add second density term if stage and head not below bottom</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;        <span class="keywordflow">if</span> (.not. stage_below_bot .and. .not. head_below_bot) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;          <span class="comment">! -- Add contribution of second density term:</span></div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;          <span class="comment">!      cond * (havg - elevavg) * (densegwf - densesfr) / denseref</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;          elevgwf = this%denseterms(3, n)</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;          elevsfr = bots</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;          elevavg = dhalf * (elevsfr + elevgwf)</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;          havg = dhalf * (hh + ss)</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;          d2 = cond * (havg - elevavg) * (rdensegwf - rdensesfr)</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;          gwfrhs = gwfrhs + d2</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;          flow = flow + d2</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a19fcebfb4dc1f317beaf82d9bf5af7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19fcebfb4dc1f317beaf82d9bf5af7a4">&#9670;&nbsp;</a></span>sfr_cc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_cc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>innertot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icnvgmod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenpakloc), intent(inout)&#160;</td>
          <td class="paramname"><em>cpak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>ipak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>dpak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform additional convergence checks on the flow between the SFR package and the model it is attached to. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">innertot</td><td>total number of inner iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>Picard iteration number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iend</td><td>flag indicating if this is the last Picard iteration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icnvgmod</td><td>flag inficating if the model has met specific convergence criteria </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cpak</td><td>string for user node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ipak</td><td>location of the maximum dependent variable change </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dpak</td><td>maximum dependent variable change </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01996">1996</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <span class="keywordtype">class</span>(SfrType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">               !&lt; SfrType object</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: innertot<span class="comment">                !&lt; total number of inner iterations</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                   !&lt; Picard iteration number</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iend<span class="comment">                    !&lt; flag indicating if this is the last Picard iteration</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icnvgmod<span class="comment">                !&lt; flag inficating if the model has met specific convergence criteria</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keywordtype">character(len=LENPAKLOC)</span>, <span class="keywordtype">intent(inout)</span> :: cpak<span class="comment">     !&lt; string for user node</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: ipak<span class="comment">                 !&lt; location of the maximum dependent variable change</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: dpak<span class="comment">                     !&lt; maximum dependent variable change</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keywordtype">character(len=LENPAKLOC)</span> :: cloc</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: icheck</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ipakfail</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: locdhmax</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: locrmax</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ntabcols</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="keywordtype">      real</span>(DP) :: dh</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="keywordtype">      real</span>(DP) :: r</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="keywordtype">      real</span>(DP) :: dhmax</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="keywordtype">      real</span>(DP) :: rmax</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      icheck = this%iconvchk </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      ipakfail = 0</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      locdhmax = 0</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      locrmax = 0</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      dhmax = dzero</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      rmax = dzero</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      <span class="comment">! -- if not saving package convergence data on check convergence if</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      <span class="comment">!    the model is considered converged</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="keywordflow">if</span> (this%ipakcsv == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">if</span> (icnvgmod == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;          icheck = 0</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="comment">! -- saving package convergence data</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        <span class="comment">! -- header for package csv</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%pakcsvtab)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;          <span class="comment">! -- determine the number of columns and rows</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;          ntabrows = 1</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;          ntabcols = 9</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;          <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%pakcsvtab, this%packName, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%table_df(ntabrows, ntabcols, this%ipakcsv,<span class="comment">           &amp;</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment"></span>                                      lineseparator=.false., separator=<span class="stringliteral">&#39;,&#39;</span><span class="comment">,       &amp;</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment"></span>                                      finalize=.false.)</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          <span class="comment">! -- add columns to package csv</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;          tag = <span class="stringliteral">&#39;total_inner_iterations&#39;</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;totim&#39;</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;kper&#39;</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;kstp&#39;</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;nouter&#39;</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 10, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;dvmax&#39;</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;dvmax_loc&#39;</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;dinflowmax&#39;</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment"></span>          tag = <span class="stringliteral">&#39;dinflowmax_loc&#39;</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%initialize_column(tag, 15, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment"></span><span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <span class="comment">! -- perform package convergence check</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      <span class="keywordflow">if</span> (icheck /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        final_check: <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;          <span class="keywordflow">if</span> (this%iboundpak(n) == 0) cycle</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;          dh = this%stage0(n) - this%stage(n)</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;          r = this%usflow0(n) - this%usflow(n)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;          <span class="comment">! -- normalize flow difference and convert to a depth</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;          r = r * <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a> / this%calc_surface_area(n)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;          <span class="comment">! -- evaluate magnitude of differences</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          <span class="keywordflow">if</span> (n == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            locdhmax = n</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            dhmax = dh</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            locrmax = n</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            rmax = r</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            <span class="keywordflow">if</span> (abs(dh) &gt; abs(dhmax)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;              locdhmax = n</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;              dhmax = dh</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            <span class="keywordflow">if</span> (abs(r) &gt; abs(rmax)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;              locrmax = n</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;              rmax = r</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="keywordflow">        end do</span> final_check</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <span class="comment">! -- set dpak and cpak</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="keywordflow">if</span> (abs(dhmax) &gt; abs(dpak)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;          ipak = locdhmax</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;          dpak = dhmax</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;          <span class="keyword">write</span>(cloc, <span class="stringliteral">&quot;(a,&#39;-&#39;,a)&quot;</span>) trim(this%packName), <span class="stringliteral">&#39;stage&#39;</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;          cpak = trim(cloc)</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <span class="keywordflow">if</span> (abs(rmax) &gt; abs(dpak)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;          ipak = locrmax</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;          dpak = rmax</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;          <span class="keyword">write</span>(cloc, <span class="stringliteral">&quot;(a,&#39;-&#39;,a)&quot;</span>) trim(this%packName), <span class="stringliteral">&#39;inflow&#39;</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;          cpak = trim(cloc)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        <span class="comment">! -- write convergence data to package csv</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="keywordflow">if</span> (this%ipakcsv /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;          <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(innertot)</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(<a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>)</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>)</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(kiter)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(dhmax)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(locdhmax)</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(rmax)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;          <span class="keyword">call </span>this%pakcsvtab%add_term(locrmax)</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;          <span class="comment">! -- finalize the package csv</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;          <span class="keywordflow">if</span> (iend == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            <span class="keyword">call </span>this%pakcsvtab%finalize_table()</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a19fcebfb4dc1f317beaf82d9bf5af7a4_cgraph.png" border="0" usemap="#namespacesfrmodule_a19fcebfb4dc1f317beaf82d9bf5af7a4_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a19fcebfb4dc1f317beaf82d9bf5af7a4_cgraph" id="namespacesfrmodule_a19fcebfb4dc1f317beaf82d9bf5af7a4_cgraph">
<area shape="rect" title="@ brief Convergence check for package." alt="" coords="5,5,140,32"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="188,5,352,32"/>
</map>
</div>

</div>
</div>
<a id="a9e647aebe799daa24b7fc145a1f425d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e647aebe799daa24b7fc145a1f425d9">&#9670;&nbsp;</a></span>sfr_cf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_cf </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>reset_mover</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Formulate the hcof and rhs terms for the WEL package that will be added to the coefficient matrix and right-hand side vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reset_mover</td><td>boolean for resetting mover </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01801">1801</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">                        !&lt; SfrType object</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: reset_mover<span class="comment">  !&lt; boolean for resetting mover </span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: igwfnode</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="keywordtype">logical</span> :: lrm</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="comment">! -- return if no sfr reaches</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordflow">if</span>(this%nbound == 0) <span class="keywordflow">return</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="comment">! -- find highest active cell</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keywordflow">do</span> n = 1, this%nbound</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        igwfnode = this%igwftopnode(n)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordflow">if</span> (igwfnode &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;          <span class="keywordflow">if</span> (this%ibound(igwfnode) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <span class="keyword">call </span>this%dis%highest_active(igwfnode, this%ibound)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        this%igwfnode(n) = igwfnode</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        this%nodelist(n) = igwfnode</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="comment">! -- pakmvrobj cf</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      lrm = .true.</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(reset_mover)) lrm = reset_mover</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keywordflow">if</span>(this%imover == 1 .and. lrm) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keyword">call </span>this%pakmvrobj%cf()</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72ae02795191b6875226f19aebd056ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72ae02795191b6875226f19aebd056ad">&#9670;&nbsp;</a></span>sfr_check_connections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_check_connections </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to check connection data for a SFR package. This method also creates the tables used to print input data, if this option in enabled in the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l04163">4163</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;      <span class="keywordtype">character (len= 5)</span> :: crch</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;      <span class="keywordtype">character (len= 5)</span> :: crch2</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nc</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ifound</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: maxconn</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ntabcol</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;      <span class="comment">! -- create input table for reach connections data</span></div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        <span class="comment">! -- calculate the maximum number of connections</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        maxconn = 0</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;          maxconn = max(maxconn, this%nconnreach(n))</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;        ntabcol = 1 + maxconn</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) STATIC REACH CONNECTION DATA&#39;</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(this%maxbound, ntabcol, this%iout)</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;        text = <span class="stringliteral">&#39;REACH&#39;</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;        <span class="keywordflow">do</span> n = 1, maxconn</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;          <span class="keyword">write</span>(text, <span class="stringliteral">&#39;(a,1x,i6)&#39;</span>) <span class="stringliteral">&#39;CONN&#39;</span>, n</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      <span class="comment">! -- check the reach connections for simple errors</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;      <span class="comment">! -- connection check</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        <span class="keyword">write</span>(crch, <span class="stringliteral">&#39;(i5)&#39;</span>) n</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        eachconn: <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;          nn = this%ja(i)</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;          <span class="keyword">write</span>(crch2, <span class="stringliteral">&#39;(i5)&#39;</span>) nn</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;          ifound = 0</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;          connreach: <span class="keywordflow">do</span> ii = this%ia(nn) + 1, this%ia(nn+1) - 1</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;            nc = this%ja(ii)</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;            <span class="keywordflow">if</span> (nc == n) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;              ifound = 1</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;              <span class="keywordflow">exit</span> connreach</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;<span class="keywordflow">          end do</span> connreach</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;          <span class="keywordflow">if</span> (ifound /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;            errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; is connected to &#39;</span> //                    &amp;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                    <span class="stringliteral">&#39;reach &#39;</span> // crch2 // <span class="stringliteral">&#39; but reach &#39;</span> // crch2 //                &amp;</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                    <span class="stringliteral">&#39; is not connected to reach &#39;</span> // crch // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="keywordflow">        end do</span> eachconn</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;        <span class="comment">! -- write connection data to the table</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;          <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%ja(i))</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;          nn = maxconn - this%nconnreach(n)</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;          <span class="keywordflow">do</span> i = 1, nn</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      <span class="comment">! -- check for incorrect connections between upstream connections</span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;      <span class="comment">! -- check upstream connections for each reach</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;      ierr = 0</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        <span class="keyword">write</span>(crch, <span class="stringliteral">&#39;(i5)&#39;</span>) n</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;        eachconnv: <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n + 1) - 1</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;          <span class="comment">! -- skip downstream connections</span></div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &lt; 0) cycle eachconnv</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;          nn = this%ja(i)</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;          <span class="keyword">write</span>(crch2, <span class="stringliteral">&#39;(i5)&#39;</span>) nn</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;          connreachv: <span class="keywordflow">do</span> ii = this%ia(nn) + 1, this%ia(nn+1) - 1</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;            <span class="comment">! -- skip downstream connections</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;            <span class="keywordflow">if</span> (this%idir(ii) &lt; 0) cycle connreachv</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;            nc = this%ja(ii)</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            <span class="comment">! -- if nc == n then that means reach n is an upstream connection for</span></div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;            <span class="comment">!    reach nn and reach nn is an upstream connection for reach n</span></div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;            <span class="keywordflow">if</span> (nc == n) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;              ierr = ierr + 1</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;              errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; is connected to &#39;</span> //                  &amp;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                      <span class="stringliteral">&#39;reach &#39;</span> // crch2 // <span class="stringliteral">&#39; but streamflow from reach &#39;</span> //       &amp;</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                      crch // <span class="stringliteral">&#39; to reach &#39;</span> // crch2 // <span class="stringliteral">&#39; is not permitted.&#39;</span></div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;              <span class="keywordflow">exit</span> connreachv</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;<span class="keywordflow">          end do</span> connreachv</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;<span class="keywordflow">        end do</span> eachconnv</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;      <span class="comment">! -- terminate if connectivity errors</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <span class="comment">! -- check that downstream reaches for a reach are</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;      <span class="comment">!    the upstream reaches for the reach</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        <span class="keyword">write</span>(crch, <span class="stringliteral">&#39;(i5)&#39;</span>) n</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;        eachconnds: <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;          nn = this%ja(i)</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle eachconnds</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;          <span class="keyword">write</span>(crch2, <span class="stringliteral">&#39;(i5)&#39;</span>) nn</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;          ifound = 0</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;          connreachds: <span class="keywordflow">do</span> ii = this%ia(nn) + 1, this%ia(nn+1) - 1</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;            nc = this%ja(ii)</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;            <span class="keywordflow">if</span> (nc == n) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;              <span class="keywordflow">if</span> (this%idir(i) /= this%idir(ii)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                ifound = 1</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;              <span class="keywordflow">exit</span> connreachds</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;<span class="keywordflow">          end do</span> connreachds</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;          <span class="keywordflow">if</span> (ifound /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;            errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; downstream connected reach &#39;</span> //         &amp;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                    <span class="stringliteral">&#39;is reach &#39;</span> // crch2 // <span class="stringliteral">&#39; but reach &#39;</span> // crch // <span class="stringliteral">&#39; is not&#39;</span> // &amp;</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                    <span class="stringliteral">&#39; the upstream connected reach for reach &#39;</span> // crch2 // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;<span class="keywordflow">        end do</span> eachconnds</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      <span class="comment">! -- create input table for upstream and downstream connections</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;        <span class="comment">! -- calculate the maximum number of upstream connections</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;        maxconn = 0</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;          ii = 0</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;          <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;            <span class="keywordflow">if</span> (this%idir(i) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;              ii = ii + 1</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;          maxconn = max(maxconn, ii)</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;        ntabcol = 1 + maxconn</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) STATIC UPSTREAM REACH &#39;</span> //           &amp;</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;                <span class="stringliteral">&#39;CONNECTION DATA&#39;</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(this%maxbound, ntabcol, this%iout)</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;        text = <span class="stringliteral">&#39;REACH&#39;</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;        <span class="keywordflow">do</span> n = 1, maxconn</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;          <span class="keyword">write</span>(text, <span class="stringliteral">&#39;(a,1x,i6)&#39;</span>) <span class="stringliteral">&#39;UPSTREAM CONN&#39;</span>, n</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;        <span class="comment">! -- upstream connection data</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;          ii = 0</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;          <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;            <span class="keywordflow">if</span> (this%idir(i) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(this%ja(i))</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;              ii = ii + 1</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;          nn = maxconn - ii</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;          <span class="keywordflow">do</span> i = 1, nn</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;<span class="keywordflow">          end do</span>  </div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        <span class="comment">! -- calculate the maximum number of downstream connections</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;        maxconn = 0</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;          ii = 0</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;          <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;            <span class="keywordflow">if</span> (this%idir(i) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;              ii = ii + 1</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;          maxconn = max(maxconn, ii)</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;        ntabcol = 1 + maxconn</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;        <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) STATIC DOWNSTREAM &#39;</span> //               &amp;</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;                <span class="stringliteral">&#39;REACH CONNECTION DATA&#39;</span></div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(this%maxbound, ntabcol, this%iout)</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;        text = <span class="stringliteral">&#39;REACH&#39;</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;        <span class="keywordflow">do</span> n = 1, maxconn</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;          <span class="keyword">write</span>(text, <span class="stringliteral">&#39;(a,1x,i6)&#39;</span>) <span class="stringliteral">&#39;DOWNSTREAM CONN&#39;</span>, n</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;        <span class="comment">! -- downstream connection data</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;          ii = 0</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;          <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;            <span class="keywordflow">if</span> (this%idir(i) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;              <span class="keyword">call </span>this%inputtab%add_term(this%ja(i))</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;              ii = ii + 1</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;          nn = maxconn - ii</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;          <span class="keywordflow">do</span> i = 1, nn</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="keywordflow">          end do</span>  </div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a72ae02795191b6875226f19aebd056ad_cgraph.png" border="0" usemap="#namespacesfrmodule_a72ae02795191b6875226f19aebd056ad_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a72ae02795191b6875226f19aebd056ad_cgraph" id="namespacesfrmodule_a72ae02795191b6875226f19aebd056ad_cgraph">
<area shape="rect" title="Check connection data." alt="" coords="5,61,164,102"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="212,17,396,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="217,68,391,95"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="222,119,386,145"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="444,68,583,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="631,27,799,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="631,93,799,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="847,5,1041,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="860,57,1028,98"/>
</map>
</div>

</div>
</div>
<a id="a4d8c519f90b35fd498f1006b22267c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d8c519f90b35fd498f1006b22267c2c">&#9670;&nbsp;</a></span>sfr_check_diversions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_check_diversions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to check diversion data for a SFR package. This method also creates the tables used to print input data, if this option in enabled in the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l04403">4403</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;      <span class="keywordtype">character (len= 5)</span> :: crch</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      <span class="keywordtype">character (len= 5)</span> :: cdiv</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      <span class="keywordtype">character (len= 5)</span> :: crch2</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cprior</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: maxdiv</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nc</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idiv</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ifound</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jpos</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <span class="comment">! -- format</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;  10  <span class="keyword">format</span>(<span class="stringliteral">&#39;Diversion &#39;</span>,i0,<span class="stringliteral">&#39; of reach &#39;</span>,i0,                                      &amp;</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;            <span class="stringliteral">&#39; is invalid or has not been defined.&#39;</span>)</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;      <span class="comment">! -- write header</span></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;        <span class="comment">! -- determine the maximum number of diversions</span></div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;        maxdiv = 0</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;          maxdiv = maxdiv + this%ndiv(n)</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;        <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) REACH DIVERSION DATA&#39;</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(maxdiv, 4, this%iout)</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;        text = <span class="stringliteral">&#39;REACH&#39;</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;        text = <span class="stringliteral">&#39;DIVERSION&#39;</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;        text = <span class="stringliteral">&#39;REACH 2&#39;</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;        text = <span class="stringliteral">&#39;CPRIOR&#39;</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;      <span class="comment">! -- check that diversion data are correct</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;        <span class="keywordflow">if</span> (this%ndiv(n) &lt; 1) cycle</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;        <span class="keyword">write</span>(crch, <span class="stringliteral">&#39;(i5)&#39;</span>) n</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;        </div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;        <span class="keywordflow">do</span> idiv = 1, this%ndiv(n)</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;          <span class="comment">! -- determine diversion index</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;          jpos = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;          <span class="comment">! -- write idiv to cdiv</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;          <span class="keyword">write</span>(cdiv, <span class="stringliteral">&#39;(i5)&#39;</span>) idiv</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;          nn = this%divreach(jpos)</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;          <span class="keyword">write</span>(crch2, <span class="stringliteral">&#39;(i5)&#39;</span>) nn</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;          <span class="comment">! -- make sure diversion reach is connected to current reach</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;          ifound = 0</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;          <span class="keywordflow">if</span> (nn &lt; 1 .or. nn &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;            <span class="keyword">write</span>(errmsg,10) idiv, n</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;            cycle</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;          connreach: <span class="keywordflow">do</span> ii = this%ia(nn) + 1, this%ia(nn+1) - 1</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;            nc = this%ja(ii)</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;            <span class="keywordflow">if</span> (nc == n) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;              <span class="keywordflow">if</span> (this%idir(ii) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;                ifound = 1</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;              <span class="keywordflow">exit</span> connreach</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;<span class="keywordflow">          end do</span> connreach</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;          <span class="keywordflow">if</span> (ifound /= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;            errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; is not a upstream reach for &#39;</span> //        &amp;</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;                    <span class="stringliteral">&#39;reach &#39;</span> // crch2 // <span class="stringliteral">&#39; as a result diversion &#39;</span> // cdiv //     &amp;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;                    <span class="stringliteral">&#39; from reach &#39;</span> // crch //<span class="stringliteral">&#39; to reach &#39;</span> // crch2 //             &amp;</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;                    <span class="stringliteral">&#39; is not possible. Check reach connectivity.&#39;</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;          <span class="comment">! -- iprior</span></div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;          cprior = this%divcprior(jpos)</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;          <span class="comment">! -- add terms to the table</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;          <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(idiv)</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(nn)</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(cprior)</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a4d8c519f90b35fd498f1006b22267c2c_cgraph.png" border="0" usemap="#namespacesfrmodule_a4d8c519f90b35fd498f1006b22267c2c_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a4d8c519f90b35fd498f1006b22267c2c_cgraph" id="namespacesfrmodule_a4d8c519f90b35fd498f1006b22267c2c_cgraph">
<area shape="rect" title="Check diversions data." alt="" coords="5,86,164,127"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="212,68,387,95"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="217,119,381,145"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,68,573,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,27,789,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,93,789,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,5,1032,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,57,1019,98"/>
</map>
</div>

</div>
</div>
<a id="a982f769cc3bd67789b08e3823384cafd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982f769cc3bd67789b08e3823384cafd">&#9670;&nbsp;</a></span>sfr_check_reaches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_check_reaches </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to check specified data for a SFR package. This method also creates the tables used to print input data, if this option in enabled in the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l04040">4040</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">   !&lt; SfrType object</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;      <span class="keywordtype">character (len= 5)</span> :: crch</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cval</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;      <span class="keywordtype">character (len=30)</span> :: nodestr</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nn</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;<span class="keywordtype">      real</span>(DP) :: btgwf</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;<span class="keywordtype">      real</span>(DP) :: bt</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      <span class="comment">! -- setup inputtab tableobj</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) STATIC REACH DATA&#39;</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(this%maxbound, 10, this%iout)</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;        text = <span class="stringliteral">&#39;NUMBER&#39;</span></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;        text = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        text = <span class="stringliteral">&#39;LENGTH&#39;</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;        text = <span class="stringliteral">&#39;WIDTH&#39;</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        text = <span class="stringliteral">&#39;SLOPE&#39;</span> </div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;        text = <span class="stringliteral">&#39;TOP&#39;</span></div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;        text = <span class="stringliteral">&#39;THICKNESS&#39;</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;        text = <span class="stringliteral">&#39;HK&#39;</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        text = <span class="stringliteral">&#39;ROUGHNESS&#39;</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;        text = <span class="stringliteral">&#39;UPSTREAM FRACTION&#39;</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      <span class="comment">! -- check the reach data for simple errors</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;        <span class="keyword">write</span>(crch, <span class="stringliteral">&#39;(i5)&#39;</span>) n</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;        nn = this%igwfnode(n)</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;        <span class="keywordflow">if</span> (nn &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;          btgwf = this%dis%bot(nn)</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;          <span class="keyword">call </span>this%dis%noder_to_string(nn, nodestr)</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;          nodestr = <span class="stringliteral">&#39;none&#39;</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        <span class="comment">! -- check reach length</span></div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;        <span class="keywordflow">if</span> (this%length(n) &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;          errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; length must be greater than 0.0.&#39;</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;        <span class="comment">! -- check reach width</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;        <span class="keywordflow">if</span> (this%width(n) &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;          errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; width must be greater than 0.0.&#39;</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;        <span class="comment">! -- check reach slope</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;        <span class="keywordflow">if</span> (this%slope(n) &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;          errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; slope must be greater than 0.0.&#39;</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;        <span class="comment">! -- check bed thickness and bed hk for reaches connected to GWF</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;        <span class="keywordflow">if</span> (nn &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;          bt = this%strtop(n) - this%bthick(n)</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;          <span class="keywordflow">if</span> (bt &lt;= btgwf .and. this%icheck /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;            <span class="keyword">write</span>(cval,<span class="stringliteral">&#39;(f10.4)&#39;</span>) bt</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;            errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; bed bottom (rtp-rbth =&#39;</span> //              &amp;</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                    cval // <span class="stringliteral">&#39;) must be greater than the bottom of cell (&#39;</span> //      &amp;</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                    nodestr</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;            <span class="keyword">write</span>(cval,<span class="stringliteral">&#39;(f10.4)&#39;</span>) btgwf</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;            errmsg = trim(adjustl(errmsg)) // <span class="stringliteral">&#39;=&#39;</span> // cval // <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;          <span class="keywordflow">if</span> (this%hk(n) &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;            errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; hk must be greater than or equal to 0.0.&#39;</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;        <span class="comment">! -- check reach roughness</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;        <span class="keywordflow">if</span> (this%rough(n) &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;          errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&quot; Manning&#39;s roughness &quot;</span> //                  &amp;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;                  <span class="stringliteral">&#39;coefficient must be greater than 0.0.&#39;</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;        <span class="comment">! -- check reach upstream fraction</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;        <span class="keywordflow">if</span> (this%ustrf(n) &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;          errmsg = <span class="stringliteral">&#39;Reach &#39;</span> // crch // <span class="stringliteral">&#39; upstream fraction must be greater &#39;</span> //    &amp;</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                  <span class="stringliteral">&#39;than or equal to 0.0.&#39;</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        <span class="comment">! -- write summary of reach information</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(nodestr)</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%length(n))</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%width(n))</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%slope(n))</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%strtop(n))</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%bthick(n))</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%hk(n))</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%rough(n))</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(this%ustrf(n))</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a982f769cc3bd67789b08e3823384cafd_cgraph.png" border="0" usemap="#namespacesfrmodule_a982f769cc3bd67789b08e3823384cafd_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a982f769cc3bd67789b08e3823384cafd_cgraph" id="namespacesfrmodule_a982f769cc3bd67789b08e3823384cafd_cgraph">
<area shape="rect" title="Check reach data." alt="" coords="5,86,164,127"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="212,68,387,95"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="217,119,381,145"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,68,573,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,27,789,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,93,789,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,5,1032,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,57,1019,98"/>
</map>
</div>

</div>
</div>
<a id="a341aafee87310288ad4e23da535d9a27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341aafee87310288ad4e23da535d9a27">&#9670;&nbsp;</a></span>sfr_check_ustrf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_check_ustrf </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to check upstream fraction data for a SFR package. This method also creates the tables used to print input data, if this option in enabled in the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l04514">4514</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      <span class="keywordtype">logical</span> :: lcycle</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;      <span class="keywordtype">logical</span> :: ladd</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;      <span class="keywordtype">character (len=5)</span> :: crch</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;      <span class="keywordtype">character (len=5)</span> :: crch2</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cval</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: maxcols</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: npairs</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ipair</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idiv</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i1</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jpos</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ids</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;<span class="keywordtype">      real</span>(DP) :: f</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;<span class="keywordtype">      real</span>(DP) :: rval</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      <span class="comment">! -- write table header</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;        <span class="comment">! -- determine the maximum number of columns</span></div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;        npairs = 0</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;          ipair = 0</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;          ec: <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;            <span class="comment">! -- skip upstream connections</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;            <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle ec</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;            n2 = this%ja(i)</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;            <span class="comment">! -- skip inactive downstream reaches</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;            <span class="keywordflow">if</span> (this%iboundpak(n2) == 0) cycle ec</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;            <span class="comment">! -- increment ipair and see if it exceeds npairs</span></div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;            ipair = ipair + 1</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;            npairs = max(npairs, ipair)</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;<span class="keywordflow">          end do</span> ec</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;        maxcols = 1 + npairs * 2</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;        <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) CONNECTED REACH UPSTREAM &#39;</span>        // &amp;</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;                <span class="stringliteral">&#39;FRACTION DATA&#39;</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;        <span class="keyword">call </span>this%inputtab%table_df(this%maxbound, maxcols, this%iout)</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;        text = <span class="stringliteral">&#39;REACH&#39;</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;        <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;        <span class="keywordflow">do</span> i = 1, npairs</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;          <span class="keyword">write</span>(cval, <span class="stringliteral">&#39;(i10)&#39;</span>) i</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;          text = <span class="stringliteral">&#39;DOWNSTREAM REACH &#39;</span> // trim(adjustl(cval)) </div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;          text = <span class="stringliteral">&#39;FRACTION &#39;</span> // trim(adjustl(cval)) </div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      <span class="comment">! -- fill diversion number for each connection</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;        <span class="keywordflow">do</span> idiv = 1, this%ndiv(n)</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;          i0 = this%iadiv(n)</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;          i1 = this%iadiv(n+1) - 1</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;          <span class="keywordflow">do</span> jpos = i0, i1 </div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;            <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;              n2 = this%ja(i)</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;              <span class="keywordflow">if</span> (this%divreach(jpos) == n2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                this%idiv(i) = jpos - i0 + 1</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;                <span class="keywordflow">exit</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;<span class="keywordflow">              end if</span> </div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;      <span class="comment">! -- check that the upstream fraction for reach connected by</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      <span class="comment">!    a diversion is zero</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;        <span class="comment">! -- determine the number of downstream reaches</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;        ids = 0</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;            ids = ids + 1</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        <span class="comment">! -- evaluate the diversions</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;        <span class="keywordflow">do</span> idiv = 1, this%ndiv(n)</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;          jpos = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;          n2 = this%divreach(jpos)</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;          f = this%ustrf(n2)</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;          <span class="keywordflow">if</span> (f /= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,2(1x,i0,1x,a),1x,a,g0,a,2(1x,a))&#39;</span>)                   &amp;</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;              <span class="stringliteral">&#39;Reach&#39;</span>, n, <span class="stringliteral">&#39;is connected to reach&#39;</span>, n2, <span class="stringliteral">&#39;by a diversion&#39;</span>,           &amp;</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;              <span class="stringliteral">&#39;but the upstream fraction is not equal to zero (&#39;</span>, f, <span class="stringliteral">&#39;). Check&#39;</span>,   &amp;</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;              trim(this%packName), <span class="stringliteral">&#39;package diversion and package data.&#39;</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;            <span class="keywordflow">if</span> (ids &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;              <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a,3(1x,a))&#39;</span>)                                        &amp;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                trim(warnmsg), <span class="stringliteral">&#39;A warning instead of an error is issued because&#39;</span>,  &amp;</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                <span class="stringliteral">&#39;the reach is only connected to the diversion reach in the &#39;</span>,      &amp;</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                <span class="stringliteral">&#39;downstream direction.&#39;</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;              <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      <span class="comment">! -- calculate the total fraction of connected reaches that are</span></div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;      <span class="comment">!    not diversions and check that the sum of upstream fractions</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      <span class="comment">!    is equal to 1 for each reach</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;        ids = 0</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;        rval = dzero</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;        f = dzero</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;        <span class="keyword">write</span>(crch, <span class="stringliteral">&#39;(i5)&#39;</span>) n</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;          <span class="keyword">call </span>this%inputtab%add_term(n)</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;        ipair = 0</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;        eachconn: <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;          lcycle = .false.</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;          <span class="comment">! -- initialize downstream connection q</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;          this%qconn(i) = dzero</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;          <span class="comment">! -- skip upstream connections</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;            lcycle = .true.</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;          n2 = this%ja(i)</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;          <span class="comment">! -- skip inactive downstream reaches</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;          <span class="keywordflow">if</span> (this%iboundpak(n2) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;            lcycle = .true.</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;          <span class="keywordflow">if</span> (lcycle) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;            cycle eachconn</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;          ipair = ipair + 1</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;          <span class="keyword">write</span>(crch2, <span class="stringliteral">&#39;(i5)&#39;</span>) n2</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;          ids = ids + 1</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;          ladd = .true.</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;          f = f + this%ustrf(n2)</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;          <span class="keyword">write</span>(cval, <span class="stringliteral">&#39;(f10.4)&#39;</span>) this%ustrf(n2)</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;          <span class="comment">! -- write upstream fractions</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;          <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(n2)</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(this%ustrf(n2))</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;          eachdiv: <span class="keywordflow">do</span> idiv = 1, this%ndiv(n)</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;            jpos = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;            <span class="keywordflow">if</span> (this%divreach(jpos) == n2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;              ladd = .false.</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;              <span class="keywordflow">exit</span> eachdiv</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;<span class="keywordflow">          end do</span> eachdiv</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;          <span class="keywordflow">if</span> (ladd) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;            rval = rval + this%ustrf(n2)</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;<span class="keywordflow">        end do</span> eachconn</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        this%ftotnd(n) = rval</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        <span class="comment">! -- write remaining table columns</span></div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;          ipair = ipair + 1</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;          <span class="keywordflow">do</span> i = ipair, npairs</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39;  &#39;</span>)</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;            <span class="keyword">call </span>this%inputtab%add_term(<span class="stringliteral">&#39;  &#39;</span>)</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;        <span class="comment">! -- evaluate if an error condition has occured</span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;        <span class="comment">!    the sum of fractions is not equal to 1</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;        <span class="keywordflow">if</span> (ids /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;          <span class="keywordflow">if</span> (abs(f-done) &gt; <a class="code" href="namespaceconstantsmodule.html#aba95664cbd721a2d72df12ac8bb78da8">dem6</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,i0,1x,a,g0,a,3(1x,a))&#39;</span>)                           &amp;</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;              <span class="stringliteral">&#39;Upstream fractions for reach &#39;</span>, n, <span class="stringliteral">&#39;is not equal to one (&#39;</span>, f,      &amp;</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;              <span class="stringliteral">&#39;). Check&#39;</span>, trim(this%packName), <span class="stringliteral">&#39;package reach connectivity and&#39;</span>,       &amp;</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;              <span class="stringliteral">&#39;package data.&#39;</span></div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a341aafee87310288ad4e23da535d9a27_cgraph.png" border="0" usemap="#namespacesfrmodule_a341aafee87310288ad4e23da535d9a27_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a341aafee87310288ad4e23da535d9a27_cgraph" id="namespacesfrmodule_a341aafee87310288ad4e23da535d9a27_cgraph">
<area shape="rect" title="Check upstream fraction data." alt="" coords="5,111,164,153"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="222,68,397,95"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title="Store warning message." alt="" coords="212,119,407,145"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="227,169,391,196"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="455,68,593,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="641,27,809,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="641,93,809,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="857,5,1052,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="871,57,1039,98"/>
</map>
</div>

</div>
</div>
<a id="a1cecc4054c571877f6b14d2beaab7356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cecc4054c571877f6b14d2beaab7356">&#9670;&nbsp;</a></span>sfr_cq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_cq </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>iadv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the flow between connected SFR package control volumes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>current dependent-variable value </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iadv</td><td>flag that indicates if this is an advance package </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02148">2148</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a07b5a678851f1bbbca15c9c058818e28">ulasav</a>, <a class="code" href="namespaceinputoutputmodule.html#acbfe2090f8aa18049afae5fa4fca29a9">ubdsv06</a></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbudgetmodule_1_1budgettype.html">budgettype</a></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keywordtype">class</span>(SfrType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">                         !&lt; SfrType object</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: x<span class="comment">                       !&lt; current dependent-variable value</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">   !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: iadv<span class="comment">                    !&lt; flag that indicates if this is an advance package</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="keywordtype">      real</span>(DP) :: qext</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="comment">! -- for budget</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="keywordtype">      real</span>(DP) :: qoutflow</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="keywordtype">      real</span>(DP) :: qfrommvr</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="keywordtype">      real</span>(DP) :: qtomvr</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="comment">! -- call base functionality in bnd_cq.  This will calculate sfr-gwf flows</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="comment">!    and put them into this%simvals</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keyword">call </span>this%BndType%bnd_cq(x, flowja, iadv=1)</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="comment">! -- Calculate qextoutflow and qoutflow for subsequent budgets</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="comment">! -- mover</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        qfrommvr = dzero</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        qtomvr = dzero</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;          qfrommvr = this%pakmvrobj%get_qfrommvr(n)</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;          qtomvr = this%pakmvrobj%get_qtomvr(n)</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;          <span class="keywordflow">if</span> (qtomvr &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;            qtomvr = -qtomvr</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="comment">! -- external downstream stream flow</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        qext = this%dsflow(n)</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        qoutflow = dzero</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="keywordflow">if</span> (qext &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;          qext = -qext</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;          qext = dzero</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <span class="comment">! -- adjust external downstream stream flow using qtomvr</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <span class="keywordflow">if</span> (qext &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;          <span class="keywordflow">if</span> (qtomvr &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            qext = qext - qtomvr</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;          qoutflow = this%dsflow(n)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;          <span class="keywordflow">if</span> (qoutflow &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            qoutflow = -qoutflow</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="comment">! -- set qextoutflow and qoutflow for cell by cell budget</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="comment">!    output and observations</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        this%qextoutflow(n) = qext</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        this%qoutflow(n) = qoutflow</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <span class="comment">! -- fill the budget object</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keyword">call </span>this%sfr_fill_budobj()</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a1cecc4054c571877f6b14d2beaab7356_cgraph.png" border="0" usemap="#namespacesfrmodule_a1cecc4054c571877f6b14d2beaab7356_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a1cecc4054c571877f6b14d2beaab7356_cgraph" id="namespacesfrmodule_a1cecc4054c571877f6b14d2beaab7356_cgraph">
<area shape="rect" title="@ brief Calculate package flows." alt="" coords="5,46,140,73"/>
<area shape="rect" href="namespaceinputoutputmodule.html#acbfe2090f8aa18049afae5fa4fca29a9" title=" " alt="" coords="188,5,343,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a07b5a678851f1bbbca15c9c058818e28" title=" " alt="" coords="188,71,343,112"/>
</map>
</div>

</div>
</div>
<a id="a64718b1d9b7025a4763ed4e29ce34578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64718b1d9b7025a4763ed4e29ce34578">&#9670;&nbsp;</a></span>sfr_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public sfrmodule::sfr_create </td>
          <td>(</td>
          <td class="paramtype">class(bndtype), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibcnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>namemodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>pakname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new SFR Package object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">packobj</td><td>pointer to default package type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>package id </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibcnum</td><td>boundary condition number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunit</td><td>unit number of SFR package input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>unit number of model listing file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">namemodel</td><td>model name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pakname</td><td>package name </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00217">217</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememoryhelpermodule.html">memoryhelpermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj<span class="comment">           !&lt; pointer to default package type</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: id<span class="comment">                !&lt; package id</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: ibcnum<span class="comment">            !&lt; boundary condition number</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: inunit<span class="comment">            !&lt; unit number of SFR package input file</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordtype">integer(I4B)</span>,<span class="keywordtype">intent(in)</span> :: iout<span class="comment">              !&lt; unit number of model listing file</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: namemodel<span class="comment">    !&lt; model name</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: pakname<span class="comment">      !&lt; package name</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordtype">type</span>(SfrType), <span class="keywordtype">pointer</span> :: sfrobj</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">! -- allocate the object and assign values to object variables</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">allocate</span>(sfrobj)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      packobj =&gt; sfrobj</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">! -- create name and memory path</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keyword">call </span>packobj%set_names(ibcnum, namemodel, pakname, ftype)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      packobj%text = text</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">! -- allocate scalars</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">call </span>sfrobj%sfr_allocate_scalars()</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">! -- initialize package</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keyword">call </span>packobj%pack_initialize()</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      packobj%inunit = inunit</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      packobj%iout = iout</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      packobj%id = id</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      packobj%ibcnum = ibcnum</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      packobj%ncolbnd = 4</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      packobj%iscloc = 0  <span class="comment">! not supported</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      packobj%isadvpak = 1</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      packobj%ictMemPath = <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a>(namemodel,<span class="stringliteral">&#39;NPF&#39;</span>)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_cgraph.png" border="0" usemap="#namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_cgraph" id="namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_cgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="5,68,167,95"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738" title="returns the path to the memory object" alt="" coords="215,61,381,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="429,61,596,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="644,68,819,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="867,68,1005,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1053,27,1221,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="1053,93,1221,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1269,5,1464,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1283,57,1451,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_icgraph.png" border="0" usemap="#namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_icgraph" alt=""/></div>
<map name="namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_icgraph" id="namespacesfrmodule_a64718b1d9b7025a4763ed4e29ce34578_icgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="211,13,372,39"/>
<area shape="rect" href="namespacegwfmodule.html#a9fc339c6daad0503d34ef42f994a98ec" title=" " alt="" coords="5,5,163,47"/>
</map>
</div>

</div>
</div>
<a id="a2df712db96a8dca145df5d98736db677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2df712db96a8dca145df5d98736db677">&#9670;&nbsp;</a></span>sfr_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate SFR package scalars and arrays. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02406">2406</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">   !&lt; SfrType object</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <span class="comment">! -- deallocate arrays</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%qoutflow)</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%qextoutflow)</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <span class="keyword">deallocate</span>(this%csfrbudget)</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sfrname, <span class="stringliteral">&#39;SFRNAME&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dbuff)</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <span class="keyword">deallocate</span>(this%cauxcbc)</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%qauxcbc)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iboundpak)</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%igwfnode)</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%igwftopnode)</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%length)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%width)</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%strtop)</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%bthick)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%hk)</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%slope)</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nconnreach)</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ustrf)</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ftotnd)</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%usflow)</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dsflow)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%depth)</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%stage)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%gwflow)</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%simevap)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%simrunoff)</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%stage0)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%usflow0)</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%denseterms)</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="comment">! -- deallocate connection data</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ia)</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ja)</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idir)</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idiv)</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%qconn)</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      <span class="comment">! -- deallocate boundary data</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rough)</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rain)</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%evap)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%inflow)</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%runoff)</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sstage)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <span class="comment">! -- deallocate aux variables</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%rauxvar)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="comment">! -- deallocate diversion variables</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iadiv)</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%divreach)</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%divcprior)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        <span class="keyword">deallocate</span>(this%divcprior)</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%divflow)</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%divq)</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ndiv)</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <span class="comment">! -- deallocate cross-section data</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ncrosspts)</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iacross)</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%station)</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%xsdepths)</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      <span class="comment">! -- deallocate budobj</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keyword">call </span>this%budobj%budgetobject_da()</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="keyword">deallocate</span>(this%budobj)</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <span class="keyword">nullify</span>(this%budobj)</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <span class="comment">! -- deallocate stage table</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      <span class="keywordflow">if</span> (this%iprhed &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        <span class="keyword">call </span>this%stagetab%table_da()</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        <span class="keyword">deallocate</span>(this%stagetab)</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        <span class="keyword">nullify</span>(this%stagetab)</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      <span class="comment">! -- deallocate package csv table</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      <span class="keywordflow">if</span> (this%ipakcsv &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        <span class="keyword">call </span>this%pakcsvtab%table_da()</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        <span class="keyword">deallocate</span>(this%pakcsvtab)</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keyword">nullify</span>(this%pakcsvtab)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <span class="comment">! -- deallocate scalars</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iprhed)</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%istageout)</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ibudgetout)</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ibudcsv)</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ipakcsv)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idiversions)</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%maxsfrpicard)</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%maxsfrit)</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%bditems)</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cbcauxitems)</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%unitconv)</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%dmaxchg)</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%deps)</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%nconn)</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icheck)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iconvchk)</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idense)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ianynone)</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ncrossptstot)</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keyword">nullify</span>(this%gwfiss)</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="comment">! -- call base BndType deallocate</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <span class="keyword">call </span>this%BndType%bnd_da()</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a2744b945481221fbaaf48acabd8186"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a2744b945481221fbaaf48acabd8186">&#9670;&nbsp;</a></span>sfr_df_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_df_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to define the observation types available in the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02584">2584</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: indx</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      <span class="comment">!    for stage observation type.</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;stage&#39;</span>, .false., indx)</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="comment">!    for inflow observation type.</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;inflow&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      <span class="comment">!    for inflow observation type.</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;ext-inflow&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="comment">!    for rainfall observation type.</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;rainfall&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;      <span class="comment">!    for runoff observation type.</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;runoff&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="comment">!    for evaporation observation type.</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;evaporation&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="comment">!    for outflow observation type.</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;outflow&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <span class="comment">!    for ext-outflow observation type.</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;ext-outflow&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      <span class="comment">!    for to-mvr observation type.</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;to-mvr&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      <span class="comment">!    for sfr-frommvr observation type.</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;from-mvr&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      <span class="comment">!    for sfr observation type.</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;sfr&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <span class="comment">!    for upstream flow observation type.</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;upstream-flow&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <span class="comment">!    for downstream flow observation type.</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;downstream-flow&#39;</span>, .true., indx)</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <span class="comment">!    for depth observation type.</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;depth&#39;</span>, .false., indx)</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;      <span class="comment">!    for wetted-perimeter observation type.</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;wet-perimeter&#39;</span>, .false., indx)</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <span class="comment">!    for wetted-area observation type.</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;wet-area&#39;</span>, .false., indx)</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <span class="comment">!    for wetted-width observation type.</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;wet-width&#39;</span>, .false., indx)</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;      this%obs%obsData(indx)%ProcessIdPtr =&gt; sfr_process_obsid</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a6a2744b945481221fbaaf48acabd8186_cgraph.png" border="0" usemap="#namespacesfrmodule_a6a2744b945481221fbaaf48acabd8186_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a6a2744b945481221fbaaf48acabd8186_cgraph" id="namespacesfrmodule_a6a2744b945481221fbaaf48acabd8186_cgraph">
<area shape="rect" title="Define the observation types available in the package." alt="" coords="5,65,168,91"/>
<area shape="rect" href="namespacesfrmodule.html#a685d2a55b16bd60a12a2aaedbea9d620" title="Process observation IDs for a package." alt="" coords="216,57,387,99"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a2f708dffa1b89bf951c41031434cc724" title=" " alt="" coords="435,57,639,99"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="687,24,841,65"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title=" " alt="" coords="687,89,841,131"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title=" " alt="" coords="915,5,1070,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1560,64,1728,105"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="905,122,1080,149"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="889,173,1096,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="1144,151,1283,178"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1331,123,1499,164"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="1331,188,1499,229"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1547,130,1741,157"/>
</map>
</div>

</div>
</div>
<a id="ad15971981bf4723e1f9b2af0280fa884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad15971981bf4723e1f9b2af0280fa884">&#9670;&nbsp;</a></span>sfr_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add the hcof and rhs terms for the SFR package to the coefficient matrix and right-hand side vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia</td><td>solution CRS row pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01842">1842</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">                             !&lt; SfrType object</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">       !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ia<span class="comment">       !&lt; solution CRS row pointers</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: idxglo<span class="comment">   !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">   !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ipos</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="keywordtype">      real</span>(DP) :: s0</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="keywordtype">      real</span>(DP) :: ds</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="keywordtype">      real</span>(DP) :: dsmax</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="keywordtype">      real</span>(DP) :: hgwf</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="keywordtype">      real</span>(DP) :: v</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="keywordtype">      real</span>(DP) :: hhcof</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="keywordtype">      real</span>(DP) :: rrhs</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="comment">! -- picard iterations for sfr to achieve good solution regardless</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="comment">!    of reach order</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      sfrpicard: <span class="keywordflow">do</span> i = 1, this%maxsfrpicard</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="comment">! -- initialize maximum stage change for iteration to zero</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        dsmax = dzero</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        <span class="comment">! -- pakmvrobj fc - reset qformvr to zero</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="keywordflow">if</span>(this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;          <span class="keyword">call </span>this%pakmvrobj%fc()</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="comment">! -- solve for each sfr reach</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        reachsolve: <span class="keywordflow">do</span> n = 1, this%nbound</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;          node = this%igwfnode(n)</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            hgwf = this%xnew(node)</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            hgwf = dep20</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;          <span class="comment">! -- save previous stage and upstream flow</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;          <span class="keywordflow">if</span> (i == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            this%stage0(n) = this%stage(n)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            this%usflow0(n) = this%usflow(n)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;          <span class="comment">! -- set initial stage to calculate stage change</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;          s0 = this%stage(n)</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;          <span class="comment">! -- solve for flow in swr</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;          <span class="keywordflow">if</span> (this%iboundpak(n) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            <span class="keyword">call </span>this%sfr_solve(n, hgwf, hhcof, rrhs)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            this%depth(n) = dzero</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            this%stage(n) = this%strtop(n)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            v = dzero</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <span class="keyword">call </span>this%sfr_update_flows(n, v, v)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            hhcof = dzero</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            rrhs = dzero</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;          <span class="comment">! -- set package hcof and rhs</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;          this%hcof(n) = hhcof</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;          this%rhs(n) = rrhs</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;          <span class="comment">! -- calculate stage change</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;          ds = s0 - this%stage(n)</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;          <span class="comment">! -- evaluate if stage change exceeds dsmax</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;          <span class="keywordflow">if</span> (abs(ds) &gt; abs(dsmax)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            dsmax = ds</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;          </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="keywordflow">        end do</span> reachsolve</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="comment">! -- evaluate if the sfr picard iterations should be terminated</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="keywordflow">if</span> (abs(dsmax) &lt;= this%dmaxchg) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;          <span class="keywordflow">exit</span> sfrpicard</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="keywordflow">      end do</span> sfrpicard</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="comment">! -- Copy package rhs and hcof into solution rhs and amat</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <span class="keywordflow">do</span> n = 1, this%nbound</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        node = this%nodelist(n)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keywordflow">if</span> (node &lt; 1) cycle</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        rhs(node) = rhs(node) + this%rhs(n)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        ipos = ia(node)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        amatsln(idxglo(ipos)) = amatsln(idxglo(ipos)) + this%hcof(n)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4b629c40e77f49df978c81616ec873c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b629c40e77f49df978c81616ec873c">&#9670;&nbsp;</a></span>sfr_fill_budobj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_fill_budobj </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to copy flows into the budget object that stores all the sfr flows The terms listed here must correspond in number and order to the ones added in the sfr_setup_budobj method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l04940">4940</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n1</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idx</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idiv</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jpos</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;<span class="keywordtype">      real</span>(DP) :: q</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;<span class="keywordtype">      real</span>(DP) :: qt</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;<span class="keywordtype">      real</span>(DP) :: d</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;<span class="keywordtype">      real</span>(DP) :: ca</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;<span class="keywordtype">      real</span>(DP) :: a</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;      <span class="comment">! -- initialize counter</span></div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      idx = 0</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <span class="comment">! -- FLOW JA FACE</span></div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%nconn)</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;        n1 = n</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;          n2 = this%ja(i)</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;          <span class="comment">! flow to downstream reaches</span></div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;            qt = this%dsflow(n)</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;            q = -this%qconn(i)</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;          <span class="comment">! flow from upstream reaches</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;            qt = this%usflow(n)</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;            <span class="keywordflow">do</span> ii = this%ia(n2) + 1, this%ia(n2+1) - 1</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;              <span class="keywordflow">if</span> (this%idir(ii) &gt; 0) cycle</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;              <span class="keywordflow">if</span> (this%ja(ii) /= n) cycle</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;              q = this%qconn(ii)</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;              <span class="keywordflow">exit</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;          <span class="comment">! calculate flow area</span></div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;          <span class="keyword">call </span>this%sfr_calc_reach_depth(n, qt, d)</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;          ca = this%calc_area_wet(n, d)</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;          this%qauxcbc(1) = ca</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n1, n2, q, this%qauxcbc)</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;      <span class="comment">! -- GWF (LEAKAGE)</span></div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound - this%ianynone)</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;        n2 = this%igwfnode(n)</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;        <span class="keywordflow">if</span> (n2 &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;          a = this%calc_surface_area(n)</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;          this%qauxcbc(1) = a</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;          q = -this%gwflow(n)</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n2, q, this%qauxcbc)</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;      <span class="comment">! -- RAIN</span></div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;        a = this%calc_surface_area(n)</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;        q = this%rain(n) * a</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;      <span class="comment">! -- EVAPORATION</span></div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;        q = -this%simevap(n)</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;      <span class="comment">! -- RUNOFF</span></div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;        q = this%simrunoff(n)</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      <span class="comment">! -- INFLOW</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;        q = this%inflow(n)</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      <span class="comment">! -- EXTERNAL OUTFLOW</span></div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;        q = dzero</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;          idiv = this%idiv(i)</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;          <span class="keywordflow">if</span> (idiv &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;            jpos = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            q = q + this%divq(jpos)</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;            q = q + this%qconn(i)</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;        q = q - this%dsflow(n)</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;        <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;          q = q + this%pakmvrobj%get_qtomvr(n)</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      <span class="comment">! -- STORAGE</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;        q = dzero</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;        d = this%depth(n)</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;        a = this%calc_surface_area_wet(n, d)</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;        this%qauxcbc(1) = a * d</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q, this%qauxcbc)</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;      <span class="comment">! -- MOVER</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;        <span class="comment">! </span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;        <span class="comment">! -- FROM MOVER</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;        idx = idx + 1</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;          q = this%pakmvrobj%get_qfrommvr(n)</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;        <span class="comment">! -- TO MOVER</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;        idx = idx + 1</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;          q = this%pakmvrobj%get_qtomvr(n)</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;          <span class="keywordflow">if</span> (q &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;            q = -q</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q)</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;      <span class="comment">! -- AUXILIARY VARIABLES</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;      naux = this%naux</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;      <span class="keywordflow">if</span> (naux &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;        idx = idx + 1</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;          q = dzero</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n, q, this%auxvar(:, n))</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;      <span class="comment">! --Terms are filled, now accumulate them for this time step</span></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;      <span class="keyword">call </span>this%budobj%accumulate_terms()</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afec5f1ca9cd19982426b70000c431141"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afec5f1ca9cd19982426b70000c431141">&#9670;&nbsp;</a></span>sfr_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate and add the Newton-Raphson terms for the SFR package to the coefficient matrix and right-hand side vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia</td><td>solution CRS row pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01944">1944</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">                             !&lt; SfrType object</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">       !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ia<span class="comment">       !&lt; solution CRS row pointers</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: idxglo<span class="comment">   !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">   !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ipos</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="keywordtype">      real</span>(DP) :: rterm</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="keywordtype">      real</span>(DP) :: drterm</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="keywordtype">      real</span>(DP) :: rhs1</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="keywordtype">      real</span>(DP) :: hcof1</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="keywordtype">      real</span>(DP) :: q1</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="keywordtype">      real</span>(DP) :: q2</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="keywordtype">      real</span>(DP) :: hgwf</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="comment">! -- Copy package rhs and hcof into solution rhs and amat</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keywordflow">do</span> i = 1, this%nbound</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <span class="comment">! -- skip inactive reaches</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        <span class="keywordflow">if</span> (this%iboundpak(i) &lt; 1) cycle</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <span class="comment">! -- skip if reach is not connected to gwf</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        n = this%nodelist(i)</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="keywordflow">if</span> (n &lt; 1) cycle</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        ipos = ia(n)</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        rterm = this%hcof(i) * this%xnew(n)</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="comment">! -- calculate perturbed head</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        hgwf = this%xnew(n) + dem4</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keyword">call </span>this%sfr_solve(i, hgwf, hcof1, rhs1, update=.false.)</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        q1 = rhs1 - hcof1 * hgwf</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">! -- calculate unperturbed head</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        q2 = this%rhs(i) - this%hcof(i) * this%xnew(n)</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="comment">! -- calculate derivative</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        drterm = (q2 - q1) / dem4</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="comment">! -- add terms to convert conductance formulation into</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">!    newton-raphson formulation</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        amatsln(idxglo(ipos)) = amatsln(idxglo(ipos)) + drterm - this%hcof(i)</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        rhs(n) = rhs(n) - rterm + drterm * this%xnew(n)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd9d59e830cf2a82a2b2d09bd094b418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9d59e830cf2a82a2b2d09bd094b418">&#9670;&nbsp;</a></span>sfr_obs_supported()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function sfrmodule::sfr_obs_supported </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to determine if observations are supported by the SFR package. Observations are supported by the SFR package.</p>
<dl class="section return"><dt>Returns</dt><dd>sfr_obs_supported boolean indicating if observations are supported </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02567">2567</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <span class="comment">! -- set boolean</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      sfr_obs_supported = .true.</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ba3494107dd3b9909fc6dcefb4468e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba3494107dd3b9909fc6dcefb4468e9">&#9670;&nbsp;</a></span>sfr_options()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(inout)&#160;</td>
          <td class="paramname"><em>option</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>found</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read additional options for SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">option</td><td>option keyword string </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">found</td><td>boolean indicating if option found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00588">588</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceopenspecmodule.html">openspecmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordtype">class</span>(SfrType),   <span class="keywordtype">intent(inout)</span> :: this<span class="comment">    !&lt; SfrType object</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(inout)</span> :: option<span class="comment">  !&lt; option keyword string</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordtype">logical</span>,          <span class="keywordtype">intent(inout)</span> :: found<span class="comment">   !&lt; boolean indicating if option found</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordtype">      real</span>(DP) :: r</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordtype">character(len=MAXCHARLEN)</span> :: fname</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordtype">character(len=MAXCHARLEN)</span> :: keyword</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtunitconv = &amp;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="stringliteral">&quot;(4x, &#39;UNIT CONVERSION VALUE (&#39;,g0,&#39;) SPECIFIED.&#39;)&quot;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtpicard = &amp;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="stringliteral">&quot;(4x, &#39;MAXIMUM SFR PICARD ITERATION VALUE (&#39;,i0,&#39;) SPECIFIED.&#39;)&quot;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtiter = &amp;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="stringliteral">&quot;(4x, &#39;MAXIMUM SFR ITERATION VALUE (&#39;,i0,&#39;) SPECIFIED.&#39;)&quot;</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtdmaxchg = &amp;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="stringliteral">&quot;(4x, &#39;MAXIMUM DEPTH CHANGE VALUE (&#39;,g0,&#39;) SPECIFIED.&#39;)&quot;</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtsfrbin = &amp;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="stringliteral">&quot;(4x, &#39;SFR &#39;, 1x, a, 1x, &#39; WILL BE SAVED TO FILE: &#39;, a, /4x,               &amp;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39;OPENED ON UNIT: &#39;, I0)&quot;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="comment">! -- Check for SFR options</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">select case</span> (option)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRINT_STAGE&#39;</span>)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          this%iprhed = 1</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(4x,a)&#39;</span>) trim(adjustl(this%text))//          <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39; STAGES WILL BE PRINTED TO LISTING FILE.&#39;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          found = .true.</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;STAGE&#39;</span>)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            this%istageout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%istageout, this%iout, fname, <span class="stringliteral">&#39;DATA(BINARY)&#39;</span><span class="comment">,        &amp;</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"></span>                        <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, mnormal)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keyword">write</span>(this%iout,fmtsfrbin) <span class="stringliteral">&#39;STAGE&#39;</span>, fname, this%istageout</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            found = .true.</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Optional stage keyword must be followed by fileout.&#39;</span><span class="comment">)</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span><span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;BUDGET&#39;</span>)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            this%ibudgetout = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ibudgetout, this%iout, fname, <span class="stringliteral">&#39;DATA(BINARY)&#39;</span><span class="comment">,       &amp;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"></span>                          <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>, mnormal)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keyword">write</span>(this%iout,fmtsfrbin) <span class="stringliteral">&#39;BUDGET&#39;</span>, fname, this%ibudgetout</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            found = .true.</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Optional budget keyword must be &#39;</span> //      <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span>                            <span class="stringliteral">&#39;followed by fileout.&#39;</span>)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;BUDGETCSV&#39;</span>)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            this%ibudcsv = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ibudcsv, this%iout, fname, <span class="stringliteral">&#39;CSV&#39;</span>, &amp;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;              filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keyword">write</span>(this%iout,fmtsfrbin) <span class="stringliteral">&#39;BUDGET CSV&#39;</span>, fname, this%ibudcsv</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;OPTIONAL BUDGETCSV KEYWORD MUST BE FOLLOWED BY &amp;</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;FILEOUT&#39;</span>)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;PACKAGE_CONVERGENCE&#39;</span>)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            this%ipakcsv = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ipakcsv, this%iout, fname, <span class="stringliteral">&#39;CSV&#39;</span>,        <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"></span>                          filstat_opt=<span class="stringliteral">&#39;REPLACE&#39;</span>, mode_opt=mnormal)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keyword">write</span>(this%iout,fmtsfrbin) <span class="stringliteral">&#39;PACKAGE_CONVERGENCE&#39;</span>, fname, this%ipakcsv</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            found = .true.</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Optional package_convergence keyword must be &#39;</span><span class="comment"> //    &amp;</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span>                            <span class="stringliteral">&#39;followed by fileout.&#39;</span>)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;UNIT_CONVERSION&#39;</span>)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          this%unitconv = this%parser%GetDouble()</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          <span class="keyword">write</span>(this%iout, fmtunitconv) this%unitconv</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;          found = .true.</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MAXIMUM_PICARD_ITERATIONS&#39;</span>)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          this%maxsfrpicard = this%parser%GetInteger()</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          <span class="keyword">write</span>(this%iout, fmtpicard) this%maxsfrpicard</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          found = .true.</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MAXIMUM_ITERATIONS&#39;</span>)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          this%maxsfrit = this%parser%GetInteger()</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="keyword">write</span>(this%iout, fmtiter) this%maxsfrit</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          found = .true.</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MAXIMUM_DEPTH_CHANGE&#39;</span>)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          r = this%parser%GetDouble()</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          this%dmaxchg = r</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          this%deps = dp999 * r</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keyword">write</span>(this%iout, fmtdmaxchg) this%dmaxchg</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          found = .true.</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MOVER&#39;</span>)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          this%imover = 1</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(4x,A)&#39;</span>) <span class="stringliteral">&#39;MOVER OPTION ENABLED&#39;</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          found = .true.</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">! -- right now these are options that are only available in the</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">!    development version and are not included in the documentation.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">!    These options are only available when IDEVELOPMODE in</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment">!    constants module is set to 1</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;DEV_NO_CHECK&#39;</span>)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          this%icheck = 0</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(4x,A)&#39;</span>) <span class="stringliteral">&#39;SFR CHECKS OF REACH GEOMETRY &#39;</span> // <span class="comment">        &amp;</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"></span>                                    <span class="stringliteral">&#39;RELATIVE TO MODEL GRID AND &#39;</span> //    <span class="comment">       &amp;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"></span>                                    <span class="stringliteral">&#39;REASONABLE PARAMETERS WILL NOT &#39;</span> //<span class="comment">       &amp;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span>                                    <span class="stringliteral">&#39;BE PERFORMED.&#39;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          found = .true.</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&#39;DEV_NO_FINAL_CHECK&#39;</span>)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="keyword">call </span>this%parser%DevOpt()</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          this%iconvchk = 0</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>)                                    <span class="comment">         &amp;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span>      &amp;    <span class="stringliteral">&#39;A FINAL CONVERGENCE CHECK OF THE CHANGE IN STREAM FLOW ROUTING &#39;</span><span class="comment"> // &amp;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"></span>      &amp;    <span class="stringliteral">&#39;STAGES AND FLOWS WILL NOT BE MADE&#39;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          found = .true.</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">! -- no valid options found</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          <span class="comment">! -- No options found</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          found = .false.</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a6ba3494107dd3b9909fc6dcefb4468e9_cgraph.png" border="0" usemap="#namespacesfrmodule_a6ba3494107dd3b9909fc6dcefb4468e9_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a6ba3494107dd3b9909fc6dcefb4468e9_cgraph" id="namespacesfrmodule_a6ba3494107dd3b9909fc6dcefb4468e9_cgraph">
<area shape="rect" title="@ brief Read additional options for package" alt="" coords="5,78,173,105"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title=" " alt="" coords="221,5,376,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title=" " alt="" coords="221,71,376,112"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="424,137,599,163"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title=" " alt="" coords="434,5,589,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="434,71,589,112"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="647,137,785,163"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="833,96,1001,137"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="833,161,1001,203"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1049,74,1244,101"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1063,125,1231,167"/>
</map>
</div>

</div>
</div>
<a id="aae824e3dd1ae4113f3313e79316bf4b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae824e3dd1ae4113f3313e79316bf4b8">&#9670;&nbsp;</a></span>sfr_ot_bdsummary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_ot_bdsummary </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibudfl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output SFR package budget summary. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kstp</td><td>time step number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kper</td><td>period number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>flag and unit number for the model listing file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibudfl</td><td>flag indicating budget should be written </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02385">2385</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="comment">! -- module</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">              !&lt; SfrType object</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp<span class="comment">    !&lt; time step number</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper<span class="comment">    !&lt; period number</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment">    !&lt; flag and unit number for the model listing file</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ibudfl<span class="comment">  !&lt; flag indicating budget should be written</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      <span class="keyword">call </span>this%budobj%write_budtable(kstp, kper, iout, ibudfl, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>)</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a506c1fd74d4c4c8a1965b9b50d7d4205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a506c1fd74d4c4c8a1965b9b50d7d4205">&#9670;&nbsp;</a></span>sfr_ot_dv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_ot_dv </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvsave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvprint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output SFR boundary package dependent-variable terms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idvsave</td><td>flag and unit number for dependent-variable output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idvprint</td><td>flag indicating if dependent-variable should be written to the model listing file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02284">2284</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#a011f43ae7ec20b725b0092529bda2b73">pertim</a>, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a07b5a678851f1bbbca15c9c058818e28">ulasav</a></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">                 !&lt; SfrType object</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvsave<span class="comment">    !&lt; flag and unit number for dependent-variable output</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvprint<span class="comment">   !&lt; flag indicating if dependent-variable should be written to the model listing file</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="keywordtype">character (len=20)</span> :: cellid</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="keywordtype">      real</span>(DP) :: d</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="keywordtype">      real</span>(DP) :: v</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="keywordtype">      real</span>(DP) :: hgwf</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="keywordtype">      real</span>(DP) :: sbot</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="keywordtype">      real</span>(DP) :: depth</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="keywordtype">      real</span>(DP) :: stage</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="keywordtype">      real</span>(DP) :: w</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="keywordtype">      real</span>(DP) :: cond</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="keywordtype">      real</span>(DP) :: grad</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      <span class="comment">! -- set unit number for binary dependent variable output</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keywordflow">if</span>(this%istageout /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        ibinun = this%istageout</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="keywordflow">if</span>(idvsave == 0) ibinun = 0</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <span class="comment">! -- write sfr binary output</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      <span class="keywordflow">if</span> (ibinun &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;          d = this%depth(n)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;          v = this%stage(n)</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;          <span class="keywordflow">if</span> (this%iboundpak(n) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            v = dhnoflo</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d == dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            v = dhdry</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;          this%dbuff(n) = v</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#a07b5a678851f1bbbca15c9c058818e28">ulasav</a>(this%dbuff, <span class="stringliteral">&#39;           STAGE&#39;</span>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#a011f43ae7ec20b725b0092529bda2b73">pertim</a>, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a><span class="comment">,   &amp;</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment"></span>                    this%maxbound, 1, 1, ibinun)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="comment">! -- print sfr stage and depth table</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <span class="keywordflow">if</span> (idvprint /= 0 .and. this%iprhed /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="comment">! -- set table kstp and kper</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="keyword">call </span>this%stagetab%set_kstpkper(<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <span class="comment">! -- fill stage data</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;          node = this%igwfnode(n)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;          <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            <span class="keyword">call </span>this%dis%noder_to_string(node, cellid)</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            hgwf = this%xnew(node)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            cellid = <span class="stringliteral">&#39;NONE&#39;</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;          <span class="keywordflow">if</span>(this%inamedbound==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(this%boundname(n))</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;          <span class="keyword">call </span>this%stagetab%add_term(n)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;          <span class="keyword">call </span>this%stagetab%add_term(cellid)</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          depth = this%depth(n)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;          stage = this%stage(n)</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;          w = this%calc_top_width_wet(n, depth)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;          <span class="keyword">call </span>this%stagetab%add_term(stage)</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;          <span class="keyword">call </span>this%stagetab%add_term(depth)</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;          <span class="keyword">call </span>this%stagetab%add_term(w)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;          <span class="keyword">call </span>this%sfr_calc_cond(n, depth, cond)</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;          <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            sbot = this%strtop(n) - this%bthick(n)</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <span class="keywordflow">if</span> (hgwf &lt; sbot) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;              grad = stage - sbot</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;              grad = stage - hgwf</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            grad = grad / this%bthick(n)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(hgwf)</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(cond)</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(grad)</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            <span class="keyword">call </span>this%stagetab%add_term(<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a506c1fd74d4c4c8a1965b9b50d7d4205_cgraph.png" border="0" usemap="#namespacesfrmodule_a506c1fd74d4c4c8a1965b9b50d7d4205_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a506c1fd74d4c4c8a1965b9b50d7d4205_cgraph" id="namespacesfrmodule_a506c1fd74d4c4c8a1965b9b50d7d4205_cgraph">
<area shape="rect" title="@ brief Output package dependent&#45;variable terms." alt="" coords="5,13,161,39"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a07b5a678851f1bbbca15c9c058818e28" title=" " alt="" coords="209,5,364,47"/>
</map>
</div>

</div>
</div>
<a id="a23b0ec222b7529d8ff451c39732978ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b0ec222b7529d8ff451c39732978ce">&#9670;&nbsp;</a></span>sfr_ot_package_flows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_ot_package_flows </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>ibudfl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output SFR package flow terms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcfl</td><td>flag and unit number for cell-by-cell output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibudfl</td><td>flag indication if cell-by-cell data should be saved </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02227">2227</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, <a class="code" href="namespacetdismodule.html#a011f43ae7ec20b725b0092529bda2b73">pertim</a>, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">               !&lt; SfrType object</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcfl<span class="comment">   !&lt; flag and unit number for cell-by-cell output</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: ibudfl<span class="comment">   !&lt; flag indication if cell-by-cell data should be saved</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="keywordtype">character (len=20)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: cellidstr</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="comment">! -- write the flows from the budobj</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <span class="keywordflow">if</span>(this%ibudgetout /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        ibinun = this%ibudgetout</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="keywordflow">if</span>(icbcfl == 0) ibinun = 0</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      <span class="keywordflow">if</span> (ibinun &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        <span class="keyword">call </span>this%budobj%save_flows(this%dis, ibinun, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, <span class="comment">&amp;</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment"></span>                                    <a class="code" href="namespacetdismodule.html#a011f43ae7ec20b725b0092529bda2b73">pertim</a>, <a class="code" href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">totim</a>, this%iout)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="comment">! -- Print lake flows table</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <span class="keywordflow">if</span> (ibudfl /= 0 .and. this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="comment">! -- If there are any &#39;none&#39; gwf connections then need to calculate</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        <span class="comment">!    a vector of cellids and pass that in to the budget flow table because</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="comment">!    the table assumes that there are maxbound gwf entries, which is not</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <span class="comment">!    the case if any &#39;none&#39;s are specified.</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="keywordflow">if</span> (this%ianynone &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;          <span class="keyword">allocate</span>(cellidstr(this%maxbound))</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;          <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            node = this%igwfnode(n)</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            <span class="keywordflow">if</span> (node &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;              <span class="keyword">call </span>this%dis%noder_to_string(node, cellidstr(n))</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;              cellidstr(n) = <span class="stringliteral">&#39;NONE&#39;</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;          <span class="keyword">call </span>this%budobj%write_flowtable(this%dis, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, cellidstr<span class="comment">)</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment"></span>          <span class="keyword">deallocate</span>(cellidstr)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;          <span class="keyword">call </span>this%budobj%write_flowtable(this%dis, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a685d2a55b16bd60a12a2aaedbea9d620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685d2a55b16bd60a12a2aaedbea9d620">&#9670;&nbsp;</a></span>sfr_process_obsid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_process_obsid </td>
          <td>(</td>
          <td class="paramtype">type(observetype), intent(inout)&#160;</td>
          <td class="paramname"><em>obsrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disbasetype), intent(in)&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunitobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to process observation ID strings for a SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obsrv</td><td>Observation object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dis</td><td>Discretization object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunitobs</td><td>file unit number for the package observation file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>model listing file unit number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02891">2891</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;      <span class="keywordtype">type</span>(ObserveType),      <span class="keywordtype">intent(inout)</span> :: obsrv<span class="comment">        !&lt; Observation object</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;      <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">intent(in)</span>    :: dis<span class="comment">              !&lt; Discretization object</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;      <span class="keywordtype">integer(I4B)</span>,            <span class="keywordtype">intent(in)</span>    :: inunitobs<span class="comment">   !&lt; file unit number for the package observation file</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;      <span class="keywordtype">integer(I4B)</span>,            <span class="keywordtype">intent(in)</span>    :: iout<span class="comment">        !&lt; model listing file unit number</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nn1</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: icol</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: istart</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: istop</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: strng</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;      <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bndname</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      <span class="comment">! -- initialize local variables</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;      strng = obsrv%IDstring</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="comment">! -- Extract reach number from strng and store it.</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <span class="comment">!    If 1st item is not an integer(I4B), it should be a</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <span class="comment">!    boundary name--deal with it.</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      icol = 1</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      <span class="comment">! -- get reach number or boundary name</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="keyword">call </span>extract_idnum_or_bndname(strng, icol, istart, istop, nn1, bndname<span class="comment">)</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="comment"></span>      <span class="keywordflow">if</span> (nn1 == namedboundflag) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        obsrv%FeatureName = bndname</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="comment">! -- store reach number (NodeNumber)</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      obsrv%NodeNumber = nn1</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_cgraph.png" border="0" usemap="#namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_cgraph" id="namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_cgraph">
<area shape="rect" title="Process observation IDs for a package." alt="" coords="5,57,176,99"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a2f708dffa1b89bf951c41031434cc724" title=" " alt="" coords="224,57,428,99"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="476,24,631,65"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title=" " alt="" coords="476,89,631,131"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title=" " alt="" coords="705,5,859,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1349,64,1517,105"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="695,122,869,149"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="679,173,885,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="933,151,1072,178"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1120,123,1288,164"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="1120,188,1288,229"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1336,130,1531,157"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_icgraph.png" border="0" usemap="#namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_icgraph" alt=""/></div>
<map name="namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_icgraph" id="namespacesfrmodule_a685d2a55b16bd60a12a2aaedbea9d620_icgraph">
<area shape="rect" title="Process observation IDs for a package." alt="" coords="216,5,387,47"/>
<area shape="rect" href="namespacesfrmodule.html#a6a2744b945481221fbaaf48acabd8186" title="Define the observation types available in the package." alt="" coords="5,13,168,39"/>
</map>
</div>

</div>
</div>
<a id="a44e43e3ecbd62de751259b7395031c72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e43e3ecbd62de751259b7395031c72">&#9670;&nbsp;</a></span>sfr_read_connectiondata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_read_connectiondata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read connectiondata for each reach for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01149">1149</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacesparsemodule.html">sparsemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structsparsemodule_1_1sparsematrix.html">sparsematrix</a></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jj</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jcol</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jcol2</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nja</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ival</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idir</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nconnmax</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: rowmaxnnz =&gt; null<span class="comment">()</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment"></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: nboundchk</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: iconndata</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordtype">type</span>(sparsematrix), <span class="keywordtype">pointer</span> :: sparse =&gt; null()</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="comment">! -- allocate and initialize local variables for reach connections</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keyword">allocate</span>(nboundchk(this%maxbound))</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        nboundchk(n) = 0</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="comment">! -- calculate the number of non-zero entries (size of ja maxtrix)</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      nja = 0</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      nconnmax = 0</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keyword">allocate</span>(rowmaxnnz(this%maxbound))</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        ival = this%nconnreach(n)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">if</span> (ival &lt; 0) ival = 0</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        rowmaxnnz(n) = ival + 1</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        nja = nja + ival + 1</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">if</span> (ival &gt; nconnmax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          nconnmax = ival</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="comment">! -- reallocate connection data for package</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%ja, nja, <span class="stringliteral">&#39;JA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%idir, nja, <span class="stringliteral">&#39;IDIR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%idiv, nja, <span class="stringliteral">&#39;IDIV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%qconn, nja, <span class="stringliteral">&#39;QCONN&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="comment">! -- initialize connection data</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">do</span> n = 1, nja</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        this%idir(n) = 0</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        this%idiv(n) = 0</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        this%qconn(n) = dzero</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="comment">! -- allocate space for iconndata</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keyword">allocate</span>(iconndata(nconnmax, this%maxbound))</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="comment">! -- initialize iconndata</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">do</span> j = 1, nconnmax</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;          iconndata(j, n) = 0</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="comment">! -- allocate space for connectivity</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="keyword">allocate</span>(sparse)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">! -- set up sparse</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="keyword">call </span>sparse%init(this%maxbound, this%maxbound, rowmaxnnz)</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="comment">! -- read connection data</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;CONNECTIONDATA&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                supportopenclose=.true.)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="comment">! -- parse reach connectivity block if detected</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(/1x,a)&#39;</span>)                                      <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;PROCESSING &#39;</span> // trim(adjustl(this%text)) // <span class="stringliteral">&#39; CONNECTIONDATA&#39;</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          <span class="comment">! -- get reach number</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          n = this%parser%GetInteger()</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          <span class="comment">! -- check for error</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          <span class="keywordflow">if</span> (n &lt; 1 .or. n &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0)&#39;</span>)                             <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;SFR reach in connectiondata block is less than one or greater&#39;</span><span class="comment">,     &amp;</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;than NREACHES:&#39;</span>, n</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            cycle</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          <span class="comment">! -- increment nboundchk</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;          nboundchk(n) = nboundchk(n) + 1</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          <span class="comment">! -- add diagonal connection for reach</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          <span class="keyword">call </span>sparse%addconnection(n, n, 1)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;          <span class="comment">! -- fill off diagonals</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          <span class="keywordflow">do</span> i = 1, this%nconnreach(n)</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <span class="comment">! -- get connected reach</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            ival = this%parser%GetInteger()</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="comment">! -- save connection data to temporary iconndata</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            iconndata(i, n) = ival</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="comment">! -- determine idir</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">if</span> (ival &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;              idir = -1</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;              ival = abs(ival)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keywordflow">elseif</span> (ival == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Missing or zero connection reach in line:&#39;</span><span class="comment">)</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment"></span>              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(line)</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;              idir = 1</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keywordflow">if</span> (ival &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Reach number exceeds NREACHES in line:&#39;</span>)</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(line)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="comment">! -- add connection to sparse</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keyword">call </span>sparse%addconnection(n, ival, 1)</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)                                       <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;END OF &#39;</span> // trim(adjustl(this%text)) // <span class="stringliteral">&#39; CONNECTIONDATA&#39;</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          <span class="comment">! -- check for missing or duplicate sfr connections</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          <span class="keywordflow">if</span> (nboundchk(n) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i0)&#39;</span>)                                   <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;No connection data specified for reach&#39;</span>, n</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nboundchk(n) &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i0,1x,a,1x,i0,1x,a)&#39;</span>)                   <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;Connection data for reach&#39;</span>, n,                           <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;specified&#39;</span>, nboundchk(n), <span class="stringliteral">&#39;times.&#39;</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Required connectiondata block not found.&#39;</span>)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="comment">! -- terminate if errors encountered in connectiondata block</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="comment">! -- create ia and ja from sparse</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keyword">call </span>sparse%filliaja(this%ia, this%ja, ierr, sort=.true.)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="comment">! -- test for error condition</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,3(1x,a))&#39;</span>)                                    <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;Could not fill&#39;</span>, trim(this%packName),                        <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;package IA and JA connection data.&#39;</span>,                         <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;Check connectivity data in connectiondata block.&#39;</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="comment">! -- fill flat connection storage</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="keywordflow">do</span> j = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;          jcol = this%ja(j)</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;          <span class="keywordflow">do</span> jj = 1, this%nconnreach(n)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            jcol2 = iconndata(jj, n)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordflow">if</span> (abs(jcol2) == jcol) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;              idir = 1</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;              <span class="keywordflow">if</span> (jcol2 &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                idir = -1</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;              this%idir(j) = idir</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;              <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="comment">! -- deallocate temporary local storage for reach connections</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keyword">deallocate</span>(rowmaxnnz)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keyword">deallocate</span>(nboundchk)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keyword">deallocate</span>(iconndata)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="comment">! -- destroy sparse</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <span class="keyword">call </span>sparse%destroy()</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keyword">deallocate</span>(sparse)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a44e43e3ecbd62de751259b7395031c72_cgraph.png" border="0" usemap="#namespacesfrmodule_a44e43e3ecbd62de751259b7395031c72_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a44e43e3ecbd62de751259b7395031c72_cgraph" id="namespacesfrmodule_a44e43e3ecbd62de751259b7395031c72_cgraph">
<area shape="rect" title="@ brief Read connectiondata for the package" alt="" coords="5,35,155,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="203,17,387,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="207,68,382,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,68,573,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,27,789,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,93,789,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,5,1032,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,57,1019,98"/>
</map>
</div>

</div>
</div>
<a id="ad915fc4ef5fcef0cfd2525617de6c63b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad915fc4ef5fcef0cfd2525617de6c63b">&#9670;&nbsp;</a></span>sfr_read_crossection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_read_crossection </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read crosssection data for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01015">1015</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacesfrcrosssectionmanager.html">sfrcrosssectionmanager</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43">cross_section_cr</a>, <a class="code" href="structsfrcrosssectionmanager_1_1sfrcrosssection.html">sfrcrosssection</a></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ncrossptstot</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: nboundchk</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordtype">type</span>(SfrCrossSection), <span class="keywordtype">pointer</span> :: cross_data =&gt; null()</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="comment">! -- read cross-section data</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;CROSSSECTIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                supportopenclose=.true., &amp;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                blockrequired=.false.)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">! -- parse reach connectivity block if detected</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(/1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;          <span class="stringliteral">&#39;PROCESSING &#39;</span> // trim(adjustl(this%text)) // <span class="stringliteral">&#39; CROSSSECTIONS&#39;</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="comment">! -- allocate and initialize local variables for reach cross-sections</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keyword">allocate</span>(nboundchk(this%maxbound))</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          nboundchk(n) = 0</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="comment">! -- create and initialize cross-section data</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43">cross_section_cr</a>(cross_data, this%iout, this%iprpak, this%maxbound<span class="comment">)</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"></span>        <span class="keyword">call </span>cross_data%initialize(this%ncrossptstot, this%ncrosspts, &amp;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                   this%iacross, &amp;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                   this%station, this%xsdepths)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">! -- read all of the entries in the block</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        readtable: <span class="keywordflow">do</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          <span class="comment">! -- get reach number</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          n = this%parser%GetInteger()</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <span class="comment">! -- check for reach number error</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          <span class="keywordflow">if</span> (n &lt; 1 .or. n &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;              <span class="stringliteral">&#39;SFR reach in crosssections block is less than one or greater&#39;</span><span class="comment">, &amp;</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;than NREACHES:&#39;</span>, n</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            cycle readtable</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="comment">! -- increment nboundchk</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          nboundchk(n) = nboundchk(n) + 1</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          <span class="comment">! -- read FILE keyword</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">case</span>(<span class="stringliteral">&#39;TAB6&#39;</span>)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;              <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;              <span class="keywordflow">if</span>(trim(adjustl(keyword)) /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                errmsg = <span class="stringliteral">&#39;TAB6 keyword must be followed by &quot;FILEIN&quot; &#39;</span> //<span class="comment">           &amp;</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment"></span>                          <span class="stringliteral">&#39;then by filename.&#39;</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                cycle readtable</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;              <span class="keyword">call </span>this%parser%GetString(line)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;              <span class="keyword">call </span>cross_data%read_table(n, this%width(n), trim(adjustl(line<span class="comment">)))</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"></span><span class="keywordflow">            case default</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;              <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i4,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                <span class="stringliteral">&#39;CROSS-SECTION TABLE ENTRY for REACH &#39;</span>, n, &amp;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <span class="stringliteral">&#39;MUST INCLUDE TAB6 KEYWORD&#39;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;              cycle readtable</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keywordflow">        end do</span> readtable</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;          <span class="stringliteral">&#39;END OF &#39;</span> // trim(adjustl(this%text)) // <span class="stringliteral">&#39; CROSSSECTIONS&#39;</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">! -- check for duplicate sfr crosssections</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="keywordflow">if</span> (nboundchk(n) &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i0,1x,a,1x,i0,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;              <span class="stringliteral">&#39;Cross-section data for reach&#39;</span>, n, &amp;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;              <span class="stringliteral">&#39;specified&#39;</span>, nboundchk(n), <span class="stringliteral">&#39;times.&#39;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="comment">! -- terminate if errors encountered in cross-sections block</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="comment">! -- determine the current size of cross-section data</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        ncrossptstot = cross_data%get_ncrossptstot()</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="comment">! -- reallocate sfr package cross-section data</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">if</span> (ncrossptstot /= this%ncrossptstot) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          this%ncrossptstot = ncrossptstot</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%station, this%ncrossptstot, <span class="stringliteral">&#39;STATION&#39;</span><span class="comment">, this%memoryPath)</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment"></span>          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%xsdepths, this%ncrossptstot, <span class="stringliteral">&#39;XSDEPTHS&#39;</span><span class="comment">, this%memoryPath)          </span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment"></span><span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="comment">! -- write cross-section data to the model listing file</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keyword">call </span>cross_data%output(this%width)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">! -- pack cross-section data</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keyword">call </span>cross_data%pack(this%ncrossptstot, this%ncrosspts, &amp;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                             this%iacross, &amp;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                             this%station, this%xsdepths)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">! -- deallocate temporary local storage for reach cross-sections</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keyword">deallocate</span>(nboundchk)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keyword">call </span>cross_data%destroy()</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keyword">deallocate</span>(cross_data)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keyword">nullify</span>(cross_data)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_ad915fc4ef5fcef0cfd2525617de6c63b_cgraph.png" border="0" usemap="#namespacesfrmodule_ad915fc4ef5fcef0cfd2525617de6c63b_cgraph" alt=""/></div>
<map name="namespacesfrmodule_ad915fc4ef5fcef0cfd2525617de6c63b_cgraph" id="namespacesfrmodule_ad915fc4ef5fcef0cfd2525617de6c63b_cgraph">
<area shape="rect" title="@ brief Read crosssection block for the package" alt="" coords="5,57,155,98"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="203,5,387,32"/>
<area shape="rect" href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43" title="Create a cross&#45;section object." alt="" coords="205,57,384,98"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="207,123,382,149"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,123,573,149"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,82,789,123"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,147,789,189"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,60,1032,87"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,111,1019,153"/>
</map>
</div>

</div>
</div>
<a id="ad513a31368de41f3044a63ab67e1df2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad513a31368de41f3044a63ab67e1df2f">&#9670;&nbsp;</a></span>sfr_read_dimensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_read_dimensions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read dimensions for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00499">499</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordtype">character (len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="comment">! -- initialize dimensions to 0</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      this%maxbound = 0</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">! -- get dimensions block</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;DIMENSIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                supportopenclose=.true.)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="comment">! -- parse dimensions block if detected</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(/1x,a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="stringliteral">&#39;PROCESSING &#39;</span> // trim(adjustl(this%text)) // <span class="stringliteral">&#39; DIMENSIONS&#39;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NREACHES&#39;</span>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;              this%maxbound = this%parser%GetInteger()</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(4x,a,i0)&#39;</span>)<span class="stringliteral">&#39;NREACHES = &#39;</span>, this%maxbound</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordflow">            case default</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(2a)&#39;</span>)                                                 &amp;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="stringliteral">&#39;Unknown &#39;</span> // trim(this%text) // <span class="stringliteral">&#39; dimension: &#39;</span>, trim(keyword)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)                                                  &amp;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          <span class="stringliteral">&#39;END OF &#39;</span> // trim(adjustl(this%text)) // <span class="stringliteral">&#39; DIMENSIONS&#39;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;Required dimensions block not found.&#39;</span>)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="comment">! -- verify dimensions were set</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">if</span>(this%maxbound &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>)                                                       &amp;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          <span class="stringliteral">&#39;NREACHES was not specified or was specified incorrectly.&#39;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="comment">! -- write summary of error messages for block</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="comment">! -- Call define_listlabel to construct the list label that is written</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="comment">!    when PRINT_INPUT option is used.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keyword">call </span>this%define_listlabel()</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="comment">! -- Define default cross-section data size</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      this%ncrossptstot = this%maxbound</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="comment">! -- Allocate arrays in package superclass</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keyword">call </span>this%sfr_allocate_arrays()</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="comment">! -- read package data</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keyword">call </span>this%sfr_read_packagedata()</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">! -- read cross-section data</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keyword">call </span>this%sfr_read_crossection()</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">! -- read connection data</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keyword">call </span>this%sfr_read_connectiondata()</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="comment">! -- read diversion data</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keyword">call </span>this%sfr_read_diversions()</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="comment">! -- setup the budget object</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keyword">call </span>this%sfr_setup_budobj()</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">! -- setup the stage table object</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keyword">call </span>this%sfr_setup_tableobj()</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_ad513a31368de41f3044a63ab67e1df2f_cgraph.png" border="0" usemap="#namespacesfrmodule_ad513a31368de41f3044a63ab67e1df2f_cgraph" alt=""/></div>
<map name="namespacesfrmodule_ad513a31368de41f3044a63ab67e1df2f_cgraph" id="namespacesfrmodule_ad513a31368de41f3044a63ab67e1df2f_cgraph">
<area shape="rect" title="@ brief Read dimensions for package" alt="" coords="5,35,155,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="203,17,387,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="207,68,382,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,68,573,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,27,789,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,93,789,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,5,1032,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,57,1019,98"/>
</map>
</div>

</div>
</div>
<a id="a305f842f1a320a487511a19262ab3420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305f842f1a320a487511a19262ab3420">&#9670;&nbsp;</a></span>sfr_read_diversions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_read_diversions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read diversions for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01358">1358</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cnum</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cval</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ival</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i0</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ipos</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jpos</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ndiv</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ndiversions</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idivreach</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idiv</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: iachk</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: nboundchk</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="comment">! -- determine the total number of diversions and fill iadiv</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      ndiversions = 0</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      i0 = 1</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      this%iadiv(1) = i0</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        ndiversions = ndiversions + this%ndiv(n)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        i0 = i0 + this%ndiv(n)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        this%iadiv(n+1) = i0</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="comment">! -- reallocate memory for diversions</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">if</span> (ndiversions &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%divreach, ndiversions, <span class="stringliteral">&#39;DIVREACH&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment"></span>        <span class="keyword">allocate</span>(this%divcprior(ndiversions))</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%divflow, ndiversions, <span class="stringliteral">&#39;DIVFLOW&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment"></span>        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%divq, ndiversions, <span class="stringliteral">&#39;DIVQ&#39;</span>, this%memoryPath<span class="comment">)</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment"></span><span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="comment">! -- inititialize diversion flow</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordflow">do</span> n = 1, ndiversions</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        this%divflow(n) = dzero</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        this%divq(n) = dzero</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">! -- read diversions</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;DIVERSIONS&#39;</span>, isfound, ierr,            <span class="comment">          &amp;</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment"></span>                                supportopenclose=.true.,                <span class="comment">          &amp;</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment"></span>                                blockrequired=.false.)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="comment">! -- parse reach connectivity block if detected</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">if</span> (this%idiversions /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(/1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING &#39;</span> // trim(adjustl(this%text<span class="comment">)) // &amp;</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment"></span>                                    <span class="stringliteral">&#39; DIVERSIONS&#39;</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          <span class="comment">! -- allocate and initialize local variables for diversions</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          ndiv = 0</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            ndiv = ndiv + this%ndiv(n)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <span class="keyword">allocate</span>(iachk(this%maxbound+1))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          <span class="keyword">allocate</span>(nboundchk(ndiv))</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          iachk(1) = 1</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            iachk(n+1) = iachk(n) + this%ndiv(n)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          <span class="keywordflow">do</span> n = 1, ndiv</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            nboundchk(n) = 0</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          <span class="comment">! -- read diversion data</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          <span class="keywordflow">do</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="comment">! -- get reach number</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            n = this%parser%GetInteger()</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="keywordflow">if</span> (n &lt; 1 .or. n &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;              <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) n</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;              errmsg = <span class="stringliteral">&#39;Reach number should be between 1 and &#39;</span> //       <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment"></span>                        trim(cnum) // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;              cycle</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <span class="comment">! -- make sure reach has at least one diversion</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <span class="keywordflow">if</span> (this%ndiv(n) &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;              <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) n</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;              errmsg = <span class="stringliteral">&#39;Diversions cannot be specified &#39;</span> //             <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment"></span>                      <span class="stringliteral">&#39;for reach &#39;</span> // trim(cnum)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;              cycle</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            <span class="comment">! -- read diversion number</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            ival = this%parser%GetInteger()</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <span class="keywordflow">if</span> (ival &lt; 1 .or. ival &gt; this%ndiv(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;              <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) n</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;              errmsg = <span class="stringliteral">&#39;Reach  &#39;</span> // trim(cnum)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;              <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) this%ndiv(n)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;              errmsg = trim(errmsg) // <span class="stringliteral">&#39; diversion number should be between &#39;</span><span class="comment"> //   &amp;</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment"></span>                      <span class="stringliteral">&#39;1 and &#39;</span> // trim(cnum) // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;              cycle</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            <span class="comment">! -- increment nboundchk</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            ipos = iachk(n) + ival - 1</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            nboundchk(ipos) = nboundchk(ipos) + 1</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            idiv = ival</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="comment">! -- get target reach for diversion</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            ival = this%parser%GetInteger()</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">if</span> (ival &lt; 1 .or. ival &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;              <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) ival</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;              errmsg = <span class="stringliteral">&#39;Diversion target reach number should be &#39;</span> //    <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment"></span>                      <span class="stringliteral">&#39;between 1 and &#39;</span> // trim(cnum) // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;              cycle</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            idivreach = ival</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            jpos = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            this%divreach(jpos) = idivreach</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <span class="comment">! -- get cprior</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            <span class="keyword">call </span>this%parser%GetStringCaps(cval)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            ival = -1</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <span class="keywordflow">select case</span> (cval)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;              <span class="keywordflow">case</span>(<span class="stringliteral">&#39;UPTO&#39;</span>)</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                ival = 0</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;              <span class="keywordflow">case</span>(<span class="stringliteral">&#39;THRESHOLD&#39;</span>)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                ival = -1</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;              <span class="keywordflow">case</span>(<span class="stringliteral">&#39;FRACTION&#39;</span>)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                ival = -2</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;              <span class="keywordflow">case</span>(<span class="stringliteral">&#39;EXCESS&#39;</span>)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                ival = -3</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="keywordflow">              case default</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                errmsg = <span class="stringliteral">&#39;Invalid cprior type &#39;</span> // trim(cval) // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="keywordflow">            end select</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="comment">! -- set cprior for diversion</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            this%divcprior(jpos) = cval</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;          </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;          <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF &#39;</span> // trim(adjustl(this%text)<span class="comment">) //       &amp;</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment"></span>                                    <span class="stringliteral">&#39; DIVERSIONS&#39;</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;          </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <span class="keywordflow">do</span> j = 1, this%ndiv(n)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;              ipos = iachk(n) + j - 1</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;              <span class="comment">! -- check for missing or duplicate reach diversions</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;              <span class="keywordflow">if</span> (nboundchk(ipos) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i0,1x,a,1x,i0)&#39;</span>)                    <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39;No data specified for reach&#39;</span>, n, <span class="stringliteral">&#39;diversion&#39;</span>, j</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nboundchk(ipos) &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i0,1x,a,1x,i0,1x,a,1x,i0,1x,a)&#39;</span>)    <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39;Data for reach&#39;</span>, n, <span class="stringliteral">&#39;diversion&#39;</span>, j,                  <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39;specified&#39;</span>, nboundchk(ipos), <span class="stringliteral">&#39;times&#39;</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;          <span class="comment">! -- deallocate local variables</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          <span class="keyword">deallocate</span>(iachk)</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          <span class="keyword">deallocate</span>(nboundchk)</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          <span class="comment">! -- error condition</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,a)&#39;</span>)                                      <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39;A diversions block should not be&#39;</span>,                         <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39;specified if diversions are not specified.&#39;</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="keywordflow">if</span> (this%idiversions /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;REQUIRED DIVERSIONS BLOCK NOT FOUND.&#39;</span>)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">! -- write summary of diversion error messages</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a305f842f1a320a487511a19262ab3420_cgraph.png" border="0" usemap="#namespacesfrmodule_a305f842f1a320a487511a19262ab3420_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a305f842f1a320a487511a19262ab3420_cgraph" id="namespacesfrmodule_a305f842f1a320a487511a19262ab3420_cgraph">
<area shape="rect" title="@ brief Read diversions for the package" alt="" coords="5,35,155,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="203,17,387,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="207,68,382,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="435,68,573,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="621,27,789,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="621,93,789,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="837,5,1032,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="851,57,1019,98"/>
</map>
</div>

</div>
</div>
<a id="a9a4bc981e816db62637f0ec03dd07b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4bc981e816db62637f0ec03dd07b17">&#9670;&nbsp;</a></span>sfr_read_packagedata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_read_packagedata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to read packagedata for each reach for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00786">786</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetimeseriesmanagermodule.html">timeseriesmanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: cellid</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cnum</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bndName</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bndNameTemp</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: manningname</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: ustrfname</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordtype">character(len=50)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: caux</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n, ierr, ival</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jj</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iaux</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nconzero</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ipos</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: nboundchk</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">pointer</span> :: bndElem =&gt; null()</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">! -- allocate space for checking sfr reach data</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keyword">allocate</span>(nboundchk(this%maxbound))</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        nboundchk(i) = 0</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="keywordflow">      enddo</span> </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      nconzero = 0</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="comment">! -- allocate local storage for aux variables</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (this%naux &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keyword">allocate</span>(caux(this%naux))</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="comment">! -- read reach data</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;PACKAGEDATA&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                supportopenclose=.true.)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">! -- parse reaches block if detected</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(/1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING &#39;</span>//trim(adjustl(this%text)<span class="comment">)// &amp;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39; PACKAGEDATA&#39;</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;          <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="comment">! -- read reach number</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          n = this%parser%GetInteger()</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          <span class="keywordflow">if</span> (n &lt; 1 .or. n &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,a,1x,i0)&#39;</span>)                              <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;Reach number (rno) must be greater than 0 and less&#39;</span>,     <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;than or equal to&#39;</span>, this%maxbound</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            cycle</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;          <span class="comment">! -- increment nboundchk</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          nboundchk(n) = nboundchk(n) + 1</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          <span class="comment">! -- get model node number</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          <span class="keyword">call </span>this%parser%GetCellid(this%dis%ndim, cellid, flag_string=<span class="comment">.true.)</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"></span>          this%igwfnode(n) = this%dis%noder_from_cellid(cellid, &amp;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                            this%inunit, this%iout, flag_string=.true.)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;          this%igwftopnode(n) = this%igwfnode(n)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          <span class="comment">! -- read the cellid string and determine if &#39;none&#39; is specified</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          <span class="keywordflow">if</span> (this%igwfnode(n) &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            this%ianynone = this%ianynone + 1</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">if</span> (keyword /= <span class="stringliteral">&#39;NONE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) n</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              errmsg = <span class="stringliteral">&#39;Cell ID (&#39;</span> // trim(cellid) //                   <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"></span>                      <span class="stringliteral">&#39;) for unconnected reach &#39;</span> //  trim(cnum) //      <span class="comment">          &amp;</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"></span>                      <span class="stringliteral">&#39; must be NONE&#39;</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          <span class="comment">! -- get reach length</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          this%length(n) = this%parser%GetDouble()</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <span class="comment">! -- get reach width</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          this%width(n) = this%parser%GetDouble()</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="comment">! -- get reach slope</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;          this%slope(n) = this%parser%GetDouble()</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <span class="comment">! -- get reach stream bottom</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          this%strtop(n) = this%parser%GetDouble()</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          <span class="comment">! -- get reach bed thickness</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          this%bthick(n) = this%parser%GetDouble()</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="comment">! -- get reach bed hk</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          this%hk(n) = this%parser%GetDouble()</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;          <span class="comment">! -- get reach roughness</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(manningname)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;          <span class="comment">! -- get number of connections for reach</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;          ival = this%parser%GetInteger()</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          this%nconnreach(n) = ival</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          this%nconn = this%nconn + ival</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          <span class="keywordflow">if</span> (ival &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,i0,1x,a,i0,a)&#39;</span>)                        <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;NCON for reach&#39;</span>, n,                                      <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;must be greater than or equal to 0 (&#39;</span>, ival, <span class="stringliteral">&#39;).&#39;</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ival == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            nconzero = nconzero + 1</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          <span class="comment">! -- get upstream fraction for reach</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          <span class="keyword">call </span>this%parser%GetString(ustrfname)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="comment">! -- get number of diversions for reach</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          ival = this%parser%GetInteger()</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;          this%ndiv(n) = ival</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          <span class="keywordflow">if</span> (ival &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            this%idiversions = 1</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ival &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            ival = 0</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;          <span class="comment">! -- get aux data</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          <span class="keywordflow">do</span> iaux = 1, this%naux</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keyword">call </span>this%parser%GetString(caux(iaux))</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="comment">! -- set default bndName</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          <span class="keyword">write</span>(cnum,<span class="stringliteral">&#39;(i10.10)&#39;</span>) n</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          bndname = <span class="stringliteral">&#39;Reach&#39;</span> // cnum</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          <span class="comment">! -- get reach name</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          <span class="keywordflow">if</span> (this%inamedbound /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keyword">call </span>this%parser%GetStringCaps(bndnametemp)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordflow">if</span> (bndnametemp /= <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;              bndname = bndnametemp</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="comment">!this%boundname(n) = bndName</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          this%sfrname(n) = bndname</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="comment">! -- set Mannings</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          text = manningname</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          jj = 1 <span class="comment">!for &#39;ROUGH&#39;</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          bndelem =&gt; this%rough(n)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span>                                              <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,  &amp;</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"></span>                                              <span class="stringliteral">&#39;MANNING&#39;</span>)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          <span class="comment">! -- set upstream fraction</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          text = ustrfname</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          jj = 1  <span class="comment">! For &#39;USTRF&#39;</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          bndelem =&gt; this%ustrf(n)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;USTRF&#39;</span>)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="comment">! -- get aux data</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          <span class="keywordflow">do</span> jj = 1, this%naux</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            text = caux(jj)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            ii = n</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            bndelem =&gt; this%rauxvar(jj, ii)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, ii, jj, bndelem, this%packName<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span>                                              <span class="stringliteral">&#39;AUX&#39;</span>, this%tsManager, this%iprpak<span class="comment">, &amp;</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment"></span>                                              this%auxname(jj))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <span class="comment">! -- initialize sstage to the top of the reach</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          <span class="comment">!    this value would be used by simple routing reaches</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;          <span class="comment">!    on kper = 1 and kstp = 1 if a stage is not specified</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;          <span class="comment">!    on the status line for the reach</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;          this%sstage(n) = this%strtop(n)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)                                       <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;END OF &#39;</span>//trim(adjustl(this%text))//<span class="stringliteral">&#39; PACKAGEDATA&#39;</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;REQUIRED PACKAGEDATA BLOCK NOT FOUND.&#39;</span>)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="comment">! -- Check to make sure that every reach is specified and that no reach</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="comment">!    is specified more than once.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">if</span> (nboundchk(i) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;          <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,i0,1x,a)&#39;</span>)                                  <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39;Information for reach &#39;</span>, i, <span class="stringliteral">&#39;not specified in packagedata block.&#39;</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nboundchk(i) &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,i0,1x,a,1x,i0)&#39;</span>)                         <span class="comment">           &amp;</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39;Reach information specified&#39;</span>, nboundchk(i), <span class="stringliteral">&#39;times for reach&#39;</span><span class="comment">, i</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"></span>          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keyword">deallocate</span>(nboundchk)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">! -- Submit warning message if any reach has zero connections</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">if</span> (nconzero &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a,1x,a,1x,a,1x,i0,1x, a)&#39;</span>)                     <span class="comment">         &amp;</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;SFR Package&#39;</span>, trim(this%packName),                           <span class="comment">         &amp;</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment"></span>          <span class="stringliteral">&#39;has&#39;</span>, nconzero, <span class="stringliteral">&#39;reach(es) with zero connections.&#39;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="comment">! -- terminate if errors encountered in reach block</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="comment">! -- initialize the cross-section data</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      ipos = 1</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      this%iacross(1) = ipos</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">do</span> i = 1, this%maxbound</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        this%ncrosspts(i) = 1</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        this%station(ipos) = this%width(i)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        this%xsdepths(ipos) = dzero</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        ipos = ipos + 1</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        this%iacross(i+1) = ipos </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="comment">! -- deallocate local storage for aux variables</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordflow">if</span> (this%naux &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keyword">deallocate</span>(caux)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a9a4bc981e816db62637f0ec03dd07b17_cgraph.png" border="0" usemap="#namespacesfrmodule_a9a4bc981e816db62637f0ec03dd07b17_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a9a4bc981e816db62637f0ec03dd07b17_cgraph" id="namespacesfrmodule_a9a4bc981e816db62637f0ec03dd07b17_cgraph">
<area shape="rect" title="@ brief Read packagedata for the package" alt="" coords="5,91,155,132"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="229,10,413,37"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666" title=" " alt="" coords="203,61,439,103"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="499,123,673,150"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title="Store warning message." alt="" coords="223,178,418,205"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#ad1b537cde3acf4d66f1e3db237bdb5c4" title=" " alt="" coords="487,5,685,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="943,17,1097,59"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a20fd69114074fcbe01dcc8219d4bbd79" title=" " alt="" coords="733,5,888,47"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="741,123,880,150"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="936,104,1104,145"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="936,169,1104,211"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1152,82,1347,109"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1165,133,1333,175"/>
</map>
</div>

</div>
</div>
<a id="a8384c7cbe28ad9a362df94f26295481c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8384c7cbe28ad9a362df94f26295481c">&#9670;&nbsp;</a></span>sfr_rp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_rp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read and prepare period data for the SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l01561">1561</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacesfrcrosssectionmanager.html">sfrcrosssectionmanager</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43">cross_section_cr</a>, <a class="code" href="structsfrcrosssectionmanager_1_1sfrcrosssection.html">sfrcrosssection</a></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: crossfile</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ichkustrm</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ichkcross</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ncrossptstot</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordtype">type</span>(SfrCrossSection), <span class="keywordtype">pointer</span> :: cross_data =&gt; null()</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="comment">! -- formats</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtblkerr = &amp;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="stringliteral">&quot;(&#39;Looking for BEGIN PERIOD iper.  Found &#39;, a, &#39; instead.&#39;)&quot;</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtlsp = &amp;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      &amp;  <span class="stringliteral">&quot;(1X,/1X,&#39;REUSING &#39;,A,&#39;S FROM LAST STRESS PERIOD&#39;)&quot;</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtnbd = &amp;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="stringliteral">&quot;(1X,/1X,&#39;The number of active &#39;,A,&#39;S (&#39;,I6, &amp;</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;  &#39;) is greater than maximum (&#39;,I6,&#39;)&#39;)&quot;</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="comment">! -- initialize flags</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      ichkustrm = 0</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      ichkcross = 0</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        ichkustrm = 1</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="comment">! -- set nbound to maxbound</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      this%nbound = this%maxbound</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      <span class="comment">! -- Set ionper to the stress period number for which a new block of data</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="comment">!    will be read.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <span class="keywordflow">if</span> (this%ionper &lt; <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="comment">! -- get period block</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;PERIOD&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                                  supportopenclose=.true.)</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordflow">if</span>(isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          <span class="comment">! -- read ionper and check for increasing period numbers</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          <span class="keyword">call </span>this%read_check_ionper()</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;          <span class="comment">! -- PERIOD block not found</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;          <span class="keywordflow">if</span> (ierr &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="comment">! -- End of file found; data applies for remainder of simulation.</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            this%ionper = <a class="code" href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">nper</a> + 1</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="comment">! -- Found invalid block</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keyword">call </span>this%parser%GetCurrentLine(line)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <span class="keyword">write</span>(errmsg, fmtblkerr) adjustl(trim(line))</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="comment">! -- Read data if ionper == kper</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordflow">if</span>(this%ionper==<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="comment">! -- create and initialize cross-section data</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43">cross_section_cr</a>(cross_data, this%iout, this%iprpak, this%maxbound<span class="comment">)</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment"></span>        <span class="keyword">call </span>cross_data%initialize(this%ncrossptstot, this%ncrosspts, &amp;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                                   this%iacross, &amp;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                                   this%station, this%xsdepths)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="comment">! -- setup table for period data</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          <span class="comment">! -- reset the input table object</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //           <span class="comment">             &amp;</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment"></span>                  trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) DATA FOR PERIOD&#39;</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          <span class="keyword">write</span>(title, <span class="stringliteral">&#39;(a,1x,i6)&#39;</span>) trim(adjustl(title)), <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%inputtab, this%packName, title)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;          <span class="keyword">call </span>this%inputtab%table_df(1, 4, this%iout, finalize=.false.)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;          text = <span class="stringliteral">&#39;NUMBER&#39;</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 10, alignment=tabcenter<span class="comment">)</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment"></span>          text = <span class="stringliteral">&#39;KEYWORD&#39;</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;          <span class="keyword">call </span>this%inputtab%initialize_column(text, 20, alignment=tableft<span class="comment">)</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment"></span>          <span class="keywordflow">do</span> n = 1, 2</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            <span class="keyword">write</span>(text, <span class="stringliteral">&#39;(a,1x,i6)&#39;</span>) <span class="stringliteral">&#39;VALUE&#39;</span>, n</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            <span class="keyword">call </span>this%inputtab%initialize_column(text, 15, alignment=tabcenter<span class="comment">)</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment"></span><span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="comment">! -- read data</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;          <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;          n = this%parser%GetInteger()</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;          <span class="keywordflow">if</span> (n &lt; 1 .or. n &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,a,1x,i0,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;              <span class="stringliteral">&#39;Reach number (RNO) must be greater than 0 and&#39;</span>,          <span class="comment">           &amp;</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;less than or equal to&#39;</span>, this%maxbound, <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            cycle</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;          <span class="comment">! -- read data from the rest of the line</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;          <span class="keyword">call </span>this%sfr_set_stressperiod(n, ichkustrm, crossfile)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          <span class="comment">! -- write line to table</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;          <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="keyword">call </span>this%parser%GetCurrentLine(line)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <span class="keyword">call </span>this%inputtab%line_to_columns(line)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;          <span class="comment">! -- process cross-section file</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(crossfile)) /= <span class="stringliteral">&#39;NONE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            <span class="keyword">call </span>cross_data%read_table(n, this%width(n), trim(adjustl(crossfile<span class="comment">)))</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment"></span><span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="comment">! -- write raw period data </span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="keywordflow">if</span> (this%iprpak /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          <span class="keyword">call </span>this%inputtab%finalize_table()</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="comment">! -- finalize cross-sections</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="comment">! -- determine the current size of cross-section data</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        ncrossptstot = cross_data%get_ncrossptstot()</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="comment">! -- reallocate sfr package cross-section data</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="keywordflow">if</span> (ncrossptstot /= this%ncrossptstot) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;          this%ncrossptstot = ncrossptstot</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%station, this%ncrossptstot, <span class="stringliteral">&#39;STATION&#39;</span><span class="comment">, this%memoryPath)</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment"></span>          <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%xsdepths, this%ncrossptstot, <span class="stringliteral">&#39;XSDEPTHS&#39;</span><span class="comment">, this%memoryPath)          </span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment"></span><span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="comment">! -- write cross-section data to the model listing file</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keyword">call </span>cross_data%output(this%width, kstp=1, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>=<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="comment">! -- pack cross-section data</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keyword">call </span>cross_data%pack(this%ncrossptstot, this%ncrosspts, &amp;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                             this%iacross, &amp;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                             this%station, this%xsdepths)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="comment">! -- deallocate temporary local storage for reach cross-sections</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keyword">call </span>cross_data%destroy()</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="keyword">deallocate</span>(cross_data)</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="keyword">nullify</span>(cross_data)</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="comment">! -- Reuse data from last stress period</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keyword">write</span>(this%iout,fmtlsp) trim(this%filtyp)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="comment">! -- check upstream fraction values</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keywordflow">if</span> (ichkustrm /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keyword">call </span>this%sfr_check_ustrf()</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="comment">! -- write summary of package block error messages</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a8384c7cbe28ad9a362df94f26295481c_cgraph.png" border="0" usemap="#namespacesfrmodule_a8384c7cbe28ad9a362df94f26295481c_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a8384c7cbe28ad9a362df94f26295481c_cgraph" id="namespacesfrmodule_a8384c7cbe28ad9a362df94f26295481c_cgraph">
<area shape="rect" title="@ brief Read and prepare period data for package" alt="" coords="5,93,139,120"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="187,5,371,32"/>
<area shape="rect" href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43" title="Create a cross&#45;section object." alt="" coords="189,57,368,98"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="191,123,366,149"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="197,173,361,200"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="419,123,557,149"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="605,82,773,123"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="605,147,773,189"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="821,60,1016,87"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="835,111,1003,153"/>
</map>
</div>

</div>
</div>
<a id="ad9f92e161b51b34427f1b12cfbb79815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9f92e161b51b34427f1b12cfbb79815">&#9670;&nbsp;</a></span>sfr_rp_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_rp_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to read and prepare observations for a SFR package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02778">2778</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <span class="keywordtype">class</span>(SfrType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nn1</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bname</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keywordtype">logical</span> :: jfound</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keywordtype">class</span>(ObserveType),   <span class="keywordtype">pointer</span> :: obsrv =&gt; null()</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <span class="comment">! -- formats</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  10  <span class="keyword">format</span>(<span class="stringliteral">&#39;Boundary &quot;&#39;</span>,a,<span class="stringliteral">&#39;&quot; for observation &quot;&#39;</span>,a,                    <span class="comment">           &amp;</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39;&quot; is invalid in package &quot;&#39;</span>,a,<span class="stringliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  30  <span class="keyword">format</span>(<span class="stringliteral">&#39;Boundary name not provided for observation &quot;&#39;</span>,a,          <span class="comment">           &amp;</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment"></span>            <span class="stringliteral">&#39;&quot; in package &quot;&#39;</span>,a,<span class="stringliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <span class="comment">! -- process each package observation</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="comment">!    only done the first stress period since boundaries are fixed</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      <span class="comment">!    for the simulation</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <span class="keywordflow">do</span> i = 1, this%obs%npakobs</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;          obsrv =&gt; this%obs%pakobs(i)%obsrv</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;          <span class="comment">! -- get node number 1</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;          nn1 = obsrv%NodeNumber</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;          <span class="keywordflow">if</span> (nn1 == namedboundflag) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            bname = obsrv%FeatureName</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            <span class="keywordflow">if</span> (bname /= <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;              <span class="comment">! -- Observation location(s) is(are) based on a boundary name.</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;              <span class="comment">!    Iterate through all boundaries to identify and store</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;              <span class="comment">!    corresponding index(indices) in bound array.</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;              jfound = .false.</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;              <span class="keywordflow">do</span> j = 1, this%maxbound</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                <span class="keywordflow">if</span> (this%boundname(j) == bname) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                  jfound = .true.</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                  <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="keywordflow">                endif</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="keywordflow">              enddo</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;              <span class="keywordflow">if</span> (.not. jfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                <span class="keyword">write</span>(errmsg,10) trim(bname), trim(obsrv%name), trim(this%packName<span class="comment">)</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment"></span>                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="keywordflow">              endif</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;              <span class="keyword">write</span>(errmsg,30) trim(obsrv%name), trim(this%packName)</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nn1 &lt; 1 .or. nn1 &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0,1x,a,1x,i0,a)&#39;</span>)                <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment"></span>              trim(adjustl(obsrv%ObsTypeId)),                           <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment"></span>              <span class="stringliteral">&#39;reach must be greater than 0 and less than or equal to&#39;</span>, <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment"></span>              this%maxbound, <span class="stringliteral">&#39;(specified value is &#39;</span>, nn1, <span class="stringliteral">&#39;)&#39;</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;            <span class="keywordflow">if</span> (obsrv%indxbnds_count == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;              <span class="keyword">call </span>obsrv%AddObsIndex(nn1)</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;              errmsg = <span class="stringliteral">&#39;Programming error in sfr_rp_obs&#39;</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;          <span class="comment">! -- catch non-cumulative observation assigned to observation defined</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;          <span class="comment">!    by a boundname that is assigned to more than one element</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;          <span class="keywordflow">if</span> (obsrv%ObsTypeId == <span class="stringliteral">&#39;STAGE&#39;</span> .or. &amp;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;DEPTH&#39;</span> .or. &amp;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;WET-PERIMETER&#39;</span> .or. &amp;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;WET-AREA&#39;</span> .or. &amp;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;              obsrv%ObsTypeId == <span class="stringliteral">&#39;WET-WIDTH&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;            nn1 = obsrv%NodeNumber</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;            <span class="keywordflow">if</span> (nn1 == namedboundflag) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;              <span class="keywordflow">if</span> (obsrv%indxbnds_count &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,3(1x,a))&#39;</span>)                            <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="comment"></span>                  trim(adjustl(obsrv%ObsTypeId)),                       <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39;for observation&#39;</span>, trim(adjustl(obsrv%Name)),         <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39; must be assigned to a reach with a unique boundname.&#39;</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;          <span class="comment">! -- check that node number 1 is valid; call store_error if not</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;          <span class="keywordflow">do</span> j = 1, obsrv%indxbnds_count</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;            nn1 = obsrv%indxbnds(j)</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;            <span class="keywordflow">if</span> (nn1 &lt; 1 .or. nn1 &gt; this%maxbound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;              <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a,1x,a,1x,i0,1x,a,1x,i0,a)&#39;</span>)              <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="comment"></span>                trim(adjustl(obsrv%ObsTypeId)),                         <span class="comment">             &amp;</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="comment"></span>                <span class="stringliteral">&#39;reach must be greater than 0 and less than or equal to&#39;</span><span class="comment">,            &amp;</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment"></span>                this%maxbound, <span class="stringliteral">&#39;(specified value is &#39;</span>, nn1, <span class="stringliteral">&#39;)&#39;</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="comment">! -- evaluate if there are any observation errors</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_ad9f92e161b51b34427f1b12cfbb79815_cgraph.png" border="0" usemap="#namespacesfrmodule_ad9f92e161b51b34427f1b12cfbb79815_cgraph" alt=""/></div>
<map name="namespacesfrmodule_ad9f92e161b51b34427f1b12cfbb79815_cgraph" id="namespacesfrmodule_ad9f92e161b51b34427f1b12cfbb79815_cgraph">
<area shape="rect" title="Read and prepare observations for a package." alt="" coords="5,43,168,69"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="216,17,400,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="221,68,395,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="448,68,587,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="635,27,803,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="635,93,803,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="851,5,1045,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="864,57,1032,98"/>
</map>
</div>

</div>
</div>
<a id="a4be68d7b3767ac5f38ca10a65cc9b9ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be68d7b3767ac5f38ca10a65cc9b9ea">&#9670;&nbsp;</a></span>sfr_set_stressperiod()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_set_stressperiod </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>ichkustrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=linelength), intent(inout)&#160;</td>
          <td class="paramname"><em>crossfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to read and set period data for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ichkustrm</td><td>flag indicating if upstream fraction data specified </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">crossfile</td><td>cross-section file name </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l02935">2935</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetimeseriesmanagermodule.html">timeseriesmanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="keywordtype">class</span>(SfrType),<span class="keywordtype">intent(inout)</span> :: this<span class="comment">                   !&lt; SfrType object</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">                          !&lt; reach number</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: ichkustrm<span class="comment">               !&lt; flag indicating if upstream fraction data specified</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span>, <span class="keywordtype">intent(inout)</span> :: crossfile<span class="comment">  !&lt; cross-section file name</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="keywordtype">character(len=10)</span> :: cnum</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: caux</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ival</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jj</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idiv</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ixserror</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      <span class="keywordtype">character (len=10)</span> :: cp</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="keywordtype">      real</span>(DP) :: divq</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">pointer</span> :: bndElem =&gt; null()</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="comment">! -- initialize variables</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      crossfile = <span class="stringliteral">&#39;NONE&#39;</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <span class="comment">! -- read line</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;STATUS&#39;</span>)</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;          ichkustrm = 1</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(text)</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;          <span class="keywordflow">if</span> (text == <span class="stringliteral">&#39;INACTIVE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            this%iboundpak(n) = 0</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (text == <span class="stringliteral">&#39;ACTIVE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            this%iboundpak(n) = 1</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (text == <span class="stringliteral">&#39;SIMPLE&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;            this%iboundpak(n) = -1</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(2a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;              <span class="stringliteral">&#39;Unknown &#39;</span> // trim(this%text) // <span class="stringliteral">&#39; sfr status keyword: &#39;</span>, trim<span class="comment">(text)</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="comment"></span>            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;MANNING&#39;</span>)</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;          jj = 1  <span class="comment">! For &#39;MANNING&#39;</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;          bndelem =&gt; this%rough(n)</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;MANNING&#39;</span>)</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;STAGE&#39;</span>)</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;          jj = 1  <span class="comment">! For &#39;STAGE&#39;</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;          bndelem =&gt; this%sstage(n)</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;STAGE&#39;</span>)</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;RAINFALL&#39;</span>)</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;          jj = 1  <span class="comment">! For &#39;RAIN&#39;</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;          bndelem =&gt; this%rain(n)</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;RAIN&#39;</span>)</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;EVAPORATION&#39;</span>)</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;          jj = 1  <span class="comment">! For &#39;EVAP&#39;</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;          bndelem =&gt; this%evap(n)</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;MANNING&#39;</span>)</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;RUNOFF&#39;</span>)</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;          jj = 1  <span class="comment">! For &#39;RUNOFF&#39;</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;          bndelem =&gt; this%runoff(n)</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;RUNOFF&#39;</span>)</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;INFLOW&#39;</span>)</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;          jj = 1  <span class="comment">! For &#39;INFLOW&#39;</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;          bndelem =&gt; this%inflow(n)</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;INFLOW&#39;</span>)</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DIVERSION&#39;</span>)</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;          <span class="comment">! -- make sure reach has at least one diversion</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;          <span class="keywordflow">if</span> (this%ndiv(n) &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) n</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            errmsg = <span class="stringliteral">&#39;diversions cannot be specified for reach &#39;</span> // trim<span class="comment">(cnum)</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="comment"></span>            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;          <span class="comment">! -- read diversion number</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;          ival = this%parser%GetInteger()</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;          <span class="keywordflow">if</span> (ival &lt; 1 .or. ival &gt; this%ndiv(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;            <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) n</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;            errmsg = <span class="stringliteral">&#39;Reach  &#39;</span> // trim(cnum)</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;            <span class="keyword">write</span>(cnum, <span class="stringliteral">&#39;(i0)&#39;</span>) this%ndiv(n)</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            errmsg = trim(errmsg) // <span class="stringliteral">&#39; diversion number should be between 1 &#39;</span><span class="comment"> //   &amp;</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="comment"></span>                    <span class="stringliteral">&#39;and &#39;</span> // trim(cnum) // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;          idiv = ival</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;          <span class="comment">! -- read value</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;          ii = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;          jj = 1  <span class="comment">! For &#39;DIVERSION&#39;</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;          bndelem =&gt; this%divflow(ii)</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, ii, jj, bndelem, this%packName<span class="comment">,     &amp;</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;DIVFLOW&#39;</span>)</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;          <span class="comment">! -- if diversion cprior is &#39;fraction&#39;, ensure that 0.0 &lt;= fraction &lt;= 1.0</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;          cp = this%divcprior(ii)</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;          divq = this%divflow(ii) </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;          <span class="keywordflow">if</span> (cp == <span class="stringliteral">&#39;FRACTION&#39;</span> .and. (divq &lt; dzero .or. divq &gt; done)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i0,a)&#39;</span>)                                 <span class="comment">           &amp;</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39;cprior is type FRACTION for diversion no.&#39;</span>, ii,      <span class="comment">           &amp;</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="comment"></span>                  <span class="stringliteral">&#39;, but divflow not within the range 0.0 to 1.0&#39;</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UPSTREAM_FRACTION&#39;</span>)</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;          ichkustrm = 1</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;          <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;          jj = 1  <span class="comment">! For &#39;USTRF&#39;</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;          bndelem =&gt; this%ustrf(n)</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, n, jj, bndelem, this%packName<span class="comment">,      &amp;</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;BND&#39;</span>, this%tsManager, this%iprpak<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment"></span>                                            <span class="stringliteral">&#39;USTRF&#39;</span>)</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;CROSS_SECTION&#39;</span>)</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          ixserror = 0</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;          <span class="comment">! -- read FILE keyword</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;          <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;            <span class="keywordflow">case</span>(<span class="stringliteral">&#39;TAB6&#39;</span>)</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;              <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;              <span class="keywordflow">if</span>(trim(adjustl(keyword)) /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                errmsg = <span class="stringliteral">&#39;TAB6 keyword must be followed by &quot;FILEIN&quot; &#39;</span> //<span class="comment">           &amp;</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment"></span>                          <span class="stringliteral">&#39;then by filename.&#39;</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                ixserror = 1</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;              <span class="keywordflow">if</span> (ixserror == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                <span class="keyword">call </span>this%parser%GetString(crossfile)</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="keywordflow">            case default</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;              <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,1x,i4,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                <span class="stringliteral">&#39;CROSS-SECTION TABLE ENTRY for REACH &#39;</span>, n, &amp;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                <span class="stringliteral">&#39;MUST INCLUDE TAB6 KEYWORD&#39;</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; </div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;AUXILIARY&#39;</span>)</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(caux)</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;          <span class="keywordflow">do</span> jj = 1, this%naux</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;            <span class="keywordflow">if</span> (trim(adjustl(caux)) /= trim(adjustl(this%auxname(jj)))) cycle</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;            <span class="keyword">call </span>this%parser%GetString(text)</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            ii = n</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;            bndelem =&gt; this%rauxvar(jj, ii)</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">read_value_or_time_series_adv</a>(text, ii, jj, bndelem, this%packName<span class="comment">,   &amp;</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="comment"></span>                                              <span class="stringliteral">&#39;AUX&#39;</span>, this%tsManager, this%iprpak<span class="comment">, &amp;</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="comment"></span>                                              this%auxname(jj))</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160; </div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;            <span class="stringliteral">&#39;Unknown &#39;</span> // trim(this%text) // <span class="stringliteral">&#39; sfr data keyword: &#39;</span>,     <span class="comment">           &amp;</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment"></span>            trim(keyword) // <span class="stringliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a4be68d7b3767ac5f38ca10a65cc9b9ea_cgraph.png" border="0" usemap="#namespacesfrmodule_a4be68d7b3767ac5f38ca10a65cc9b9ea_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a4be68d7b3767ac5f38ca10a65cc9b9ea_cgraph" id="namespacesfrmodule_a4be68d7b3767ac5f38ca10a65cc9b9ea_cgraph">
<area shape="rect" title="Set period data." alt="" coords="5,91,145,132"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666" title=" " alt="" coords="193,61,429,103"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="489,123,664,150"/>
<area shape="rect" href="namespacetimeseriesmanagermodule.html#ad1b537cde3acf4d66f1e3db237bdb5c4" title=" " alt="" coords="477,5,676,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a3418ad9e27e9d9caac6f541863e1c522" title=" " alt="" coords="933,17,1088,59"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a20fd69114074fcbe01dcc8219d4bbd79" title=" " alt="" coords="724,5,879,47"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="732,123,871,150"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="927,104,1095,145"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="927,169,1095,211"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1143,82,1337,109"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1156,133,1324,175"/>
</map>
</div>

</div>
</div>
<a id="a7fa3402fe639ad226e2ade9195cc66b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa3402fe639ad226e2ade9195cc66b3">&#9670;&nbsp;</a></span>sfr_setup_budobj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_setup_budobj </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to set up the budget object that stores all the sfr flows The terms listed here must correspond in number and order to the ones listed in the sfr_fill_budobj method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l04721">4721</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">   !&lt; SfrType object</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nbudterm</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n1</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: maxlist</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: naux</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idx</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;<span class="keywordtype">      real</span>(DP) :: q</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      <span class="keywordtype">character(len=LENBUDTXT)</span> :: text</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;      <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(1)</span> :: auxtxt</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      <span class="comment">! -- Determine the number of sfr budget terms. These are fixed for </span></div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;      <span class="comment">!    the simulation and cannot change.  This includes FLOW-JA-FACE</span></div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      <span class="comment">!    so they can be written to the binary budget files, but these internal</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <span class="comment">!    flows are not included as part of the budget table.</span></div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      nbudterm = 8</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <span class="keywordflow">if</span> (this%imover == 1) nbudterm = nbudterm + 2</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;      <span class="keywordflow">if</span> (this%naux &gt; 0) nbudterm = nbudterm + 1</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      <span class="comment">! -- set up budobj</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;      <span class="keyword">call </span>budgetobject_cr(this%budobj, this%packName)</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      <span class="keyword">call </span>this%budobj%budgetobject_df(this%maxbound, nbudterm, 0, 0, &amp;</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                                       ibudcsv=this%ibudcsv)</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      idx = 0</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;      <span class="comment">! -- Go through and set up each budget term</span></div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;      text = <span class="stringliteral">&#39;    FLOW-JA-FACE&#39;</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;      maxlist = this%nconn</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;      naux = 1</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;      auxtxt(1) = <span class="stringliteral">&#39;       FLOW-AREA&#39;</span></div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                                              naux, auxtxt)</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;      <span class="comment">! -- store connectivity</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%nconn)</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;      q = dzero</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;        n1 = n</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;          n2 = this%ja(i)</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n1, n2, q)</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;      text = <span class="stringliteral">&#39;             GWF&#39;</span></div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;      maxlist = this%maxbound - this%ianynone</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;      naux = 1</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;      auxtxt(1) = <span class="stringliteral">&#39;       FLOW-AREA&#39;</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;                                              maxlist, .false., .true., &amp;</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                                              naux, auxtxt)</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%reset(this%maxbound)</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;      q = dzero</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;      <span class="keywordflow">do</span> n = 1, this%maxbound</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;        n2 = this%igwfnode(n)</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;        <span class="keywordflow">if</span> (n2 &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;          <span class="keyword">call </span>this%budobj%budterm(idx)%update_term(n, n2, q)</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;      text = <span class="stringliteral">&#39;        RAINFALL&#39;</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;      maxlist = this%maxbound</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      naux = 0</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;                                              naux)</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;      text = <span class="stringliteral">&#39;     EVAPORATION&#39;</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      maxlist = this%maxbound</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      naux = 0</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                                              naux)</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;      text = <span class="stringliteral">&#39;          RUNOFF&#39;</span></div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      maxlist = this%maxbound</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      naux = 0</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;                                              naux)</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;      text = <span class="stringliteral">&#39;      EXT-INFLOW&#39;</span></div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;      maxlist = this%maxbound</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      naux = 0</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;                                              naux)</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      text = <span class="stringliteral">&#39;     EXT-OUTFLOW&#39;</span></div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      maxlist = this%maxbound</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      naux = 0</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;                                              naux)</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;      text = <span class="stringliteral">&#39;         STORAGE&#39;</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      idx = idx + 1</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;      maxlist = this%maxbound</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      naux = 1</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;      auxtxt(1) = <span class="stringliteral">&#39;          VOLUME&#39;</span></div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;      <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;                                              this%name_model, &amp;</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;                                              this%packName, &amp;</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;                                              maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;                                              naux, auxtxt)</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;        <span class="comment">! -- </span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        text = <span class="stringliteral">&#39;        FROM-MVR&#39;</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;        idx = idx + 1</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;        maxlist = this%maxbound</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;        naux = 0</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;                                                this%name_model, &amp;</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;                                                this%packName, &amp;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                                                this%name_model, &amp;</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                                                this%packName, &amp;</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                                                maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;                                                naux)</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        <span class="comment">! -- </span></div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;        text = <span class="stringliteral">&#39;          TO-MVR&#39;</span></div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;        idx = idx + 1</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;        maxlist = this%maxbound</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;        naux = 0</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;                                                this%name_model, &amp;</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;                                                this%packName, &amp;</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;                                                this%name_model, &amp;</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;                                                this%packName, &amp;</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;                                                maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;                                                naux)</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="comment">! -- </span></div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;      naux = this%naux</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      <span class="keywordflow">if</span> (naux &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;        <span class="comment">! -- </span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;        text = <span class="stringliteral">&#39;       AUXILIARY&#39;</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;        idx = idx + 1</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;        maxlist = this%maxbound</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;        <span class="keyword">call </span>this%budobj%budterm(idx)%initialize(text, &amp;</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;                                                this%name_model, &amp;</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;                                                this%packName, &amp;</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                                                this%name_model, &amp;</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                                                this%packName, &amp;</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;                                                maxlist, .false., .false., &amp;</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;                                                naux, this%auxname)</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;      <span class="comment">! -- if sfr flow for each reach are written to the listing file</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;      <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;        <span class="keyword">call </span>this%budobj%flowtable_df(this%iout, cellids=<span class="stringliteral">&#39;GWF&#39;</span>)</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a7fa3402fe639ad226e2ade9195cc66b3_cgraph.png" border="0" usemap="#namespacesfrmodule_a7fa3402fe639ad226e2ade9195cc66b3_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a7fa3402fe639ad226e2ade9195cc66b3_cgraph" id="namespacesfrmodule_a7fa3402fe639ad226e2ade9195cc66b3_cgraph">
<area shape="rect" title="Setup budget object for package." alt="" coords="5,5,161,47"/>
<area shape="rect" href="namespacebudgetobjectmodule.html#a0b10034ed28f5a4131a181f960908a1d" title=" " alt="" coords="209,5,365,47"/>
<area shape="rect" href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f" title="@ brief Create a new budget object" alt="" coords="413,13,601,39"/>
</map>
</div>

</div>
</div>
<a id="a126527f0b5361bc25a93acfd502b01cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a126527f0b5361bc25a93acfd502b01cd">&#9670;&nbsp;</a></span>sfr_setup_tableobj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_setup_tableobj </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to set up the table object that is used to write the sfr stage data. The terms listed here must correspond in number and order to the ones written to the stage table in the sfr_ot method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>SfrType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l05118">5118</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">  !&lt; SfrType object</span></div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nterms</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: title</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <span class="comment">! -- setup stage table</span></div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      <span class="keywordflow">if</span> (this%iprhed &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;        <span class="comment">! -- Determine the number of sfr budget terms. These are fixed for </span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;        <span class="comment">!    the simulation and cannot change.  This includes FLOW-JA-FACE</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;        <span class="comment">!    so they can be written to the binary budget files, but these internal</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;        <span class="comment">!    flows are not included as part of the budget table.</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;        nterms = 8</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;          nterms = nterms + 1</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;        <span class="comment">! -- set up table title</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;        title = trim(adjustl(this%text)) // <span class="stringliteral">&#39; PACKAGE (&#39;</span> //                        &amp;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                trim(adjustl(this%packName)) //<span class="stringliteral">&#39;) STAGES FOR EACH CONTROL VOLUME&#39;</span></div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;        <span class="comment">! -- set up stage tableobj</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(this%stagetab, this%packName, title)</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;        <span class="keyword">call </span>this%stagetab%table_df(this%maxbound, nterms, this%iout,              &amp;</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;                                    transient=.true.)</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;        <span class="comment">! -- Go through and set up table budget term</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;          text = <span class="stringliteral">&#39;NAME&#39;</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;          <span class="keyword">call </span>this%stagetab%initialize_column(text, lenboundname, alignment=tableft)</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;        <span class="comment">! -- reach number</span></div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;        text = <span class="stringliteral">&#39;NUMBER&#39;</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;        <span class="comment">! -- cellids</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;        text = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;        <span class="comment">! -- reach stage</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;        text = <span class="stringliteral">&#39;STAGE&#39;</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;        <span class="comment">! -- reach depth</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;        text = <span class="stringliteral">&#39;DEPTH&#39;</span></div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;        <span class="comment">! -- reach width</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;        text = <span class="stringliteral">&#39;WIDTH&#39;</span></div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;        <span class="comment">! -- gwf head</span></div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;        text = <span class="stringliteral">&#39;GWF HEAD&#39;</span></div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;        <span class="comment">! -- streambed conductance</span></div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;        text = <span class="stringliteral">&#39;STREAMBED CONDUCTANCE&#39;</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;        <span class="comment">! -- streambed gradient</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;        text = <span class="stringliteral">&#39;STREAMBED GRADIENT&#39;</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;        <span class="keyword">call </span>this%stagetab%initialize_column(text, 12, alignment=tabcenter)</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesfrmodule_a126527f0b5361bc25a93acfd502b01cd_cgraph.png" border="0" usemap="#namespacesfrmodule_a126527f0b5361bc25a93acfd502b01cd_cgraph" alt=""/></div>
<map name="namespacesfrmodule_a126527f0b5361bc25a93acfd502b01cd_cgraph" id="namespacesfrmodule_a126527f0b5361bc25a93acfd502b01cd_cgraph">
<area shape="rect" title="Setup stage table object for package." alt="" coords="5,5,161,47"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="209,13,373,39"/>
</map>
</div>

</div>
</div>
<a id="ad4744f90a4cc1281e6536c5068d1c7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4744f90a4cc1281e6536c5068d1c7a4">&#9670;&nbsp;</a></span>sfr_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_solve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>hcof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to solve the continuity equation for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>groundwater head in cell connected to reach </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hcof</td><td>coefficient term added to the diagonal </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side term </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">update</td><td>boolean indicating if the reach depth and stage variables should be updated to current iterate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03121">3121</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <span class="keywordtype">class</span>(SfrType) :: this<span class="comment">                    !&lt; SfrType object</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">             !&lt; reach number</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: h<span class="comment">                 !&lt; groundwater head in cell connected to reach</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: hcof<span class="comment">           !&lt; coefficient term added to the diagonal</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: rhs<span class="comment">            !&lt; right-hand side term</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: update<span class="comment">   !&lt; boolean indicating if the reach depth and stage variables should be updated to current iterate</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      <span class="keywordtype">logical</span> :: lupdate</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ii</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: isolve</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iic</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iic2</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iic3</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iic4</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ibflg</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;<span class="keywordtype">      real</span>(DP) :: hgwf</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="keywordtype">      real</span>(DP) :: sa</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="keywordtype">      real</span>(DP) :: qu</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="keywordtype">      real</span>(DP) :: qi</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="keywordtype">      real</span>(DP) :: qr</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="keywordtype">      real</span>(DP) :: qe</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<span class="keywordtype">      real</span>(DP) :: qro</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="keywordtype">      real</span>(DP) :: qmp</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="keywordtype">      real</span>(DP) :: qsrc</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="keywordtype">      real</span>(DP) :: qfrommvr</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="keywordtype">      real</span>(DP) :: qgwf</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="keywordtype">      real</span>(DP) :: qmpsrc</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="keywordtype">      real</span>(DP) :: qc</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="keywordtype">      real</span>(DP) :: qt</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="keywordtype">      real</span>(DP) :: tp</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="keywordtype">      real</span>(DP) :: bt</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="keywordtype">      real</span>(DP) :: hsfr</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="keywordtype">      real</span>(DP) :: cstr</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="keywordtype">      real</span>(DP) :: qd</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="keywordtype">      real</span>(DP) :: en1</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="keywordtype">      real</span>(DP) :: en2</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="keywordtype">      real</span>(DP) :: qen1</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="keywordtype">      real</span>(DP) :: f1, f2</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="keywordtype">      real</span>(DP) :: qgwf1</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="keywordtype">      real</span>(DP) :: qgwf2</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="keywordtype">      real</span>(DP) :: qgwfp</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="keywordtype">      real</span>(DP) :: qgwfold</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="keywordtype">      real</span>(DP) :: fhstr1</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="keywordtype">      real</span>(DP) :: fhstr2</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="keywordtype">      real</span>(DP) :: d1</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="keywordtype">      real</span>(DP) :: d2</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="keywordtype">      real</span>(DP) :: dpp</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="keywordtype">      real</span>(DP) :: dx</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="keywordtype">      real</span>(DP) :: q1</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="keywordtype">      real</span>(DP) :: q2</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="keywordtype">      real</span>(DP) :: derv</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="keywordtype">      real</span>(DP) :: dlh</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="keywordtype">      real</span>(DP) :: dlhold</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="keywordtype">      real</span>(DP) :: fp</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="keywordtype">      real</span>(DP) :: err</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="keywordtype">      real</span>(DP) :: errold</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="keywordtype">      real</span>(DP) :: sumleak</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="keywordtype">      real</span>(DP) :: sumrch</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="keywordtype">      real</span>(DP) :: gwfhcof</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="keywordtype">      real</span>(DP) :: gwfrhs</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="comment">! -- Process optional dummy variables</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(update)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        lupdate = update</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        lupdate = .true.</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      <span class="comment">! -- calculate hgwf</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      hgwf = h</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      hcof = dzero</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      rhs = dzero</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      <span class="comment">! -- initialize d1, d2, q1, q2, qsrc, and qgwf</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      d1 = dzero</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      d2 = dzero</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      q1 = dzero</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;      q2 = dzero</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      qsrc = dzero</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      qgwf = dzero</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      qgwfold = dzero</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      <span class="comment">! -- calculate initial depth assuming a wide cross-section and ignore</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      <span class="comment">!    groundwater leakage</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <span class="comment">! -- calculate upstream flow</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      qu = dzero</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;      <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        <span class="keywordflow">if</span> (this%idir(i) &lt; 0) cycle</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        n2 = this%ja(i)</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        <span class="keywordflow">do</span> ii = this%ia(n2) + 1, this%ia(n2+1) - 1</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;          <span class="keywordflow">if</span> (this%idir(ii) &gt; 0) cycle</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;          <span class="keywordflow">if</span> (this%ja(ii) /= n) cycle</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;          qu = qu + this%qconn(ii)</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      this%usflow(n) = qu</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="comment">! -- calculate remaining terms</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      sa = this%calc_surface_area(n)</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      qi = this%inflow(n)</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      qr = this%rain(n) * sa</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      qe = this%evap(n) * sa</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      qro = this%runoff(n)</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <span class="comment">! -- Water mover term; assume that it goes in at the upstream end of the reach</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      qfrommvr = dzero</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <span class="keywordflow">if</span>(this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        qfrommvr = this%pakmvrobj%get_qfrommvr(n)</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      <span class="comment">! -- calculate sum of sources to the reach excluding groundwater leakage</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;      qc = qu + qi + qr - qe + qro + qfrommvr</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      <span class="comment">! -- adjust runoff or evaporation if sum of sources is negative</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <span class="keywordflow">if</span> (qc &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        <span class="comment">! -- calculate sources without et</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        qt = qu + qi + qr + qro + qfrommvr</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        <span class="comment">! -- runoff exceeds sources of water for reach</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        <span class="keywordflow">if</span> (qt &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;          qro = -(qu + qi + qr + qfrommvr)</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;          qe = dzero</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        <span class="comment">! -- evaporation exceeds sources of water for reach</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;          qe = qu + qi + qr + qro + qfrommvr</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        qc = qu + qi + qr - qe + qro + qfrommvr</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      <span class="comment">! -- set simulated evaporation and runoff</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      this%simevap(n) = qe</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      this%simrunoff(n) = qro</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;      <span class="comment">! -- calculate flow at the middle of the reach and excluding groundwater leakage</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      qmp = qu + qi + qfrommvr + dhalf * (qr - qe + qro)</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;      qmpsrc = qmp</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;      <span class="comment">! -- calculate stream depth at the midpoint</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;      <span class="keywordflow">if</span> (this%iboundpak(n) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        <span class="keyword">call </span>this%sfr_calc_reach_depth(n, qmp, d1)</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        this%stage(n) = this%sstage(n)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;        d1 = max(dzero, this%stage(n) - this%strtop(n))</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      <span class="comment">! -- calculate sources/sinks for reach excluding groundwater leakage</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <span class="keyword">call </span>this%sfr_calc_qsource(n, d1, qsrc)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;      <span class="comment">! -- calculate initial reach stage, downstream flow, and groundwater leakage</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      tp = this%strtop(n)</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      bt = tp - this%bthick(n)</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      hsfr = d1 + tp</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      qd = max(qsrc, dzero)</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      qgwf = dzero</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      <span class="comment">! -- calculate reach conductance for a unit depth of water</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="comment">!    if equal to zero will skip iterations</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;      <span class="keyword">call </span>this%sfr_calc_cond(n, d1, cstr)</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;      <span class="comment">! -- set flag to skip iterations</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      isolve = 1</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      <span class="keywordflow">if</span> (hsfr &lt;= tp .and. hgwf &lt;= tp) isolve = 0</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      <span class="keywordflow">if</span> (hgwf &lt;= tp .and. qc &lt; dem30) isolve = 0</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      <span class="keywordflow">if</span> (cstr &lt; dem30) isolve = 0</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      <span class="keywordflow">if</span> (this%iboundpak(n) &lt; 0) isolve = 0</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="comment">! -- iterate to achieve solution</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      itersol: <span class="keywordflow">if</span> (isolve /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        <span class="comment">! -- estimate initial end points</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        en1 = dzero</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        <span class="keywordflow">if</span> (d1 &gt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;          <span class="keywordflow">if</span> ((tp - hgwf) &gt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            en2 = dp9 * d1</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;            en2 = d1p1 * d1 - (tp - hgwf)</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((tp - hgwf) &gt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;          en2 = done</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;          en2 = dp99 * (hgwf - tp)</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        <span class="comment">! -- estimate flow at end points</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        <span class="comment">! -- end point 1</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;        <span class="keywordflow">if</span> (hgwf &gt; tp) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qgwf(n, dzero, hgwf, qgwf1)</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;          qgwf1 = -qgwf1</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;          qen1 = qmp - dhalf * qgwf1</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;          qgwf1 = dzero</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;          qen1 = qmpsrc</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        <span class="keywordflow">if</span> (hgwf &gt; bt) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qgwf(n, en2, hgwf, qgwf2)</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;          qgwf2 = -qgwf2</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qgwf(n, en2, bt, qgwf2)</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;          qgwf2 = -qgwf2</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        <span class="keywordflow">if</span> (qgwf2 &gt; qsrc) qgwf2 = qsrc</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        <span class="comment">! -- calculate two depths</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        <span class="keyword">call </span>this%sfr_calc_reach_depth(n, (qmpsrc-dhalf*qgwf1), d1)</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;        <span class="keyword">call </span>this%sfr_calc_reach_depth(n, (qmpsrc-dhalf*qgwf2), d2)</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        <span class="comment">! -- determine roots</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <span class="keywordflow">if</span> (d1 &gt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;          f1 = en1 - d1</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;          en1 = dzero</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;          f1 = en1 - dzero</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">if</span> (d2 &gt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;          f2 = en2 - d2</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;          <span class="keywordflow">if</span> (f2 &lt; dem30) en2 = d2</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;          d2 = dzero</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;          f2 = en2 - dzero</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        <span class="comment">! -- iterate to find a solution</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        dpp = dhalf * (en1 + en2)</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        dx = dpp</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;        iic = 0</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        iic2 = 0</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        iic3 = 0</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        fhstr1 = dzero</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        fhstr2 = dzero</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        qgwfp = dzero</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        dlhold = dzero</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        <span class="keywordflow">do</span> i = 1, this%maxsfrit</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;          ibflg = 0</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;          d1 = dpp</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;          d2 = d1 + dtwo * this%deps</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;          <span class="comment">! -- calculate q at midpoint at both end points</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qman(n, d1, q1)</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qman(n, d2, q2)</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;          <span class="comment">! -- calculate groundwater leakage at both end points</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qgwf(n, d1, hgwf, qgwf1)</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;          qgwf1 = -qgwf1</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qgwf(n, d2, hgwf, qgwf2)</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;          qgwf2 = -qgwf2</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;          <span class="keywordflow">if</span> (qgwf1 &gt;= qsrc) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;            en2 = dpp</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            dpp = dhalf * (en1 + en2)</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            <span class="keyword">call </span>this%sfr_calc_qgwf(n, dpp, hgwf, qgwfp)</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;            qgwfp = -qgwfp</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;            <span class="keywordflow">if</span> (qgwfp &gt; qsrc) qgwfp = qsrc</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;            <span class="keyword">call </span>this%sfr_calc_reach_depth(n, (qmpsrc-dhalf*qgwfp), dx)</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            ibflg = 1</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;            fhstr1 = (qmpsrc-dhalf*qgwf1) - q1</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;            fhstr2 = (qmpsrc-dhalf*qgwf2) - q2</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;          <span class="keywordflow">if</span> (ibflg == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;            derv = dzero</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;            <span class="keywordflow">if</span> (abs(d1-d2) &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;              derv = (fhstr1-fhstr2) / (d1 - d2)</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;            <span class="keywordflow">if</span> (abs(derv) &gt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;              dlh = -fhstr1 / derv</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;              dlh = dzero</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            dpp = d1 + dlh</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;            <span class="comment">! -- updated depth outside of endpoints - use bisection instead</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            <span class="keywordflow">if</span> ((dpp &gt;= en2) .or. (dpp &lt;= en1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;              <span class="keywordflow">if</span> (abs(dlh) &gt; abs(dlhold) .or. dpp &lt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                ibflg = 1</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                dpp = dhalf * (en1 + en2)</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            <span class="comment">! -- check for slow convergence</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            <span class="comment">! -- set flags to determine if the Newton-Raphson method oscillates</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            <span class="comment">!    or if convergence is slow</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;            <span class="keywordflow">if</span> (qgwf1*qgwfold &lt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;              iic2 = iic2 + 1</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;              iic2 = 0</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;            <span class="keywordflow">if</span> (qgwf1 &lt; dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;              iic3 = iic3 + 1</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;              iic3 = 0</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;            <span class="keywordflow">if</span> (dlh*dlhold &lt; dem30 .or. abs(dlh) &gt; abs(dlhold)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;              iic = iic + 1</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;            iic4 = 0</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;            <span class="keywordflow">if</span> (iic3 &gt; 7 .and. iic &gt; 12) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;              iic4 = 1</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;            <span class="comment">! -- switch to bisection when the Newton-Raphson method oscillates</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;            <span class="comment">!    or when convergence is slow</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;            <span class="keywordflow">if</span> (iic2 &gt; 7 .or. iic &gt; 12 .or. iic4 == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;              ibflg = 1</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;              dpp = dhalf * (en1 + en2)</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;            <span class="comment">! -- Calculate perturbed gwf flow</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            <span class="keyword">call </span>this%sfr_calc_qgwf(n, dpp, hgwf, qgwfp)</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            qgwfp = -qgwfp</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            <span class="keywordflow">if</span> (qgwfp &gt; qsrc) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;              qgwfp = qsrc</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;              <span class="keywordflow">if</span> (abs(en1-en2) &lt; this%dmaxchg*<a class="code" href="namespaceconstantsmodule.html#aba95664cbd721a2d72df12ac8bb78da8">dem6</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                <span class="keyword">call </span>this%sfr_calc_reach_depth(n, (qmpsrc-dhalf*qgwfp), dpp)</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            <span class="keyword">call </span>this%sfr_calc_reach_depth(n, (qmpsrc-dhalf*qgwfp), dx)</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;          <span class="comment">! -- bisection to update end points</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;          fp = dpp - dx</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;          <span class="keywordflow">if</span> (ibflg == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            dlh = fp</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;            <span class="comment">! -- change end points</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;            <span class="comment">! -- root is between f1 and fp</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;            <span class="keywordflow">if</span> (f1*fp &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;              en2 = dpp</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;              f2 = fp</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;            <span class="comment">! -- root is between fp and f2</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;              en1 = dpp</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;              f1 = fp</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            err = min(abs(fp), abs(en2-en1))</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            err = abs(dlh)</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;          <span class="comment">! -- check for convergence and exit if converged</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;          <span class="keywordflow">if</span> (err &lt; this%dmaxchg) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;            d1 = dpp</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            qgwf = qgwfp</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;            qd = qsrc - qgwf</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;          <span class="comment">! -- save iterates</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;          errold = err</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;          dlhold = dlh</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;          <span class="keywordflow">if</span> (ibflg == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;            qgwfold = qgwfp</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;            qgwfold = qgwf1</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <span class="comment">! -- end of iteration</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="keywordflow">      end if</span> itersol</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160; </div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <span class="comment">! -- simple routing option or where depth = 0 and hgwf &lt; bt</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <span class="keywordflow">if</span> (isolve == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <span class="keyword">call </span>this%sfr_calc_qgwf(n, d1, hgwf, qgwf)</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        qgwf = -qgwf</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        <span class="comment">! -- leakage exceeds inflow</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        <span class="keywordflow">if</span> (qgwf &gt; qsrc) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;          d1 = dzero</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;          <span class="keyword">call </span>this%sfr_calc_qsource(n, d1, qsrc)</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;          qgwf = qsrc</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;        <span class="comment">! -- set qd</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        qd = qsrc - qgwf</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;      <span class="comment">! -- update sfr stage</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      hsfr = tp + d1</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;      <span class="comment">! -- update stored values</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      <span class="keywordflow">if</span> (lupdate) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        <span class="comment">! -- save depth and calculate stage</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        this%depth(n) = d1</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        this%stage(n) = hsfr</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        <span class="comment">! -- update flows</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        <span class="keyword">call </span>this%sfr_update_flows(n, qd, qgwf)</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      <span class="comment">! -- calculate sumleak and sumrch</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;      sumleak = dzero</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;      sumrch = dzero</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;        sumleak = qgwf</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        sumleak = qgwf</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;      <span class="keywordflow">if</span> (hgwf &lt; bt) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        sumrch = qgwf</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;      <span class="comment">! -- make final qgwf calculation and obtain</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      <span class="comment">!    gwfhcof and gwfrhs values</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="keyword">call </span>this%sfr_calc_qgwf(n, d1, hgwf, qgwf, gwfhcof, gwfrhs)</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <span class="keywordflow">if</span> (abs(sumleak) &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;        <span class="comment">! -- stream leakage is not head dependent</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        <span class="keywordflow">if</span> (hgwf &lt; bt) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;          rhs = rhs - sumrch</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;        <span class="comment">! -- stream leakage is head dependent</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((sumleak-qsrc) &lt; -dem30) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;          <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;            rhs = rhs + gwfrhs - sumrch</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            rhs = rhs + gwfrhs</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;          hcof = gwfhcof</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        <span class="comment">! -- place holder for UZF</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;          <span class="keywordflow">if</span> (this%gwfiss == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;            rhs = rhs - sumleak - sumrch</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;            rhs = rhs - sumleak</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;      <span class="comment">! -- add groundwater leakage</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hgwf &lt; bt) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        rhs = rhs - sumrch</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bfa2634514f23a92277fc718952915b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bfa2634514f23a92277fc718952915b">&#9670;&nbsp;</a></span>sfr_update_flows()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfrmodule::sfr_update_flows </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>qd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>qgwf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to update downstream flow and groundwater leakage terms for a SFR package reach. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>SfrType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>reach number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qd</td><td>downstream reach flow </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qgwf</td><td>groundwater leakage for reach </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l03567">3567</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;      <span class="keywordtype">class</span>(SfrType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">   !&lt; SfrType object</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment">           !&lt; reach number</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(inout)</span> :: qd<span class="comment">           !&lt; downstream reach flow</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="keywordtype">      real</span>(DP), <span class="keywordtype">intent(in)</span> :: qgwf<span class="comment">            !&lt; groundwater leakage for reach</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idiv</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: jpos</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;<span class="keywordtype">      real</span>(DP) :: qdiv</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;<span class="keywordtype">      real</span>(DP) :: f</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      <span class="comment">! -- update reach terms</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;      <span class="comment">! -- save final downstream stream flow</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      this%dsflow(n) = qd</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      <span class="comment">! -- save groundwater leakage</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      this%gwflow(n) = qgwf</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <span class="comment">! -- route downstream flow</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      <span class="keywordflow">if</span> (qd &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;        <span class="comment">! -- route water to diversions</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;          idiv = this%idiv(i)</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;          <span class="keywordflow">if</span> (idiv == 0) cycle</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;          jpos = this%iadiv(n) + idiv - 1</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;          <span class="keyword">call </span>this%sfr_calc_div(n, idiv, qd, qdiv)</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;          this%qconn(i) = qdiv</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;          this%divq(jpos) = qdiv</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;        <span class="comment">! -- Mover terms: store outflow after diversion loss</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;        <span class="comment">!    as qformvr and reduce outflow (qd)</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;        <span class="comment">!    by how much was actually sent to the mover</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;        <span class="keywordflow">if</span> (this%imover == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;          <span class="keyword">call </span>this%pakmvrobj%accumulate_qformvr(n, qd)</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;          qd = max(qd - this%pakmvrobj%get_qtomvr(n), dzero)</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        <span class="comment">! -- route remaining water to downstream reaches</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;          <span class="keywordflow">if</span> (this%idiv(i) &gt; 0) cycle</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;          n2 = this%ja(i)</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;          f = this%ustrf(n2) / this%ftotnd(n)</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;          this%qconn(i) = qd * f</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;        <span class="keywordflow">do</span> i = this%ia(n) + 1, this%ia(n+1) - 1</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;          <span class="keywordflow">if</span> (this%idir(i) &gt; 0) cycle</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;          this%qconn(i) = dzero</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab14c292fd351befba8b2ed33a9cb65dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14c292fd351befba8b2ed33a9cb65dd">&#9670;&nbsp;</a></span>ftype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenftype) sfrmodule::ftype = 'SFR'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00041">41</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">character(len=LENFTYPE)</span>       :: ftype = <span class="stringliteral">&#39;SFR&#39;</span><span class="comment">                                  !&lt; package ftype string</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe1408ea8d05f91dcfac95cc8e579853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe1408ea8d05f91dcfac95cc8e579853">&#9670;&nbsp;</a></span>text</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenpackagename) sfrmodule::text = ' SFR'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3sfr8_8f90_source.html#l00042">42</a> of file <a class="el" href="gwf3sfr8_8f90_source.html">gwf3sfr8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">character(len=LENPACKAGENAME)</span> :: text  = <span class="stringliteral">&#39;             SFR&#39;</span><span class="comment">                     !&lt; package budget string</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructsfrcrosssectionmanager_1_1sfrcrosssection_html"><div class="ttname"><a href="structsfrcrosssectionmanager_1_1sfrcrosssection.html">sfrcrosssectionmanager::sfrcrosssection</a></div><div class="ttdef"><b>Definition:</b> <a href="_sfr_cross_section_manager_8f90_source.html#l00022">SfrCrossSectionManager.f90:22</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__reallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__reallocate.html">memorymanagermodule::mem_reallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00064">MemoryManager.f90:64</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespacetimeseriesmanagermodule_html"><div class="ttname"><a href="namespacetimeseriesmanagermodule.html">timeseriesmanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_time_series_manager_8f90_source.html#l00001">TimeSeriesManager.f90:1</a></div></div>
<div class="ttc" id="anamespacesfrcrosssectionmanager_html"><div class="ttname"><a href="namespacesfrcrosssectionmanager.html">sfrcrosssectionmanager</a></div><div class="ttdef"><b>Definition:</b> <a href="_sfr_cross_section_manager_8f90_source.html#l00001">SfrCrossSectionManager.f90:1</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html"><div class="ttname"><a href="namespaceopenspecmodule.html">openspecmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00001">OpenSpec.f90:1</a></div></div>
<div class="ttc" id="anamespacegwfsfrcrosssectionutilsmodule_html_acdfa709bd613cffad96ab7f6806ba7a7"><div class="ttname"><a href="namespacegwfsfrcrosssectionutilsmodule.html#acdfa709bd613cffad96ab7f6806ba7a7">gwfsfrcrosssectionutilsmodule::get_cross_section_area</a></div><div class="ttdeci">real(dp) function, public get_cross_section_area(npts, stations, depths, d)</div><div class="ttdoc">Calculate the cross-sectional area for a reach.</div><div class="ttdef"><b>Definition:</b> <a href="_sfr_cross_section_utils_8f90_source.html#l00125">SfrCrossSectionUtils.f90:125</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_aba95664cbd721a2d72df12ac8bb78da8"><div class="ttname"><a href="namespaceconstantsmodule.html#aba95664cbd721a2d72df12ac8bb78da8">constantsmodule::dem6</a></div><div class="ttdeci">real(dp), parameter dem6</div><div class="ttdoc">real constant 1e-6</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00091">Constants.f90:91</a></div></div>
<div class="ttc" id="astructsparsemodule_1_1sparsematrix_html"><div class="ttname"><a href="structsparsemodule_1_1sparsematrix.html">sparsemodule::sparsematrix</a></div><div class="ttdef"><b>Definition:</b> <a href="_sparse_8f90_source.html#l00014">Sparse.f90:14</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html"><div class="ttname"><a href="namespacememoryhelpermodule.html">memoryhelpermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00001">MemoryHelper.f90:1</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_a3791dbc2d4a06a0b9112158cff21f738"><div class="ttname"><a href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:21</a></div></div>
<div class="ttc" id="anamespacetimeseriesmanagermodule_html_a2075a4c123cb1167bfbdaaf4ceae7666"><div class="ttname"><a href="namespacetimeseriesmanagermodule.html#a2075a4c123cb1167bfbdaaf4ceae7666">timeseriesmanagermodule::read_value_or_time_series_adv</a></div><div class="ttdeci">subroutine, public read_value_or_time_series_adv(textInput, ii, jj, bndElem, pkgName, auxOrBnd, tsManager, iprpak, varName)</div><div class="ttdef"><b>Definition:</b> <a href="_time_series_manager_8f90_source.html#l00657">TimeSeriesManager.f90:657</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00204">InputOutput.f90:204</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_a5f22ad41ccf3be8d4bb899e8a1834ff4"><div class="ttname"><a href="namespacetdismodule.html#a5f22ad41ccf3be8d4bb899e8a1834ff4">tdismodule::totim</a></div><div class="ttdeci">real(dp), pointer, public totim</div><div class="ttdoc">time relative to start of simulation</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00032">tdis.f90:32</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_a011f43ae7ec20b725b0092529bda2b73"><div class="ttname"><a href="namespacetdismodule.html#a011f43ae7ec20b725b0092529bda2b73">tdismodule::pertim</a></div><div class="ttdeci">real(dp), pointer, public pertim</div><div class="ttdoc">time relative to start of stress period</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00031">tdis.f90:31</a></div></div>
<div class="ttc" id="anamespacesfrcrosssectionmanager_html_a61b33483d60662b9a866ddadc6cd9b43"><div class="ttname"><a href="namespacesfrcrosssectionmanager.html#a61b33483d60662b9a866ddadc6cd9b43">sfrcrosssectionmanager::cross_section_cr</a></div><div class="ttdeci">subroutine, public cross_section_cr(this, iout, iprpak, nreaches)</div><div class="ttdoc">Create a cross-section object.</div><div class="ttdef"><b>Definition:</b> <a href="_sfr_cross_section_manager_8f90_source.html#l00057">SfrCrossSectionManager.f90:57</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__setptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__setptr.html">memorymanagermodule::mem_setptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00069">MemoryManager.f90:69</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html"><div class="ttname"><a href="namespacebudgetmodule.html">budgetmodule</a></div><div class="ttdoc">This module contains the BudgetModule.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00020">Budget.f90:20</a></div></div>
<div class="ttc" id="astructbudgetmodule_1_1budgettype_html"><div class="ttname"><a href="structbudgetmodule_1_1budgettype.html">budgetmodule::budgettype</a></div><div class="ttdoc">Derived type for the Budget object.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00039">Budget.f90:39</a></div></div>
<div class="ttc" id="anamespacetablemodule_html_a7632d784ec9e94277a76705ef56725f2"><div class="ttname"><a href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">tablemodule::table_cr</a></div><div class="ttdeci">subroutine, public table_cr(this, name, title)</div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00084">Table.f90:84</a></div></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_afd8781393621765a2e864a230a23da50"><div class="ttname"><a href="namespacetdismodule.html#afd8781393621765a2e864a230a23da50">tdismodule::nper</a></div><div class="ttdeci">integer(i4b), pointer, public nper</div><div class="ttdoc">number of stress period</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00022">tdis.f90:22</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_acbfe2090f8aa18049afae5fa4fca29a9"><div class="ttname"><a href="namespaceinputoutputmodule.html#acbfe2090f8aa18049afae5fa4fca29a9">inputoutputmodule::ubdsv06</a></div><div class="ttdeci">subroutine, public ubdsv06(kstp, kper, text, modelnam1, paknam1, modelnam2, paknam2, ibdchn, naux, auxtxt, ncol, nrow, nlay, nlist, iout, delt, pertim, totim)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l01316">InputOutput.f90:1316</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_ade3198b3fa7a2972dae70d888f866536"><div class="ttname"><a href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">openspecmodule::form</a></div><div class="ttdeci">character(len=20) form</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_a5cd9b8ccff306158f81ed8cc744b1e46"><div class="ttname"><a href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">openspecmodule::access</a></div><div class="ttdeci">character(len=20) access</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae9a8dbe15bd2bcb8a85d53d570407ae6"><div class="ttname"><a href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">tdismodule::delt</a></div><div class="ttdeci">real(dp), pointer, public delt</div><div class="ttdoc">length of the current time step</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00030">tdis.f90:30</a></div></div>
<div class="ttc" id="anamespacesparsemodule_html"><div class="ttname"><a href="namespacesparsemodule.html">sparsemodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_sparse_8f90_source.html#l00001">Sparse.f90:1</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00033">InputOutput.f90:33</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a07b5a678851f1bbbca15c9c058818e28"><div class="ttname"><a href="namespaceinputoutputmodule.html#a07b5a678851f1bbbca15c9c058818e28">inputoutputmodule::ulasav</a></div><div class="ttdeci">subroutine, public ulasav(BUF, TEXT, KSTP, KPER, PERTIM, TOTIM, NCOL, NROW, ILAY, ICHN)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l01251">InputOutput.f90:1251</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a1dd99b36c8013b13af6abf45ed99bf3d"><div class="ttname"><a href="namespaceconstantsmodule.html#a1dd99b36c8013b13af6abf45ed99bf3d">constantsmodule::dtwothirds</a></div><div class="ttdeci">real(dp), parameter dtwothirds</div><div class="ttdoc">real constant 2/3</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00059">Constants.f90:59</a></div></div>
<div class="ttc" id="anamespacetimeseriesmanagermodule_html_a709444fc8810a44dd181f632d2a4eb14"><div class="ttname"><a href="namespacetimeseriesmanagermodule.html#a709444fc8810a44dd181f632d2a4eb14">timeseriesmanagermodule::var_timeseries</a></div><div class="ttdeci">logical function, public var_timeseries(tsManager, pkgName, varName, auxOrBnd)</div><div class="ttdef"><b>Definition:</b> <a href="_time_series_manager_8f90_source.html#l00817">TimeSeriesManager.f90:817</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesfrmodule.html">sfrmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:21 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
