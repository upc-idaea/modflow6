<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: adaptivetimestepmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceadaptivetimestepmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">adaptivetimestepmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a95cd63bed2962fac3da7f09aaddbf7de"><td class="memItemLeft" align="right" valign="top">logical(lgp) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a95cd63bed2962fac3da7f09aaddbf7de">isadaptiveperiod</a> (kper)</td></tr>
<tr class="memdesc:a95cd63bed2962fac3da7f09aaddbf7de"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Determine if period is adaptive  <a href="namespaceadaptivetimestepmodule.html#a95cd63bed2962fac3da7f09aaddbf7de">More...</a><br /></td></tr>
<tr class="separator:a95cd63bed2962fac3da7f09aaddbf7de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2c6ad757cfd226850cbde7bb96ad25"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25">ats_cr</a> (inunit, nper_tdis)</td></tr>
<tr class="memdesc:a3e2c6ad757cfd226850cbde7bb96ad25"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create ATS object  <a href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25">More...</a><br /></td></tr>
<tr class="separator:a3e2c6ad757cfd226850cbde7bb96ad25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae21a205956d300f1131589a25525dd13"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#ae21a205956d300f1131589a25525dd13">ats_allocate_scalars</a> ()</td></tr>
<tr class="memdesc:ae21a205956d300f1131589a25525dd13"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespaceadaptivetimestepmodule.html#ae21a205956d300f1131589a25525dd13">More...</a><br /></td></tr>
<tr class="separator:ae21a205956d300f1131589a25525dd13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f35da20567fb391379ed066d335a96f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a1f35da20567fb391379ed066d335a96f">ats_allocate_arrays</a> ()</td></tr>
<tr class="memdesc:a1f35da20567fb391379ed066d335a96f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays  <a href="namespaceadaptivetimestepmodule.html#a1f35da20567fb391379ed066d335a96f">More...</a><br /></td></tr>
<tr class="separator:a1f35da20567fb391379ed066d335a96f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5bba04bd8165e1beeb8372060811b34"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#ab5bba04bd8165e1beeb8372060811b34">ats_da</a> ()</td></tr>
<tr class="memdesc:ab5bba04bd8165e1beeb8372060811b34"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate variables  <a href="namespaceadaptivetimestepmodule.html#ab5bba04bd8165e1beeb8372060811b34">More...</a><br /></td></tr>
<tr class="separator:ab5bba04bd8165e1beeb8372060811b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef8193d44c7240ac3bd111a8c11dc088"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#aef8193d44c7240ac3bd111a8c11dc088">ats_read_options</a> ()</td></tr>
<tr class="memdesc:aef8193d44c7240ac3bd111a8c11dc088"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read options  <a href="namespaceadaptivetimestepmodule.html#aef8193d44c7240ac3bd111a8c11dc088">More...</a><br /></td></tr>
<tr class="separator:aef8193d44c7240ac3bd111a8c11dc088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac998739cb60f15166eaad8b01dd71d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#acac998739cb60f15166eaad8b01dd71d">ats_read_dimensions</a> ()</td></tr>
<tr class="memdesc:acac998739cb60f15166eaad8b01dd71d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read dimensions  <a href="namespaceadaptivetimestepmodule.html#acac998739cb60f15166eaad8b01dd71d">More...</a><br /></td></tr>
<tr class="separator:acac998739cb60f15166eaad8b01dd71d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ce696ecfbbd942b6e7403a6996435d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a12ce696ecfbbd942b6e7403a6996435d">ats_read_timing</a> ()</td></tr>
<tr class="memdesc:a12ce696ecfbbd942b6e7403a6996435d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read timing  <a href="namespaceadaptivetimestepmodule.html#a12ce696ecfbbd942b6e7403a6996435d">More...</a><br /></td></tr>
<tr class="separator:a12ce696ecfbbd942b6e7403a6996435d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd7bac22d77e33343d981b725914c98"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#acdd7bac22d77e33343d981b725914c98">ats_process_input</a> ()</td></tr>
<tr class="memdesc:acdd7bac22d77e33343d981b725914c98"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Process input  <a href="namespaceadaptivetimestepmodule.html#acdd7bac22d77e33343d981b725914c98">More...</a><br /></td></tr>
<tr class="separator:acdd7bac22d77e33343d981b725914c98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a8d5d540da42c6209a4941483f5cdfa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a7a8d5d540da42c6209a4941483f5cdfa">ats_input_table</a> ()</td></tr>
<tr class="memdesc:a7a8d5d540da42c6209a4941483f5cdfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Write input table  <a href="namespaceadaptivetimestepmodule.html#a7a8d5d540da42c6209a4941483f5cdfa">More...</a><br /></td></tr>
<tr class="separator:a7a8d5d540da42c6209a4941483f5cdfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a92d26e6f9b618f7d8ac9b61a1d7bf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a90a92d26e6f9b618f7d8ac9b61a1d7bf">ats_check_timing</a> ()</td></tr>
<tr class="memdesc:a90a92d26e6f9b618f7d8ac9b61a1d7bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Check timing  <a href="namespaceadaptivetimestepmodule.html#a90a92d26e6f9b618f7d8ac9b61a1d7bf">More...</a><br /></td></tr>
<tr class="separator:a90a92d26e6f9b618f7d8ac9b61a1d7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb381d79b778ce01e2c4eff51945d20f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#aeb381d79b778ce01e2c4eff51945d20f">ats_period_message</a> (kper)</td></tr>
<tr class="memdesc:aeb381d79b778ce01e2c4eff51945d20f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Write period message  <a href="namespaceadaptivetimestepmodule.html#aeb381d79b778ce01e2c4eff51945d20f">More...</a><br /></td></tr>
<tr class="separator:aeb381d79b778ce01e2c4eff51945d20f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad192ff605722888a8838928df3598375"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375">ats_submit_delt</a> (kstp, kper, dt, sloc, idir)</td></tr>
<tr class="memdesc:ad192ff605722888a8838928df3598375"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allow and external caller to submit preferred time step  <a href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375">More...</a><br /></td></tr>
<tr class="separator:ad192ff605722888a8838928df3598375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ef7ceed3d7cd5e91a9f407b788fc92f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a1ef7ceed3d7cd5e91a9f407b788fc92f">ats_set_delt</a> (kstp, kper, pertim, perlencurrent, delt)</td></tr>
<tr class="memdesc:a1ef7ceed3d7cd5e91a9f407b788fc92f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set time step  <a href="namespaceadaptivetimestepmodule.html#a1ef7ceed3d7cd5e91a9f407b788fc92f">More...</a><br /></td></tr>
<tr class="separator:a1ef7ceed3d7cd5e91a9f407b788fc92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac42ef52366c6713c5f75da5329f87cad"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#ac42ef52366c6713c5f75da5329f87cad">ats_reset_delt</a> (kstp, kper, lastStepFailed, delt, finishedTrying)</td></tr>
<tr class="memdesc:ac42ef52366c6713c5f75da5329f87cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Reset time step because failure has occurred  <a href="namespaceadaptivetimestepmodule.html#ac42ef52366c6713c5f75da5329f87cad">More...</a><br /></td></tr>
<tr class="separator:ac42ef52366c6713c5f75da5329f87cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ee46460f38cadb79cf7a253368850c0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a4ee46460f38cadb79cf7a253368850c0">ats_set_endofperiod</a> (kper, pertim, perlencurrent, endofperiod)</td></tr>
<tr class="memdesc:a4ee46460f38cadb79cf7a253368850c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set end of period indicator  <a href="namespaceadaptivetimestepmodule.html#a4ee46460f38cadb79cf7a253368850c0">More...</a><br /></td></tr>
<tr class="separator:a4ee46460f38cadb79cf7a253368850c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a94ddb097a24d98dc302ab4a37265fc62"><td class="memItemLeft" align="right" valign="top">integer(i4b), pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a94ddb097a24d98dc302ab4a37265fc62">nper</a> =&gt; null()</td></tr>
<tr class="memdesc:a94ddb097a24d98dc302ab4a37265fc62"><td class="mdescLeft">&#160;</td><td class="mdescRight">set equal to nper  <a href="namespaceadaptivetimestepmodule.html#a94ddb097a24d98dc302ab4a37265fc62">More...</a><br /></td></tr>
<tr class="separator:a94ddb097a24d98dc302ab4a37265fc62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17b36f39d7d5e0b785c7b4911cdbc7b"><td class="memItemLeft" align="right" valign="top">integer(i4b), pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#ab17b36f39d7d5e0b785c7b4911cdbc7b">maxats</a> =&gt; null()</td></tr>
<tr class="memdesc:ab17b36f39d7d5e0b785c7b4911cdbc7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of ats entries  <a href="namespaceadaptivetimestepmodule.html#ab17b36f39d7d5e0b785c7b4911cdbc7b">More...</a><br /></td></tr>
<tr class="separator:ab17b36f39d7d5e0b785c7b4911cdbc7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963fd97debd38d8dd58d7d880cf2f567"><td class="memItemLeft" align="right" valign="top">real(dp), pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a963fd97debd38d8dd58d7d880cf2f567">dtstable</a> =&gt; null()</td></tr>
<tr class="memdesc:a963fd97debd38d8dd58d7d880cf2f567"><td class="mdescLeft">&#160;</td><td class="mdescRight">delt value required for stability  <a href="namespaceadaptivetimestepmodule.html#a963fd97debd38d8dd58d7d880cf2f567">More...</a><br /></td></tr>
<tr class="separator:a963fd97debd38d8dd58d7d880cf2f567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b92ebc71c91c2f5d3ea58007f1138ec"><td class="memItemLeft" align="right" valign="top">integer(i4b), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a9b92ebc71c91c2f5d3ea58007f1138ec">kperats</a> =&gt; null()</td></tr>
<tr class="memdesc:a9b92ebc71c91c2f5d3ea58007f1138ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of stress period numbers to apply ats (size NPER)  <a href="namespaceadaptivetimestepmodule.html#a9b92ebc71c91c2f5d3ea58007f1138ec">More...</a><br /></td></tr>
<tr class="separator:a9b92ebc71c91c2f5d3ea58007f1138ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6266f69359bb720415bfdf5367ebe02"><td class="memItemLeft" align="right" valign="top">integer(i4b), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#af6266f69359bb720415bfdf5367ebe02">iperats</a> =&gt; null()</td></tr>
<tr class="memdesc:af6266f69359bb720415bfdf5367ebe02"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of stress period numbers to apply ats (size MAXATS)  <a href="namespaceadaptivetimestepmodule.html#af6266f69359bb720415bfdf5367ebe02">More...</a><br /></td></tr>
<tr class="separator:af6266f69359bb720415bfdf5367ebe02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ae8eac9f0f41ebd0153537037fdd2a"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#ad7ae8eac9f0f41ebd0153537037fdd2a">dt0</a> =&gt; null()</td></tr>
<tr class="memdesc:ad7ae8eac9f0f41ebd0153537037fdd2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">input array of initial time step sizes  <a href="namespaceadaptivetimestepmodule.html#ad7ae8eac9f0f41ebd0153537037fdd2a">More...</a><br /></td></tr>
<tr class="separator:ad7ae8eac9f0f41ebd0153537037fdd2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79130cfb1742cec2a630cabf9ab20be1"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a79130cfb1742cec2a630cabf9ab20be1">dtmin</a> =&gt; null()</td></tr>
<tr class="memdesc:a79130cfb1742cec2a630cabf9ab20be1"><td class="mdescLeft">&#160;</td><td class="mdescRight">input array of minimum time step sizes  <a href="namespaceadaptivetimestepmodule.html#a79130cfb1742cec2a630cabf9ab20be1">More...</a><br /></td></tr>
<tr class="separator:a79130cfb1742cec2a630cabf9ab20be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80647767c8d3326174a02e7565d0234a"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a80647767c8d3326174a02e7565d0234a">dtmax</a> =&gt; null()</td></tr>
<tr class="memdesc:a80647767c8d3326174a02e7565d0234a"><td class="mdescLeft">&#160;</td><td class="mdescRight">input array of maximum time step sizes  <a href="namespaceadaptivetimestepmodule.html#a80647767c8d3326174a02e7565d0234a">More...</a><br /></td></tr>
<tr class="separator:a80647767c8d3326174a02e7565d0234a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef426d4bb533a3dffc7604df4c888f3f"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#aef426d4bb533a3dffc7604df4c888f3f">dtadj</a> =&gt; null()</td></tr>
<tr class="memdesc:aef426d4bb533a3dffc7604df4c888f3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">input array of time step factors for shortening or increasing  <a href="namespaceadaptivetimestepmodule.html#aef426d4bb533a3dffc7604df4c888f3f">More...</a><br /></td></tr>
<tr class="separator:aef426d4bb533a3dffc7604df4c888f3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d97f72d57e8d87967ed823e55ab0c3"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#a55d97f72d57e8d87967ed823e55ab0c3">dtfailadj</a> =&gt; null()</td></tr>
<tr class="memdesc:a55d97f72d57e8d87967ed823e55ab0c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">input array of time step factors for shortening due to nonconvergence  <a href="namespaceadaptivetimestepmodule.html#a55d97f72d57e8d87967ed823e55ab0c3">More...</a><br /></td></tr>
<tr class="separator:a55d97f72d57e8d87967ed823e55ab0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf58f401738baf042e53d7b96ff8fb4"><td class="memItemLeft" align="right" valign="top">type(blockparsertype)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceadaptivetimestepmodule.html#afdf58f401738baf042e53d7b96ff8fb4">parser</a></td></tr>
<tr class="memdesc:afdf58f401738baf042e53d7b96ff8fb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">block parser for reading input file  <a href="namespaceadaptivetimestepmodule.html#afdf58f401738baf042e53d7b96ff8fb4">More...</a><br /></td></tr>
<tr class="separator:afdf58f401738baf042e53d7b96ff8fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a1f35da20567fb391379ed066d335a96f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f35da20567fb391379ed066d335a96f">&#9670;&nbsp;</a></span>ats_allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_allocate_arrays</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize arrays for the ATS package. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00140">140</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(kperats, nper, <span class="stringliteral">&#39;KPERATS&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(iperats, maxats, <span class="stringliteral">&#39;IPERATS&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(dt0, maxats, <span class="stringliteral">&#39;DT0&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(dtmin, maxats, <span class="stringliteral">&#39;DTMIN&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(dtmax, maxats, <span class="stringliteral">&#39;DTMAX&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(dtadj, maxats, <span class="stringliteral">&#39;DTADJ&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(dtfailadj, maxats, <span class="stringliteral">&#39;DTFAILADJ&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">! -- initialize kperats</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">do</span> n = 1, nper</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      kperats(n) = 0</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">do</span> n = 1, maxats</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      iperats(n) = 0</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      dt0(n) = dzero</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      dtmin(n) = dzero</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      dtmax(n) = dzero</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      dtadj(n) = dzero</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      dtfailadj(n) = dzero</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a1f35da20567fb391379ed066d335a96f_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a1f35da20567fb391379ed066d335a96f_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a1f35da20567fb391379ed066d335a96f_icgraph" id="namespaceadaptivetimestepmodule_a1f35da20567fb391379ed066d335a96f_icgraph">
<area shape="rect" title="@ brief Allocate arrays" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="ae21a205956d300f1131589a25525dd13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae21a205956d300f1131589a25525dd13">&#9670;&nbsp;</a></span>ats_allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_allocate_scalars</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate and initialize scalars for the ATS package. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00117">117</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">! -- memory manager variables</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(nper, <span class="stringliteral">&#39;NPER&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(maxats, <span class="stringliteral">&#39;MAXATS&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(dtstable, <span class="stringliteral">&#39;DTSTABLE&#39;</span>, <span class="stringliteral">&#39;ATS&#39;</span>)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">! -- Initialize variables</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    nper = 0</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    maxats = 0</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    dtstable = dnodata</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_ae21a205956d300f1131589a25525dd13_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_ae21a205956d300f1131589a25525dd13_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_ae21a205956d300f1131589a25525dd13_icgraph" id="namespaceadaptivetimestepmodule_ae21a205956d300f1131589a25525dd13_icgraph">
<area shape="rect" title="@ brief Allocate scalars" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a90a92d26e6f9b618f7d8ac9b61a1d7bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a92d26e6f9b618f7d8ac9b61a1d7bf">&#9670;&nbsp;</a></span>ats_check_timing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_check_timing</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform a check on the input data to make sure values are within required ranges. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00411">411</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING ATS INPUT&#39;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">do</span> n = 1, maxats</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="comment">! -- check iperats</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">if</span> (iperats(n) &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, i0, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          <span class="stringliteral">&#39;IPERATS MUST BE GREATER THAN ZERO.  FOUND &#39;</span>, iperats(n), &amp;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (iperats(n) &gt; nper) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a, i0, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          <span class="stringliteral">&#39;IPERATS GREATER THAN NPER.  FOUND &#39;</span>, iperats(n), &amp;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="comment">! -- check dt0</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">if</span> (dt0(n) &lt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, g15.7, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <span class="stringliteral">&#39;DT0 MUST BE &gt;= ZERO.  FOUND &#39;</span>, dt0(n), &amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">! -- check dtmin</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">if</span> (dtmin(n) &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, g15.7, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <span class="stringliteral">&#39;DTMIN MUST BE &gt; ZERO.  FOUND &#39;</span>, dtmin(n), &amp;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="comment">! -- check dtmax</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">if</span> (dtmax(n) &lt;= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, g15.7, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          <span class="stringliteral">&#39;DTMAX MUST BE &gt; ZERO.  FOUND &#39;</span>, dtmax(n), &amp;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="comment">! -- check dtmin &lt;= dtmax</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">if</span> (dtmin(n) &gt; dtmax(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, 2g15.7, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          <span class="stringliteral">&#39;DTMIN MUST BE &lt; DTMAX.  FOUND &#39;</span>, dtmin(n), dtmax(n), &amp;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="comment">! -- check dtadj</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span> (dtadj(n) .ne. dzero .and. dtadj(n) &lt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, g15.7, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <span class="stringliteral">&#39;DTADJ MUST BE 0 or &gt;= 1.0.  FOUND &#39;</span>, dtadj(n), &amp;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">! -- check dtfailadj</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">if</span> (dtfailadj(n) .ne. dzero .and. dtfailadj(n) &lt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a, g15.7, a, i0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          <span class="stringliteral">&#39;DTFAILADJ MUST BE 0 or &gt;= 1.0.  FOUND &#39;</span>, dtfailadj(n), &amp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          <span class="stringliteral">&#39; FOR ATS PERIODDATA RECORD &#39;</span>, n</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">! -- Check for errors</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span>(count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keyword">call </span>parser%StoreErrorUnit()</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;DONE PROCESSING ATS INPUT&#39;</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_cgraph" id="namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_cgraph">
<area shape="rect" title="@ brief Check timing" alt="" coords="5,61,192,102"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="245,17,429,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="250,68,425,95"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title="Store warning message." alt="" coords="240,119,435,145"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="483,68,621,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="669,27,837,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="669,93,837,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="885,5,1080,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="899,57,1067,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_icgraph" id="namespaceadaptivetimestepmodule_a90a92d26e6f9b618f7d8ac9b61a1d7bf_icgraph">
<area shape="rect" title="@ brief Check timing" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a3e2c6ad757cfd226850cbde7bb96ad25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e2c6ad757cfd226850cbde7bb96ad25">&#9670;&nbsp;</a></span>ats_cr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_cr </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nper_tdis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new ATS object, and read and check input. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00063">63</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunit</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nper_tdis</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtheader = &amp;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="stringliteral">&quot;(1X,/1X,&#39;ATS -- ADAPTIVE TIME STEP PACKAGE,&#39;,   /                  &amp;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral"></span><span class="stringliteral">        &amp;&#39; VERSION 1 : 03/18/2021 - INPUT READ FROM UNIT &#39;,I0)&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">! -- Allocate the scalar variables</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">call </span>ats_allocate_scalars()</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">! -- Identify package</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">write</span>(iout, fmtheader) inunit</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">! -- Initialize block parser</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">call </span>parser%initialize(inunit, iout)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">! -- Read options</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">call </span>ats_read_options()</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">! -- store tdis nper in nper</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    nper = nper_tdis</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">! -- Read dimensions and then allocate arrays</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">call </span>ats_read_dimensions()</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">call </span>ats_allocate_arrays()</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">! -- Read timing</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">call </span>ats_read_timing()</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">! -- Echo input data to table</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">call </span>ats_input_table()</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">! -- Check timing</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">call </span>ats_check_timing()</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">! -- Process input</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">call </span>ats_process_input()</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">! -- Close the file</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">call </span>parser%Clear()</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_cgraph" id="namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_cgraph">
<area shape="rect" title="@ brief Create ATS object" alt="" coords="5,235,192,276"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a1f35da20567fb391379ed066d335a96f" title="@ brief Allocate arrays" alt="" coords="240,5,427,47"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#ae21a205956d300f1131589a25525dd13" title="@ brief Allocate scalars" alt="" coords="240,71,427,112"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a90a92d26e6f9b618f7d8ac9b61a1d7bf" title="@ brief Check timing" alt="" coords="240,136,427,177"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a7a8d5d540da42c6209a4941483f5cdfa" title="@ brief Write input table" alt="" coords="240,397,427,439"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#acdd7bac22d77e33343d981b725914c98" title="@ brief Process input" alt="" coords="240,463,427,504"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#acac998739cb60f15166eaad8b01dd71d" title="@ brief Read dimensions" alt="" coords="240,267,427,308"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#aef8193d44c7240ac3bd111a8c11dc088" title="@ brief Read options" alt="" coords="240,332,427,373"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a12ce696ecfbbd942b6e7403a6996435d" title="@ brief Read timing" alt="" coords="240,201,427,243"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="480,202,664,229"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="485,263,659,290"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title="Store warning message." alt="" coords="475,143,669,170"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="717,263,856,290"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="904,223,1072,264"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="904,288,1072,329"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1120,201,1315,227"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="1133,252,1301,293"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="490,405,654,431"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_icgraph" id="namespaceadaptivetimestepmodule_a3e2c6ad757cfd226850cbde7bb96ad25_icgraph">
<area shape="rect" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="ab5bba04bd8165e1beeb8372060811b34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5bba04bd8165e1beeb8372060811b34">&#9670;&nbsp;</a></span>ats_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_da</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate all ATS variables. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00178">178</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(nper)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(maxats)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(dtstable)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">! -- Arrays</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(kperats)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(iperats)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(dt0)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(dtmin)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(dtmax)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(dtadj)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(dtfailadj)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_ab5bba04bd8165e1beeb8372060811b34_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_ab5bba04bd8165e1beeb8372060811b34_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_ab5bba04bd8165e1beeb8372060811b34_icgraph" id="namespaceadaptivetimestepmodule_ab5bba04bd8165e1beeb8372060811b34_icgraph">
<area shape="rect" title="@ brief Deallocate variables" alt="" coords="783,23,969,65"/>
<area shape="rect" href="namespacetdismodule.html#add64b0264997708a5d9019384517696b" title=" " alt="" coords="584,31,735,57"/>
<area shape="rect" href="namespacemf6coremodule.html#ae17efa5a9e03fd31617a08c08e20ae03" title="Finalize the simulation." alt="" coords="329,31,536,57"/>
<area shape="rect" href="namespacemf6bmi.html#ab8397f78e5c3c405656064c227eca26f" title="Clean up the initialized simulation." alt="" coords="111,5,271,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a7a8d5d540da42c6209a4941483f5cdfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a8d5d540da42c6209a4941483f5cdfa">&#9670;&nbsp;</a></span>ats_input_table()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_input_table</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write a table showing the ATS input read from the perioddata block. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00361">361</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetablemodule.html">tablemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structtablemodule_1_1tabletype.html">tabletype</a>, <a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: tag</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordtype">type</span>(TableType), <span class="keywordtype">pointer</span> :: inputtab =&gt; null()</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">! -- setup table</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">table_cr</a>(inputtab, <span class="stringliteral">&#39;ATS&#39;</span>, <span class="stringliteral">&#39;ATS PERIOD DATA&#39;</span>)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">call </span>inputtab%table_df(maxats, 7, iout)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">! add columns</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    tag = <span class="stringliteral">&#39;RECORD&#39;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    tag = <span class="stringliteral">&#39;IPERATS&#39;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tableft)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    tag = <span class="stringliteral">&#39;DT0&#39;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    tag = <span class="stringliteral">&#39;DTMIN&#39;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    tag = <span class="stringliteral">&#39;DTMAX&#39;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    tag = <span class="stringliteral">&#39;DTADJ&#39;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    tag = <span class="stringliteral">&#39;DTFAILADJ&#39;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">call </span>inputtab%initialize_column(tag, 10, alignment=tabcenter)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">! -- write the data</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">do</span> n = 1, maxats</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keyword">call </span>inputtab%add_term(n)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keyword">call </span>inputtab%add_term(iperats(n))</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keyword">call </span>inputtab%add_term(dt0(n))</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">call </span>inputtab%add_term(dtmin(n))</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">call </span>inputtab%add_term(dtmax(n))</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keyword">call </span>inputtab%add_term(dtadj(n))</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keyword">call </span>inputtab%add_term(dtfailadj(n))</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">    end do</span>      </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">! -- deallocate the table</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keyword">call </span>inputtab%table_da()</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keyword">deallocate</span>(inputtab)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keyword">nullify</span>(inputtab)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_cgraph" id="namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_cgraph">
<area shape="rect" title="@ brief Write input table" alt="" coords="5,5,192,47"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="240,13,404,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_icgraph" id="namespaceadaptivetimestepmodule_a7a8d5d540da42c6209a4941483f5cdfa_icgraph">
<area shape="rect" title="@ brief Write input table" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="aeb381d79b778ce01e2c4eff51945d20f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb381d79b778ce01e2c4eff51945d20f">&#9670;&nbsp;</a></span>ats_period_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_period_message </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write message to mfsim.lst file with information on ATS settings for this period. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00493">493</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmtspts =                                    &amp;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="stringliteral">&quot;(28X,&#39;ATS IS OVERRIDING TIME STEPPING FOR THIS PERIOD&#39;,/                  &amp;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;28X,&#39;INITIAL TIME STEP SIZE                 (DT0) = &#39;,G15.7,/           &amp;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;28X,&#39;MINIMUM TIME STEP SIZE               (DTMIN) = &#39;,G15.7,/           &amp;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;28X,&#39;MAXIMUM TIME STEP SIZE               (DTMAX) = &#39;,G15.7,/           &amp;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;28X,&#39;MULTIPLIER/DIVIDER FOR TIME STEP     (DTADJ) = &#39;,G15.7,/           &amp;</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;28X,&#39;DIVIDER FOR FAILED TIME STEP     (DTFAILADJ) = &#39;,G15.7,/           &amp;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;)&quot;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    n = kperats(kper)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keyword">write</span>(iout, fmtspts) dt0(n), dtmin(n), dtmax(n), dtadj(n), dtfailadj(n)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_aeb381d79b778ce01e2c4eff51945d20f_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_aeb381d79b778ce01e2c4eff51945d20f_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_aeb381d79b778ce01e2c4eff51945d20f_icgraph" id="namespaceadaptivetimestepmodule_aeb381d79b778ce01e2c4eff51945d20f_icgraph">
<area shape="rect" title="@ brief Write period message" alt="" coords="1099,53,1285,94"/>
<area shape="rect" href="namespacetdismodule.html#abd45660eec3b564280930a654ab2f71d" title=" " alt="" coords="896,53,1051,94"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="581,60,848,87"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="329,31,533,57"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="350,82,513,123"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,5,271,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="acdd7bac22d77e33343d981b725914c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdd7bac22d77e33343d981b725914c98">&#9670;&nbsp;</a></span>ats_process_input()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_process_input</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Process ATS input by filling the kperats array. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00343">343</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: kkper</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">! -- fill kperats for valid iperats values</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">do</span> n = 1, maxats</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      kkper = iperats(n)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">if</span> (kkper &gt; 0 .and. kkper &lt;= nper) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        kperats(kkper) = n</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_acdd7bac22d77e33343d981b725914c98_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_acdd7bac22d77e33343d981b725914c98_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_acdd7bac22d77e33343d981b725914c98_icgraph" id="namespaceadaptivetimestepmodule_acdd7bac22d77e33343d981b725914c98_icgraph">
<area shape="rect" title="@ brief Process input" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="acac998739cb60f15166eaad8b01dd71d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac998739cb60f15166eaad8b01dd71d">&#9670;&nbsp;</a></span>ats_read_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_read_dimensions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read dimensions from ATS input file. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00243">243</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtmaxats = &amp;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="stringliteral">&quot;(1X,I0,&#39; ADAPTIVE TIME STEP RECORDS(S) WILL FOLLOW IN PERIODDATA&#39;)&quot;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">! -- get DIMENSIONS block</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">call </span>parser%GetBlock(<span class="stringliteral">&#39;DIMENSIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      supportopenclose=.true.)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">! -- parse block if detected</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING ATS DIMENSIONS&#39;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keyword">call </span>parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keyword">call </span>parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;MAXATS&#39;</span>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            maxats = parser%GetInteger()</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keyword">write</span>(iout, fmtmaxats) maxats</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(4x,a,a)&#39;</span>)<span class="stringliteral">&#39;****ERROR. UNKNOWN ATS DIMENSION: &#39;</span>,     &amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                      trim(keyword)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keyword">call </span>parser%StoreErrorUnit()</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF ATS DIMENSIONS&#39;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;ERROR.  REQUIRED DIMENSIONS BLOCK NOT FOUND.&#39;</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keyword">call </span>parser%StoreErrorUnit()</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_cgraph" id="namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_cgraph">
<area shape="rect" title="@ brief Read dimensions" alt="" coords="5,61,192,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="240,68,415,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="463,68,601,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="649,27,817,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="649,93,817,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="865,5,1060,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="879,57,1047,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_icgraph" id="namespaceadaptivetimestepmodule_acac998739cb60f15166eaad8b01dd71d_icgraph">
<area shape="rect" title="@ brief Read dimensions" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="aef8193d44c7240ac3bd111a8c11dc088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef8193d44c7240ac3bd111a8c11dc088">&#9670;&nbsp;</a></span>ats_read_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_read_options</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read options from ATS input file. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00204">204</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">call </span>parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      supportopenclose=.true., blockrequired=.false.)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING ATS OPTIONS&#39;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">call </span>parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keyword">call </span>parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(4x,a,a)&#39;</span>)<span class="stringliteral">&#39;****ERROR. UNKNOWN ATS OPTION: &#39;</span>,        &amp;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                    trim(keyword)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          <span class="keyword">call </span>parser%StoreErrorUnit()</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF ATS OPTIONS&#39;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_cgraph" id="namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_cgraph">
<area shape="rect" title="@ brief Read options" alt="" coords="5,61,192,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="240,68,415,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="463,68,601,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="649,27,817,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="649,93,817,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="865,5,1060,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="879,57,1047,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_icgraph" id="namespaceadaptivetimestepmodule_aef8193d44c7240ac3bd111a8c11dc088_icgraph">
<area shape="rect" title="@ brief Read options" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a12ce696ecfbbd942b6e7403a6996435d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12ce696ecfbbd942b6e7403a6996435d">&#9670;&nbsp;</a></span>ats_read_timing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adaptivetimestepmodule::ats_read_timing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read timing information from ATS input file. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00291">291</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">! -- get PERIODDATA block</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">call </span>parser%GetBlock(<span class="stringliteral">&#39;PERIODDATA&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      supportopenclose=.true.)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">! -- parse block if detected</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;READING ATS PERIODDATA&#39;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">do</span> n = 1, maxats</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">call </span>parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">! -- fill the ats data arrays</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        iperats(n) = parser%GetInteger()</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        dt0(n) = parser%GetDouble()</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        dtmin(n) = parser%GetDouble()</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        dtmax(n) = parser%GetDouble()</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        dtadj(n) = parser%GetDouble()</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        dtfailadj(n) = parser%GetDouble()</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">! -- Close the block</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keyword">call </span>parser%terminateblock()</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">! -- Check for errors</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">if</span>(count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">call </span>parser%StoreErrorUnit()</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keyword">write</span>(iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END READING ATS PERIODDATA&#39;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;ERROR.  REQUIRED PERIODDATA BLOCK NOT FOUND.&#39;</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keyword">call </span>parser%StoreErrorUnit()</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_cgraph" id="namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_cgraph">
<area shape="rect" title="@ brief Read timing" alt="" coords="5,35,192,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="240,17,424,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="245,68,419,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="472,68,611,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="659,27,827,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="659,93,827,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="875,5,1069,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="888,57,1056,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_icgraph" id="namespaceadaptivetimestepmodule_a12ce696ecfbbd942b6e7403a6996435d_icgraph">
<area shape="rect" title="@ brief Read timing" alt="" coords="1727,23,1913,65"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a3e2c6ad757cfd226850cbde7bb96ad25" title="@ brief Create ATS object" alt="" coords="1492,23,1679,65"/>
<area shape="rect" href="namespacetdismodule.html#a8c9a06d57dc33ece9ff2351b6ba13d61" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#aad107ec5cfffd2e81af220f8227c926f" title="Set the timing module to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="ac42ef52366c6713c5f75da5329f87cad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac42ef52366c6713c5f75da5329f87cad">&#9670;&nbsp;</a></span>ats_reset_delt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_reset_delt </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>lastStepFailed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>finishedTrying</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset the time step using dtfailadj because the time step did not converge. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00634">634</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: lastStepFailed</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: delt</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span> :: finishedTrying</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordtype">    real</span>(DP) :: delt_temp</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">    real</span>(DP) :: tsfact</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: fmttsi =                                     &amp;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="stringliteral">&quot;(1X, &#39;Failed solution for step &#39;, i0, &#39; and period &#39;, i0, &amp;</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; will be retried using time step of &#39;, G15.7)&quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (isadaptiveperiod(kper)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">if</span> (laststepfailed /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        delt_temp = delt</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        n = kperats(kper)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        tsfact = dtfailadj(n)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span> (tsfact &gt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          delt_temp = delt / tsfact</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          <span class="keywordflow">if</span> (delt_temp &gt;= dtmin(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            finishedtrying = .false.</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            delt = delt_temp</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="keyword">write</span>(iout, fmttsi) kstp, kper, delt</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_cgraph" id="namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_cgraph">
<area shape="rect" title="@ brief Reset time step because failure has occurred" alt="" coords="5,5,192,47"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a95cd63bed2962fac3da7f09aaddbf7de" title="@ brief Determine if period is adaptive" alt="" coords="240,5,427,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_icgraph" id="namespaceadaptivetimestepmodule_ac42ef52366c6713c5f75da5329f87cad_icgraph">
<area shape="rect" title="@ brief Reset time step because failure has occurred" alt="" coords="1068,49,1255,90"/>
<area shape="rect" href="namespacemf6coremodule.html#aa3df08d0706463a5a6574eac307a6636" title="Rerun time step." alt="" coords="863,49,1020,90"/>
<area shape="rect" href="namespacemf6coremodule.html#a0e06aa9086d6da08ce7a9a4982905d39" title="Run time step." alt="" coords="581,56,815,83"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="329,31,533,57"/>
<area shape="rect" href="namespacemf6xmi.html#af733bd6bec65ca70994f1b14b474f9a3" title="Perform a single time step." alt="" coords="331,81,532,108"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,5,271,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a1ef7ceed3d7cd5e91a9f407b788fc92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ef7ceed3d7cd5e91a9f407b788fc92f">&#9670;&nbsp;</a></span>ats_set_delt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_set_delt </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>pertim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>perlencurrent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>delt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the time step length (delt) for this time step using the ATS controls. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00567">567</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: pertim</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: perlencurrent</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: delt</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordtype">    real</span>(DP) :: tstart</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtdt =                               &amp;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      &amp;<span class="stringliteral">&quot;(1x, &#39;ATS: time step set to &#39;, G15.7, &#39; for step &#39;, i0,          &amp;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; and period &#39;, i0)&quot;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">! -- initialize the record position (n) for this stress period</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    n = kperats(kper)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">! -- set tstart to the end of the last time step.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    tstart = pertim</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">! -- Calculate delt</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">! -- Setup new stress period if kstp is 1</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span>(kstp == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">! -- Assign first value of delt for this stress period</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">if</span> (dt0(n) /= dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        delt = dt0(n)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">! leave delt the way it was</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">! -- Assign delt based on stability</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">if</span> (dtstable /= dnodata) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        delt = dtstable</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        dtstable = dnodata</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">! -- Ensure  tsmin &lt; delt &lt; tsmax</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> (delt &lt; dtmin(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      delt = dtmin(n)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">if</span> (delt &gt; dtmax(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      delt = dtmax(n)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">! -- Cut timestep down to meet end of period</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (tstart + delt &gt; perlencurrent - dtmin(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      delt = perlencurrent - tstart</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">! -- Write time step size information</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keyword">write</span>(iout, fmtdt) delt, kstp, kper</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a1ef7ceed3d7cd5e91a9f407b788fc92f_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a1ef7ceed3d7cd5e91a9f407b788fc92f_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a1ef7ceed3d7cd5e91a9f407b788fc92f_icgraph" id="namespaceadaptivetimestepmodule_a1ef7ceed3d7cd5e91a9f407b788fc92f_icgraph">
<area shape="rect" title="@ brief Set time step" alt="" coords="1384,39,1571,80"/>
<area shape="rect" href="namespacetdismodule.html#ae74144fd4dafbd8f5ec90936c9c349cc" title=" " alt="" coords="1177,5,1336,47"/>
<area shape="rect" href="namespacetdismodule.html#aab649a48eda520fa2cda5ecc6ad1c5b0" title=" " alt="" coords="1179,71,1334,112"/>
<area shape="rect" href="namespacemf6coremodule.html#aa3df08d0706463a5a6574eac307a6636" title="Rerun time step." alt="" coords="917,5,1075,47"/>
<area shape="rect" href="namespacemf6coremodule.html#a0e06aa9086d6da08ce7a9a4982905d39" title="Run time step." alt="" coords="581,13,815,39"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="329,63,533,90"/>
<area shape="rect" href="namespacemf6xmi.html#af733bd6bec65ca70994f1b14b474f9a3" title="Perform a single time step." alt="" coords="331,13,532,39"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,38,271,65"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,89,281,115"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,89,53,115"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="863,78,1129,105"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="617,115,779,156"/>
</map>
</div>

</div>
</div>
<a id="a4ee46460f38cadb79cf7a253368850c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ee46460f38cadb79cf7a253368850c0">&#9670;&nbsp;</a></span>ats_set_endofperiod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_set_endofperiod </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>pertim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>perlencurrent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(lgp), intent(inout)&#160;</td>
          <td class="paramname"><em>endofperiod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine if it is the end of the stress period and set the endofperiod logical variable if so. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00675">675</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: pertim</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: perlencurrent</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">logical(LGP)</span>, <span class="keywordtype">intent(inout)</span> :: endofperiod</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">! -- End of stress period and/or simulation?  </span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    n = kperats(kper)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (abs(pertim - perlencurrent) &lt; dtmin(n)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      endofperiod = .true.</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a4ee46460f38cadb79cf7a253368850c0_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a4ee46460f38cadb79cf7a253368850c0_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a4ee46460f38cadb79cf7a253368850c0_icgraph" id="namespaceadaptivetimestepmodule_a4ee46460f38cadb79cf7a253368850c0_icgraph">
<area shape="rect" title="@ brief Set end of period indicator" alt="" coords="1384,39,1571,80"/>
<area shape="rect" href="namespacetdismodule.html#ae74144fd4dafbd8f5ec90936c9c349cc" title=" " alt="" coords="1177,5,1336,47"/>
<area shape="rect" href="namespacetdismodule.html#aab649a48eda520fa2cda5ecc6ad1c5b0" title=" " alt="" coords="1179,71,1334,112"/>
<area shape="rect" href="namespacemf6coremodule.html#aa3df08d0706463a5a6574eac307a6636" title="Rerun time step." alt="" coords="917,5,1075,47"/>
<area shape="rect" href="namespacemf6coremodule.html#a0e06aa9086d6da08ce7a9a4982905d39" title="Run time step." alt="" coords="581,13,815,39"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="329,63,533,90"/>
<area shape="rect" href="namespacemf6xmi.html#af733bd6bec65ca70994f1b14b474f9a3" title="Perform a single time step." alt="" coords="331,13,532,39"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,38,271,65"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,89,281,115"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,89,53,115"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="863,78,1129,105"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="617,115,779,156"/>
</map>
</div>

</div>
</div>
<a id="ad192ff605722888a8838928df3598375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad192ff605722888a8838928df3598375">&#9670;&nbsp;</a></span>ats_submit_delt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public adaptivetimestepmodule::ats_submit_delt </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>sloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>idir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Submit a preferred time step length. Alternatively, if idir is is passed, then either increase or decrease the submitted time step by the dtadj input variable. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00518">518</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: dt</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: sloc</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: idir</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordtype">    real</span>(DP) :: tsfact</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordtype">    real</span>(DP) :: dt_temp</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtdtsubmit =                               &amp;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      &amp;<span class="stringliteral">&quot;(1x, &#39;ATS: &#39;, A,&#39; submitted a preferred time step size of &#39;, G15.7)&quot;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span> (isadaptiveperiod(kper)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      n = kperats(kper)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      tsfact = dtadj(n)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span> (tsfact &gt; done) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">! -- if idir is present, then dt is a length that should be adjusted</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">!    (divided by or multiplied by) by dtadj.  If idir is not present</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">!    then dt is the submitted time step.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(idir)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          dt_temp = dzero</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          <span class="keywordflow">if</span> (idir == -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            dt_temp = dt / tsfact</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idir == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            dt_temp = dt * tsfact</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          dt_temp = dt</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">if</span> (kstp &gt; 1 .and. dt_temp &gt; dzero) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="keyword">write</span>(iout, fmtdtsubmit) trim(adjustl(sloc)), dt_temp</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span> (dt_temp &gt; dzero .and. dt_temp &lt; dtstable) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="comment">! -- Reset dtstable to a smaller value</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          dtstable = dt_temp</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_cgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_cgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_cgraph" id="namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_cgraph">
<area shape="rect" title="@ brief Allow and external caller to submit preferred time step" alt="" coords="5,5,192,47"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#a95cd63bed2962fac3da7f09aaddbf7de" title="@ brief Determine if period is adaptive" alt="" coords="240,5,427,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_icgraph" id="namespaceadaptivetimestepmodule_ad192ff605722888a8838928df3598375_icgraph">
<area shape="rect" title="@ brief Allow and external caller to submit preferred time step" alt="" coords="241,5,428,47"/>
<area shape="rect" href="namespacenumericalsolutionmodule.html#a0532bb986b3da12da5b753fc999bbe0e" title="@ brief Calculate delt" alt="" coords="5,5,193,47"/>
</map>
</div>

</div>
</div>
<a id="a95cd63bed2962fac3da7f09aaddbf7de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cd63bed2962fac3da7f09aaddbf7de">&#9670;&nbsp;</a></span>isadaptiveperiod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical(lgp) function, public adaptivetimestepmodule::isadaptiveperiod </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check settings and determine if kper is an adaptive stress period. </p>

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00046">46</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: lv</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    lv = .false.</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(kperats)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">if</span> (kperats(kper) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        lv = .true.</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceadaptivetimestepmodule_a95cd63bed2962fac3da7f09aaddbf7de_icgraph.png" border="0" usemap="#namespaceadaptivetimestepmodule_a95cd63bed2962fac3da7f09aaddbf7de_icgraph" alt=""/></div>
<map name="namespaceadaptivetimestepmodule_a95cd63bed2962fac3da7f09aaddbf7de_icgraph" id="namespaceadaptivetimestepmodule_a95cd63bed2962fac3da7f09aaddbf7de_icgraph">
<area shape="rect" title="@ brief Determine if period is adaptive" alt="" coords="1412,136,1599,177"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#ac42ef52366c6713c5f75da5329f87cad" title="@ brief Reset time step because failure has occurred" alt="" coords="1177,5,1364,47"/>
<area shape="rect" href="namespaceadaptivetimestepmodule.html#ad192ff605722888a8838928df3598375" title="@ brief Allow and external caller to submit preferred time step" alt="" coords="1177,136,1364,177"/>
<area shape="rect" href="namespacetdismodule.html#ae74144fd4dafbd8f5ec90936c9c349cc" title=" " alt="" coords="1191,71,1350,112"/>
<area shape="rect" href="namespacetdismodule.html#abd45660eec3b564280930a654ab2f71d" title=" " alt="" coords="1193,201,1348,243"/>
<area shape="rect" href="namespacetdismodule.html#aab649a48eda520fa2cda5ecc6ad1c5b0" title=" " alt="" coords="1193,267,1348,308"/>
<area shape="rect" href="namespacemf6coremodule.html#aa3df08d0706463a5a6574eac307a6636" title="Rerun time step." alt="" coords="917,71,1075,112"/>
<area shape="rect" href="namespacemf6coremodule.html#a0e06aa9086d6da08ce7a9a4982905d39" title="Run time step." alt="" coords="581,83,815,110"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="329,137,533,163"/>
<area shape="rect" href="namespacemf6xmi.html#af733bd6bec65ca70994f1b14b474f9a3" title="Perform a single time step." alt="" coords="331,83,532,110"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,111,271,138"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,162,281,189"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,162,53,189"/>
<area shape="rect" href="namespacenumericalsolutionmodule.html#a0532bb986b3da12da5b753fc999bbe0e" title="@ brief Calculate delt" alt="" coords="902,136,1090,177"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="863,209,1129,235"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="617,201,779,243"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad7ae8eac9f0f41ebd0153537037fdd2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ae8eac9f0f41ebd0153537037fdd2a">&#9670;&nbsp;</a></span>dt0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), pointer, contiguous adaptivetimestepmodule::dt0 =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00030">30</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>      :: dt0 =&gt; null()        <span class="comment">!&lt; input array of initial time step sizes</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef426d4bb533a3dffc7604df4c888f3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef426d4bb533a3dffc7604df4c888f3f">&#9670;&nbsp;</a></span>dtadj</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), pointer, contiguous adaptivetimestepmodule::dtadj =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00033">33</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>      :: dtadj =&gt; null()      <span class="comment">!&lt; input array of time step factors for shortening or increasing</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55d97f72d57e8d87967ed823e55ab0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d97f72d57e8d87967ed823e55ab0c3">&#9670;&nbsp;</a></span>dtfailadj</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), pointer, contiguous adaptivetimestepmodule::dtfailadj =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00034">34</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>      :: dtfailadj =&gt; null()  <span class="comment">!&lt; input array of time step factors for shortening due to nonconvergence</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a80647767c8d3326174a02e7565d0234a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80647767c8d3326174a02e7565d0234a">&#9670;&nbsp;</a></span>dtmax</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), pointer, contiguous adaptivetimestepmodule::dtmax =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00032">32</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>      :: dtmax =&gt; null()      <span class="comment">!&lt; input array of maximum time step sizes</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79130cfb1742cec2a630cabf9ab20be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79130cfb1742cec2a630cabf9ab20be1">&#9670;&nbsp;</a></span>dtmin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), pointer, contiguous adaptivetimestepmodule::dtmin =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00031">31</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>      :: dtmin =&gt; null()      <span class="comment">!&lt; input array of minimum time step sizes</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a963fd97debd38d8dd58d7d880cf2f567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a963fd97debd38d8dd58d7d880cf2f567">&#9670;&nbsp;</a></span>dtstable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), pointer, public adaptivetimestepmodule::dtstable =&gt; null()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00027">27</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keywordtype">  real</span>(DP), <span class="keywordtype">public</span>, <span class="keywordtype">pointer</span>                        :: dtstable =&gt; null()   <span class="comment">!&lt; delt value required for stability</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6266f69359bb720415bfdf5367ebe02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6266f69359bb720415bfdf5367ebe02">&#9670;&nbsp;</a></span>iperats</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b), dimension(:), pointer, contiguous adaptivetimestepmodule::iperats =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00029">29</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>  :: iperats =&gt; null()    <span class="comment">!&lt; array of stress period numbers to apply ats (size MAXATS)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b92ebc71c91c2f5d3ea58007f1138ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b92ebc71c91c2f5d3ea58007f1138ec">&#9670;&nbsp;</a></span>kperats</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b), dimension(:), pointer, contiguous adaptivetimestepmodule::kperats =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00028">28</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span>  :: kperats =&gt; null()    <span class="comment">!&lt; array of stress period numbers to apply ats (size NPER)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab17b36f39d7d5e0b785c7b4911cdbc7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab17b36f39d7d5e0b785c7b4911cdbc7b">&#9670;&nbsp;</a></span>maxats</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b), pointer adaptivetimestepmodule::maxats =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00026">26</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">pointer</span>                            :: maxats =&gt; null()     <span class="comment">!&lt; number of ats entries</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94ddb097a24d98dc302ab4a37265fc62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ddb097a24d98dc302ab4a37265fc62">&#9670;&nbsp;</a></span>nper</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b), pointer adaptivetimestepmodule::nper =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00025">25</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">pointer</span>                            :: nper =&gt; null()       <span class="comment">!&lt; set equal to nper</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afdf58f401738baf042e53d7b96ff8fb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf58f401738baf042e53d7b96ff8fb4">&#9670;&nbsp;</a></span>parser</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(blockparsertype) adaptivetimestepmodule::parser</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ats_8f90_source.html#l00035">35</a> of file <a class="el" href="ats_8f90_source.html">ats.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">type</span>(BlockParserType)                            :: parser<span class="comment">               !&lt; block parser for reading input file</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespacetablemodule_html_a7632d784ec9e94277a76705ef56725f2"><div class="ttname"><a href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2">tablemodule::table_cr</a></div><div class="ttdeci">subroutine, public table_cr(this, name, title)</div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00084">Table.f90:84</a></div></div>
<div class="ttc" id="astructtablemodule_1_1tabletype_html"><div class="ttname"><a href="structtablemodule_1_1tabletype.html">tablemodule::tabletype</a></div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00020">Table.f90:20</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespacetablemodule_html"><div class="ttname"><a href="namespacetablemodule.html">tablemodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_table_8f90_source.html#l00004">Table.f90:4</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceadaptivetimestepmodule.html">adaptivetimestepmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:11 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
