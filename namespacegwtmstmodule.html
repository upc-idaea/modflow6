<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: gwtmstmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.3.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacegwtmstmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gwtmstmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>&ndash; @ brief Mobile Storage and Transfer (MST) Module  
<a href="namespacegwtmstmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Mobile storage and transfer  <a href="structgwtmstmodule_1_1gwtmsttype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:adb0aad5ec852b458c2a6337129abc351"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#adb0aad5ec852b458c2a6337129abc351">mst_cr</a> (mstobj, name_model, inunit, iout, fmi)</td></tr>
<tr class="memdesc:adb0aad5ec852b458c2a6337129abc351"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new package object  <a href="namespacegwtmstmodule.html#adb0aad5ec852b458c2a6337129abc351">More...</a><br /></td></tr>
<tr class="separator:adb0aad5ec852b458c2a6337129abc351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946b4afceb1db25d4d884a4b52e0f0b8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a946b4afceb1db25d4d884a4b52e0f0b8">mst_ar</a> (this, dis, ibound)</td></tr>
<tr class="memdesc:a946b4afceb1db25d4d884a4b52e0f0b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read method for package  <a href="namespacegwtmstmodule.html#a946b4afceb1db25d4d884a4b52e0f0b8">More...</a><br /></td></tr>
<tr class="separator:a946b4afceb1db25d4d884a4b52e0f0b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a734b8accbe6962f13ff2572ab7f32b42"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a734b8accbe6962f13ff2572ab7f32b42">mst_fc</a> (this, nodes, cold, nja, njasln, amatsln, idxglo, cnew, rhs, kiter)</td></tr>
<tr class="memdesc:a734b8accbe6962f13ff2572ab7f32b42"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill coefficient method for package  <a href="namespacegwtmstmodule.html#a734b8accbe6962f13ff2572ab7f32b42">More...</a><br /></td></tr>
<tr class="separator:a734b8accbe6962f13ff2572ab7f32b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8142aa6c3072e9f4451216f5b9d31b63"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a8142aa6c3072e9f4451216f5b9d31b63">mst_fc_sto</a> (this, nodes, cold, nja, njasln, amatsln, idxglo, rhs)</td></tr>
<tr class="memdesc:a8142aa6c3072e9f4451216f5b9d31b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill storage coefficient method for package  <a href="namespacegwtmstmodule.html#a8142aa6c3072e9f4451216f5b9d31b63">More...</a><br /></td></tr>
<tr class="separator:a8142aa6c3072e9f4451216f5b9d31b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5df6f8c8ed881ab7378a8cdb61483bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#ab5df6f8c8ed881ab7378a8cdb61483bd">mst_fc_dcy</a> (this, nodes, cold, cnew, nja, njasln, amatsln, idxglo, rhs, kiter)</td></tr>
<tr class="memdesc:ab5df6f8c8ed881ab7378a8cdb61483bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill decay coefficient method for package  <a href="namespacegwtmstmodule.html#ab5df6f8c8ed881ab7378a8cdb61483bd">More...</a><br /></td></tr>
<tr class="separator:ab5df6f8c8ed881ab7378a8cdb61483bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae85f0f1a250d1f5ad4d2e3657e2c1aac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac">mst_fc_srb</a> (this, nodes, cold, nja, njasln, amatsln, idxglo, rhs, cnew)</td></tr>
<tr class="memdesc:ae85f0f1a250d1f5ad4d2e3657e2c1aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill sorption coefficient method for package  <a href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac">More...</a><br /></td></tr>
<tr class="separator:ae85f0f1a250d1f5ad4d2e3657e2c1aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67855ad68874c8c6bf7cdd74dfd3fa14"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14">mst_srb_term</a> (isrb, thetamfrac, rhob, vcell, tled, cnew, cold, swnew, swold, const1, const2, rate, hcofval, rhsval)</td></tr>
<tr class="memdesc:a67855ad68874c8c6bf7cdd74dfd3fa14"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate sorption terms  <a href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14">More...</a><br /></td></tr>
<tr class="separator:a67855ad68874c8c6bf7cdd74dfd3fa14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411dd441b93b747a04ba37f718a0a283"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a411dd441b93b747a04ba37f718a0a283">mst_fc_dcy_srb</a> (this, nodes, cold, nja, njasln, amatsln, idxglo, rhs, cnew, kiter)</td></tr>
<tr class="memdesc:a411dd441b93b747a04ba37f718a0a283"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill sorption-decay coefficient method for package  <a href="namespacegwtmstmodule.html#a411dd441b93b747a04ba37f718a0a283">More...</a><br /></td></tr>
<tr class="separator:a411dd441b93b747a04ba37f718a0a283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a478b81bdc62688ed1803ff103ad7385d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a478b81bdc62688ed1803ff103ad7385d">mst_cq</a> (this, nodes, cnew, cold, flowja)</td></tr>
<tr class="memdesc:a478b81bdc62688ed1803ff103ad7385d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate flows for package  <a href="namespacegwtmstmodule.html#a478b81bdc62688ed1803ff103ad7385d">More...</a><br /></td></tr>
<tr class="separator:a478b81bdc62688ed1803ff103ad7385d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c3ef04226a8368969a56ec29766a74"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#ae1c3ef04226a8368969a56ec29766a74">mst_cq_sto</a> (this, nodes, cnew, cold, flowja)</td></tr>
<tr class="memdesc:ae1c3ef04226a8368969a56ec29766a74"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate storage terms for package  <a href="namespacegwtmstmodule.html#ae1c3ef04226a8368969a56ec29766a74">More...</a><br /></td></tr>
<tr class="separator:ae1c3ef04226a8368969a56ec29766a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bc28b904447d8ef01cebab46e6ab33c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a9bc28b904447d8ef01cebab46e6ab33c">mst_cq_dcy</a> (this, nodes, cnew, cold, flowja)</td></tr>
<tr class="memdesc:a9bc28b904447d8ef01cebab46e6ab33c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate decay terms for package  <a href="namespacegwtmstmodule.html#a9bc28b904447d8ef01cebab46e6ab33c">More...</a><br /></td></tr>
<tr class="separator:a9bc28b904447d8ef01cebab46e6ab33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fa9bb36f8c226b9ad2d28a5f0a08c3b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b">mst_cq_srb</a> (this, nodes, cnew, cold, flowja)</td></tr>
<tr class="memdesc:a0fa9bb36f8c226b9ad2d28a5f0a08c3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate sorption terms for package  <a href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b">More...</a><br /></td></tr>
<tr class="separator:a0fa9bb36f8c226b9ad2d28a5f0a08c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a85e819e4468cd47eb01f1eba60e3f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a6a85e819e4468cd47eb01f1eba60e3f6">mst_cq_dcy_srb</a> (this, nodes, cnew, cold, flowja)</td></tr>
<tr class="memdesc:a6a85e819e4468cd47eb01f1eba60e3f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate decay-sorption terms for package  <a href="namespacegwtmstmodule.html#a6a85e819e4468cd47eb01f1eba60e3f6">More...</a><br /></td></tr>
<tr class="separator:a6a85e819e4468cd47eb01f1eba60e3f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c5b3f7739e5780f9c8174ed786f8b4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a55c5b3f7739e5780f9c8174ed786f8b4">mst_bd</a> (this, isuppress_output, model_budget)</td></tr>
<tr class="memdesc:a55c5b3f7739e5780f9c8174ed786f8b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate budget terms for package  <a href="namespacegwtmstmodule.html#a55c5b3f7739e5780f9c8174ed786f8b4">More...</a><br /></td></tr>
<tr class="separator:a55c5b3f7739e5780f9c8174ed786f8b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83986692420567168b2a0714c0f1d87e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a83986692420567168b2a0714c0f1d87e">mst_ot_flow</a> (this, icbcfl, icbcun)</td></tr>
<tr class="memdesc:a83986692420567168b2a0714c0f1d87e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output flow terms for package  <a href="namespacegwtmstmodule.html#a83986692420567168b2a0714c0f1d87e">More...</a><br /></td></tr>
<tr class="separator:a83986692420567168b2a0714c0f1d87e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab997259f35f25e6dd916f95ce36c725f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#ab997259f35f25e6dd916f95ce36c725f">mst_da</a> (this)</td></tr>
<tr class="memdesc:ab997259f35f25e6dd916f95ce36c725f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate  <a href="namespacegwtmstmodule.html#ab997259f35f25e6dd916f95ce36c725f">More...</a><br /></td></tr>
<tr class="separator:ab997259f35f25e6dd916f95ce36c725f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d11d92183647bc768b266af6054f31d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a9d11d92183647bc768b266af6054f31d">allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:a9d11d92183647bc768b266af6054f31d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalar variables for package  <a href="namespacegwtmstmodule.html#a9d11d92183647bc768b266af6054f31d">More...</a><br /></td></tr>
<tr class="separator:a9d11d92183647bc768b266af6054f31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d0786badf360f7f302f2426402b982"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a57d0786badf360f7f302f2426402b982">allocate_arrays</a> (this, nodes)</td></tr>
<tr class="memdesc:a57d0786badf360f7f302f2426402b982"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays for package  <a href="namespacegwtmstmodule.html#a57d0786badf360f7f302f2426402b982">More...</a><br /></td></tr>
<tr class="separator:a57d0786badf360f7f302f2426402b982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d176c88873cd8b526fe6db4c3f68ffb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a8d176c88873cd8b526fe6db4c3f68ffb">read_options</a> (this)</td></tr>
<tr class="memdesc:a8d176c88873cd8b526fe6db4c3f68ffb"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read options for package  <a href="namespacegwtmstmodule.html#a8d176c88873cd8b526fe6db4c3f68ffb">More...</a><br /></td></tr>
<tr class="separator:a8d176c88873cd8b526fe6db4c3f68ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d09f066cfdab8c675bf6191b267a71e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a9d09f066cfdab8c675bf6191b267a71e">read_data</a> (this)</td></tr>
<tr class="memdesc:a9d09f066cfdab8c675bf6191b267a71e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read data for package  <a href="namespacegwtmstmodule.html#a9d09f066cfdab8c675bf6191b267a71e">More...</a><br /></td></tr>
<tr class="separator:a9d09f066cfdab8c675bf6191b267a71e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137ecf7edc177c2911dc5f854ea630f1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a137ecf7edc177c2911dc5f854ea630f1">addto_prsity2</a> (this, thetaim)</td></tr>
<tr class="memdesc:a137ecf7edc177c2911dc5f854ea630f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add porosity values to prsity2  <a href="namespacegwtmstmodule.html#a137ecf7edc177c2911dc5f854ea630f1">More...</a><br /></td></tr>
<tr class="separator:a137ecf7edc177c2911dc5f854ea630f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad137a1aaa4caf1c76c564c243da54cda"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#ad137a1aaa4caf1c76c564c243da54cda">get_thetamfrac</a> (this, node)</td></tr>
<tr class="memdesc:ad137a1aaa4caf1c76c564c243da54cda"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Return mobile porosity fraction  <a href="namespacegwtmstmodule.html#ad137a1aaa4caf1c76c564c243da54cda">More...</a><br /></td></tr>
<tr class="separator:ad137a1aaa4caf1c76c564c243da54cda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34782cc11ccc2721cc438901f673ed52"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a34782cc11ccc2721cc438901f673ed52">get_thetaimfrac</a> (this, node, thetaim)</td></tr>
<tr class="memdesc:a34782cc11ccc2721cc438901f673ed52"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Return immobile porosity fraction  <a href="namespacegwtmstmodule.html#a34782cc11ccc2721cc438901f673ed52">More...</a><br /></td></tr>
<tr class="separator:a34782cc11ccc2721cc438901f673ed52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7677dc12366e5817f6f756c278d02ac5"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5">get_freundlich_conc</a> (conc, kf, a)</td></tr>
<tr class="memdesc:a7677dc12366e5817f6f756c278d02ac5"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate sorption concentration using Freundlich  <a href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5">More...</a><br /></td></tr>
<tr class="separator:a7677dc12366e5817f6f756c278d02ac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead2e0c98106a0cb499e163e67231295"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295">get_langmuir_conc</a> (conc, kl, sbar)</td></tr>
<tr class="memdesc:aead2e0c98106a0cb499e163e67231295"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate sorption concentration using Langmuir  <a href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295">More...</a><br /></td></tr>
<tr class="separator:aead2e0c98106a0cb499e163e67231295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b55bd57b61eb65f144034426a8dcf9a"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a5b55bd57b61eb65f144034426a8dcf9a">get_freundlich_derivative</a> (conc, kf, a)</td></tr>
<tr class="memdesc:a5b55bd57b61eb65f144034426a8dcf9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate sorption derivative using Freundlich  <a href="namespacegwtmstmodule.html#a5b55bd57b61eb65f144034426a8dcf9a">More...</a><br /></td></tr>
<tr class="separator:a5b55bd57b61eb65f144034426a8dcf9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda372342b5163673cd16cd1fbdd7da9"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#acda372342b5163673cd16cd1fbdd7da9">get_langmuir_derivative</a> (conc, kl, sbar)</td></tr>
<tr class="memdesc:acda372342b5163673cd16cd1fbdd7da9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate sorption derivative using Langmuir  <a href="namespacegwtmstmodule.html#acda372342b5163673cd16cd1fbdd7da9">More...</a><br /></td></tr>
<tr class="separator:acda372342b5163673cd16cd1fbdd7da9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b025361da5a358fd0c7d4c06ea2bf52"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52">get_zero_order_decay</a> (decay_rate_usr, decay_rate_last, kiter, cold, cnew, delt)</td></tr>
<tr class="memdesc:a2b025361da5a358fd0c7d4c06ea2bf52"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate zero-order decay rate and constrain if necessary  <a href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52">More...</a><br /></td></tr>
<tr class="separator:a2b025361da5a358fd0c7d4c06ea2bf52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac0db1c5827de3221108759b936e53b3c"><td class="memItemLeft" align="right" valign="top">integer(i4b), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#ac0db1c5827de3221108759b936e53b3c">nbditems</a> = 4</td></tr>
<tr class="separator:ac0db1c5827de3221108759b936e53b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32da4440492b0eee857aad5ec0dadec5"><td class="memItemLeft" align="right" valign="top">character(len=lenbudtxt), dimension(<a class="el" href="namespacegwtmstmodule.html#ac0db1c5827de3221108759b936e53b3c">nbditems</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwtmstmodule.html#a32da4440492b0eee857aad5ec0dadec5">budtxt</a></td></tr>
<tr class="separator:a32da4440492b0eee857aad5ec0dadec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The GwtMstModule is contains the GwtMstType, which is the derived type responsible for adding the effects of</p><ol type="1">
<li>Changes in dissolved solute mass</li>
<li>Decay of dissolved solute mass</li>
<li>Sorption</li>
<li>Decay of sorbed solute mass </li>
</ol>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a137ecf7edc177c2911dc5f854ea630f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a137ecf7edc177c2911dc5f854ea630f1">&#9670;&nbsp;</a></span>addto_prsity2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::addto_prsity2 </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>thetaim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to add immobile domain porosities, which are stored as a cumulative value in prsity2. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thetaim</td><td>immobile domain porosity that contributes to total porosity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01424">1424</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                     !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: thetaim<span class="comment">                 !&lt; immobile domain porosity that contributes to total porosity</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">! -- Add to prsity2</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">if</span> (this%ibound(n) == 0) cycle</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      this%prsity2(n) = this%prsity2(n) + thetaim(n)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57d0786badf360f7f302f2426402b982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d0786badf360f7f302f2426402b982">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to allocate arrays for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01063">1063</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                     !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                             !&lt; number of nodes</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">! -- sto</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%porosity, nodes, <span class="stringliteral">&#39;POROSITY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%prsity2, nodes, <span class="stringliteral">&#39;PRSITY2&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratesto, nodes, <span class="stringliteral">&#39;RATESTO&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">! -- dcy</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (this%idcy == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratedcy, 1, <span class="stringliteral">&#39;RATEDCY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decay, 1, <span class="stringliteral">&#39;DECAY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decaylast, 1, <span class="stringliteral">&#39;DECAYLAST&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratedcy, this%dis%nodes, <span class="stringliteral">&#39;RATEDCY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decay, nodes, <span class="stringliteral">&#39;DECAY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decaylast, nodes, <span class="stringliteral">&#39;DECAYLAST&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">if</span> (this%idcy /= 0 .and. this%isrb /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratedcys, this%dis%nodes, <span class="stringliteral">&#39;RATEDCYS&#39;</span>,           &amp;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        this%memoryPath)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decayslast, this%dis%nodes, <span class="stringliteral">&#39;DECAYSLAST&#39;</span>,       &amp;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        this%memoryPath)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratedcys, 1, <span class="stringliteral">&#39;RATEDCYS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decayslast, 1, <span class="stringliteral">&#39;DECAYSLAST&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%decay_sorbed, 1, <span class="stringliteral">&#39;DECAY_SORBED&#39;</span>,                    &amp;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                      this%memoryPath)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">! -- srb</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span> (this%isrb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bulk_density, 1, <span class="stringliteral">&#39;BULK_DENSITY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sp2, 1, <span class="stringliteral">&#39;SP2&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%distcoef,  1, <span class="stringliteral">&#39;DISTCOEF&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratesrb, 1, <span class="stringliteral">&#39;RATESRB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%bulk_density, nodes, <span class="stringliteral">&#39;BULK_DENSITY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%distcoef,  nodes, <span class="stringliteral">&#39;DISTCOEF&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ratesrb, nodes, <span class="stringliteral">&#39;RATESRB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">if</span> (this%isrb == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sp2, 1, <span class="stringliteral">&#39;SP2&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%sp2, nodes, <span class="stringliteral">&#39;SP2&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">do</span> n = 1, nodes</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      this%porosity(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      this%prsity2(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      this%ratesto(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(this%decay)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      this%decay(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      this%ratedcy(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      this%decaylast(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(this%bulk_density)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      this%bulk_density(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      this%distcoef(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      this%ratesrb(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(this%sp2)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      this%sp2(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(this%ratedcys)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      this%ratedcys(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      this%decayslast(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d11d92183647bc768b266af6054f31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d11d92183647bc768b266af6054f31d">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to allocate scalar variables for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtMstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01036">1036</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__setptr.html">mem_setptr</a></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                     !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">! -- Allocate scalars in NumericalPackageType</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%allocate_scalars()</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%isrb, <span class="stringliteral">&#39;ISRB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idcy, <span class="stringliteral">&#39;IDCY&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    this%isrb = 0</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    this%idcy = 0</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7677dc12366e5817f6f756c278d02ac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7677dc12366e5817f6f756c278d02ac5">&#9670;&nbsp;</a></span>get_freundlich_conc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_freundlich_conc </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>kf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate sorption concentration using Freundlich </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">conc</td><td>solute concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kf</td><td>freundlich constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>freundlich exponent </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01489">1489</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: conc<span class="comment">                                !&lt; solute concentration</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: kf<span class="comment">                                  !&lt; freundlich constant</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a<span class="comment">                                   !&lt; freundlich exponent</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="keywordtype">    real</span>(DP) :: cbar</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (conc &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      cbar = kf * conc ** a</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      cbar = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a7677dc12366e5817f6f756c278d02ac5_icgraph.png" border="0" usemap="#namespacegwtmstmodule_a7677dc12366e5817f6f756c278d02ac5_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a7677dc12366e5817f6f756c278d02ac5_icgraph" id="namespacegwtmstmodule_a7677dc12366e5817f6f756c278d02ac5_icgraph">
<area shape="rect" title="@ brief Calculate sorption concentration using Freundlich" alt="" coords="523,78,781,105"/>
<area shape="rect" href="namespacegwtmstmodule.html#a6a85e819e4468cd47eb01f1eba60e3f6" title="@ brief Calculate decay&#45;sorption terms for package" alt="" coords="278,5,453,47"/>
<area shape="rect" href="namespacegwtmstmodule.html#a411dd441b93b747a04ba37f718a0a283" title="@ brief Fill sorption&#45;decay coefficient method for package" alt="" coords="279,71,451,112"/>
<area shape="rect" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14" title="@ brief Calculate sorption terms" alt="" coords="256,137,475,163"/>
<area shape="rect" href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b" title="@ brief Calculate sorption terms for package" alt="" coords="5,111,208,138"/>
<area shape="rect" href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac" title="@ brief Fill sorption coefficient method for package" alt="" coords="7,162,206,189"/>
</map>
</div>

</div>
</div>
<a id="a5b55bd57b61eb65f144034426a8dcf9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b55bd57b61eb65f144034426a8dcf9a">&#9670;&nbsp;</a></span>get_freundlich_derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_freundlich_derivative </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>kf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate sorption derivative using Freundlich </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">conc</td><td>solute concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kf</td><td>freundlich constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>freundlich exponent </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01531">1531</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: conc<span class="comment">                              !&lt; solute concentration</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: kf<span class="comment">                                !&lt; freundlich constant</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a<span class="comment">                                 !&lt; freundlich exponent</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keywordtype">    real</span>(DP) :: derv</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordflow">if</span> (conc &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      derv = kf * a * conc ** (a - done)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      derv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a5b55bd57b61eb65f144034426a8dcf9a_icgraph.png" border="0" usemap="#namespacegwtmstmodule_a5b55bd57b61eb65f144034426a8dcf9a_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a5b55bd57b61eb65f144034426a8dcf9a_icgraph" id="namespacegwtmstmodule_a5b55bd57b61eb65f144034426a8dcf9a_icgraph">
<area shape="rect" title="@ brief Calculate sorption derivative using Freundlich" alt="" coords="523,23,744,65"/>
<area shape="rect" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14" title="@ brief Calculate sorption terms" alt="" coords="256,31,475,57"/>
<area shape="rect" href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b" title="@ brief Calculate sorption terms for package" alt="" coords="5,5,208,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac" title="@ brief Fill sorption coefficient method for package" alt="" coords="7,56,206,83"/>
</map>
</div>

</div>
</div>
<a id="aead2e0c98106a0cb499e163e67231295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead2e0c98106a0cb499e163e67231295">&#9670;&nbsp;</a></span>get_langmuir_conc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_langmuir_conc </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>kl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>sbar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate sorption concentration using Langmuir </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">conc</td><td>solute concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kl</td><td>langmuir constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sbar</td><td>langmuir sorption sites </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01510">1510</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: conc<span class="comment">                              !&lt; solute concentration</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: kl<span class="comment">                                !&lt; langmuir constant</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: sbar<span class="comment">                              !&lt; langmuir sorption sites</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="keywordtype">    real</span>(DP) :: cbar</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">if</span> (conc &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      cbar = (kl * sbar * conc) / (done + kl * conc)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      cbar = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_aead2e0c98106a0cb499e163e67231295_icgraph.png" border="0" usemap="#namespacegwtmstmodule_aead2e0c98106a0cb499e163e67231295_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_aead2e0c98106a0cb499e163e67231295_icgraph" id="namespacegwtmstmodule_aead2e0c98106a0cb499e163e67231295_icgraph">
<area shape="rect" title="@ brief Calculate sorption concentration using Langmuir" alt="" coords="523,78,773,105"/>
<area shape="rect" href="namespacegwtmstmodule.html#a6a85e819e4468cd47eb01f1eba60e3f6" title="@ brief Calculate decay&#45;sorption terms for package" alt="" coords="278,5,453,47"/>
<area shape="rect" href="namespacegwtmstmodule.html#a411dd441b93b747a04ba37f718a0a283" title="@ brief Fill sorption&#45;decay coefficient method for package" alt="" coords="279,71,451,112"/>
<area shape="rect" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14" title="@ brief Calculate sorption terms" alt="" coords="256,137,475,163"/>
<area shape="rect" href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b" title="@ brief Calculate sorption terms for package" alt="" coords="5,111,208,138"/>
<area shape="rect" href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac" title="@ brief Fill sorption coefficient method for package" alt="" coords="7,162,206,189"/>
</map>
</div>

</div>
</div>
<a id="acda372342b5163673cd16cd1fbdd7da9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda372342b5163673cd16cd1fbdd7da9">&#9670;&nbsp;</a></span>get_langmuir_derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_langmuir_derivative </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>kl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>sbar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate sorption derivative using Langmuir </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">conc</td><td>solute concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kl</td><td>langmuir constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sbar</td><td>langmuir sorption sites </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01552">1552</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: conc<span class="comment">                              !&lt; solute concentration</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: kl<span class="comment">                                !&lt; langmuir constant</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: sbar<span class="comment">                              !&lt; langmuir sorption sites</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="keywordtype">    real</span>(DP) :: derv</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">if</span> (conc &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      derv = (kl * sbar) / (done + kl * conc) ** dtwo</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      derv = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_acda372342b5163673cd16cd1fbdd7da9_icgraph.png" border="0" usemap="#namespacegwtmstmodule_acda372342b5163673cd16cd1fbdd7da9_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_acda372342b5163673cd16cd1fbdd7da9_icgraph" id="namespacegwtmstmodule_acda372342b5163673cd16cd1fbdd7da9_icgraph">
<area shape="rect" title="@ brief Calculate sorption derivative using Langmuir" alt="" coords="523,23,737,65"/>
<area shape="rect" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14" title="@ brief Calculate sorption terms" alt="" coords="256,31,475,57"/>
<area shape="rect" href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b" title="@ brief Calculate sorption terms for package" alt="" coords="5,5,208,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac" title="@ brief Fill sorption coefficient method for package" alt="" coords="7,56,206,83"/>
</map>
</div>

</div>
</div>
<a id="a34782cc11ccc2721cc438901f673ed52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34782cc11ccc2721cc438901f673ed52">&#9670;&nbsp;</a></span>get_thetaimfrac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_thetaimfrac </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>thetaim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pass in an immobile domain porosity and calculate the fraction of the total porosity that is immobile </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>node number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thetaim</td><td>immobile domain porosity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01468">1468</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">                               !&lt; node number</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: thetaim<span class="comment">                                !&lt; immobile domain porosity</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetaimfrac</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    thetaimfrac = thetaim / &amp;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                 (this%porosity(node) + this%prsity2(node))</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad137a1aaa4caf1c76c564c243da54cda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad137a1aaa4caf1c76c564c243da54cda">&#9670;&nbsp;</a></span>get_thetamfrac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_thetamfrac </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate and return the fraction of the total porosity that is mobile </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>node number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01447">1447</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                     !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: node<span class="comment">                              !&lt; node number</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    thetamfrac = this%porosity(node) / &amp;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                 (this%porosity(node) + this%prsity2(node))</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b025361da5a358fd0c7d4c06ea2bf52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b025361da5a358fd0c7d4c06ea2bf52">&#9670;&nbsp;</a></span>get_zero_order_decay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwtmstmodule::get_zero_order_decay </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>decay_rate_usr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>decay_rate_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate the zero-order decay rate from the user specified decay rate. If the decay rate is positive, then the decay rate must be constrained so that more mass is not removed than is available. Without this constraint, negative concentrations could result from zero-order decay. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">decay_rate_usr</td><td>user-entered decay rate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">decay_rate_last</td><td>decay rate used for last iteration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>Picard iteration counter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delt</td><td>length of time step </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>returned value for decay rate </dd></dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01577">1577</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: decay_rate_usr<span class="comment">    !&lt; user-entered decay rate</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: decay_rate_last<span class="comment">   !&lt; decay rate used for last iteration</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">         !&lt; Picard iteration counter</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cold<span class="comment">              !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cnew<span class="comment">              !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: delt<span class="comment">              !&lt; length of time step</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="keywordtype">    real</span>(DP) :: decay_rate<span class="comment">                    !&lt; returned value for decay rate</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">! -- Return user rate if production, otherwise constrain, if necessary</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">if</span> (decay_rate_usr &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="comment">! -- Production, no need to limit rate</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      decay_rate = decay_rate_usr</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <span class="comment">! -- Need to ensure decay does not result in negative</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="comment">!    concentration, so reduce the rate if it would result in</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="comment">!    removing more mass than is in the cell.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">if</span> (kiter == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        decay_rate = min(decay_rate_usr, cold / delt)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        decay_rate = decay_rate_last</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="keywordflow">if</span> (cnew &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;          decay_rate = decay_rate_last + cnew / delt</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cnew &gt; cold) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          decay_rate = decay_rate_last + cnew / delt</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        decay_rate = min(decay_rate_usr, decay_rate)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      decay_rate = max(decay_rate, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>)</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a2b025361da5a358fd0c7d4c06ea2bf52_icgraph.png" border="0" usemap="#namespacegwtmstmodule_a2b025361da5a358fd0c7d4c06ea2bf52_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a2b025361da5a358fd0c7d4c06ea2bf52_icgraph" id="namespacegwtmstmodule_a2b025361da5a358fd0c7d4c06ea2bf52_icgraph">
<area shape="rect" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="259,129,443,170"/>
<area shape="rect" href="namespacegwtistmodule.html#ada94becde756a937e3b9e970a31de656" title="@ brief Calculate package flows." alt="" coords="29,5,187,32"/>
<area shape="rect" href="namespacegwtistmodule.html#a37c321f840348165c87503d0d1165a6e" title="@ brief Fill coefficient method for package" alt="" coords="31,56,185,83"/>
<area shape="rect" href="namespacegwtmstmodule.html#a9bc28b904447d8ef01cebab46e6ab33c" title="@ brief Calculate decay terms for package" alt="" coords="5,107,211,133"/>
<area shape="rect" href="namespacegwtmstmodule.html#a6a85e819e4468cd47eb01f1eba60e3f6" title="@ brief Calculate decay&#45;sorption terms for package" alt="" coords="21,158,195,199"/>
<area shape="rect" href="namespacegwtmstmodule.html#ab5df6f8c8ed881ab7378a8cdb61483bd" title="@ brief Fill decay coefficient method for package" alt="" coords="7,224,209,251"/>
<area shape="rect" href="namespacegwtmstmodule.html#a411dd441b93b747a04ba37f718a0a283" title="@ brief Fill sorption&#45;decay coefficient method for package" alt="" coords="22,275,194,317"/>
</map>
</div>

</div>
</div>
<a id="a946b4afceb1db25d4d884a4b52e0f0b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946b4afceb1db25d4d884a4b52e0f0b8">&#9670;&nbsp;</a></span>mst_ar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disbasetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), pointer, contiguous&#160;</td>
          <td class="paramname"><em>ibound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to allocate and read static data for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dis</td><td>pointer to dis package </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ibound</td><td>pointer to GWT ibound array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00131">131</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">class</span>(GwtMstType), <span class="keywordtype">intent(inout)</span> :: this<span class="comment">                    !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: dis<span class="comment">              !&lt; pointer to dis package</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: ibound<span class="comment">   !&lt; pointer to GWT ibound array</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtmst =                                    &amp;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="stringliteral">&quot;(1x,/1x,&#39;MST -- MOBILE STORAGE AND TRANSFER PACKAGE, VERSION 1, &amp;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;7/29/2020 INPUT READ FROM UNIT &#39;, i0, //)&quot;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">! --print a message identifying the immobile domain package.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">write</span>(this%iout, fmtmst) this%inunit</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">! -- Read options</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">call </span>this%read_options()</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">! -- store pointers to arguments that were passed in</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    this%dis     =&gt; dis</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    this%ibound  =&gt; ibound</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">! -- Allocate arrays</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">call </span>this%allocate_arrays(dis%nodes)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">! -- read the data block</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">call </span>this%read_data()</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55c5b3f7739e5780f9c8174ed786f8b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55c5b3f7739e5780f9c8174ed786f8b4">&#9670;&nbsp;</a></span>mst_bd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_bd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(budgettype), intent(inout)&#160;</td>
          <td class="paramname"><em>model_budget</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate budget terms for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isuppress_output</td><td>flag to supress output </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model_budget</td><td>model budget object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00888">888</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbudgetmodule_1_1budgettype.html">budgettype</a>, <a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                     !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output<span class="comment">                  !&lt; flag to supress output</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordtype">type</span>(BudgetType), <span class="keywordtype">intent(inout)</span> :: model_budget<span class="comment">               !&lt; model budget object</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="keywordtype">    real</span>(DP) :: rin</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keywordtype">    real</span>(DP) :: rout</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">! -- sto</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%ratesto, rin, rout)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(1),                     &amp;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                               isuppress_output, rowlabel=this%packName)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">! -- dcy</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (this%idcy /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%ratedcy, rin, rout)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(2),                   &amp;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                               isuppress_output, rowlabel=this%packName)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">! -- srb</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%ratesrb, rin, rout)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(3),                   &amp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                               isuppress_output, rowlabel=this%packName)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">! -- srb dcy</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= 0 .and. this%idcy /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%ratedcys, rin, rout)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keyword">call </span>model_budget%addentry(rin, rout, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>, budtxt(4),                   &amp;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                               isuppress_output, rowlabel=this%packName)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a55c5b3f7739e5780f9c8174ed786f8b4_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a55c5b3f7739e5780f9c8174ed786f8b4_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a55c5b3f7739e5780f9c8174ed786f8b4_cgraph" id="namespacegwtmstmodule_a55c5b3f7739e5780f9c8174ed786f8b4_cgraph">
<area shape="rect" title="@ brief Calculate budget terms for package" alt="" coords="5,13,181,39"/>
<area shape="rect" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e" title="@ brief Rate accumulator subroutine" alt="" coords="229,5,380,47"/>
</map>
</div>

</div>
</div>
<a id="a478b81bdc62688ed1803ff103ad7385d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a478b81bdc62688ed1803ff103ad7385d">&#9670;&nbsp;</a></span>mst_cq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_cq </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate flows for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00579">579</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                              !&lt; number of nodes</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">    !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">! - storage</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keyword">call </span>this%mst_cq_sto(nodes, cnew, cold, flowja)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">! -- decay</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">if</span> (this%idcy /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keyword">call </span>this%mst_cq_dcy(nodes, cnew, cold, flowja)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">! -- sorption</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keyword">call </span>this%mst_cq_srb(nodes, cnew, cold, flowja)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">! -- decay sorbed</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= 0 .and. this%idcy /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keyword">call </span>this%mst_cq_dcy_srb(nodes, cnew, cold, flowja)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bc28b904447d8ef01cebab46e6ab33c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bc28b904447d8ef01cebab46e6ab33c">&#9670;&nbsp;</a></span>mst_cq_dcy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_cq_dcy </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate decay terms for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00668">668</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                              !&lt; number of nodes</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">    !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordtype">    real</span>(DP) :: swtpdt</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordtype">    real</span>(DP) :: decay_rate</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">! -- Calculate decay change</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">do</span> n = 1, nodes</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      this%ratedcy(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="comment">! -- calculate new and old water volumes</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      swtpdt = this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="comment">! -- calculate decay gains and losses</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      rate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      hhcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      rrhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">if</span> (this%idcy == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        hhcof = -this%decay(n) * vcell * swtpdt * this%porosity(n)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keywordflow">elseif</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        decay_rate = get_zero_order_decay(this%decay(n), this%decaylast(n),  &amp;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                          0, cold(n), cnew(n), <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        rrhs = decay_rate * vcell * swtpdt * this%porosity(n)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      rate = hhcof * cnew(n) - rrhs</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      this%ratedcy(n) = rate</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      flowja(idiag) = flowja(idiag) + rate</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a9bc28b904447d8ef01cebab46e6ab33c_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a9bc28b904447d8ef01cebab46e6ab33c_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a9bc28b904447d8ef01cebab46e6ab33c_cgraph" id="namespacegwtmstmodule_a9bc28b904447d8ef01cebab46e6ab33c_cgraph">
<area shape="rect" title="@ brief Calculate decay terms for package" alt="" coords="5,13,211,39"/>
<area shape="rect" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="259,5,443,47"/>
</map>
</div>

</div>
</div>
<a id="a6a85e819e4468cd47eb01f1eba60e3f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a85e819e4468cd47eb01f1eba60e3f6">&#9670;&nbsp;</a></span>mst_cq_dcy_srb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_cq_dcy_srb </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate decay-sorption terms for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00786">786</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                              !&lt; number of nodes</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">    !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="keywordtype">    real</span>(DP) :: swnew</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="keywordtype">    real</span>(DP) :: distcoef</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keywordtype">    real</span>(DP) :: term</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="keywordtype">    real</span>(DP) :: csrb</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordtype">    real</span>(DP) :: csrbnew</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keywordtype">    real</span>(DP) :: csrbold</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keywordtype">    real</span>(DP) :: decay_rate</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">! -- Calculate sorbed decay change</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">!    This routine will only be called if sorption and decay are active</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">do</span> n = 1, nodes</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="comment">! -- initialize rates</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      this%ratedcys(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">! -- set variables</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      hhcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      rrhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      swnew =  this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      distcoef = this%distcoef(n)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      thetamfrac = this%get_thetamfrac(n)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      term = this%decay_sorbed(n) * thetamfrac * this%bulk_density(n) *        &amp;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;             swnew * vcell</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">! -- add sorbed mass decay rate terms to accumulators</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">if</span> (this%idcy == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">if</span> (this%isrb == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="comment">! -- first order decay rate is a function of concentration, so add</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="comment">!    to left hand side</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          hhcof = - term * distcoef</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          <span class="comment">! -- nonlinear Freundlich sorption, so add to RHS</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          csrb = get_freundlich_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          rrhs = term * csrb</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;          <span class="comment">! -- nonlinear Lanmuir sorption, so add to RHS</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;          csrb = get_langmuir_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          rrhs = term * csrb</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">elseif</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="comment">! -- Call function to get zero-order decay rate, which may be changed</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="comment">!    from the user-specified rate to prevent negative concentrations</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">if</span> (distcoef &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          <span class="keywordflow">if</span> (this%isrb == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            csrbold = cold(n) * distcoef</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            csrbnew = cnew(n) * distcoef</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            csrbold = get_freundlich_conc(cold(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            csrbnew = get_freundlich_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            csrbold = get_langmuir_conc(cold(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            csrbnew = get_langmuir_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          decay_rate = get_zero_order_decay(this%decay_sorbed(n),              &amp;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                            this%decayslast(n),                &amp;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                            0, csrbold, csrbnew, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          rrhs = decay_rate * thetamfrac * this%bulk_density(n) * swnew * vcell</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="comment">! -- calculate rate</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      rate = hhcof * cnew(n) - rrhs</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      this%ratedcys(n) = rate</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      flowja(idiag) = flowja(idiag) + rate</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a6a85e819e4468cd47eb01f1eba60e3f6_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a6a85e819e4468cd47eb01f1eba60e3f6_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a6a85e819e4468cd47eb01f1eba60e3f6_cgraph" id="namespacegwtmstmodule_a6a85e819e4468cd47eb01f1eba60e3f6_cgraph">
<area shape="rect" title="@ brief Calculate decay&#45;sorption terms for package" alt="" coords="5,49,180,90"/>
<area shape="rect" href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5" title="@ brief Calculate sorption concentration using Freundlich" alt="" coords="228,5,487,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295" title="@ brief Calculate sorption concentration using Langmuir" alt="" coords="232,56,483,83"/>
<area shape="rect" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="265,107,449,149"/>
</map>
</div>

</div>
</div>
<a id="a0fa9bb36f8c226b9ad2d28a5f0a08c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fa9bb36f8c226b9ad2d28a5f0a08c3b">&#9670;&nbsp;</a></span>mst_cq_srb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_cq_srb </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate sorption terms for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00726">726</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                              !&lt; number of nodes</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">    !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordtype">    real</span>(DP) :: swt, swtpdt</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhob</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordtype">    real</span>(DP) :: const1</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keywordtype">    real</span>(DP) :: const2</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    tled = done / <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">! -- Calculate sorption change</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">do</span> n = 1, nodes</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="comment">! -- initialize rates</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      this%ratesrb(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="comment">! -- assign variables</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      swtpdt = this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      swt = this%fmi%gwfsatold(n, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      thetamfrac = this%get_thetamfrac(n)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      rhob = this%bulk_density(n)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      const1 = this%distcoef(n)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      const2 = 0.</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">if</span> (this%isrb &gt; 1) const2 = this%sp2(n)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keyword">call </span>mst_srb_term(this%isrb, thetamfrac, rhob, vcell, tled, cnew(n),     &amp;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                        cold(n), swtpdt, swt, const1, const2,                  &amp;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                        rate=rate)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      this%ratesrb(n) = rate</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      flowja(idiag) = flowja(idiag) + rate</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a0fa9bb36f8c226b9ad2d28a5f0a08c3b_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a0fa9bb36f8c226b9ad2d28a5f0a08c3b_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a0fa9bb36f8c226b9ad2d28a5f0a08c3b_cgraph" id="namespacegwtmstmodule_a0fa9bb36f8c226b9ad2d28a5f0a08c3b_cgraph">
<area shape="rect" title="@ brief Calculate sorption terms for package" alt="" coords="5,93,208,120"/>
<area shape="rect" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14" title="@ brief Calculate sorption terms" alt="" coords="256,93,475,120"/>
<area shape="rect" href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5" title="@ brief Calculate sorption concentration using Freundlich" alt="" coords="523,5,781,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#a5b55bd57b61eb65f144034426a8dcf9a" title="@ brief Calculate sorption derivative using Freundlich" alt="" coords="541,57,763,98"/>
<area shape="rect" href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295" title="@ brief Calculate sorption concentration using Langmuir" alt="" coords="527,123,777,149"/>
<area shape="rect" href="namespacegwtmstmodule.html#acda372342b5163673cd16cd1fbdd7da9" title="@ brief Calculate sorption derivative using Langmuir" alt="" coords="545,174,759,215"/>
</map>
</div>

</div>
</div>
<a id="ae1c3ef04226a8368969a56ec29766a74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c3ef04226a8368969a56ec29766a74">&#9670;&nbsp;</a></span>mst_cq_sto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_cq_sto </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), contiguous&#160;</td>
          <td class="paramname"><em>flowja</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate storage terms for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flowja</td><td>flow between two connected control volumes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00616">616</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                              !&lt; number of nodes</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">intent(inout)</span> :: flowja<span class="comment">    !&lt; flow between two connected control volumes</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordtype">    real</span>(DP) :: rate</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordtype">    real</span>(DP) :: vnew, vold</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    tled = done / <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">! -- Calculate storage change</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">do</span> n = 1, nodes</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      this%ratesto(n) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">! -- calculate new and old water volumes</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      vnew = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n)) * &amp;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;             this%fmi%gwfsat(n) * this%porosity(n)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      vold = vnew</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">if</span> (this%fmi%igwfstrgss /= 0) vold = vold + this%fmi%gwfstrgss(n) * <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span> (this%fmi%igwfstrgsy /= 0) vold = vold + this%fmi%gwfstrgsy(n) * <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="comment">! -- calculate rate</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      hhcof = -vnew * tled</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      rrhs = -vold * tled * cold(n)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      rate = hhcof * cnew(n) - rrhs</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      this%ratesto(n) = rate</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      flowja(idiag) = flowja(idiag) + rate</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb0aad5ec852b458c2a6337129abc351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb0aad5ec852b458c2a6337129abc351">&#9670;&nbsp;</a></span>mst_cr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public gwtmstmodule::mst_cr </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>), pointer&#160;</td>
          <td class="paramname"><em>mstobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gwtfmitype), intent(in), target&#160;</td>
          <td class="paramname"><em>fmi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new MST object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mstobj</td><td>unallocated new mst object to create </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name_model</td><td>name of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunit</td><td>unit number of WEL package input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>unit number of model listing file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fmi</td><td>fmi package for this GWT model </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00097">97</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">type</span>(GwtMstType), <span class="keywordtype">pointer</span> :: mstobj<span class="comment">            !&lt; unallocated new mst object to create</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name_model<span class="comment">     !&lt; name of the model</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunit<span class="comment">             !&lt; unit number of WEL package input file</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment">               !&lt; unit number of model listing file</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">type</span>(GwtFmiType), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: fmi<span class="comment">    !&lt; fmi package for this GWT model</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">! -- Create the object</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">allocate</span>(mstobj)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">! -- create name and memory path</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">call </span>mstobj%set_names(1, name_model, <span class="stringliteral">&#39;MST&#39;</span>, <span class="stringliteral">&#39;MST&#39;</span>)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">! -- Allocate scalars</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">call </span>mstobj%allocate_scalars()</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">! -- Set variables</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    mstobj%inunit = inunit</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    mstobj%iout = iout</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    mstobj%fmi =&gt; fmi</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">! -- Initialize block parser</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">call </span>mstobj%parser%Initialize(mstobj%inunit, mstobj%iout)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_adb0aad5ec852b458c2a6337129abc351_icgraph.png" border="0" usemap="#namespacegwtmstmodule_adb0aad5ec852b458c2a6337129abc351_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_adb0aad5ec852b458c2a6337129abc351_icgraph" id="namespacegwtmstmodule_adb0aad5ec852b458c2a6337129abc351_icgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="1492,31,1664,57"/>
<area shape="rect" href="namespacegwtmodule.html#ad4f6eefd4112176d49bd99d8944bdef3" title=" " alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a0043d2fa8d8b96e41e5e0fdfecaadae7" title="Set the models to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="ab997259f35f25e6dd916f95ce36c725f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab997259f35f25e6dd916f95ce36c725f">&#9670;&nbsp;</a></span>mst_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to deallocate memory for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtMstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00995">995</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">! -- Deallocate arrays if package was active</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">if</span>(this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%porosity)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%prsity2)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ratesto)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idcy)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decay)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decay_sorbed)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ratedcy)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decaylast)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%decayslast)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%isrb)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%bulk_density)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%distcoef)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%sp2)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ratesrb)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ratedcys)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      this%ibound =&gt; null()</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      this%fmi =&gt; null()</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">! -- deallocate parent</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%da()</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a734b8accbe6962f13ff2572ab7f32b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a734b8accbe6962f13ff2572ab7f32b42">&#9670;&nbsp;</a></span>mst_fc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate and fill coefficients for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nja</td><td>number of GWT connections </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>number of connections in solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>solution outer iteration number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00169">169</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                       !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                                    !&lt; number of nodes</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                  !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nja<span class="comment">                                 !&lt; number of GWT connections</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                              !&lt; number of connections in solution</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">           !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nja)</span> :: idxglo<span class="comment">              !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(nodes)</span> :: rhs<span class="comment">                !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                  !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                               !&lt; solution outer iteration number</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">! -- storage contribution</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">call </span>this%mst_fc_sto(nodes, cold, nja, njasln, amatsln, idxglo, rhs)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">! -- decay contribution</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (this%idcy /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">call </span>this%mst_fc_dcy(nodes, cold, cnew, nja, njasln, amatsln, idxglo, &amp;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                           rhs, kiter)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">! -- sorption contribution</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keyword">call </span>this%mst_fc_srb(nodes, cold, nja, njasln, amatsln, idxglo, rhs, cnew)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">! -- decay sorbed contribution</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (this%isrb /= 0 .and. this%idcy /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">call </span>this%mst_fc_dcy_srb(nodes, cold, nja, njasln, amatsln, idxglo, rhs, &amp;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                               cnew, kiter)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5df6f8c8ed881ab7378a8cdb61483bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5df6f8c8ed881ab7378a8cdb61483bd">&#9670;&nbsp;</a></span>mst_fc_dcy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_fc_dcy </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate and fill decay coefficients for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nja</td><td>number of GWT connections </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>number of connections in solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>solution outer iteration number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00275">275</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                                   !&lt; number of nodes</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nja<span class="comment">                                !&lt; number of GWT connections</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                             !&lt; number of connections in solution</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">          !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nja)</span> :: idxglo<span class="comment">             !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(nodes)</span> :: rhs<span class="comment">               !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                              !&lt; solution outer iteration number</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, idiag</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">    real</span>(DP) :: swtpdt</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">    real</span>(DP) :: decay_rate</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">! -- loop through and calculate decay contribution to hcof and rhs</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">! -- calculate new and old water volumes</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      swtpdt = this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">! -- add decay rate terms to accumulators</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">if</span> (this%idcy == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">! -- first order decay rate is a function of concentration, so add</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">!    to left hand side</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        hhcof = -this%decay(n) * vcell * swtpdt * this%porosity(n)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        amatsln(idxglo(idiag)) = amatsln(idxglo(idiag)) + hhcof</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">elseif</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">! -- Call function to get zero-order decay rate, which may be changed</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">!    from the user-specified rate to prevent negative concentrations</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        decay_rate = get_zero_order_decay(this%decay(n), this%decaylast(n), kiter, &amp;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                cold(n), cnew(n), <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        this%decaylast(n) = decay_rate</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        rrhs = decay_rate * vcell * swtpdt * this%porosity(n)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        rhs(n) = rhs(n) + rrhs</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_ab5df6f8c8ed881ab7378a8cdb61483bd_cgraph.png" border="0" usemap="#namespacegwtmstmodule_ab5df6f8c8ed881ab7378a8cdb61483bd_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_ab5df6f8c8ed881ab7378a8cdb61483bd_cgraph" id="namespacegwtmstmodule_ab5df6f8c8ed881ab7378a8cdb61483bd_cgraph">
<area shape="rect" title="@ brief Fill decay coefficient method for package" alt="" coords="5,13,208,39"/>
<area shape="rect" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="256,5,440,47"/>
</map>
</div>

</div>
</div>
<a id="a411dd441b93b747a04ba37f718a0a283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a411dd441b93b747a04ba37f718a0a283">&#9670;&nbsp;</a></span>mst_fc_dcy_srb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_fc_dcy_srb </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate and fill sorption-decay coefficients for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nja</td><td>number of GWT connections </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>number of connections in solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kiter</td><td>solution outer iteration number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00475">475</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                       !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                                    !&lt; number of nodes</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                  !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nja<span class="comment">                                 !&lt; number of GWT connections</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                              !&lt; number of connections in solution</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">           !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nja)</span> :: idxglo<span class="comment">              !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(nodes)</span> :: rhs<span class="comment">                !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                  !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter<span class="comment">                               !&lt; solution outer iteration number</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, idiag</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordtype">    real</span>(DP) :: swnew</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordtype">    real</span>(DP) :: distcoef</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordtype">    real</span>(DP) :: term</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordtype">    real</span>(DP) :: csrb</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordtype">    real</span>(DP) :: decay_rate</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordtype">    real</span>(DP) :: csrbold</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordtype">    real</span>(DP) :: csrbnew</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">! -- loop through and calculate sorption contribution to hcof and rhs</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="comment">! -- set variables</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      hhcof = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      rrhs = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      swnew =  this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      distcoef = this%distcoef(n)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      thetamfrac = this%get_thetamfrac(n)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      term = this%decay_sorbed(n) * thetamfrac * this%bulk_density(n) *        &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;             swnew * vcell</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="comment">! -- add sorbed mass decay rate terms to accumulators</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">if</span> (this%idcy == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">if</span> (this%isrb == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          <span class="comment">! -- first order decay rate is a function of concentration, so add</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="comment">!    to left hand side</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          hhcof = - term * distcoef</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          <span class="comment">! -- nonlinear Freundlich sorption, so add to RHS</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          csrb = get_freundlich_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          rrhs = term * csrb</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          <span class="comment">! -- nonlinear Lanmuir sorption, so add to RHS</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          csrb = get_langmuir_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          rrhs = term * csrb</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">elseif</span> (this%idcy == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">! -- Call function to get zero-order decay rate, which may be changed</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">!    from the user-specified rate to prevent negative concentrations</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">if</span> (distcoef &gt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          <span class="keywordflow">if</span> (this%isrb == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            csrbold = cold(n) * distcoef</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            csrbnew = cnew(n) * distcoef</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            csrbold = get_freundlich_conc(cold(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            csrbnew = get_freundlich_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this%isrb == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            csrbold = get_langmuir_conc(cold(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            csrbnew = get_langmuir_conc(cnew(n), distcoef, this%sp2(n))</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          decay_rate = get_zero_order_decay(this%decay_sorbed(n),              &amp;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                            this%decayslast(n),                &amp;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                            kiter, csrbold, csrbnew, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;          this%decayslast(n) = decay_rate</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          rrhs = decay_rate * thetamfrac * this%bulk_density(n) * swnew * vcell</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">! -- Add hhcof to diagonal and rrhs to right-hand side</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      amatsln(idxglo(idiag)) = amatsln(idxglo(idiag)) + hhcof</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      rhs(n) = rhs(n) + rrhs</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a411dd441b93b747a04ba37f718a0a283_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a411dd441b93b747a04ba37f718a0a283_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a411dd441b93b747a04ba37f718a0a283_cgraph" id="namespacegwtmstmodule_a411dd441b93b747a04ba37f718a0a283_cgraph">
<area shape="rect" title="@ brief Fill sorption&#45;decay coefficient method for package" alt="" coords="5,49,177,90"/>
<area shape="rect" href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5" title="@ brief Calculate sorption concentration using Freundlich" alt="" coords="225,5,484,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295" title="@ brief Calculate sorption concentration using Langmuir" alt="" coords="229,56,480,83"/>
<area shape="rect" href="namespacegwtmstmodule.html#a2b025361da5a358fd0c7d4c06ea2bf52" title="@ brief Calculate zero&#45;order decay rate and constrain if necessary" alt="" coords="263,107,447,149"/>
</map>
</div>

</div>
</div>
<a id="ae85f0f1a250d1f5ad4d2e3657e2c1aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae85f0f1a250d1f5ad4d2e3657e2c1aac">&#9670;&nbsp;</a></span>mst_fc_srb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_fc_srb </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate and fill sorption coefficients for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nja</td><td>number of GWT connections </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>number of connections in solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00337">337</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                                   !&lt; number of nodes</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">                 !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nja<span class="comment">                                !&lt; number of GWT connections</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                             !&lt; number of connections in solution</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">          !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nja)</span> :: idxglo<span class="comment">             !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(nodes)</span> :: rhs<span class="comment">               !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cnew<span class="comment">                 !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, idiag</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordtype">    real</span>(DP) :: swt, swtpdt</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordtype">    real</span>(DP) :: vcell</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">    real</span>(DP) :: const1</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordtype">    real</span>(DP) :: const2</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordtype">    real</span>(DP) :: thetamfrac</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordtype">    real</span>(DP) :: rhob</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">! -- set variables</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    tled = done / <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">! -- loop through and calculate sorption contribution to hcof and rhs</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="comment">! -- assign variables</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      vcell = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n))</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      swtpdt = this%fmi%gwfsat(n)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      swt = this%fmi%gwfsatold(n, <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a>)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      thetamfrac = this%get_thetamfrac(n)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      const1 = this%distcoef(n)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      const2 = 0.</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">if</span> (this%isrb &gt; 1) const2 = this%sp2(n)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      rhob = this%bulk_density(n)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">call </span>mst_srb_term(this%isrb, thetamfrac, rhob, vcell, tled, cnew(n),     &amp;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        cold(n), swtpdt, swt, const1, const2,                  &amp;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        hcofval=hhcof, rhsval=rrhs)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="comment">! -- Add hhcof to diagonal and rrhs to right-hand side</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      amatsln(idxglo(idiag)) = amatsln(idxglo(idiag)) + hhcof</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      rhs(n) = rhs(n) + rrhs</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_ae85f0f1a250d1f5ad4d2e3657e2c1aac_cgraph.png" border="0" usemap="#namespacegwtmstmodule_ae85f0f1a250d1f5ad4d2e3657e2c1aac_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_ae85f0f1a250d1f5ad4d2e3657e2c1aac_cgraph" id="namespacegwtmstmodule_ae85f0f1a250d1f5ad4d2e3657e2c1aac_cgraph">
<area shape="rect" title="@ brief Fill sorption coefficient method for package" alt="" coords="5,93,204,120"/>
<area shape="rect" href="namespacegwtmstmodule.html#a67855ad68874c8c6bf7cdd74dfd3fa14" title="@ brief Calculate sorption terms" alt="" coords="252,93,471,120"/>
<area shape="rect" href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5" title="@ brief Calculate sorption concentration using Freundlich" alt="" coords="519,5,777,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#a5b55bd57b61eb65f144034426a8dcf9a" title="@ brief Calculate sorption derivative using Freundlich" alt="" coords="537,57,759,98"/>
<area shape="rect" href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295" title="@ brief Calculate sorption concentration using Langmuir" alt="" coords="523,123,773,149"/>
<area shape="rect" href="namespacegwtmstmodule.html#acda372342b5163673cd16cd1fbdd7da9" title="@ brief Calculate sorption derivative using Langmuir" alt="" coords="541,174,755,215"/>
</map>
</div>

</div>
</div>
<a id="a8142aa6c3072e9f4451216f5b9d31b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8142aa6c3072e9f4451216f5b9d31b63">&#9670;&nbsp;</a></span>mst_fc_sto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_fc_sto </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nja</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>njasln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(njasln), intent(inout)&#160;</td>
          <td class="paramname"><em>amatsln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(nja), intent(in)&#160;</td>
          <td class="paramname"><em>idxglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nodes), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to calculate and fill storage coefficients for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nodes</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nja</td><td>number of GWT connections </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">njasln</td><td>number of connections in solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amatsln</td><td>solution coefficient matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idxglo</td><td>mapping vector for model (local) to solution (global) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhs</td><td>right-hand side vector for model </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00213">213</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nodes<span class="comment">                             !&lt; number of nodes</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nodes)</span> :: cold<span class="comment">           !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nja<span class="comment">                          !&lt; number of GWT connections</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: njasln<span class="comment">                       !&lt; number of connections in solution</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(njasln)</span>, <span class="keywordtype">intent(inout)</span> :: amatsln<span class="comment">    !&lt; solution coefficient matrix</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(nja)</span> :: idxglo<span class="comment">       !&lt; mapping vector for model (local) to solution (global)</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(nodes)</span> :: rhs<span class="comment">         !&lt; right-hand side vector for model</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, idiag</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordtype">    real</span>(DP) :: tled</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordtype">    real</span>(DP) :: hhcof, rrhs</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">    real</span>(DP) :: vnew, vold</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">    real</span>(DP) :: v, alp</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">! -- set variables</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    tled = done / <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">! -- loop through and calculate storage contribution to hcof and rhs</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">! -- skip if transport inactive</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span>(this%ibound(n) &lt;= 0) cycle</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">! -- calculate new and old water volumes</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      vnew = this%dis%area(n) * (this%dis%top(n) - this%dis%bot(n)) * &amp;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;             this%fmi%gwfsat(n) * this%porosity(n)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      vold = vnew</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">if</span> (this%fmi%igwfstrgss /= 0) vold = vold + this%fmi%gwfstrgss(n) * <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (this%fmi%igwfstrgsy /= 0) vold = vold + this%fmi%gwfstrgsy(n) * <a class="code" href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">delt</a></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">! -- Non conservative (advective) formulation considers</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="comment">!      Equation =&gt; V*dc/dt = V^alp/dt*( c^(t+dt)-c^t) with alp = [0,1]</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">! -- Our V</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      alp = 0.0 <span class="comment">! alp = 0 =&gt; t, alp = 1 =&gt; t+dt</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      v   = alp*vnew + (1-alp)*vold</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">! -- add terms to diagonal and rhs accumulators</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      hhcof = -v * tled</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      rrhs  = -v * tled * cold(n)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      idiag = this%dis%con%ia(n)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      amatsln(idxglo(idiag)) = amatsln(idxglo(idiag)) + hhcof</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      rhs(n) = rhs(n) + rrhs</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a83986692420567168b2a0714c0f1d87e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83986692420567168b2a0714c0f1d87e">&#9670;&nbsp;</a></span>mst_ot_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_ot_flow </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>icbcun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to output terms for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwtMstType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcfl</td><td>flag and unit number for cell-by-cell output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icbcun</td><td>flag indication if cell-by-cell data should be saved </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00935">935</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                          !&lt; GwtMstType object</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcfl<span class="comment">                 !&lt; flag and unit number for cell-by-cell output</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: icbcun<span class="comment">                 !&lt; flag indication if cell-by-cell data should be saved</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">!character(len=16), dimension(2) :: aname</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iprint, nvaluesp, nwidthp</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">character(len=1)</span> :: cdatafmp=<span class="stringliteral">&#39; &#39;</span>, editdesc=<span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="keywordtype">    real</span>(DP) :: dinact</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">! -- Set unit number for binary output</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span>(this%ipakcb &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      ibinun = icbcun</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">elseif</span>(this%ipakcb == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      ibinun = this%ipakcb</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span>(icbcfl == 0) ibinun = 0</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="comment">! -- Record the storage rate if requested</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span>(ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      iprint = 0</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      dinact = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="comment">! -- sto</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%ratesto, this%iout, iprint, -ibinun,     &amp;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                 budtxt(1), cdatafmp, nvaluesp,                &amp;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="comment">! -- dcy</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">if</span> (this%idcy /= 0) &amp;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%ratedcy, this%iout, iprint, -ibinun,     &amp;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                 budtxt(2), cdatafmp, nvaluesp,                &amp;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="comment">! -- srb</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">if</span> (this%isrb /= 0) &amp;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%ratesrb, this%iout, iprint, -ibinun,     &amp;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                 budtxt(3), cdatafmp, nvaluesp,                &amp;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="comment">! -- dcy srb</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">if</span> (this%isrb /= 0 .and. this%idcy /= 0) &amp;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keyword">call </span>this%dis%record_array(this%ratedcys, this%iout, iprint, -ibinun,    &amp;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                 budtxt(4), cdatafmp, nvaluesp,                &amp;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                 nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67855ad68874c8c6bf7cdd74dfd3fa14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67855ad68874c8c6bf7cdd74dfd3fa14">&#9670;&nbsp;</a></span>mst_srb_term()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::mst_srb_term </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isrb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>thetamfrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>vcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>cold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>swnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>swold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>const1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>const2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>hcofval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out), optional&#160;</td>
          <td class="paramname"><em>rhsval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine to calculate sorption terms </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">isrb</td><td>sorption flag 1, 2, 3 are linear, freundlich, and langmuir </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thetamfrac</td><td>fraction of total porosity that is mobile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhob</td><td>bulk density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vcell</td><td>volume of cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tled</td><td>one over time step length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnew</td><td>concentration at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cold</td><td>concentration at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swnew</td><td>cell saturation at end of this time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swold</td><td>cell saturation at end of last time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">const1</td><td>distribution coefficient or freundlich or langmuir constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">const2</td><td>zero, freundlich exponent, or langmuir sorption sites </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rate</td><td>calculated sorption rate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hcofval</td><td>diagonal contribution to solution coefficient matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhsval</td><td>contribution to solution right-hand-side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00400">400</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isrb<span class="comment">                  !&lt; sorption flag 1, 2, 3 are linear, freundlich, and langmuir</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: thetamfrac<span class="comment">                !&lt; fraction of total porosity that is mobile</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: rhob<span class="comment">                      !&lt; bulk density</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: vcell<span class="comment">                     !&lt; volume of cell</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: tled<span class="comment">                      !&lt; one over time step length</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cnew<span class="comment">                      !&lt; concentration at end of this time step</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: cold<span class="comment">                      !&lt; concentration at end of last time step</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: swnew<span class="comment">                     !&lt; cell saturation at end of this time step</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: swold<span class="comment">                     !&lt; cell saturation at end of last time step</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: const1<span class="comment">                    !&lt; distribution coefficient or freundlich or langmuir constant</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: const2<span class="comment">                    !&lt; zero, freundlich exponent, or langmuir sorption sites</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: rate<span class="comment">           !&lt; calculated sorption rate</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: hcofval<span class="comment">        !&lt; diagonal contribution to solution coefficient matrix</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: rhsval<span class="comment">         !&lt; contribution to solution right-hand-side</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">    real</span>(DP) :: term</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordtype">    real</span>(DP) :: derv</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordtype">    real</span>(DP) :: cbarnew</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordtype">    real</span>(DP) :: cbarold</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">    real</span>(DP) :: cavg</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordtype">    real</span>(DP) :: cbaravg</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordtype">    real</span>(DP) :: swavg</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">! -- Calculate based on type of sorption</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (isrb == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="comment">! -- linear</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      term = - thetamfrac * rhob * vcell * tled * const1</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(hcofval)) hcofval = term * swnew</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(rhsval)) rhsval = term * swold * cold</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(rate)) rate = term * swnew * cnew - term * swold * cold</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="comment">! -- calculate average aqueous concentration</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      cavg = dhalf * (cold + cnew)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">! -- set values based on isotherm</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">if</span> (isrb == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">! -- freundlich</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        cbarnew = get_freundlich_conc(cnew, const1, const2)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        cbarold = get_freundlich_conc(cold, const1, const2)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        derv = get_freundlich_derivative(cavg, const1, const2)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isrb == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">! -- langmuir</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        cbarnew = get_langmuir_conc(cnew, const1, const2)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        cbarold = get_langmuir_conc(cold, const1, const2)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        derv = get_langmuir_derivative(cavg, const1, const2)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="comment">! -- calculate hcof, rhs, and rate for freundlich and langmuir</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      term = - thetamfrac * rhob * vcell * tled</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      cbaravg = (cbarold + cbarnew) * dhalf</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      swavg = (swnew + swold) * dhalf</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(hcofval)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        hcofval = term * derv * swavg</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(rhsval)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        rhsval = term * derv * swavg * cold - term * cbaravg * (swnew - swold)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(rate)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        rate = term * derv * swavg * (cnew - cold) &amp;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;               + term * cbaravg * (swnew - swold)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_cgraph" id="namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_cgraph">
<area shape="rect" title="@ brief Calculate sorption terms" alt="" coords="5,93,224,120"/>
<area shape="rect" href="namespacegwtmstmodule.html#a7677dc12366e5817f6f756c278d02ac5" title="@ brief Calculate sorption concentration using Freundlich" alt="" coords="272,5,531,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#a5b55bd57b61eb65f144034426a8dcf9a" title="@ brief Calculate sorption derivative using Freundlich" alt="" coords="291,57,512,98"/>
<area shape="rect" href="namespacegwtmstmodule.html#aead2e0c98106a0cb499e163e67231295" title="@ brief Calculate sorption concentration using Langmuir" alt="" coords="276,123,527,149"/>
<area shape="rect" href="namespacegwtmstmodule.html#acda372342b5163673cd16cd1fbdd7da9" title="@ brief Calculate sorption derivative using Langmuir" alt="" coords="294,174,509,215"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_icgraph.png" border="0" usemap="#namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_icgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_icgraph" id="namespacegwtmstmodule_a67855ad68874c8c6bf7cdd74dfd3fa14_icgraph">
<area shape="rect" title="@ brief Calculate sorption terms" alt="" coords="256,31,475,57"/>
<area shape="rect" href="namespacegwtmstmodule.html#a0fa9bb36f8c226b9ad2d28a5f0a08c3b" title="@ brief Calculate sorption terms for package" alt="" coords="5,5,208,32"/>
<area shape="rect" href="namespacegwtmstmodule.html#ae85f0f1a250d1f5ad4d2e3657e2c1aac" title="@ brief Fill sorption coefficient method for package" alt="" coords="7,56,206,83"/>
</map>
</div>

</div>
</div>
<a id="a9d09f066cfdab8c675bf6191b267a71e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d09f066cfdab8c675bf6191b267a71e">&#9670;&nbsp;</a></span>read_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::read_data </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read data for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtMstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01228">1228</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>,   <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>, <a class="code" href="interfacememorymanagermodule_1_1mem__reassignptr.html">mem_reassignptr</a></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                     !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: line</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: istart, istop, lloc, ierr</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(6)</span> :: lname</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordtype">character(len=24)</span>, <span class="keywordtype">dimension(6)</span> :: aname</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">! -- data</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keyword">data</span> aname(1) /<span class="stringliteral">&#39;  MOBILE DOMAIN POROSITY&#39;</span>/</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keyword">data</span> aname(2) /<span class="stringliteral">&#39;            BULK DENSITY&#39;</span>/</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keyword">data</span> aname(3) /<span class="stringliteral">&#39;DISTRIBUTION COEFFICIENT&#39;</span>/</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keyword">data</span> aname(4) /<span class="stringliteral">&#39;              DECAY RATE&#39;</span>/</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keyword">data</span> aname(5) /<span class="stringliteral">&#39;       DECAY SORBED RATE&#39;</span>/</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keyword">data</span> aname(6) /<span class="stringliteral">&#39;   SECOND SORPTION PARAM&#39;</span>/</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    isfound = .false.</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    lname(:) = .false.</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">! -- get griddata block</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;GRIDDATA&#39;</span>, isfound, ierr)</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">if</span>(isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>)<span class="stringliteral">&#39;PROCESSING GRIDDATA&#39;</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keyword">call </span>this%parser%GetRemainingLine(line)</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        lloc = 1</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;POROSITY&#39;</span>)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                         this%parser%iuactive, this%porosity,  &amp;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                         aname(1))</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            lname(1) = .true.</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;BULK_DENSITY&#39;</span>)</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordflow">if</span> (this%isrb == 0) &amp;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%bulk_density, this%dis%nodes,           &amp;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                  <span class="stringliteral">&#39;BULK_DENSITY&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                         this%parser%iuactive,                 &amp;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                         this%bulk_density, aname(2))</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            lname(2) = .true.</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DISTCOEF&#39;</span>)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordflow">if</span> (this%isrb == 0) &amp;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%distcoef, this%dis%nodes, <span class="stringliteral">&#39;DISTCOEF&#39;</span>,   &amp;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                trim(this%memoryPath))</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                         this%parser%iuactive, this%distcoef,  &amp;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                         aname(3))</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            lname(3) = .true.</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DECAY&#39;</span>)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            <span class="keywordflow">if</span> (this%idcy == 0) &amp;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%decay, this%dis%nodes, <span class="stringliteral">&#39;DECAY&#39;</span>,         &amp;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                 trim(this%memoryPath))</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                         this%parser%iuactive, this%decay,     &amp;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                         aname(4))</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            lname(4) = .true.</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DECAY_SORBED&#39;</span>)</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%decay_sorbed, this%dis%nodes,             &amp;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                <span class="stringliteral">&#39;DECAY_SORBED&#39;</span>, trim(this%memoryPath))</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                         this%parser%iuactive,                 &amp;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                         this%decay_sorbed, aname(5))</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            lname(5) = .true.</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SP2&#39;</span>)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            <span class="keywordflow">if</span> (this%isrb &lt; 2) &amp;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;              <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__reallocate.html">mem_reallocate</a>(this%sp2, this%dis%nodes, <span class="stringliteral">&#39;SP2&#39;</span>,             &amp;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                trim(this%memoryPath))</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="keyword">call </span>this%dis%read_grid_array(line, lloc, istart, istop, this%iout,&amp;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                         this%parser%iuactive, this%sp2,       &amp;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                         aname(6))</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            lname(6) = .true.</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,a)&#39;</span>) <span class="stringliteral">&#39;UNKNOWN GRIDDATA TAG: &#39;</span>, trim(keyword)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END PROCESSING GRIDDATA&#39;</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;REQUIRED GRIDDATA BLOCK NOT FOUND.&#39;</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">! -- Check for rquired porosity</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span>(.not. lname(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;POROSITY NOT SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">! -- Check for required sorption variables</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (this%isrb &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordflow">if</span> (.not. lname(2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SORPTION IS ACTIVE BUT BULK_DENSITY &amp;</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;NOT SPECIFIED.  BULK_DENSITY MUST BE SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordflow">if</span> (.not. lname(3)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SORPTION IS ACTIVE BUT DISTRIBUTION &amp;</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;COEFFICIENT NOT SPECIFIED.  DISTCOEF MUST BE SPECIFIED IN &amp;</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">if</span> (this%isrb &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="keywordflow">if</span> (.not. lname(6)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;FREUNDLICH OR LANGMUIR SORPTION IS ACTIVE &amp;</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;BUT SP2 NOT SPECIFIED.  SP2 MUST BE SPECIFIED IN &amp;</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="keywordflow">if</span> (lname(2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SORPTION IS NOT ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;BULK_DENSITY WAS SPECIFIED.  BULK_DENSITY WILL HAVE NO AFFECT ON &amp;</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  &#39;</span> // warnmsg</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">if</span> (lname(3)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SORPTION IS NOT ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;DISTRIBUTION COEFFICIENT WAS SPECIFIED.  DISTCOEF WILL HAVE &amp;</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;NO AFFECT ON SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  &#39;</span> // warnmsg</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">if</span> (lname(6)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SORPTION IS NOT ACTIVE BUT &amp;</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;SP2 WAS SPECIFIED.  SP2 WILL HAVE &amp;</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;NO AFFECT ON SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  &#39;</span> // warnmsg</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">! -- Check for required decay/production rate coefficients</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">if</span> (this%idcy &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keywordflow">if</span> (.not. lname(4)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;FIRST OR ZERO ORDER DECAY IS &amp;</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;ACTIVE BUT THE FIRST RATE COEFFICIENT IS NOT SPECIFIED.  DECAY &amp;</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;MUST BE SPECIFIED IN GRIDDATA BLOCK.&#39;</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keywordflow">if</span> (.not. lname(5)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="comment">! -- If DECAY_SORBED not specified and sorption is active, then</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="comment">!    terminate with an error</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keywordflow">if</span> (this%isrb &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;DECAY_SORBED not provided in GRIDDATA &amp;</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;block but decay and sorption are active.  Specify DECAY_SORBED &amp;</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;in GRIDDATA block.&#39;</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">if</span> (lname(4)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;FIRST OR ZERO ORER DECAY &amp;</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;IS NOT ACTIVE BUT DECAY WAS SPECIFIED.  DECAY WILL &amp;</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;HAVE NO AFFECT ON SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  &#39;</span> // warnmsg</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keywordflow">if</span> (lname(5)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <span class="keyword">write</span>(warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;FIRST OR ZERO ORER DECAY &amp;</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;IS NOT ACTIVE BUT DECAY_SORBED WAS SPECIFIED.  &amp;</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="stringliteral"></span><span class="stringliteral">          &amp;DECAY_SORBED WILL HAVE NO AFFECT ON SIMULATION RESULTS.&#39;</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <span class="keyword">write</span>(this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;WARNING.  &#39;</span> // warnmsg</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">! -- terminate if errors</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">if</span>(count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a9d09f066cfdab8c675bf6191b267a71e_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a9d09f066cfdab8c675bf6191b267a71e_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a9d09f066cfdab8c675bf6191b267a71e_cgraph" id="namespacegwtmstmodule_a9d09f066cfdab8c675bf6191b267a71e_cgraph">
<area shape="rect" title="@ brief Read data for package" alt="" coords="5,68,199,95"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="252,17,436,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="257,68,431,95"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title="Store warning message." alt="" coords="247,119,441,145"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="489,68,628,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="676,27,844,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="676,93,844,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="892,5,1087,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="905,57,1073,98"/>
</map>
</div>

</div>
</div>
<a id="a8d176c88873cd8b526fe6db4c3f68ffb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d176c88873cd8b526fe6db4c3f68ffb">&#9670;&nbsp;</a></span>read_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwtmstmodule::read_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwtmstmodule_1_1gwtmsttype.html">gwtmsttype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Method to read options for the package. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwtMstType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l01151">1151</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>,   <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordtype">class</span>(GwtMstType) :: this<span class="comment">                                      !&lt; GwtMstType object</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword, keyword2</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtisvflow =                                &amp;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;CELL-BY-CELL FLOW INFORMATION WILL BE SAVED TO BINARY FILE &quot;</span> //    &amp;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="stringliteral">&quot;WHENEVER ICBCFL IS NOT ZERO.&#39;)&quot;</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtisrb =                                   &amp;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;LINEAR SORPTION IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtfreundlich =                             &amp;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;FREUNDLICH SORPTION IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtlangmuir =                               &amp;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;LANGMUIR SORPTION IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtidcy1 =                                  &amp;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;FIRST-ORDER DECAY IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtidcy2 =                                  &amp;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="stringliteral">&quot;(4x,&#39;ZERO-ORDER DECAY IS ACTIVE. &#39;)&quot;</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, blockrequired=.false., &amp;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING MOBILE STORAGE AND TRANSFER OPTIONS&#39;</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SAVE_FLOWS&#39;</span>)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            this%ipakcb = -1</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <span class="keyword">write</span>(this%iout, fmtisvflow)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SORBTION&#39;</span>, <span class="stringliteral">&#39;SORPTION&#39;</span>)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            this%isrb = 1</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <span class="keyword">call </span>this%parser%GetStringCaps(keyword2)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="keywordflow">if</span> (trim(adjustl(keyword2)) == <span class="stringliteral">&#39;LINEAR&#39;</span>) this%isrb = 1</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            <span class="keywordflow">if</span> (trim(adjustl(keyword2)) == <span class="stringliteral">&#39;FREUNDLICH&#39;</span>) this%isrb = 2</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordflow">if</span> (trim(adjustl(keyword2)) == <span class="stringliteral">&#39;LANGMUIR&#39;</span>) this%isrb = 3</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            <span class="keywordflow">select case</span> (this%isrb)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            <span class="keywordflow">case</span>(1)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;              <span class="keyword">write</span>(this%iout, fmtisrb)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <span class="keywordflow">case</span>(2)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;              <span class="keyword">write</span>(this%iout, fmtfreundlich)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            <span class="keywordflow">case</span>(3)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;              <span class="keyword">write</span>(this%iout, fmtlangmuir)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="keywordflow">            end select</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;FIRST_ORDER_DECAY&#39;</span>)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            this%idcy = 1</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            <span class="keyword">write</span>(this%iout, fmtidcy1)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ZERO_ORDER_DECAY&#39;</span>)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            this%idcy = 2</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="keyword">write</span>(this%iout, fmtidcy2)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <span class="keyword">write</span>(errmsg,<span class="stringliteral">&#39;(a,a)&#39;</span>) <span class="stringliteral">&#39;UNKNOWN MST OPTION: &#39;</span>, trim(keyword)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keyword">write</span>(this%iout,<span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF MOBILE STORAGE AND TRANSFER OPTIONS&#39;</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwtmstmodule_a8d176c88873cd8b526fe6db4c3f68ffb_cgraph.png" border="0" usemap="#namespacegwtmstmodule_a8d176c88873cd8b526fe6db4c3f68ffb_cgraph" alt=""/></div>
<map name="namespacegwtmstmodule_a8d176c88873cd8b526fe6db4c3f68ffb_cgraph" id="namespacegwtmstmodule_a8d176c88873cd8b526fe6db4c3f68ffb_cgraph">
<area shape="rect" title="@ brief Read options for package" alt="" coords="5,61,163,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="211,68,385,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="433,68,572,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="620,27,788,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title=" " alt="" coords="620,93,788,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="836,5,1031,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title=" " alt="" coords="849,57,1017,98"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a32da4440492b0eee857aad5ec0dadec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32da4440492b0eee857aad5ec0dadec5">&#9670;&nbsp;</a></span>budtxt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=lenbudtxt), dimension(<a class="el" href="namespacegwtmstmodule.html#ac0db1c5827de3221108759b936e53b3c">nbditems</a>) gwtmstmodule::budtxt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00026">26</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(NBDITEMS)</span> :: budtxt</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0db1c5827de3221108759b936e53b3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0db1c5827de3221108759b936e53b3c">&#9670;&nbsp;</a></span>nbditems</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b), parameter gwtmstmodule::nbditems = 4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwt1mst1_8f90_source.html#l00025">25</a> of file <a class="el" href="gwt1mst1_8f90_source.html">gwt1mst1.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">parameter</span> :: NBDITEMS = 4</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__reallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__reallocate.html">memorymanagermodule::mem_reallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00064">MemoryManager.f90:64</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdoc">real constant zero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00054">Constants.f90:54</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html_a917d4897942de165ea88d0c1f0850d8e"><div class="ttname"><a href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">budgetmodule::rate_accumulator</a></div><div class="ttdeci">subroutine, public rate_accumulator(flow, rin, rout)</div><div class="ttdoc">@ brief Rate accumulator subroutine</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00646">Budget.f90:646</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__reassignptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__reassignptr.html">memorymanagermodule::mem_reassignptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00080">MemoryManager.f90:80</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a060d310ded5535ce2dc85bd1ca1afd3d"><div class="ttname"><a href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">constantsmodule::linelength</a></div><div class="ttdeci">integer(i4b), parameter linelength</div><div class="ttdoc">maximum length of a standard line</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00036">Constants.f90:36</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__setptr_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__setptr.html">memorymanagermodule::mem_setptr</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00069">MemoryManager.f90:69</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html"><div class="ttname"><a href="namespacebudgetmodule.html">budgetmodule</a></div><div class="ttdoc">This module contains the BudgetModule.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00020">Budget.f90:20</a></div></div>
<div class="ttc" id="astructbudgetmodule_1_1budgettype_html"><div class="ttname"><a href="structbudgetmodule_1_1budgettype.html">budgetmodule::budgettype</a></div><div class="ttdoc">Derived type for the Budget object.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00039">Budget.f90:39</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdoc">This module contains simulation constants.</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00009">Constants.f90:9</a></div></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00085">MemoryManager.f90:85</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae9a8dbe15bd2bcb8a85d53d570407ae6"><div class="ttname"><a href="namespacetdismodule.html#ae9a8dbe15bd2bcb8a85d53d570407ae6">tdismodule::delt</a></div><div class="ttdeci">real(dp), pointer, public delt</div><div class="ttdoc">length of the current time step</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00030">tdis.f90:30</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegwtmstmodule.html">gwtmstmodule</a></li>
    <li class="footer">Generated on Wed Oct 27 2021 11:25:14 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
